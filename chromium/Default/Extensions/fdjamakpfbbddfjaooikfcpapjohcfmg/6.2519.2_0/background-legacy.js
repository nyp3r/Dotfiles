"use strict";(globalThis.webpackChunk_dashlane_amphora=globalThis.webpackChunk_dashlane_amphora||[]).push([["2"],{74326:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.fetchABTestingVersionDetails=void 0;let a=r(22560),o=r(53392);t.fetchABTestingVersionDetails=(e,t)=>{let r=e.storeService,n={capacity:"",language:r.getPlatform().info.lang,platform:"real_website"};return t?.abTestForcedVersion&&(n.forceVersion3=t.abTestForcedVersion),e.wsService.premium.getABTestingVersionDetails(n).then(e=>{r.dispatch((0,o.saveABTestingInfo)(e))}).catch(e=>{a.default.error("Carbon init - Error while calling getABTestingVersionDetails: ",e)})}},91071:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.config=void 0;let a=r(43379),o=r(89314),n=r(813);t.config={commands:{participateToUserABTest:{handler:o.participateToUserABTest}},queries:{getUserABTestVariant:{selector:n.userABTestVariantSelector}},liveQueries:{liveUserABTestVariant:{operator:a.userABTestVariant$}}}},53392:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.saveABTestingInfo=t.SAVE_ABTESTING_INFO=void 0,t.SAVE_ABTESTING_INFO="SAVE_ABTESTING_INFO",t.saveABTestingInfo=e=>({type:t.SAVE_ABTESTING_INFO,data:Object.assign({},e)})},14132:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.getEmptyABTesting=void 0;let a=r(53392);function o(){return{details:[],version:"control2016_all",success:null}}t.default=(e=o(),t)=>t.type===a.SAVE_ABTESTING_INFO?Object.assign({},e,{...t.data}):e,t.getEmptyABTesting=o},80304:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.bootstrap=void 0;let a=r(91071);t.bootstrap=e=>{e.register(a.config)}},10303:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.refreshUserABTest=void 0;let a=r(20648),o=r(1413),n=r(80896),i=r(7767),s=r(28323),c=r(22198),l=r(76811),u=r(34761);async function d(e,t,r){try{let a=(0,i.abTestsNamesSelector)(e.getState());if(0===a.length)return;let n=await (0,o.getAndEvaluateForUser)(e,r,{abtests:a});if((0,s.isApiError)(n))throw Error(`Failed to refresh user AB tests: ${n}`);let d=(0,l.mapGetUserABServerResponse)(a,n.abtests);e.dispatch((0,c.refreshedUserABTests)(d)),(0,u.persistUserTests)(t,e)}catch(t){let e=Error(`[ABTests] - refreshUserABTest: ${t}`);(0,n.sendExceptionLog)({error:e,code:a.ExceptionCriticality.WARNING})}}t.refreshUserABTest=d},75335:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.bootstrap=void 0;var a=r(80304);Object.defineProperty(t,"bootstrap",{enumerable:!0,get:function(){return a.bootstrap}})},43379:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.userABTestVariant$=void 0;let a=r(95121),o=r(15237),n=r(813);t.userABTestVariant$=e=>(0,a.pipe)((0,o.map)(t=>(0,n.userABTestVariantSelector)(t,e)),(0,o.distinctUntilChanged)())},76811:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.mapGetUserABServerResponse=t.NOT_PARTICIPATING=void 0,t.NOT_PARTICIPATING="not-participating",t.mapGetUserABServerResponse=function(e,r){return e.reduce((e,a)=>{let o=r.find(e=>a===e.name);return e[a]=o?{variant:o.variant,version:o.abtestVersion}:{variant:t.NOT_PARTICIPATING},e},{})}},89314:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.participateToUserABTest=void 0;let a=r(813),o=r(76811),n=r(34761);async function i(e,t){let r=(0,a.userABTestSelector)(e.storeService.getState(),t);r&&o.NOT_PARTICIPATING!==r.variant&&(0,n.persistUserTests)(e.localStorageService.getInstance(),e.storeService)}t.participateToUserABTest=i},34761:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.persistUserTests=void 0;let a=r(4455),o=r(813);async function n(e,t){if(t.getAccountInfo().persistData===a.PersistData.PERSIST_DATA_NO)return Promise.resolve();e&&await e.storeUserABTests((0,o.userABTestsSelector)(t.getState()))}t.persistUserTests=n},77180:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.setupSubscriptions=void 0;let a=r(28009),o=r(74326),n=r(13776);t.setupSubscriptions=function(e,t){e.appInitialized.on(async e=>{if(e.initMode===a.InitMode.FirstInit){await (0,o.fetchABTestingVersionDetails)(t,{abTestForcedVersion:e.abTestForcedVersion});let r=t.storeService.getABTesting();(0,n.triggerABTestingChanged)(r)}})}},76600:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.config=void 0;let a=r(43835),o=r(58003),n=r(15095);t.config={commands:{editContactInfo:{handler:a.editContactInfoHandler},refreshContactInfo:{handler:a.refreshContactInfoHandler}},queries:{getContactInfo:{selector:o.contactInfoSelector}},liveQueries:{liveContactInfo:{operator:n.contactInfo$}}}},18431:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.bootstrap=void 0;let a=r(76600);t.bootstrap=e=>{e.register(a.config)}},54569:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.editContactInfoHandler=void 0;let a=r(20648),o=r(28323),n=r(93748),i={contact_email_required:a.EditContactInfoErrorCode.EMPTY_EMAIL,contact_phone_required:a.EditContactInfoErrorCode.UNKNOWN_ERROR,invalid_contact_email:a.EditContactInfoErrorCode.INVALID_EMAIL};async function s(e,t){let{storeService:r,sessionService:s}=e,{user:c}=s.getInstance(),l=r.getState(),u=(0,n.userLoginSelector)(l);if(!r.isAuthenticated())return{success:!1,error:{code:a.EditContactInfoErrorCode.UNKNOWN_ERROR}};try{let e=await (0,o.updateContactInfo)(r,u,t);if((0,o.isApiError)(e))return{success:!1,error:{code:i[e.code]??a.EditContactInfoErrorCode.UNKNOWN_ERROR}};return await c.refreshContactInfo(),{success:!0}}catch(e){return{success:!1,error:{code:a.EditContactInfoErrorCode.UNKNOWN_ERROR}}}}t.editContactInfoHandler=s},43835:function(e,t,r){var a=this&&this.__createBinding||(Object.create?function(e,t,r,a){void 0===a&&(a=r);var o=Object.getOwnPropertyDescriptor(t,r);(!o||("get"in o?!t.__esModule:o.writable||o.configurable))&&(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,a,o)}:function(e,t,r,a){void 0===a&&(a=r),e[a]=t[r]}),o=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||a(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),t.refreshContactInfoHandler=void 0,o(r(54569),t);var n=r(94042);Object.defineProperty(t,"refreshContactInfoHandler",{enumerable:!0,get:function(){return n.refreshContactInfoHandler}})},94042:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.refreshContactInfoHandler=void 0;let a=r(20648);async function o(e){try{let{sessionService:t}=e,{user:r}=t.getInstance();return await r.refreshContactInfo(),{success:!0}}catch(e){return{success:!1,error:{code:a.RefreshContactInfoErrorCode.UNKNOWN_ERROR}}}}t.refreshContactInfoHandler=o},30717:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.bootstrap=void 0;var a=r(18431);Object.defineProperty(t,"bootstrap",{enumerable:!0,get:function(){return a.bootstrap}})},15095:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.contactInfo$=void 0;let a=r(95121),o=r(15237),n=r(58003);t.contactInfo$=()=>(0,a.pipe)((0,o.map)(n.contactInfoSelector),(0,o.distinctUntilChanged)())},58003:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.contactInfoSelector=void 0,t.contactInfoSelector=e=>e.userSession.accountContactInfo},97880:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.makeAccountCreationController=t.encryptSettings=t.checkLogin=t.validateLoginForAccountCreation=void 0;let a=r(20648),o=r(80896),n=r(49977),i=r(1722),s=r(67972),c=r(40501),l=r(98215),u=r(76380),d=r(15346),p=r(22560),S=r(92180),g=r(93308),m=r(28323),y=/^[a-zA-Z0-9_.+@'\-{}]{5,128}.[A-Za-z]{2,24}$/;function f(e){return y.test(e)}async function E(e,t){if(p.default.log("AccountCreationController.checkLogin"),!f(t))return{accountCreationCode:a.AccountCreationCode.USER_DOESNT_EXIST_INVALID_MX};let r=await (0,m.requestAccountCreation)(e,{login:t});if((0,m.isApiError)(r)){if("SSO_BLOCKED"===r.code)return{accountCreationCode:a.AccountCreationCode.USER_DOESNT_EXIST_SSO_NON_PROVISIONED};throw Error(`[AccountCreationController] - checkLogin: ${r.message} (${r.code})`)}if(r.ssoServiceProviderUrl)return(e.dispatch((0,u.storeSSOSettings)({serviceProviderUrl:r.ssoServiceProviderUrl,isNitroProvider:r.ssoIsNitroProvider})),r.ssoIsNitroProvider)?{accountCreationCode:a.AccountCreationCode.USER_NITRO_SSO_PROVISIONED,isProposedExpired:r.isProposedExpired,isUserProposed:r.isProposed,isUserAccepted:r.isAccepted}:((0,d.triggerServiceProviderUrlRedirect)(e.getState(),t),{accountCreationCode:a.AccountCreationCode.USER_SSO_PROVISIONED,isProposedExpired:r.isProposedExpired,isUserProposed:r.isProposed,isUserAccepted:r.isAccepted});switch(r.exists){case m.AccountExistsStatus.AccountExists:return{accountCreationCode:a.AccountCreationCode.USER_EXISTS,isProposedExpired:r.isProposedExpired,isUserProposed:r.isProposed,isUserAccepted:r.isAccepted};case m.AccountExistsStatus.AccountDoesntExistInvalid:return{accountCreationCode:a.AccountCreationCode.USER_DOESNT_EXIST_INVALID_MX,isProposedExpired:r.isProposedExpired,isUserProposed:r.isProposed,isUserAccepted:r.isAccepted};case m.AccountExistsStatus.AccountDoesntExistUnlikely:return{accountCreationCode:a.AccountCreationCode.USER_DOESNT_EXIST_UNLIKELY_MX,isProposedExpired:r.isProposedExpired,isUserProposed:r.isProposed,isUserAccepted:r.isAccepted};case m.AccountExistsStatus.AccountDoesntExist:default:return{accountCreationCode:a.AccountCreationCode.USER_DOESNT_EXIST,isProposedExpired:r.isProposedExpired,isUserProposed:r.isProposed,isUserAccepted:r.isAccepted}}}function A(e,t,r){return Promise.resolve().then(()=>{let a=e.getStore(),o=n.encryptSettings(e,t,r);a.dispatch((0,c.saveAccountSettings)(o));let i=(0,s.makeCryptoService)(),u={cryptoConfig:(0,S.parsePayload)(o.personalSettings.CryptoUserPayload).cryptoConfig,forceSalt:(0,g.base64ToBuffer)(o.personalSettings.CryptoFixedSalt)},d={promise:(0,l.generateRsaKeys)(t,i,u)};return e.dispatch((0,c.saveAccountKeys)(d)),{encryptSettingsRequest:r,valid:!0}}).catch(e=>{let t=Error(`[AccountCreation] - encryptSettings: ${e}`);throw p.default.error(t),(0,o.sendExceptionLog)({error:t}),t})}t.validateLoginForAccountCreation=f,t.checkLogin=E,t.encryptSettings=A,t.makeAccountCreationController=function(e){return{checkLogin:t=>E(e.storeService,t),createAccount:t=>(e.storeService.dispatch((0,c.accountCreationStarted)({isSSO:!1})),e.sessionService.close(!1).then(()=>{e.masterPasswordEncryptorService.setInstance({raw:t.password},"");let{storeService:r,masterPasswordEncryptorService:a}=e;return A(r,a,t)})),confirmAccountCreation:t=>Promise.resolve().then(()=>{let r=e.storeService.getStore().getState().userSession.accountCreation.settings.personalSettings,a=e.storeService.getAccountCreation(),o=a.settings.promise;if(null===o)throw Error("createAccount should be call before confirmAccountCreation");let n=a.accountKey.promise;if(null===n)throw Error("createAccount should be call before confirmAccountCreation");return i.createAccount(e,t,o,r,n)}).catch(e=>{let t=Error(`[AccountCreation] - confirmAccountCreation: ${e}`);throw p.default.error(t),(0,o.sendExceptionLog)({error:t}),t})}}},49977:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.encryptSettings=void 0;let a=r(83648),o=r(27498),n=r(34978),i=r(50527),s=r(93308),c=r(60355),l=r(62774),u=r(13206),d=r(61681),p=r(67179);t.encryptSettings=function(e,t,r){let S=(0,d.generateItemUuid)(),g=(0,p.getUnixTimestamp)(),m=(0,c.getRandomValues)(16),y=e.getState(),f=(0,l.isSSOAccountCreationSelector)(y)?i.CRYPTO_NODERIVATION_HMAC64:n.ARGON2_DEFAULT_PAYLOAD,E={...(0,u.makeBasePersonalSettings)(),AnonymousUserId:r.anonymousUserId,UsagelogToken:S,Format:r.format,Language:r.language,SecurityEmail:r.login,RealLogin:r.login,accountCreationDatetime:g,SyncBackup:!0,CryptoFixedSalt:(0,s.bufferToBase64)(m),CryptoUserPayload:f},A=(0,o.getTransactionXml)(E),h={time:(0,p.getUnixTimestamp)(),backupDate:0,type:"SETTINGS",action:"BACKUP_EDIT",identifier:"SETTINGS_userId",content:A};return{personalSettings:E,promise:a.encryptSingleTransaction(t,h,{forceSalt:m})}}},95174:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.createSSOAccount=t.prepareRemoteDataEncryptionServices=void 0;let a=r(42387),o=r(20648),n=r(97880),i=r(1722),s=r(29509),c=r(34978),l=r(93308),u=r(18040),d=r(58361),p=r(12971),S=r(28323),g=r(80896),m=r(15346),y=r(49789),f=r(40501),E=async(e,t)=>{let r=(0,a.v4)(),{remoteDataEncryptorService:o,masterPasswordEncryptorService:n}=e,i=await (0,p.generate64BytesKey)(),s=(0,l.base64BufferToText)(i),S=await (0,p.generate64BytesKey)(),g=(0,l.bufferToBase64)(S),m=(0,l.base64ToBuffer)(t),f=(0,d.getEncryptionKeyBuffer)(m,S,{skipDerivation:!0}),E=(0,l.arrayBufferToText)(f),A=(0,u.getNoDerivationCryptoConfig)();n.setInstance({raw:E},"",A);let h=(0,c.utf16ToDeflatedUtf8)(s,{skipUtf8Encoding:!0,skipDeflate:!0}),_=await n.getInstance().encrypt(h);return o.setInstance({raw:s},"",A),e.storeService.dispatch((0,y.updateRemoteKey)(s)),{remoteKey:{uuid:r,key:_,type:"sso"},serverKeyBase64:g}};async function A(e,r){let{sessionService:a,storeService:c,remoteDataEncryptorService:l}=e,{consents:u,deviceName:d,login:p,ssoServiceProviderKey:g,ssoToken:m,anonymousUserId:E}=r,{appVersion:A,country:_,lang:T,platformName:v}=(0,s.platformInfoSelector)(c.getState());await a.close(!1),c.dispatch((0,f.accountCreationStarted)({isSSO:!0}));let{remoteKey:I,serverKeyBase64:D}=await (0,t.prepareRemoteDataEncryptionServices)(e,g),P={anonymousUserId:E,deviceName:d,format:_,language:T,login:p,password:g,subscribe:u.find(({consentType:e})=>"emailsOffersAndTips"===e).status||!1};await (0,n.encryptSettings)(c,l,P);let O=c.getAccountCreation(),{content:C,time:b}=await O.settings.promise,R=await O.accountKey.promise,N=(0,S.makeSafeCountry)(c.getLocation().country||_);if("server_carbon_unknown"===v)throw Error("Unexpected uninitialized platform info");let w={login:p,contactEmail:p,appVersion:A,sdkVersion:"1.0.0.0",platform:v,settings:{content:C,time:b},consents:u,deviceName:d,country:N,osCountry:N,language:(0,S.makeSafeLanguage)(T),osLanguage:(0,S.makeSafeLanguage)(T),remoteKeys:[I],ssoServerKey:D,ssoToken:m,sharingKeys:{publicKey:R.keys.publicKey,privateKey:R.encryptedPrivateKey},temporaryDevice:!0},L=await (0,S.createUserWithSSO)(c,w);return(0,S.isApiError)(L)?h(L):(await (0,i.firstSync)(e,{createAccountResult:{encryptSettingsRequest:P,valid:!0},options:{flowIndicator:"memberAccount"},isStandAlone:!1,consents:u},L,{useRemoteKey:!0}),e.storeService.dispatch((0,y.updateAnalyticsIds)(L.userAnalyticsId,L.deviceAnalyticsId)),{success:!0,code:o.LoginViaSsoCode.SUCCESS})}t.prepareRemoteDataEncryptionServices=E,t.createSSOAccount=A;let h=e=>{let{code:t,message:r}=e;switch(_(t),t){case S.DomainNotValidForTeam:case S.InvalidUser:case S.InvalidSsoToken:case S.NotProposedNeitherAccepted:case S.NoFreeSlot:return(0,m.makeReturnErrorObject)(o.LoginViaSsoCode.SSO_VERIFICATION_FAILED,r);default:return(0,m.makeReturnErrorObject)(o.LoginViaSsoCode.UNKNOWN_ERROR,r)}},_=e=>{let t=Error(`[createSSOAccount] - createUserWithSSO: ${e}`);(0,g.sendExceptionLog)({error:t})}},1722:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.firstSync=t.createAccount=void 0;let a=r(20648),o=r(83533),n=r(87829),i=r(75795),s=r(4455),c=r(72287),l=r(49789),u=r(61681),d=r(64419),p=r(33170),S=r(52780),g=r(63011),m=r(58682),y=r(99882),f=r(48451),E=r(28323),A=r(51414),h=r(80306);async function _(e,t,r,a,o){let n=e.storeService.getPlatform().info;if(!t.createAccountResult.valid)throw Error("Account creation: Will not perform API request for invalidated settings promise");let[i,s]=await Promise.all([r,o]),c=await T(e,n,t,a,i,s);await v(e,t,c);let l=(0,A.convertDeviceKeysToUki)({accessKey:c.deviceAccessKey,secretKey:c.deviceSecretKey});return{m2dToken:c.token,abtestingversion:c.abTestingVersion,uki:l,origin:c.origin,openSession:t.isStandAlone}}async function T(e,t,r,a,o,n){let{storeService:i}=e,{createAccountResult:s}=r,c=e.storeService.getABTesting().version,u=r.consents;Array.isArray(u)||(u=[{consentType:"emailsOffersAndTips",status:s.encryptSettingsRequest.subscribe}]);let d=s.encryptSettingsRequest.login;if("server_carbon_unknown"===t.platformName)throw Error("Unexpected uninitialized platform info");let g={abTestingVersion:c,askM2dToken:!0,country:(0,E.makeSafeCountry)(e.storeService.getLocation().country||t.country),deviceName:(0,E.makeSafeDeviceName)((0,S.secureDeviceName)(s.encryptSettingsRequest.deviceName)),language:(0,E.makeSafeLanguage)(t.lang),login:d,osCountry:(0,E.makeSafeCountry)(t.country),osLanguage:(0,E.makeSafeLanguage)(t.lang),platform:t.platformName,settings:{content:o.content,time:o.time},appVersion:t.appVersion,contactEmail:d,consents:u,sharingKeys:{publicKey:n.keys.publicKey,privateKey:n.encryptedPrivateKey},temporaryDevice:!r.isStandAlone},m=await (0,E.createUser)(i,g);if((0,E.isApiError)(m))throw Error(`[AccountCreation] - createAccountOnServer : ${m.message} (${m.code})`);return e.storeService.dispatch((0,l.updateIsFirstSessionAfterAccountCreation)()),e.storeService.dispatch((0,l.updateKeyPair)({publicKey:n.keys.publicKey,privateKey:n.keys.privateKey})),e.storeService.dispatch((0,p.loadStoredPersonalSettings)(a)),e.storeService.dispatch((0,l.updateAnalyticsIds)(m.userAnalyticsId,m.deviceAnalyticsId)),m}async function v(e,t,r,l={useRemoteKey:!1}){let p=t.createAccountResult,{login:E}=p.encryptSettingsRequest,_=(0,u.generateItemUuid)(),T=(0,d.getEmptyPersonalDataState)();T.emails.push({Email:E,EmailName:"Email 1",Id:_,kwType:"KWEmail",LastBackupTime:0,LocaleFormat:a.Country.UNIVERSAL,SpaceId:"",Type:"PERSO"}),T.changesToUpload.push((0,h.createUploadChange)({action:"EDIT",itemId:_,kwType:"KWEmail"}));let{monitor:I}=(0,y.makeEventLoggerSyncMonitor)(),D=(0,m.setupProbe)(I,(0,f.makeSyncLoggerMonitor)()),P={accessKey:r.deviceAccessKey,secretKey:r.deviceSecretKey},O=(0,A.convertDeviceKeysToUki)(P),C=l.useRemoteKey?e.remoteDataEncryptorService:e.masterPasswordEncryptorService,b=Date.now(),R=n.SyncType.FULL_SYNC,N={storeService:e.storeService,dataEncryptorService:C,login:E,uki:O,lastSyncTimestamp:b,personalData:T,syncType:R,needsKeys:!1,ws:e.wsService,announce:D},w=null;try{D(g.announcements.syncStarted(o.Trigger.AccountCreation,R),g.announcements.chronologicalSyncStarted(T)),w=await (0,i.sync)(N),D(g.announcements.chronologicalSyncFinished(w.summary),g.announcements.syncFinished())}catch(e){throw D(g.announcements.chronologicalSyncFailed(e),g.announcements.syncFailed(e)),e}if(t.isStandAlone){let t=(0,c.makeLoginController)(e);await t.loadAccountCreationInfos(E,p.encryptSettingsRequest.password,(0,S.secureDeviceName)(p.encryptSettingsRequest.deviceName),P,w.lastSyncTimestamp,s.PersistData.PERSIST_DATA_YES),await t.openSession(E,{password:p.encryptSettingsRequest.password})}}t.createAccount=_,t.firstSync=v},10861:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.AntiPhishingConfig=void 0;let a=r(14803);t.AntiPhishingConfig={commands:{},queries:{},liveQueries:{livePhishingURLList:{operator:a.antiPhishingURLList$}}}},74044:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.updateAntiPhishingURLList=t.UPDATE_ANTI_PHISHING_URL_LIST=void 0,t.UPDATE_ANTI_PHISHING_URL_LIST="UPDATE_ANTI_PHISHING_URL_LIST",t.updateAntiPhishingURLList=e=>({type:t.UPDATE_ANTI_PHISHING_URL_LIST,phishingURLList:e})},74903:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.bootstrap=void 0;let a=r(10861);t.bootstrap=e=>{e.register(a.AntiPhishingConfig)}},59482:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.REMOTE_PHISHING_FILE=void 0,t.REMOTE_PHISHING_FILE="phishing_urls_test.json"},27195:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.bootstrap=void 0;var a=r(74903);Object.defineProperty(t,"bootstrap",{enumerable:!0,get:function(){return a.bootstrap}})},14803:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.antiPhishingURLList$=void 0;let a=r(95121),o=r(15237),n=r(28748);t.antiPhishingURLList$=()=>(0,a.pipe)((0,o.map)(n.antiPhishingURLListSelector),(0,o.distinctUntilChanged)())},10814:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.AntiPhishingReducer=t.getEmptyAntiPhishingState=void 0;let a=r(49093),o=r(74044);t.getEmptyAntiPhishingState=()=>new Set([]),t.AntiPhishingReducer=(e=(0,t.getEmptyAntiPhishingState)(),r)=>r.type===o.UPDATE_ANTI_PHISHING_URL_LIST?(0,a.areSetsEqual)(r.phishingURLList,e)?e:r.phishingURLList:e},28748:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.antiPhishingURLListSelector=void 0,t.antiPhishingURLListSelector=e=>e.device.antiPhishing},37314:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.setupSubscriptions=void 0;let a=r(56063);t.setupSubscriptions=function(e,t){e.remoteFileChanged.on(e=>(0,a.triggerUpdatePhishingURLFile)(t,e))}},56063:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.triggerUpdatePhishingURLFile=void 0;let a=r(80896),o=r(39382),n=r(74044),i=r(59482),s=e=>{let t=(0,o.fileContentStrSelector)(e,i.REMOTE_PHISHING_FILE),r=t?JSON.parse(t):[];if(!(1===r.fileFormat&&Array.isArray(r.domains))){let e=Error("[Anti-Phishing]: File format is invalid");return(0,a.sendExceptionLog)(e),null}return{domains:new Set(r.domains),fileFormat:r.fileFormat}};t.triggerUpdatePhishingURLFile=function(e,t){let{storeService:r}=e,a=r.getState();if(t===i.REMOTE_PHISHING_FILE){let e=s(a);e&&r.dispatch((0,n.updateAntiPhishingURLList)(e.domains))}}},17229:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.connectLazySlot=void 0;let a=r(95674),o=["API","Live"],n=(e,t,r,n)=>e?e=>((0,a.logInfo)({message:`Emitting on ${t.slotName} with param ${r}`,tag:o,details:{event:e}}),n(e)):n;t.connectLazySlot=(e,t,r=!1)=>{let i=new Map;return e.lazy(s=>{r&&(0,a.logInfo)({message:`${e.slotName} subscribed on param ${s}`,tag:o});let c=t(s),l=n(r,e,s,t=>e(s,t).catch(()=>void 0)),u=c.subscribe(l);i.set(s,u)},t=>{let n=i.get(t);n?(r&&(0,a.logInfo)({message:`${e.slotName} unsubscribed on param ${t}`,tag:o}),n.unsubscribe(),i.delete(t)):r&&(0,a.logWarn)({message:`Cannot unsubscribe from ${e.slotName} on param ${t}: subscription not found.`,tag:o})})}},15535:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.getSyncAppSetting=t.setDataDEBUGONLY=t.decipherApplicationSettings=t.loadAppSettings=t.getCommonAppSettings=t.getCommonAppSetting=t.storeCommonAppSetting=t.getUsersWithPublicSettings=t.deleteUsersPublicSettings=t.getUserPublicSetting=t.storeUserPublicSetting=t.initApplicationSettings=void 0;let a=r(22560),o=r(25434),n=r(34978),i=r(70362),s=r(897),c=r(23724),l=r(7767),u=r(28009),d=null,p=null,S=null;async function g(e){if(!S)throw Error("ApplicationSettings not initialized");return S.dispatch((0,c.deleteUserPublicSettings)(e)),f()}function m(){if(!S)throw Error("ApplicationSettings not initialized");let e=(0,l.commonApplicationSettingsSelector)(S.getState());return e||{}}t.initApplicationSettings=function(e,t,r,a){return(d=e,p=a&&a.dataEncryptorService||(0,i.makeKeyDataEncryptorService)(),S=t,(0,o.setObfuscatingKey)(p),r===u.InitMode.FirstInit)?(a?.settings&&t.dispatch((0,c.storeApplicationSettings)(a.settings)),E()):Promise.resolve()},t.storeUserPublicSetting=function(e,t,r){if(!S)throw Error("ApplicationSettings not initialized");return S.dispatch((0,c.storeUserPublicSetting)(e,{[t]:r})),f()},t.getUserPublicSetting=function(e,t){if(!S)throw Error("ApplicationSettings not initialized");let r=(0,l.userPublicSettingsSelector)(S.getState(),e);return r&&r.hasOwnProperty(t)?r[t]:null},t.deleteUsersPublicSettings=g,t.getUsersWithPublicSettings=function(){if(!S)throw Error("ApplicationSettings not initialized");return Object.keys((0,l.publicUsersSettingsSelector)(S.getState()))},t.storeCommonAppSetting=function(e,t){return m()[e]=t,f()},t.getCommonAppSetting=function(e){let t=m();return t.hasOwnProperty(e)?(t[e],t[e]):null},t.getCommonAppSettings=m;let y="ApplicationSettings.cdata";function f(){if(!S||!d||!p)throw Error("ApplicationSettings not initialized");let e=d.getLocalStorage(),t=JSON.stringify({publicUsersSettings:(0,l.publicUsersSettingsSelector)(S.getState()),commonApplicationSettings:(0,l.commonApplicationSettingsSelector)(S.getState())||{}}),r=(0,n.utf16ToDeflatedUtf8)(t);return p.getInstance().encrypt(r).then(t=>e.writeItem(y,t)).then(()=>{})}function E(){if(!d||!p)throw Error("ApplicationSettings not initialized");let e=d.getLocalStorage();return e.itemExists(y).then(t=>t?e.readItem(y).then(e=>{if(null==e)throw Error("storing empty or null value is not authorized");if("string"!=typeof e)throw Error("value of ApplicationSettings.cdata is expected to be a string");return A(p,e).then(e=>JSON.parse(e)).then(e=>{_(e)})}):_(h())).catch(e=>{a.default.error(e,"loadAppSettings"),_(h())})}function A(e,t){return e.getInstance().decrypt(t).then(e=>(0,n.deflatedUtf8ToUtf16)(e)).catch(()=>{let e=(0,o.makeDataEncryptorService)((0,s.makeStoreService)());return(0,o.setObfuscatingKey)(e),e.getInstance().decrypt(t).then(e=>(0,n.deflatedUtf8ToUtf16)(e))})}function h(){return{publicUsersSettings:{},commonApplicationSettings:{}}}function _(e){if(!S)throw Error("ApplicationSettings not initialized");S.dispatch((0,c.storeApplicationSettings)(e))}t.loadAppSettings=E,t.decipherApplicationSettings=A,t.setDataDEBUGONLY=function(e){if(!S)throw Error("ApplicationSettings not initialized");S.dispatch((0,c.storeApplicationSettings)(e))},t.getSyncAppSetting=function(e){let t=function(){if(!S)throw Error("ApplicationSettings not initialized");return S.getState().device.application.settings.sync}();return t.hasOwnProperty(e)?t[e]:null}},47589:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.appSessionIdInitialized=t.APP_SESSION_ID_INITIALIZED=void 0,t.APP_SESSION_ID_INITIALIZED="APP_SESSION_ID_INITIALIZED",t.appSessionIdInitialized=e=>({type:t.APP_SESSION_ID_INITIALIZED,appSessionId:e})},70515:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.applicationReducer=t.getEmptyApplicationSessionState=void 0;let a=r(20781),o=r(77568),n=r(47589);t.getEmptyApplicationSessionState=()=>({appSessionId:void 0}),t.applicationReducer=(0,a.combineReducers)({appSession:(e=(0,t.getEmptyApplicationSessionState)(),r)=>r.type===n.APP_SESSION_ID_INITIALIZED?{...e,appSessionId:r.appSessionId}:e,settings:o.default})},12826:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.appSessionIdSelector=void 0,t.appSessionIdSelector=e=>e.device.application.appSession.appSessionId},23724:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.deleteUserPublicSettings=t.storeUserPublicSetting=t.storeApplicationSettings=t.DELETE_USER_PUBLIC_SETTINGS=t.STORE_USER_PUBLIC_SETTING=t.STORE_APPLICATION_SETTINGS=void 0,t.STORE_APPLICATION_SETTINGS="STORE_APPLICATION_SETTINGS",t.STORE_USER_PUBLIC_SETTING="STORE_USER_PUBLIC_SETTING",t.DELETE_USER_PUBLIC_SETTINGS="DELETE_USER_PUBLIC_SETTINGS",t.storeApplicationSettings=e=>({type:t.STORE_APPLICATION_SETTINGS,settings:e}),t.storeUserPublicSetting=(e,r)=>({type:t.STORE_USER_PUBLIC_SETTING,login:e,userSettings:r}),t.deleteUserPublicSettings=e=>({type:t.DELETE_USER_PUBLIC_SETTINGS,logins:e})},77568:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.getEmptyApplicationSettings=void 0;let a=r(23724),o=()=>({syncWithLocalClients:!1});t.getEmptyApplicationSettings=()=>({sync:o(),userABTestNames:[],migratedToSAEX:void 0,desktopLogin:void 0,publicUsersSettings:void 0,commonApplicationSettings:void 0}),t.default=(e=(0,t.getEmptyApplicationSettings)(),r)=>{switch(r.type){case a.STORE_APPLICATION_SETTINGS:return{...e,...r.settings||{}};case a.STORE_USER_PUBLIC_SETTING:{let t=r.login,a=e.publicUsersSettings??{},o={...a,[t]:{...a[t]??{},...r.userSettings}};return{...e,publicUsersSettings:o}}case a.DELETE_USER_PUBLIC_SETTINGS:{let t=r.logins,a=Object.keys(e.publicUsersSettings??{}),o=t.filter(e=>a.includes(e.trim()));if(0===o.length)return{...e};return o.forEach(t=>{let r=t.trim();delete e.publicUsersSettings[r]}),{...e}}default:return e}}},7767:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.commonApplicationSettingsSelector=t.publicUsersSettingsSelector=t.userPublicSettingsSelector=t.abTestsNamesSelector=void 0;let r={};t.abTestsNamesSelector=e=>e.device.application.settings.userABTestNames,t.userPublicSettingsSelector=(e,t)=>e.device.application.settings.publicUsersSettings?.[t],t.publicUsersSettingsSelector=e=>e.device.application.settings.publicUsersSettings??r,t.commonApplicationSettingsSelector=e=>e.device.application.settings.commonApplicationSettings},93787:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.ensureDeviceId=t.initAuthenticatedCarbonApplication=void 0;let a=r(42387),o=r(15535),n=r(47674),i=r(32395),s=r(80896),c=r(591),l=r(65559),u=r(53510),d=r(12971),p=r(93308),S=r(28009);async function g(e,t,r,{platformInfo:n,settings:i}){try{console.log("[background/carbon] Initializing Carbon application settings"),(0,u.initializeAppSessionId)(e),(0,l.setPlatformInfo)(n),await (0,o.initApplicationSettings)(t,e,r,{settings:i}),await function(){if(!(0,o.getCommonAppSetting)("anonymousComputerId"))return(0,o.storeCommonAppSetting)("anonymousComputerId",(0,a.v4)())}(),await ((0,o.getCommonAppSetting)("installationId")?Promise.resolve():(0,o.storeCommonAppSetting)("installationId",(0,a.v4)())),await f()}catch(e){throw console.error("[background/carbon] Failed initializing Carbon application",e),e}}t.default=g;let m=async(e,t,r)=>{r===S.InitMode.FirstInit&&await E(e,t);let{storageService:a,storeService:o}=(0,n.getCoreServices)(t);return await g(o,a,r,e),t};async function y(){let e=(0,o.getCommonAppSetting)("deviceId");return e||(await (0,o.storeCommonAppSetting)("deviceId",(0,a.v4)().replace(/-/g,"")),e=(0,o.getCommonAppSetting)("deviceId")),e}async function f(){if(!(0,o.getCommonAppSetting)("eventLoggerQueueKey")){let e=await (0,d.generate64BytesKey)(),t=(0,p.base64BufferToText)(e);return(0,o.storeCommonAppSetting)("eventLoggerQueueKey",t)}}t.initAuthenticatedCarbonApplication=m,t.ensureDeviceId=y;let E=async(e,t)=>{try{console.log("[background/carbon] Initializing SDK authentication");let r=(0,n.getCoreServices)(t),{storeService:a}=r;e.anonymousPartnerId&&a.dispatch((0,i.loadAnonymousPartnerId)(e.anonymousPartnerId)),await (0,c.initAuthentication)(r,e.keys)}catch(t){console.error("[background/carbon] Failed initializing SDK authentication",t);let e=Error(`[Application] - setSdkAuthentication: ${t}`);(0,s.sendExceptionLog)({error:e})}}},65559:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.setPlatformInfo=t.getPlatformInfo=void 0;let a=r(4221),o=Object.assign({},a.defaultPlatformInfo);t.getPlatformInfo=function(){return o},t.setPlatformInfo=function(e){o=Object.assign({},a.defaultPlatformInfo,e)}},53510:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.getApplicationSessionId=t.initializeAppSessionId=void 0;let a=r(98233),o=r(12826),n=r(47589);function i(e){return(0,o.appSessionIdSelector)(e.getState())}t.initializeAppSessionId=function(e){i(e)||function(e,t){e.dispatch((0,n.appSessionIdInitialized)(t))}(e,(0,a.default)())},t.getApplicationSessionId=i},32034:function(e,t){let r;Object.defineProperty(t,"__esModule",{value:!0}),t.getPublicPath=t.setPublicPath=void 0,t.setPublicPath=e=>{if("string"!=typeof e)throw Error("[Assets] - setPublicPath: provided public path is not a string.");r=e},t.getPublicPath=()=>{if(!r)throw Error("[Assets] - getPublicPath: trying to access public path before it was set.");return r}},93154:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.config=void 0;let a=r(89372),o=r(33705),n=r(40383),i=r(50433),s=r(14297),c=r(70102),l=r(29509),u=r(70058),d=r(50239),p=r(72620),S=r(58770);t.config={commands:{registerDevice:{handler:d.registerDeviceHandler},requestEmailToken:{handler:c.requestEmailToken},requestPaymentUpdateAuthenticationToken:{handler:c.requestPaymentUpdateAuthenticationToken},setReactivationStatus:{handler:u.setReactivationStatusHandler},disableAutologin:{handler:p.disableAutologin},openSessionWithMasterPassword:{handler:S.openSessionWithMasterPasswordHandler},...a.config.commands,...o.config.commands,...n.config.commands,...i.config.commands},queries:{getHasOtp2Type:{selector:l.hasOtp2TypeSelector},getUserOtpType:{selector:l.otpTypeSelector},getLocalAccounts:{selector:l.localAccountsListSelector},getReactivationStatus:{selector:l.reactivationStatusSelector},...a.config.queries,...o.config.queries,...n.config.queries,...i.config.queries},liveQueries:{liveReactivationStatus:{operator:s.reactivationStatus$},...a.config.liveQueries,...o.config.liveQueries,...n.config.liveQueries,...i.config.liveQueries}}},72620:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.disableAutologin=void 0;let a=r(23555),o=r(29509),n=r(10039);async function i({storeService:e,localStorageService:t}){return["autologin","sso"].includes((0,o.rememberMeTypeSelector)(e.getState()))&&(await t.getInstance().cleanAuthenticationKey(),await (0,n.persistLocalAccountRememberMeType)(e,"disabled"),e.dispatch((0,a.setRememberMeTypeAction)("disabled"))),Promise.resolve()}t.disableAutologin=i},92846:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.getLocalAccounts=void 0;let a=r(15535),o=r(29509),n=r(6833),i=r(10039),s=r(22560),c=r(80896);async function l(e,t){let r=(0,a.getUsersWithPublicSettings)(),l={},u=["localSettings","personalData","personalSettings"];return Promise.all(r.map(async r=>{let a=[...u,...(0,o.getUserDeviceWasRegisteredWithDeviceKeysSelector)(e.getState(),r)?["authentication"]:[]],i=(await Promise.all(a.map(e=>(0,n.isDataStored)(t,r,e)))).every(e=>e);l[r]=i})).then(()=>r.filter(e=>l[e])).then(e=>{let t=e.map(e=>({login:e,lastLoginTime:(0,a.getUserPublicSetting)(e,"lastSuccessfulLoginTime")||0})).sort((e,t)=>{let r=e.lastLoginTime,a=t.lastLoginTime;return r>a?-1:+(r<a)})[0];return e.map(e=>({login:e,hasLoginOtp:(0,a.getUserPublicSetting)(e,"otp2")||!1,isLastSuccessfulLogin:t&&t.login===e,rememberMeType:(0,i.getLocalAccountRememberMeType)(e)??void 0,shouldAskMasterPassword:(0,i.shouldAskMasterPassword)(e)})).sort((e,t)=>{let r=e.login.toLowerCase(),a=t.login.toLowerCase();return r.localeCompare(a)})}).catch(e=>{let t=`get-local-accounts: ${e}`,r=Error(t);return(0,s.logError)({message:t,details:{error:r}}),(0,c.sendExceptionLog)({error:r}),[]})}t.getLocalAccounts=l},47207:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.getTokenForKwUser=void 0;let a=r(28323),o=async(e,t)=>{let{storeService:r}=e,o=await (0,a.getTokens)(r);if((0,a.isApiError)(o))throw Error(`Error: ${o.code}`);let{tokens:n}=o,i=n.find(e=>e.login===t);if(!i)throw Error("Email token not found for "+t);return i.token};t.getTokenForKwUser=o},70102:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.requestPaymentUpdateAuthenticationToken=t.requestEmailToken=void 0;var a=r(34550);Object.defineProperty(t,"requestEmailToken",{enumerable:!0,get:function(){return a.requestEmailToken}});var o=r(20284);Object.defineProperty(t,"requestPaymentUpdateAuthenticationToken",{enumerable:!0,get:function(){return o.requestPaymentUpdateAuthenticationToken}})},591:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.initAuthentication=void 0;let a=r(22560),o=r(32395),n=r(66965),i=r(28323),s=async(e,t)=>{c(e,t),l(e,t),await (0,n.loadLocalUsersAuthenticationDataFromStorage)(e),await u(e)};t.initAuthentication=s;let c=(e,t)=>{let{storeService:r}=e;r.dispatch((0,o.saveAppKeys)({accessKey:t.appAccess,secretKey:t.appSecret}))},l=(e,t)=>{let{storeService:r}=e;r.dispatch((0,o.saveStyxKeys)({accessKey:t.styxAccess,secretKey:t.styxSecret}))},u=async e=>{let{storeService:t}=e;try{let e=await (0,i.getRemoteTime)(t);if((0,i.isApiError)(e))throw e;t.dispatch((0,o.saveDashlaneServerDeltaTimestamp)(e.timestamp))}catch(e){(0,a.logDebug)({tag:["Auth"],message:"Error while calling getRemoteTime",details:{error:e}})}}},13706:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.loadRememberMeTypeToStore=void 0;let a=r(23555),o=r(10039),n=r(93748);t.loadRememberMeTypeToStore=function(e){let{storeService:t}=e,r=(0,n.userLoginSelector)(t.getState()),i=(0,o.getLocalAccountRememberMeType)(r);i&&t.dispatch((0,a.setRememberMeTypeAction)(i))}},58770:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.openSessionWithMasterPasswordHandler=void 0;let a=r(72287);t.openSessionWithMasterPasswordHandler=function(e,t){return(0,a.makeLoginController)(e).openSessionWithMasterPassword(t.login,t.password,{rememberMasterPassword:t.rememberPassword,requiredPermissions:t.requiredPermissions,serverKey:t.serverKey,loginType:t.loginType})}},50239:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.registerDeviceHandler=void 0;let a=r(45407),o=r(62923);async function n({storeService:e,storageService:t,moduleClients:r,sessionService:n},i){await n.close(!1),await (0,o.wipeOutLocalAccounts)(t,r["carbon-legacy"],[i.login]),await (0,a.registerDevice)(e,i)}t.registerDeviceHandler=n},20284:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.requestPaymentUpdateAuthenticationToken=void 0;let a=r(27762),o=r(28323),n=r(93748),i=r(4790),s=r(87279),c=r(77765);async function l(e){try{let t;let{storeService:r}=e,l=r.getState(),u=(0,n.userLoginSelector)(l);if(!(0,n.isAuthenticatedSelector)(l))return{success:!1};let d=await (0,s.getAuthenticationTokenForCardUpdate)(r,u);if((0,o.isApiError)(d))return{success:!1};let p=(0,i.getCurrentTeamId)(l.userSession.spaceData),S=(0,i.isTeamAdminInCurrentSpace)(l.userSession.spaceData),g=(0,i.isBillingAdminInCurrentSpace)(l.userSession.spaceData),m={login:u,uki:(0,a.ukiSelector)(l),teamId:p},y={};if(p&&(S||g)){if(t=await (0,c.NewCardToken)(m,{name:"teamPlans",version:1}),200!==t.code)return{success:!1};y={customerId:t.content.customerId,tokenId:t.content.tokenId}}let f={},E=await (0,c.NewCardToken)(m,{name:"premium",version:3});if(200!==E.code)return{success:!1};return f={customerId:E.content.customerId,tokenId:E.content.tokenId},{success:!0,accessKey:d.accessKey,creationDateUnix:d.creationDateUnix,expirationDateUnix:d.expirationDateUnix,secretKey:d.secretKey,livemode:d.livemode,b2bPaymentTokens:y,b2cPaymentTokens:f}}catch(e){return{success:!1}}}t.requestPaymentUpdateAuthenticationToken=l},34550:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.requestEmailToken=void 0;let a=r(20648),o=r(93748);async function n(e){try{let{storeService:t,moduleClients:r}=e,a=t.getState(),n=(0,o.userLoginSelector)(a);if(!n)throw Error("[emailToken] - askServerToSendToken: no current authenticated user");await r.authenticationFlow.commands.requestEmailTokenVerification({login:n})}catch(e){return{success:!1,error:{code:a.EmailTokenApiError,message:e.message}}}return{success:!0}}t.requestEmailToken=n},70058:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.setReactivationStatusHandler=void 0;let a=r(483);t.setReactivationStatusHandler=function({storeService:e},{reactivationStatus:t}){return e.dispatch((0,a.reactivationStatusUpdated)(t)),Promise.resolve()}},77010:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.persistUserAuthenticationData=t.loadUserAuthenticationData=void 0;let a=r(29509),o=r(23555),n=r(21486),i=async(e,t)=>{let r;try{let t=e.getInstance();if(!await t.hasAuthenticationData())return Promise.resolve({type:"success"});r=await t.getAuthenticationData()}catch(e){return Promise.resolve({type:"failed",message:n.FailedToReadParseOrValidateAuthenticationData,error:e})}try{t.dispatch((0,o.rehydrateUserAuthenticationData)(r))}catch(e){return Promise.resolve({type:"failed",message:n.FailedToRehydrateAuthenticationData,error:e})}return Promise.resolve({type:"success"})};t.loadUserAuthenticationData=i;let s=async(e,t)=>{let r=(0,a.userAuthenticationDataSelector)(t.getState()),o=e.getInstance();await o.storeAuthenticationData(r)};t.persistUserAuthenticationData=s},66965:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.loadLocalUsersAuthenticationDataFromStorage=t.persistLocalUsersAuthenticationData=void 0;let a=r(25434),o=r(40891),n=r(80896),i=r(22560),s=r(21837),c=r(29509),l=r(93308),u=r(70362),d=r(34978),p=r(24592),S="authentication.localusers",g=async(e,t)=>{try{let r=e.getLocalStorage(),o=(0,u.makeKeyDataEncryptorService)();(0,a.setObfuscatingKey)(o);let n=(0,c.localUsersAuthenticationDataSelector)(t.getState()),i=JSON.stringify(n),s=(0,l.utf8ChunkEncode)(i),g=p.encode(s),m=(0,d.utf16ToDeflatedUtf8)(g,{skipUtf8Encoding:!0}),y=await o.getInstance().encrypt(m);await r.writeItem(S,y)}catch(r){let e="Auth",t=s.CarbonError.fromAnyError(r).addContextInfo(e,"persistLocalUsersAuthenticationData");(0,i.logError)({tag:[e],message:`${t}`,details:{error:r}}),(0,n.sendExceptionLog)({error:t})}};t.persistLocalUsersAuthenticationData=g;let m=async e=>{try{let{storageService:t,storeService:r}=e,n=t.getLocalStorage(),i=(0,a.makeDataEncryptorService)(r);(0,a.setObfuscatingKey)(i);let s=await n.readItem(S);if(!s)return;if("string"!=typeof s)throw Error("value of authentication.localusers is expected to be a string");let c=await i.getInstance().decrypt(s),u=(0,d.deflatedUtf8ToUtf16)(c,{skipUtf8Decoding:!0}),g=p.decode(u),m=g;try{m=(0,l.utf8ChunkDecode)(g)}catch(e){}let y=JSON.parse(m);r.dispatch((0,o.loadLocalUsersAuthenticationData)(y))}catch(r){let e="Auth",t=s.CarbonError.fromAnyError(r).addContextInfo(e,"loadLocalUsersAuthenticationDataFromStorage");(0,i.logError)({tag:[e],message:`${t}`,details:{error:r}}),(0,n.sendExceptionLog)({error:t})}};t.loadLocalUsersAuthenticationDataFromStorage=m},21486:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.isLoadAuthenticationSuccess=t.FailedToRehydrateAuthenticationData=t.FailedToReadParseOrValidateAuthenticationData=void 0,t.FailedToReadParseOrValidateAuthenticationData="Failed to read, parse or validate persisted data",t.FailedToRehydrateAuthenticationData="Failed to rehydrate",t.isLoadAuthenticationSuccess=e=>"object"==typeof e&&"success"===e.type},57758:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.deviceRegistered=t.makeDeviceRegistrationKeys=t.makeLegacyDeviceRegistrationKey=t.DEVICE_REGISTERED=void 0,t.DEVICE_REGISTERED="DEVICE_REGISTERED",t.makeLegacyDeviceRegistrationKey=e=>({type:"uki",uki:e}),t.makeDeviceRegistrationKeys=(e,t)=>({type:"deviceKeys",deviceAccessKey:e,deviceSecretKey:t}),t.deviceRegistered=(e,r,a)=>({type:t.DEVICE_REGISTERED,registrationType:e,persistData:r,login:a})},23555:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.setRememberMeTypeAction=t.rehydrateUserAuthenticationData=t.SET_REMEMBER_ME_TYPE=t.REHYDRATE_USER_AUTHENTICATION_DATA=void 0,t.REHYDRATE_USER_AUTHENTICATION_DATA="REHYDRATE_USER_AUTHENTICATION_DATA",t.SET_REMEMBER_ME_TYPE="SET_REMEMBER_ME_TYPE",t.rehydrateUserAuthenticationData=e=>({type:t.REHYDRATE_USER_AUTHENTICATION_DATA,data:e}),t.setRememberMeTypeAction=e=>({type:t.SET_REMEMBER_ME_TYPE,rememberMeType:e})},26211:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.getEmptyCurrentUserAuthentication=t.currentUserAuthenticationReducer=void 0;let a=r(92830),o=r(23555),n=r(57758);t.currentUserAuthenticationReducer=(e=(0,t.getEmptyCurrentUserAuthentication)(),r)=>{switch(r.type){case a.CLOSE_SESSION:return(0,t.getEmptyCurrentUserAuthentication)();case n.DEVICE_REGISTERED:if("deviceKeys"===r.registrationType.type){let{deviceAccessKey:t,deviceSecretKey:a}=r.registrationType;return{...e,deviceKeys:{accessKey:t,secretKey:a}}}return e;case o.REHYDRATE_USER_AUTHENTICATION_DATA:return{...e,...r.data};case o.SET_REMEMBER_ME_TYPE:return{...e,rememberMeType:r.rememberMeType};default:return e}},t.getEmptyCurrentUserAuthentication=()=>({deviceKeys:null,rememberMeType:null})},15876:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.authenticationReducer=t.updateLocalUserInfo=t.makeDeviceRegistrationKeys=t.makeLegacyDeviceRegistrationKey=t.deviceRegistered=void 0;var a=r(57758);Object.defineProperty(t,"deviceRegistered",{enumerable:!0,get:function(){return a.deviceRegistered}}),Object.defineProperty(t,"makeLegacyDeviceRegistrationKey",{enumerable:!0,get:function(){return a.makeLegacyDeviceRegistrationKey}}),Object.defineProperty(t,"makeDeviceRegistrationKeys",{enumerable:!0,get:function(){return a.makeDeviceRegistrationKeys}});var o=r(40891);Object.defineProperty(t,"updateLocalUserInfo",{enumerable:!0,get:function(){return o.updateLocalUserInfo}});var n=r(67513);Object.defineProperty(t,"authenticationReducer",{enumerable:!0,get:function(){return n.authenticationReducer}})},483:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.reactivationStatusUpdated=t.localAccountsListUpdated=void 0;let a=r(51683);t.localAccountsListUpdated=e=>({type:a.LOCAL_ACCOUNTS_LIST_UPDATED,localAccounts:e}),t.reactivationStatusUpdated=e=>({type:a.REACTIVATION_STATUS_UPDATED,reactivationStatus:e})},88397:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.localAccountsAuthenticationReducer=t.getEmptyLocalAccountsAuthenticationState=void 0;let a=r(51683);t.getEmptyLocalAccountsAuthenticationState=()=>({accountsList:[],accountsListInitialized:!1,reactivationStatus:a.ReactivationStatus.CLASSIC}),t.localAccountsAuthenticationReducer=(e=(0,t.getEmptyLocalAccountsAuthenticationState)(),r)=>{switch(r.type){case a.LOCAL_ACCOUNTS_LIST_UPDATED:return{...e,accountsList:r.localAccounts,accountsListInitialized:!0};case a.REACTIVATION_STATUS_UPDATED:return{...e,reactivationStatus:r.reactivationStatus};default:return e}}},51683:function(e,t){var r;Object.defineProperty(t,"__esModule",{value:!0}),t.REACTIVATION_STATUS_UPDATED=t.LOCAL_ACCOUNTS_LIST_UPDATED=t.ReactivationStatus=void 0,(r=t.ReactivationStatus||(t.ReactivationStatus={})).DISABLED="DISABLED",r.CLASSIC="CLASSIC",r.WEBAUTHN="WEBAUTHN",t.LOCAL_ACCOUNTS_LIST_UPDATED="LOCAL_ACCOUNTS_LIST_UPDATED",t.REACTIVATION_STATUS_UPDATED="REACTIVATION_STATUS_UPDATED"},40891:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.isLocalUserAuthenticationAction=t.updateLocalUserInfo=t.loadLocalUsersAuthenticationData=t.UPDATE_LOCAL_USER_INFO=t.LOAD_LOCAL_USERS_AUTH_DATA_FROM_STORAGE=void 0;let a=r(57758);t.LOAD_LOCAL_USERS_AUTH_DATA_FROM_STORAGE="LOAD_LOCAL_USERS_AUTH_DATA_FROM_STORAGE",t.UPDATE_LOCAL_USER_INFO="UPDATE_LOCAL_USER_INFO",t.loadLocalUsersAuthenticationData=e=>({type:t.LOAD_LOCAL_USERS_AUTH_DATA_FROM_STORAGE,data:e}),t.updateLocalUserInfo=(e,r)=>({type:t.UPDATE_LOCAL_USER_INFO,login:e,data:r}),t.isLocalUserAuthenticationAction=e=>e.type===a.DEVICE_REGISTERED},74640:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.getEmptyLocalUsersAuthentication=t.localUsersAuthenticationReducer=void 0;let a=r(25903),o=r(40891),n=r(57758),i=r(91783);t.localUsersAuthenticationReducer=(e=(0,t.getEmptyLocalUsersAuthentication)(),r)=>{if((0,o.isLocalUserAuthenticationAction)(r)){let t=s(e[r.login],r);return t?{...e,[r.login]:t}:(0,a.omit)([r.login],e)}switch(r.type){case o.LOAD_LOCAL_USERS_AUTH_DATA_FROM_STORAGE:return{...e,...r.data};case o.UPDATE_LOCAL_USER_INFO:let n=c();return{...e,[r.login]:{...n,...e[r.login],...r.data}};default:return e}},t.getEmptyLocalUsersAuthentication=()=>({});let s=(e,t)=>{let r=e||c();if(t.type!==n.DEVICE_REGISTERED)return e;{let{registrationType:e}=t;switch(e.type){case"deviceKeys":{let{deviceAccessKey:t}=e;return{...r,deviceAccessKey:t,deviceRegisteredWithLegacyKey:!1}}case"uki":return{...r,deviceRegisteredWithLegacyKey:!0};default:(0,i.assertUnreachable)(e)}}},c=()=>({deviceAccessKey:null,deviceRegisteredWithLegacyKey:!1,ssoActivatedUser:!1})},67513:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.authenticationReducer=t.getEmptyAuthenticationState=void 0;let a=r(20781),o=r(26211),n=r(88397),i=r(74640),s=r(7750),c=r(82509),l=r(40777);t.getEmptyAuthenticationState=()=>({currentUser:(0,o.getEmptyCurrentUserAuthentication)(),localAccounts:(0,n.getEmptyLocalAccountsAuthenticationState)(),localUsers:(0,i.getEmptyLocalUsersAuthentication)(),u2f:(0,s.getEmptyU2FAuthenticationState)(),webAuthnAuthentication:(0,l.getEmptyWebAuthnAuthentication)(),twoFactorAuthentication:(0,c.getEmptyTwoFactorAuthenticationState)()}),t.authenticationReducer=(0,a.combineReducers)({currentUser:o.currentUserAuthenticationReducer,localAccounts:n.localAccountsAuthenticationReducer,localUsers:i.localUsersAuthenticationReducer,u2f:s.u2fAuthenticationReducer,webAuthnAuthentication:l.webAuthnAuthenticationReducer,twoFactorAuthentication:c.TwoFactorAuthenticationReducer})},49912:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.u2fDevicesUpdated=t.U2F_DEVICES_UPDATED=void 0,t.U2F_DEVICES_UPDATED="U2F_DEVICES_UPDATED",t.u2fDevicesUpdated=e=>({type:t.U2F_DEVICES_UPDATED,devices:e})},7750:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.u2fAuthenticationReducer=t.getEmptyU2FAuthenticationState=void 0;let a=r(49912);t.getEmptyU2FAuthenticationState=()=>({u2fDevices:[]}),t.u2fAuthenticationReducer=(e=(0,t.getEmptyU2FAuthenticationState)(),r)=>r.type===a.U2F_DEVICES_UPDATED?{...e,u2fDevices:r.devices}:e},8748:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.webAuthnAvailableAuthenticatorsListUpdated=t.webAuthnAuthenticatorsListUpdated=t.webAuthnAuthenticatorRemoved=t.webAuthnAuthenticatorAdded=t.webAuthnUserIdUpdated=t.WEBAUTHN_AVAILABLE_AUTHENTICATORS_LIST_UPDATED=t.WEBAUTHN_AUTHENTICATORS_LIST_UPDATED=t.WEBAUTHN_AUTHENTICATOR_REMOVED=t.WEBAUTHN_AUTHENTICATOR_ADDED=t.WEBAUTHN_USERID_UPDATED=void 0,t.WEBAUTHN_USERID_UPDATED="WEBAUTHN_USERID_UPDATED",t.WEBAUTHN_AUTHENTICATOR_ADDED="WEBAUTHN_AUTHENTICATOR_ADDED",t.WEBAUTHN_AUTHENTICATOR_REMOVED="WEBAUTHN_AUTHENTICATOR_REMOVED",t.WEBAUTHN_AUTHENTICATORS_LIST_UPDATED="WEBAUTHN_AUTHENTICATORS_LIST_UPDATED",t.WEBAUTHN_AVAILABLE_AUTHENTICATORS_LIST_UPDATED="WEBAUTHN_AVAILABLE_AUTHENTICATORS_LIST_UPDATED",t.webAuthnUserIdUpdated=e=>({type:t.WEBAUTHN_USERID_UPDATED,webAuthnUserId:e}),t.webAuthnAuthenticatorAdded=e=>({type:t.WEBAUTHN_AUTHENTICATOR_ADDED,authenticator:e}),t.webAuthnAuthenticatorRemoved=e=>({type:t.WEBAUTHN_AUTHENTICATOR_REMOVED,credentialId:e}),t.webAuthnAuthenticatorsListUpdated=e=>({type:t.WEBAUTHN_AUTHENTICATORS_LIST_UPDATED,authenticatorsList:e}),t.webAuthnAvailableAuthenticatorsListUpdated=e=>({type:t.WEBAUTHN_AVAILABLE_AUTHENTICATORS_LIST_UPDATED,availableAuthenticatorsList:e})},40777:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.webAuthnAuthenticationReducer=t.getEmptyWebAuthnAuthentication=void 0;let a=r(8748);t.getEmptyWebAuthnAuthentication=()=>({webAuthnUserId:null,authenticators:[]}),t.webAuthnAuthenticationReducer=(e=(0,t.getEmptyWebAuthnAuthentication)(),r)=>{switch(r.type){case a.WEBAUTHN_USERID_UPDATED:return{...e,webAuthnUserId:r.webAuthnUserId};case a.WEBAUTHN_AUTHENTICATOR_ADDED:return{...e,authenticators:[...e.authenticators,r.authenticator]};case a.WEBAUTHN_AUTHENTICATOR_REMOVED:{let t=e.authenticators.filter(e=>e.credentialId!==r.credentialId);return{...e,authenticators:t}}case a.WEBAUTHN_AUTHENTICATORS_LIST_UPDATED:return{...e,authenticators:r.authenticatorsList};case a.WEBAUTHN_AVAILABLE_AUTHENTICATORS_LIST_UPDATED:{let t=r.availableAuthenticatorsList.map(e=>e.credentialId),a=e.authenticators.map(e=>t.includes(e.credentialId)?{...e,canOpenSession:!0}:{...e,canOpenSession:!1});return{...e,authenticators:a}}default:return e}}},50433:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.config=void 0;let a=r(48463),o=r(63484),n=r(75848),i=r(77170);t.config={commands:{refreshTwoFactorAuthenticationInfo:{handler:n.refreshTwoFactorAuthenticationInfoHandler},...i.config.commands},queries:{getTwoFactorAuthenticationInfo:{selector:o.twoFactorAuthenticationInfoSelector},...i.config.queries},liveQueries:{liveTwoFactorAuthenticationInfo:{operator:a.twoFactorAuthenticationInfo$},...i.config.liveQueries}}},40383:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.config=void 0;let a=r(23937),o=r(91842),n=r(51981);t.config={commands:{startTwoFactorAuthenticationDisableFlow:{handler:a.startTwoFactorAuthenticationDisableFlow},continueTwoFactorAuthenticationDisableFlow:{handler:a.continueTwoFactorAuthenticationDisableFlow},backTwoFactorAuthenticationDisableFlow:{handler:a.backTwoFactorAuthenticationDisableFlow},stopTwoFactorAuthenticationDisableFlow:{handler:a.stopTwoFactorAuthenticationDisableFlow}},queries:{getTwoFactorAuthenticationDisableStage:{selector:o.getTwoFactorAuthenticationDisableStageData}},liveQueries:{liveTwoFactorAuthenticationDisableStage:{operator:n.twoFactorAuthenticationDisableFlow$}}}},34099:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.stopTwoFactorAuthenticationStage=t.updateTwoFactorAuthenticationStage=void 0;let a=r(12190);t.updateTwoFactorAuthenticationStage=e=>({type:a.UPDATE_TWO_FACTOR_AUTHENTICATION_DISABLE_STAGE,data:e}),t.stopTwoFactorAuthenticationStage=()=>({type:a.UPDATE_TWO_FACTOR_AUTHENTICATION_DISABLE_STAGE,data:{stage:void 0}})},12190:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.STOP_TWO_FACTOR_AUTHENTICATION_DISABLE_FLOW=t.UPDATE_TWO_FACTOR_AUTHENTICATION_DISABLE_STAGE=void 0,t.UPDATE_TWO_FACTOR_AUTHENTICATION_DISABLE_STAGE="UPDATE_TWO_FACTOR_AUTHENTICATION_DISABLE_STAGE",t.STOP_TWO_FACTOR_AUTHENTICATION_DISABLE_FLOW="STOP_TWO_FACTOR_AUTHENTICATION_DISABLE_FLOW"},7484:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.twoFactorAuthenticationDisableFlow=t.stopTwoFactorAuthenticationStage=t.updateTwoFactorAuthenticationStage=void 0;var a=r(34099);Object.defineProperty(t,"updateTwoFactorAuthenticationStage",{enumerable:!0,get:function(){return a.updateTwoFactorAuthenticationStage}}),Object.defineProperty(t,"stopTwoFactorAuthenticationStage",{enumerable:!0,get:function(){return a.stopTwoFactorAuthenticationStage}});var o=r(4017);Object.defineProperty(t,"twoFactorAuthenticationDisableFlow",{enumerable:!0,get:function(){return o.twoFactorAuthenticationDisableFlow}})},4017:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.twoFactorAuthenticationDisableFlow=t.getEmptyTwoFactorAuthenticationDisable=void 0;let a=r(12190);t.getEmptyTwoFactorAuthenticationDisable=()=>({stage:void 0}),t.twoFactorAuthenticationDisableFlow=(e=(0,t.getEmptyTwoFactorAuthenticationDisable)(),r)=>r.type===a.UPDATE_TWO_FACTOR_AUTHENTICATION_DISABLE_STAGE?{...e,...r.data}:e},91842:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.getTwoFactorAuthenticationDisableFlowData=t.getTwoFactorAuthenticationDisableStageData=void 0;let a=r(98183);t.getTwoFactorAuthenticationDisableStageData=e=>{let{stage:t}=e.userSession.twoFactorAuthenticationDisableFlow,r=a.TwoFactorAuthenticationDisableFlowConfig?.[t]?.viewMapper;return{stage:t,viewData:r?r(e):void 0}},t.getTwoFactorAuthenticationDisableFlowData=e=>{let{flowData:t}=e.userSession.twoFactorAuthenticationDisableFlow;return t}},98183:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.TwoFactorAuthenticationDisableFlowStages=t.TwoFactorAuthenticationDisableFlowConfig=void 0;let a=r(20648),o=r(62717),n=r(4832),i=r(87628),s=r(79146);t.TwoFactorAuthenticationDisableFlowConfig={start:{storeMapper:o.startTwoFactorAuthenticationDisableStoreMapper},stop:{currentHandler:s.endTwoFactorAuthenticationHandler,storeMapper:o.endTwoFactorAuthenticationDisableStoreMapper},end:{currentHandler:s.endTwoFactorAuthenticationHandler,storeMapper:o.endTwoFactorAuthenticationDisableStoreMapper},[a.TwoFactorAuthenticationDisableStages.AUTHENTICATION_CODE]:{currentHandler:n.disableTwoFactorAuthenticationCodeHandler,viewMapper:i.disableTwoFactorAuthenticationCodeViewMapper},[a.TwoFactorAuthenticationDisableStages.BACKUP_CODE]:{currentHandler:n.disableTwoFactorAuthenticationCodeHandler,viewMapper:i.disableTwoFactorAuthenticationBackupCodeViewMapper},[a.TwoFactorAuthenticationDisableStages.LOGOUT_REQUIRED]:{currentHandler:n.disableTwoFactorAuthenticationLogoutRequiredHandler}},t.TwoFactorAuthenticationDisableFlowStages=[{stage:a.TwoFactorAuthenticationDisableStages.CONFIRMATION},{stage:a.TwoFactorAuthenticationDisableStages.AUTHENTICATION_CODE},{stage:a.TwoFactorAuthenticationDisableStages.FINALIZING_CHANGES},{stage:a.TwoFactorAuthenticationDisableStages.SUCCESS}]},23937:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.backTwoFactorAuthenticationDisableFlow=t.continueTwoFactorAuthenticationDisableFlow=t.stopTwoFactorAuthenticationDisableFlow=t.startTwoFactorAuthenticationDisableFlow=void 0;let a=r(98183),o=r(7484),n=e=>e.userSession.twoFactorAuthenticationDisableFlow,i=e=>{let{stage:t}=n(e.getState());return{currentIndex:a.TwoFactorAuthenticationDisableFlowStages.findIndex(e=>e.stage===t),currentStage:t}};t.startTwoFactorAuthenticationDisableFlow=({storeService:e})=>{let{storeMapper:t}=a.TwoFactorAuthenticationDisableFlowConfig.start,r=t?t(e):void 0,n=(0,o.updateTwoFactorAuthenticationStage)({...r,stage:a.TwoFactorAuthenticationDisableFlowStages[0].stage});return e.dispatch(n),Promise.resolve({success:!0})},t.stopTwoFactorAuthenticationDisableFlow=e=>{let{storeService:t}=e;t.dispatch((0,o.stopTwoFactorAuthenticationStage)());let{currentHandler:r,storeMapper:n}=a.TwoFactorAuthenticationDisableFlowConfig.stop,i=n?n(t):void 0;return r?r(e,i):Promise.resolve({success:!0})};let s=(e,t,r,a)=>{let{storeService:o}=e;return t(e,r?r(o):void 0,a)},c=({storeService:e},t)=>{let{currentIndex:r}=i(e);if(r!==a.TwoFactorAuthenticationDisableFlowStages.length-1){let n=(0,o.updateTwoFactorAuthenticationStage)({...t,stage:a.TwoFactorAuthenticationDisableFlowStages[r+1].stage});e.dispatch(n)}return Promise.resolve({success:!0})},l=({storeService:e},t)=>{let{currentIndex:r}=i(e);if(0!==r){let n=(0,o.updateTwoFactorAuthenticationStage)({...t,stage:a.TwoFactorAuthenticationDisableFlowStages[r-1].stage});e.dispatch(n)}return Promise.resolve({success:!0})},u=e=>{let t;let{currentStage:r}=i(e),o=c,n=l;if(a.TwoFactorAuthenticationDisableFlowConfig[r]){let e=a.TwoFactorAuthenticationDisableFlowConfig[r];n=e.backHandler||n,o=e.currentHandler||o,t=e.storeMapper}return{currentHandler:o,backHandler:n,storeMapper:t}};t.continueTwoFactorAuthenticationDisableFlow=(e,t)=>{let{storeService:r}=e,{currentHandler:a,storeMapper:o}=u(r);return s(e,a,o,t)},t.backTwoFactorAuthenticationDisableFlow=(e,t)=>{let{storeService:r}=e,{backHandler:a,storeMapper:o}=u(r);return s(e,a,o,t)}},51981:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.twoFactorAuthenticationDisableFlow$=void 0;let a=r(95121),o=r(15237),n=r(91842);t.twoFactorAuthenticationDisableFlow$=()=>(0,a.pipe)((0,o.map)(n.getTwoFactorAuthenticationDisableStageData),(0,o.distinctUntilChanged)())},4832:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.disableTwoFactorAuthenticationLogoutRequiredHandler=t.disableTwoFactorAuthenticationCodeHandler=void 0;let a=r(20648),o=r(7484),n=r(79146),i=r(63484),s=r(16659),c=r(91842),l=r(93748),u=r(62923),d={[a.TwoFactorAuthenticationType.DEVICE_REGISTRATION]:{handler:n.disableTwoFactorAuthenticationTOTP1Handler,showLoading:!1},[a.TwoFactorAuthenticationType.LOGIN]:{handler:n.disableTwoFactorAuthenticationTOTP2Handler,showLoading:!0}},p=async(e,t,r)=>{let{storeService:l}=e,u=e=>{let t=(0,o.updateTwoFactorAuthenticationStage)({...e});l.dispatch(t)};try{let p=(0,c.getTwoFactorAuthenticationDisableFlowData)(l.getState()),S=(0,i.twoFactorAuthenticationInfoSelector)(l.getState());if(S.status===a.TwoFactorAuthenticationInfoRequestStatus.READY){let{type:i}=S,{authenticationCode:c}=r,g=await (0,s.performTotpVerificationService)(e,c);if(g.success){let{authTicket:r}=g;if(d[i]){let{handler:s,showLoading:c}=d[i];c&&u({...t,stage:a.TwoFactorAuthenticationDisableStages.FINALIZING_CHANGES});let S=await s(e,r);if(S.success){if(S.logoutRequired){let e={...p,logoutRequired:S.logoutRequired};u({...t,stage:a.TwoFactorAuthenticationDisableStages.LOGOUT_REQUIRED,flowData:e})}else await (0,n.refreshTwoFactorAuthenticationInfoHandler)(e),u({...t,stage:a.TwoFactorAuthenticationDisableStages.SUCCESS}),l.dispatch((0,o.stopTwoFactorAuthenticationStage)())}else u({...t,stage:a.TwoFactorAuthenticationDisableStages.GENERIC_ERROR,stageData:{...S}})}else u({...t,stage:a.TwoFactorAuthenticationDisableStages.GENERIC_ERROR,stageData:{success:!1,error:{code:a.AuthenticationCode.UNEXPECTED_OTP_TYPE}}})}else u({...t,stageData:g})}else u({...t,stage:a.TwoFactorAuthenticationDisableStages.GENERIC_ERROR,stageData:{success:!1,error:{code:a.AuthenticationCode.UNKNOWN_ERROR}}})}catch(e){u({...t,stageData:{success:!1,error:{code:a.AuthenticationCode.UNKNOWN_ERROR}}})}return{success:!0}},S=async(e,t,r)=>{let a=r.target;if(a){let{storeService:r}=e,n=(0,o.updateTwoFactorAuthenticationStage)({...t,stage:a,stageData:void 0});return r.dispatch(n),{success:!0}}return await p(e,t,r)};t.disableTwoFactorAuthenticationCodeHandler=S;let g=async e=>{let{storeService:t,storageService:r,sessionService:a,moduleClients:n}=e,i=(0,l.userLoginSelector)(t.getState());return t.dispatch((0,o.stopTwoFactorAuthenticationStage)()),i&&await (0,u.wipeOutLocalAccounts)(r,n["carbon-legacy"],[i]),await a.close(),{success:!0}};t.disableTwoFactorAuthenticationLogoutRequiredHandler=g},62717:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.endTwoFactorAuthenticationDisableStoreMapper=t.startTwoFactorAuthenticationDisableStoreMapper=void 0;let a=r(29509);t.startTwoFactorAuthenticationDisableStoreMapper=e=>{let t=e.getState();return{stage:void 0,stageData:void 0,flowData:{otpType:(0,a.otpTypeSelector)(t)}}},t.endTwoFactorAuthenticationDisableStoreMapper=()=>({stage:void 0,stageData:void 0,flowData:void 0})},87628:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.disableTwoFactorAuthenticationBackupCodeViewMapper=t.disableTwoFactorAuthenticationCodeViewMapper=void 0;let a=r(20648);t.disableTwoFactorAuthenticationCodeViewMapper=e=>{let{stageData:t}=e.userSession.twoFactorAuthenticationDisableFlow;if(t&&!t.success){let{error:e}=t;return{success:!1,error:e}}},t.disableTwoFactorAuthenticationBackupCodeViewMapper=e=>{let{stageData:t}=e.userSession.twoFactorAuthenticationDisableFlow;if(t&&!t.success){let{error:e}=t;return e.code===a.AuthenticationCode.OTP_NOT_VALID?{success:!1,error:{code:a.AuthenticationCode.BACKUP_CODE_NOT_VALID}}:{success:!1,error:e}}}},33705:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.config=void 0;let a=r(12246),o=r(52394),n=r(99353);t.config={commands:{startTwoFactorAuthenticationEnableFlow:{handler:a.startTwoFactorAuthenticationEnableFlow},continueTwoFactorAuthenticationEnableFlow:{handler:a.continueTwoFactorAuthenticationEnableFlow},backTwoFactorAuthenticationEnableFlow:{handler:a.backTwoFactorAuthenticationEnableFlow},stopTwoFactorAuthenticationEnableFlow:{handler:a.stopTwoFactorAuthenticationEnableFlow}},queries:{getTwoFactorAuthenticationEnableStage:{selector:o.getTwoFactorAuthenticationEnableStageData}},liveQueries:{liveTwoFactorAuthenticationEnableStage:{operator:n.twoFactorAuthenticationEnableFlow$}}}},23764:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.enableTwoFactorAuthenticationBackupCodesHandler=void 0;let a=r(20648),o=r(82087),n=r(52394),i=async(e,t)=>{let{storeService:r}=e,i=(0,n.getTwoFactorAuthenticationEnableFlowData)(r.getState());return(0,o.updateStore)(e,{...t,stage:i.logoutRequired?a.TwoFactorAuthenticationEnableStages.LOGOUT_REQUIRED:a.TwoFactorAuthenticationEnableStages.SUCCESS}),{success:!0}};t.enableTwoFactorAuthenticationBackupCodesHandler=i},57821:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.enableTwoFactorAuthenticationBackupPhoneHandler=void 0;let a=r(20648),o=r(28323),n=r(82087),i=r(52394),s=r(16659),c=async(e,t,r)=>{let{storeService:c}=e,l=(0,i.getTwoFactorAuthenticationEnableFlowData)(c.getState()),u=await (0,s.requestTOTPActivationService)(e,{...r,country:(0,o.makeSafeCountry)(r.countryCode)});if(u.success){let{seed:o,uri:i,recoveryKeys:s,serverKey:c}=u,{authenticationType:d}=l;d===a.TwoFactorAuthenticationType.LOGIN&&(l[a.TwoFactorAuthenticationType.LOGIN].serverKey=c),l={...l,seed:o,uri:i,recoveryKeys:s},(0,n.updateStore)(e,{...t,stageData:{...u},flowData:{...l,savedValues:{...l?.savedValues,savedCountryCode:r.countryCode,savedPhoneNumber:r.phoneNumber}},stage:a.TwoFactorAuthenticationEnableStages.QR_CODE})}else(0,n.updateStore)(e,{...t,stageData:{...u}});return Promise.resolve({success:!0})};t.enableTwoFactorAuthenticationBackupPhoneHandler=c},43218:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.enableTwoFactorAuthenticationCodeHandler=void 0;let a=r(20648),o=r(83533),n=r(82087),i=r(52394),s=r(61799),c=r(98099),l=r(79146),u=r(16659),d=r(12770),p={[a.TwoFactorAuthenticationType.DEVICE_REGISTRATION]:{handler:s.enableTwoFactorAuthenticationTOTP1Handler,showLoading:!1},[a.TwoFactorAuthenticationType.LOGIN]:{handler:c.enableTwoFactorAuthenticationTOTP2Handler,showLoading:!0,errorStage:a.TwoFactorAuthenticationEnableStages.GENERIC_ERROR}},S=e=>{switch(e){case a.AuthenticationCode.OTP_NOT_VALID:case a.AuthenticationCode.OTP_ALREADY_USED:return o.TwoFactorAuthenticationError.WrongCodeError;case a.AuthenticationCode.NETWORK_ERROR:return o.TwoFactorAuthenticationError.UserOfflineError;default:return o.TwoFactorAuthenticationError.UnknownError}},g=async(e,t,{authenticationCode:r})=>{let{storeService:s}=e;try{let c=(0,i.getTwoFactorAuthenticationEnableFlowData)(s.getState()),{authenticationType:g}=c,m=await (0,u.performTotpVerificationService)(e,r,!0);if(!m.success){(0,n.updateStore)(e,{...t,stageData:m});let r=S(m.error.code);return(0,d.logEvent)(e,{event:new o.UserChangeTwoFactorAuthenticationSettingEvent({flowStep:o.FlowStep.Error,flowType:o.FlowType.Activation,errorName:r})}),{success:!1}}if(p[g]){let{authTicket:r}=m,o=c[g],{handler:i,showLoading:s,errorStage:u}=p[g];s&&(0,n.updateStore)(e,{...t,stage:a.TwoFactorAuthenticationEnableStages.FINALIZING_CHANGES});let d=await i(e,r,o);if(d.success){d.logoutRequired||await (0,l.refreshTwoFactorAuthenticationInfoHandler)(e);let r={...c,logoutRequired:d.logoutRequired};(0,n.updateStore)(e,{...t,stage:a.TwoFactorAuthenticationEnableStages.BACKUP_CODES,flowData:r})}else(0,n.updateStore)(e,{...t,stage:u?a.TwoFactorAuthenticationEnableStages.GENERIC_ERROR:a.TwoFactorAuthenticationEnableStages.AUTHENTICATION_CODE,stageData:{...d}})}else(0,n.updateStore)(e,{...t,stage:a.TwoFactorAuthenticationEnableStages.GENERIC_ERROR,stageData:{success:!1}});return{success:!0}}catch(r){return(0,n.updateStore)(e,{...t,stageData:{success:!1,error:{code:a.AuthenticationCode.UNKNOWN_ERROR}}}),{success:!1}}};t.enableTwoFactorAuthenticationCodeHandler=g},50564:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.enableTwoFactorAuthenticationLogoutRequiredHandler=void 0;let a=r(93748),o=r(62923),n=r(39801),i=async e=>{let{storeService:t,storageService:r,sessionService:i,moduleClients:s}=e,c=(0,a.userLoginSelector)(t.getState());return t.dispatch((0,n.stopTwoFactorAuthenticationStage)()),c&&await (0,o.wipeOutLocalAccounts)(r,s["carbon-legacy"],[c]),await i.close(),{success:!0}};t.enableTwoFactorAuthenticationLogoutRequiredHandler=i},21692:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.enableTwoFactorAuthenticationTypeHandler=void 0;let a=r(20648),o=r(63860),n=r(39801),i=r(52394),s=r(82087),c=r(34056),l=r(93748),u=r(28323),d=r(25361),p=r(83533),S=r(20648),g=async(e,t,{authenticationType:r})=>{let{storeService:g}=e,m=(0,i.getTwoFactorAuthenticationEnableFlowData)(g.getState());if(r===S.TwoFactorAuthenticationType.LOGIN)try{let i=(0,n.updateTwoFactorAuthenticationStage)({...t,stage:a.TwoFactorAuthenticationEnableStages.LOADING});g.dispatch(i);let{eventLoggerService:y}=e,f=g.getState(),E=(0,l.userLoginSelector)(f);if(!E||!await (0,o.waitUntilSyncComplete)(g))return(0,s.updateStore)(e,{...t,stage:a.TwoFactorAuthenticationEnableStages.GENERIC_ERROR}),Promise.resolve({success:!1});g.dispatch((0,c.changeMPStart)());let A=await (0,u.getDataForMasterPasswordChange)(g,E,{});if((0,u.isApiError)(A))(0,d.logChangeMasterPasswordError)(y,p.ChangeMasterPasswordError.DownloadError),g.dispatch((0,c.changeMPDone)()),(0,s.updateStore)(e,{...t,stage:a.TwoFactorAuthenticationEnableStages.GENERIC_ERROR});else{let{data:{transactions:e,sharingKeys:o},timestamp:i}=A,s=(0,n.updateTwoFactorAuthenticationStage)({...t,flowData:{...m,authenticationType:r,[S.TwoFactorAuthenticationType.LOGIN]:{transactions:e,sharingKeys:o,timestamp:i,serverKey:""},savedValues:{...m?.savedValues,savedAuthenticationType:r}},stage:a.TwoFactorAuthenticationEnableStages.BACKUP_PHONE});g.dispatch(s)}}catch(r){g.dispatch((0,c.changeMPDone)()),(0,s.updateStore)(e,{...t,stage:a.TwoFactorAuthenticationEnableStages.GENERIC_ERROR})}else{let e=(0,n.updateTwoFactorAuthenticationStage)({...t,flowData:{...m,authenticationType:r,savedValues:{...m?.savedValues,savedAuthenticationType:r}},stage:a.TwoFactorAuthenticationEnableStages.BACKUP_PHONE});g.dispatch(e)}return Promise.resolve({success:!0})};t.enableTwoFactorAuthenticationTypeHandler=g},77449:function(e,t,r){var a=this&&this.__createBinding||(Object.create?function(e,t,r,a){void 0===a&&(a=r);var o=Object.getOwnPropertyDescriptor(t,r);(!o||("get"in o?!t.__esModule:o.writable||o.configurable))&&(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,a,o)}:function(e,t,r,a){void 0===a&&(a=r),e[a]=t[r]}),o=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||a(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),o(r(43218),t),o(r(57821),t),o(r(21692),t),o(r(23764),t),o(r(50564),t)},14430:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.stopTwoFactorAuthenticationStage=t.updateTwoFactorAuthenticationStage=t.UPDATE_TWO_FACTOR_AUTHENTICATION_ENABLE_STAGE=void 0,t.UPDATE_TWO_FACTOR_AUTHENTICATION_ENABLE_STAGE="UPDATE_TWO_FACTOR_AUTHENTICATION_ENABLE_STAGE",t.updateTwoFactorAuthenticationStage=e=>({type:t.UPDATE_TWO_FACTOR_AUTHENTICATION_ENABLE_STAGE,data:e}),t.stopTwoFactorAuthenticationStage=()=>({type:t.UPDATE_TWO_FACTOR_AUTHENTICATION_ENABLE_STAGE,data:{stage:void 0}})},39801:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.twoFactorAuthenticationEnableFlow=t.stopTwoFactorAuthenticationStage=t.updateTwoFactorAuthenticationStage=void 0;var a=r(14430);Object.defineProperty(t,"updateTwoFactorAuthenticationStage",{enumerable:!0,get:function(){return a.updateTwoFactorAuthenticationStage}}),Object.defineProperty(t,"stopTwoFactorAuthenticationStage",{enumerable:!0,get:function(){return a.stopTwoFactorAuthenticationStage}});var o=r(4660);Object.defineProperty(t,"twoFactorAuthenticationEnableFlow",{enumerable:!0,get:function(){return o.twoFactorAuthenticationEnableFlow}})},4660:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.twoFactorAuthenticationEnableFlow=t.getEmptyTwoFactorAuthenticationEnable=void 0;let a=r(14430);t.getEmptyTwoFactorAuthenticationEnable=()=>({stage:void 0}),t.twoFactorAuthenticationEnableFlow=(e=(0,t.getEmptyTwoFactorAuthenticationEnable)(),r)=>r.type===a.UPDATE_TWO_FACTOR_AUTHENTICATION_ENABLE_STAGE?{...e,...r.data}:e},52394:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.getTwoFactorAuthenticationEnableFlowData=t.getTwoFactorAuthenticationEnableStageData=void 0;let a=r(36212);t.getTwoFactorAuthenticationEnableStageData=e=>{let{stage:t}=e.userSession.twoFactorAuthenticationEnableFlow,r=a.TwoFactorAuthenticationEnableFlowConfig?.[t]?.viewMapper,o=e.userSession.twoFactorAuthenticationEnableFlow?.flowData?.savedValues;return{stage:t,viewData:r?r(e):void 0,savedValues:o}},t.getTwoFactorAuthenticationEnableFlowData=e=>{let{flowData:t}=e.userSession.twoFactorAuthenticationEnableFlow;return t}},36212:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.TwoFactorAuthenticationEnableFlowStages=t.TwoFactorAuthenticationEnableFlowConfig=void 0;let a=r(20648),o=r(19824),n=r(81607),i=r(77449),s=r(79146);t.TwoFactorAuthenticationEnableFlowConfig={start:{storeMapper:o.startTwoFactorAuthenticationEnableStoreMapper},stop:{currentHandler:s.endTwoFactorAuthenticationHandler,storeMapper:o.endTwoFactorAuthenticationEnableStoreMapper},end:{currentHandler:s.endTwoFactorAuthenticationHandler,storeMapper:o.endTwoFactorAuthenticationEnableStoreMapper},[a.TwoFactorAuthenticationEnableStages.AUTHENTICATION_TYPE]:{currentHandler:i.enableTwoFactorAuthenticationTypeHandler,viewMapper:n.enableTwoFactorAuthenticationTypeViewMapper},[a.TwoFactorAuthenticationEnableStages.BACKUP_PHONE]:{currentHandler:i.enableTwoFactorAuthenticationBackupPhoneHandler,viewMapper:n.enableTwoFactorAuthenticationBackupPhoneViewMapper},[a.TwoFactorAuthenticationEnableStages.QR_CODE]:{viewMapper:n.enableTwoFactorAuthenticationQRCodeViewMapper},[a.TwoFactorAuthenticationEnableStages.AUTHENTICATION_CODE]:{currentHandler:i.enableTwoFactorAuthenticationCodeHandler,viewMapper:n.enableTwoFactorAuthenticationCodeViewMapper},[a.TwoFactorAuthenticationEnableStages.BACKUP_CODES]:{currentHandler:i.enableTwoFactorAuthenticationBackupCodesHandler,viewMapper:n.enableTwoFactorAuthenticationBackupCodesViewMapper},[a.TwoFactorAuthenticationEnableStages.LOGOUT_REQUIRED]:{currentHandler:i.enableTwoFactorAuthenticationLogoutRequiredHandler}},t.TwoFactorAuthenticationEnableFlowStages=[{stage:a.TwoFactorAuthenticationEnableStages.AUTHENTICATION_TYPE},{stage:a.TwoFactorAuthenticationEnableStages.BACKUP_PHONE},{stage:a.TwoFactorAuthenticationEnableStages.QR_CODE},{stage:a.TwoFactorAuthenticationEnableStages.AUTHENTICATION_CODE},{stage:a.TwoFactorAuthenticationEnableStages.FINALIZING_CHANGES},{stage:a.TwoFactorAuthenticationEnableStages.BACKUP_CODES},{stage:a.TwoFactorAuthenticationEnableStages.SUCCESS}]},12246:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.backTwoFactorAuthenticationEnableFlow=t.continueTwoFactorAuthenticationEnableFlow=t.stopTwoFactorAuthenticationEnableFlow=t.startTwoFactorAuthenticationEnableFlow=void 0;let a=r(36212),o=r(39801),n=e=>e.userSession.twoFactorAuthenticationEnableFlow,i=e=>{let{stage:t}=n(e.getState());return{currentIndex:a.TwoFactorAuthenticationEnableFlowStages.findIndex(e=>e.stage===t),currentStage:t}},s=e=>{let t=n(e.getState()),r=(0,o.updateTwoFactorAuthenticationStage)({...t,stageData:void 0});e.dispatch(r)};t.startTwoFactorAuthenticationEnableFlow=({storeService:e})=>{let{storeMapper:t}=a.TwoFactorAuthenticationEnableFlowConfig.start,r=t?t(e):void 0,n=(0,o.updateTwoFactorAuthenticationStage)({...r,stage:a.TwoFactorAuthenticationEnableFlowStages[0].stage});return e.dispatch(n),Promise.resolve({success:!0})},t.stopTwoFactorAuthenticationEnableFlow=e=>{let{storeService:t}=e;t.dispatch((0,o.stopTwoFactorAuthenticationStage)());let{currentHandler:r,storeMapper:n}=a.TwoFactorAuthenticationEnableFlowConfig.stop,i=n?n(t):void 0;return r?r(e,i):Promise.resolve({success:!0})};let c=(e,t,r,a)=>{let{storeService:o}=e;return t(e,r?r(o):void 0,a)},l=({storeService:e},t)=>{let{currentIndex:r}=i(e);if(r!==a.TwoFactorAuthenticationEnableFlowStages.length-1){let n=(0,o.updateTwoFactorAuthenticationStage)({...t,stage:a.TwoFactorAuthenticationEnableFlowStages[r+1].stage});e.dispatch(n)}return Promise.resolve({success:!0})},u=({storeService:e},t)=>{let{currentIndex:r}=i(e);if(0!==r){let n=(0,o.updateTwoFactorAuthenticationStage)({...t,stage:a.TwoFactorAuthenticationEnableFlowStages[r-1].stage});e.dispatch(n)}return Promise.resolve({success:!0})},d=e=>{let t;let{currentStage:r}=i(e),o=l,n=u;if(a.TwoFactorAuthenticationEnableFlowConfig[r]){let e=a.TwoFactorAuthenticationEnableFlowConfig[r];n=e.backHandler||n,o=e.currentHandler||o,t=e.storeMapper}return{currentHandler:o,backHandler:n,storeMapper:t}};t.continueTwoFactorAuthenticationEnableFlow=(e,t)=>{let{storeService:r}=e,{currentHandler:a,storeMapper:o}=d(r);return c(e,a,o,t)},t.backTwoFactorAuthenticationEnableFlow=(e,t)=>{let{storeService:r}=e,{backHandler:a,storeMapper:o}=d(r);return s(r),c(e,a,o,t)}},82087:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.updateStore=void 0;let a=r(39801);t.updateStore=({storeService:e},t)=>{let r=(0,a.updateTwoFactorAuthenticationStage)({...t});e.dispatch(r)}},99353:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.twoFactorAuthenticationEnableFlow$=void 0;let a=r(95121),o=r(15237),n=r(52394);t.twoFactorAuthenticationEnableFlow$=()=>(0,a.pipe)((0,o.map)(n.getTwoFactorAuthenticationEnableStageData),(0,o.distinctUntilChanged)())},19824:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.endTwoFactorAuthenticationEnableStoreMapper=t.startTwoFactorAuthenticationEnableStoreMapper=void 0,t.startTwoFactorAuthenticationEnableStoreMapper=()=>({stage:void 0,stageData:void 0,flowData:void 0}),t.endTwoFactorAuthenticationEnableStoreMapper=()=>({stage:void 0,stageData:void 0,flowData:void 0})},81607:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.enableTwoFactorAuthenticationBackupCodesViewMapper=t.enableTwoFactorAuthenticationCodeViewMapper=t.enableTwoFactorAuthenticationQRCodeViewMapper=t.enableTwoFactorAuthenticationBackupPhoneViewMapper=t.enableTwoFactorAuthenticationTypeViewMapper=void 0;let a=r(28323);t.enableTwoFactorAuthenticationTypeViewMapper=()=>({currentStep:1,totalSteps:5}),t.enableTwoFactorAuthenticationBackupPhoneViewMapper=e=>{let t=(0,a.makeSafeCountry)(e.device.platform.location.country),{stageData:r}=e.userSession.twoFactorAuthenticationEnableFlow;return{currentStep:2,totalSteps:5,countryCode:t,...r}},t.enableTwoFactorAuthenticationQRCodeViewMapper=e=>{let{uri:t,seed:r}=e.userSession.twoFactorAuthenticationEnableFlow.flowData;return{currentStep:3,totalSteps:5,uri:t,seed:r}},t.enableTwoFactorAuthenticationCodeViewMapper=e=>{let{stageData:t}=e.userSession.twoFactorAuthenticationEnableFlow;if(t){let{error:t}=e.userSession.twoFactorAuthenticationEnableFlow.stageData;return{currentStep:4,totalSteps:5,error:t}}return{currentStep:4,totalSteps:5}},t.enableTwoFactorAuthenticationBackupCodesViewMapper=e=>{let{recoveryKeys:t}=e.userSession.twoFactorAuthenticationEnableFlow.flowData;return{currentStep:5,totalSteps:5,recoveryKeys:t}}},96949:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.TwoFactorAuthStatusError=t.TwoFactorAuthStatusRequested=t.TwoFactorAuthStatusUpdated=t.TWO_FACTOR_AUTHENTICATION_INFO_ERROR=t.TWO_FACTOR_AUTHENTICATION_INFO_REQUESTED=t.TWO_FACTOR_AUTHENTICATION_INFO_UPDATED=void 0,t.TWO_FACTOR_AUTHENTICATION_INFO_UPDATED="TWO_FACTOR_AUTHENTICATION_INFO_UPDATED",t.TWO_FACTOR_AUTHENTICATION_INFO_REQUESTED="TWO_FACTOR_AUTHENTICATION_INFO_REQUESTED",t.TWO_FACTOR_AUTHENTICATION_INFO_ERROR="TWO_FACTOR_AUTHENTICATION_INFO_ERROR",t.TwoFactorAuthStatusUpdated=e=>({type:t.TWO_FACTOR_AUTHENTICATION_INFO_UPDATED,info:e}),t.TwoFactorAuthStatusRequested=()=>({type:t.TWO_FACTOR_AUTHENTICATION_INFO_REQUESTED}),t.TwoFactorAuthStatusError=()=>({type:t.TWO_FACTOR_AUTHENTICATION_INFO_ERROR})},82509:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.TwoFactorAuthenticationReducer=t.getEmptyTwoFactorAuthenticationState=void 0;let a=r(20648),o=r(96949),n=r(79683);t.getEmptyTwoFactorAuthenticationState=()=>({status:a.TwoFactorAuthenticationInfoRequestStatus.UNKNOWN}),t.TwoFactorAuthenticationReducer=(e=(0,t.getEmptyTwoFactorAuthenticationState)(),r)=>{let i=r?.info?.type;switch(r.type){case o.TWO_FACTOR_AUTHENTICATION_INFO_REQUESTED:return{status:a.TwoFactorAuthenticationInfoRequestStatus.PENDING};case o.TWO_FACTOR_AUTHENTICATION_INFO_ERROR:return{status:a.TwoFactorAuthenticationInfoRequestStatus.ERROR};case o.TWO_FACTOR_AUTHENTICATION_INFO_UPDATED:return{...r.info,isTwoFactorAuthenticationEnabled:n.TwoFactorAuthenticationEnabled.includes(i),status:a.TwoFactorAuthenticationInfoRequestStatus.READY};default:return e}}},77170:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.config=void 0;let a=r(43819),o=r(95626),n=r(96016),i=r(26137);t.config={commands:{removeU2FAuthenticator:{handler:a.removeU2FAuthenticatorHandler},refreshU2FDevicesList:{handler:o.refreshU2FDevicesListHandler}},queries:{getU2FDevicesList:{selector:i.listU2FDevicesSelector}},liveQueries:{liveU2FDevicesList:{operator:n.listU2FDevices$}}}},95626:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.refreshU2FDevicesListHandler=void 0;let a=r(20648),o=r(28323),n=r(93748),i=r(49912),s=async e=>{try{let{storeService:t}=e,r=t.isAuthenticated,s=(0,n.userLoginSelector)(t.getState());if(!s||!r)return{success:!1,error:{code:a.RefreshU2FErrorCode.UNKNOWN_ERROR}};let c=await (0,o.getU2FDevices)(t,s);if((0,o.isApiError)(c))return{success:!1,error:{code:a.RefreshU2FErrorCode.UNKNOWN_ERROR}};return t.dispatch((0,i.u2fDevicesUpdated)(c.u2fDevices)),{success:!0}}catch(e){return{success:!1,error:{code:a.RefreshU2FErrorCode.UNKNOWN_ERROR}}}};t.refreshU2FDevicesListHandler=s},43819:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.removeU2FAuthenticatorHandler=void 0;let a=r(20648),o=r(74907),n=r(21837),i=r(28323),s=r(80896),c=r(93748),l=r(49087),u=r(95626),d=async(e,t)=>{try{let{storeService:r}=e,o=r.getState(),n=r.isAuthenticated,s=(0,c.userLoginSelector)(o);if(!s||!n)return{success:!1,error:{code:a.RemoveU2FAuthenticatorError.UNKNOWN_ERROR}};let{authenticationCode:d,keyHandle:p}=t,S=await (0,i.performTotpVerification)(r,{login:s,otp:d});if((0,i.isApiError)(S))return(0,l.handlePerformValidationError)(S,!0);let{authTicket:g}=S,m=await (0,i.removeU2FAuthenticator)(r,s,{authTicket:g,keyHandle:p});if((0,i.isApiError)(m))return{success:!1,error:{code:a.RemoveU2FAuthenticatorError.UNKNOWN_ERROR}};return await (0,u.refreshU2FDevicesListHandler)(e),{success:!0}}catch(t){let e=n.CarbonError.fromAnyError(t).addContextInfo("U2F","removeU2FAuthenticatorHandler");return(0,s.sendExceptionLog)({error:e}),{success:!1,error:{code:(0,n.isCarbonError)(t)&&t.errorCode===o.HttpErrorCode.NETWORK_ERROR?a.AuthenticationCode.NETWORK_ERROR:a.RemoveU2FAuthenticatorError.UNKNOWN_ERROR}}}};t.removeU2FAuthenticatorHandler=d},96016:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.listU2FDevices$=void 0;let a=r(95121),o=r(15237),n=r(26137);t.listU2FDevices$=()=>(0,a.pipe)((0,o.map)(n.listU2FDevicesSelector),(0,o.distinctUntilChanged)())},26137:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.listU2FDevicesSelector=void 0,t.listU2FDevicesSelector=e=>e.authentication.u2f.u2fDevices},79683:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.ENFORCE_2FA_POLICY_REFRESH_TIMER_INTERVAL=t.TwoFactorAuthenticationEnabled=void 0;let a=r(20648);t.TwoFactorAuthenticationEnabled=[a.TwoFactorAuthenticationType.DEVICE_REGISTRATION,a.TwoFactorAuthenticationType.LOGIN,a.TwoFactorAuthenticationType.SSO],t.ENFORCE_2FA_POLICY_REFRESH_TIMER_INTERVAL=36e5},74978:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.disableTwoFactorAuthenticationTOTP1Handler=void 0;let a=r(20648),o=r(28323),n=async(e,t)=>{let{storeService:r}=e,{login:n}=r.getAccountInfo(),i=await (0,o.deactivateTotpVerification)(r,n,{authTicket:t});return(0,o.isApiError)(i)?{success:!1,error:{code:a.AuthenticationCode.UNKNOWN_ERROR}}:{success:!0}};t.disableTwoFactorAuthenticationTOTP1Handler=n},46030:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.disableTwoFactorAuthenticationTOTP2Handler=void 0;let a=r(20648),o=r(10039),n=r(28323),i=r(51700),s=r(63860),c=r(34056),l=r(93748),u=r(49789),d=r(9779),p=async(e,t)=>{let{moduleClients:r,storeService:p,masterPasswordEncryptorService:S,sessionService:g,storageService:m}=e,y=p.getState(),f=(0,l.userLoginSelector)(y);try{if(!f)throw Error("2FA Disable Flow - Login not available");if((0,l.isRemoteKeyActivatedSelector)(y))throw console.error("Disable 2FA unavailable: RK account"),Error("2FA Disable Flow - Unavailable due to RemoteKey Account");if(!await (0,s.waitUntilSyncComplete)(p))return{success:!1,error:{code:a.AuthenticationCode.UNKNOWN_SYNC_ERROR}};p.dispatch((0,c.changeMPStart)()),await r.session.commands.prepareLocalDataFlush();let E=await (0,n.getDataForMasterPasswordChange)(p,f,{});if((0,n.isApiError)(E))throw Error("2FA Disable Flow - Unable to getDataForMasterPasswordChange");let A=(0,l.serverKeySelector)(y);if(!(0,i.isOtpStatusValid)(E.otpStatus,A))throw Error("2FA Disable Flow - OTP status is invalid");let{timestamp:h}=E,{transactions:_,sharingKeys:T}=E.data,v=await (0,i.deCipherAllTransactions)(g,S,_,!1),I=p.getUserSession().masterPassword,D=e.localStorageService.getInstance(),P=await D.doesLocalKeyExist(),O=null;P&&(O=await D.getLocalKey());let{publicKey:C}=T,b=await (0,i.decipherPrivateKey)(p,S,T);await (0,o.cleanRememberMeStorageData)(p,m,r.session);let R=(0,i.returnProperCryptoConfig)(p);S.setInstance({raw:I},"",R),p.dispatch((0,u.updateServerKey)("")),await e.applicationModulesAccess.createClients().session.commands.updateUserSessionKey({email:(0,l.userLoginSelector)(p.getState()),sessionKey:{type:"mp",masterPassword:(0,l.masterPasswordSelector)(p.getState()),secondaryKey:""}}),p.dispatch((0,u.updateRemoteKey)(null));let N=await (0,i.cipherTransactionWithNewMP)(p,g,S,v,null,!1),w=await (0,i.cipherPrivateKey)(S,b),L={timestamp:h,transactions:(0,i.formatTransaction)(N),updateVerification:{type:"email_token"},sharingKeys:{publicKey:C,privateKey:w},authTicket:t},U=await (0,n.uploadDataForMasterPasswordChange)(p,f,L);if((0,n.isApiError)(U))throw(0,i.revertOnError)(e,S,{currentPassword:I,serverKey:A}),Error("2FA Disable Flow - Unable to uploadDataForMasterPasswordChange");O&&await g.getInstance().user.persistLocalKey(O),await r.session.commands.flushLocalData(),await (0,d.storeSessionCredentialForRecovery)(p,e.localStorageService)}catch(e){return p.dispatch((0,c.changeMPDone)()),{success:!1,error:{code:a.AuthenticationCode.UNKNOWN_ERROR}}}let E=!0;try{let e=await (0,n.confirmMasterPasswordChangeDone)(p,f,{});if((0,n.isApiError)(e))throw Error("2FA Disable Flow - Failed to confirmMasterPasswordChangeDone");E=!1}catch(e){throw Error("2FA Disable Flow - Failed to confirmMasterPasswordChangeDone")}return p.dispatch((0,c.changeMPDone)()),{success:!0,logoutRequired:E}};t.disableTwoFactorAuthenticationTOTP2Handler=p},61799:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.enableTwoFactorAuthenticationTOTP1Handler=void 0;let a=r(56307),o=async(e,t)=>await (0,a.completeTotpActivationHandler)(e,t);t.enableTwoFactorAuthenticationTOTP1Handler=o},98099:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.enableTwoFactorAuthenticationTOTP2Handler=void 0;let a=r(20648),o=r(10039),n=r(28323),i=r(51700),s=r(93748),c=r(9779),l=r(34056),u=r(49789),d=e=>{let{storeService:t,masterPasswordEncryptorService:r,remoteDataEncryptorService:a}=e,o=t.getState(),n=(0,s.isRemoteKeyActivatedSelector)(o),c=t.getUserSession().masterPassword;(0,i.revertOnError)(e,n?a:r,{currentPassword:c,serverKey:""})},p=async(e,t,r)=>{let{timestamp:p,transactions:S,sharingKeys:g,serverKey:m}=r;if(!m)throw Error("[2FA - Enable] - Empty server key");let{moduleClients:y,storeService:f,masterPasswordEncryptorService:E,sessionService:A,storageService:h}=e,_=f.getState();if((0,s.isRemoteKeyActivatedSelector)(_))return console.error("Enable 2FA unavailable: RK account"),{success:!1,error:{code:a.AuthenticationCode.UNKNOWN_ERROR}};await y.session.commands.prepareLocalDataFlush();let T=(0,s.userLoginSelector)(_);if(!T)return{success:!1,error:{code:a.AuthenticationCode.UNKNOWN_ERROR}};let v=e.localStorageService.getInstance(),I=await v.doesLocalKeyExist(),D=null;I&&(D=await v.getLocalKey());try{let r=await (0,i.deCipherAllTransactions)(A,E,S,!1),{publicKey:a}=g,l=await (0,i.decipherPrivateKey)(f,E,g);await (0,o.cleanRememberMeStorageData)(f,h,y.session);let d=(0,i.returnProperCryptoConfig)(f),_=f.getUserSession().masterPassword;E.setInstance({raw:_},m,d);let v=await (0,i.cipherTransactionWithNewMP)(f,A,E,r,null,!1),I=await (0,i.cipherPrivateKey)(E,l),P={timestamp:p,transactions:(0,i.formatTransaction)(v),updateVerification:{type:"totp_login",serverKey:m},sharingKeys:{publicKey:a,privateKey:I},authTicket:t},O=await (0,n.uploadDataForMasterPasswordChange)(f,T,P);if((0,n.isApiError)(O))throw Error("2FA Enable Flow - Unable to uploadDataForMasterPasswordChange");f.dispatch((0,u.updateServerKey)(m)),await y.session.commands.updateUserSessionKey({email:(0,s.userLoginSelector)(f.getState()),sessionKey:{type:"mp",masterPassword:(0,s.masterPasswordSelector)(f.getState()),secondaryKey:m}}),D&&await A.getInstance().user.persistLocalKey(D),await y.session.commands.flushLocalData(),await (0,c.storeSessionCredentialForRecovery)(f,e.localStorageService),await y.pinCode.commands.deactivate()}catch(t){return d(e),f.dispatch((0,l.changeMPDone)()),{success:!1,error:{code:a.AuthenticationCode.UNKNOWN_ERROR}}}let P=!0;try{let e=await (0,n.confirmMasterPasswordChangeDone)(f,T,{});if((0,n.isApiError)(e))throw Error("2FA Enable Flow - Failed to confirmMasterPasswordChangeDone");P=!1}catch(e){}return f.dispatch((0,l.changeMPDone)()),{success:!0,logoutRequired:P}};t.enableTwoFactorAuthenticationTOTP2Handler=p},56307:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.completeTotpActivationHandler=void 0;let a=r(20648),o=r(28323),n=r(93748),i=r(10028),s=async(e,t)=>{let{storeService:r}=e,s=r.getState(),c=(0,n.userLoginSelector)(s);if(!c)return{success:!1,error:{code:a.AuthenticationCode.UNKNOWN_ERROR}};let l=await (0,i.completeTotpActivation)(r,c,{authTicket:t});return(0,o.isApiError)(l)?{success:!1,error:{code:l.code}}:{success:!0}};t.completeTotpActivationHandler=s},8085:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.endTwoFactorAuthenticationHandler=void 0;let a=r(83533),o=r(34056),n=async({sessionService:e,storeService:t})=>(t.dispatch((0,o.changeMPDone)()),await e.getInstance().user.attemptSync(a.Trigger.SettingsChange),{success:!0});t.endTwoFactorAuthenticationHandler=n},79146:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.endTwoFactorAuthenticationHandler=t.disableTwoFactorAuthenticationTOTP1Handler=t.disableTwoFactorAuthenticationTOTP2Handler=t.refreshTwoFactorAuthenticationInfoHandler=void 0;var a=r(75848);Object.defineProperty(t,"refreshTwoFactorAuthenticationInfoHandler",{enumerable:!0,get:function(){return a.refreshTwoFactorAuthenticationInfoHandler}});var o=r(46030);Object.defineProperty(t,"disableTwoFactorAuthenticationTOTP2Handler",{enumerable:!0,get:function(){return o.disableTwoFactorAuthenticationTOTP2Handler}});var n=r(74978);Object.defineProperty(t,"disableTwoFactorAuthenticationTOTP1Handler",{enumerable:!0,get:function(){return n.disableTwoFactorAuthenticationTOTP1Handler}});var i=r(8085);Object.defineProperty(t,"endTwoFactorAuthenticationHandler",{enumerable:!0,get:function(){return i.endTwoFactorAuthenticationHandler}})},75848:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.refreshTwoFactorAuthenticationInfoHandler=void 0;let a=r(93748),o=r(96949),n=r(16659),i=async e=>{let{storeService:t,wsService:r}=e;try{let e=t.isAuthenticated,i=(0,a.userLoginSelector)(t.getState());if(t.dispatch((0,o.TwoFactorAuthStatusRequested)()),!i||!e)return t.dispatch((0,o.TwoFactorAuthStatusError)()),{success:!1};let s=await (0,n.refreshTwoFactorAuthenticationInfoService)(t,r);if(!1===s.success)return t.dispatch((0,o.TwoFactorAuthStatusError)()),{success:!1};return{success:!0}}catch(e){return t.dispatch((0,o.TwoFactorAuthStatusError)()),{success:!1}}};t.refreshTwoFactorAuthenticationInfoHandler=i},48463:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.twoFactorAuthenticationInfo$=void 0;let a=r(95121),o=r(15237),n=r(63484);t.twoFactorAuthenticationInfo$=()=>(0,a.pipe)((0,o.map)(n.twoFactorAuthenticationInfoSelector),(0,o.distinctUntilChanged)())},63484:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.twoFactorAuthenticationInfoSelector=void 0,t.twoFactorAuthenticationInfoSelector=e=>e.authentication.twoFactorAuthentication},16659:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.requestTOTPActivationService=t.refreshTwoFactorAuthenticationInfoService=t.performTotpVerificationService=void 0;var a=r(39234);Object.defineProperty(t,"performTotpVerificationService",{enumerable:!0,get:function(){return a.performTotpVerificationService}});var o=r(32501);Object.defineProperty(t,"refreshTwoFactorAuthenticationInfoService",{enumerable:!0,get:function(){return o.refreshTwoFactorAuthenticationInfoService}});var n=r(75739);Object.defineProperty(t,"requestTOTPActivationService",{enumerable:!0,get:function(){return n.requestTOTPActivationService}})},39234:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.performTotpVerificationService=void 0;let a=r(20648),o=r(28323),n=r(21837),i=r(74907),s=r(49087),c=r(93748),l=async(e,t,r=!1)=>{let{storeService:l}=e,u=l.getState(),d=(0,c.userLoginSelector)(u);if(!d)return{success:!1,error:{code:a.AuthenticationCode.UNKNOWN_ERROR}};try{let e=await (0,o.performTotpVerification)(l,{login:d,otp:t,activationFlow:r});if((0,o.isApiError)(e))return(0,s.handlePerformValidationError)(e,!0);let{authTicket:a}=e;return{success:!0,authTicket:a}}catch(e){return{success:!1,error:{code:(0,n.isCarbonError)(e)&&e.errorCode===i.HttpErrorCode.NETWORK_ERROR?a.AuthenticationCode.NETWORK_ERROR:a.AuthenticationCode.UNKNOWN_ERROR}}}};t.performTotpVerificationService=l},32501:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.refreshTwoFactorAuthenticationInfoService=void 0;let a=r(28323),o=r(93748),n=r(79683),i=r(29509),s=r(96949),c=r(20648),l=r(80896),u=r(21837),d={email_token:c.TwoFactorAuthenticationType.EMAIL_TOKEN,totp_login:c.TwoFactorAuthenticationType.LOGIN,totp_device_registration:c.TwoFactorAuthenticationType.DEVICE_REGISTRATION,sso:c.TwoFactorAuthenticationType.SSO},p=async(e,t)=>{try{let r=(0,o.userLoginSelector)(e.getState()),l=await (0,a.getTwoFactorAuthenticationStatus)(e,r);if((0,a.isApiError)(l))return e.dispatch((0,s.TwoFactorAuthStatusError)()),{success:!1};let u=d[l.type],p=n.TwoFactorAuthenticationEnabled.includes(u),S=!1,{spaces:g}=await t.premium.status({login:(0,o.userLoginSelector)(e.getState()),uki:(0,i.ukiSelector)(e.getState()),spaces:!0});g&&(S=g.some(e=>{let{info:{twoFAEnforced:t}}=e;return c.ENFORCE_TWO_FACTOR_AUTHENTICATION_ENABLED_VALUES.includes(t)}));let m=!p&&S,y={...l,isTwoFactorAuthenticationEnabled:p,isTwoFactorAuthenticationEnforced:S,shouldEnforceTwoFactorAuthentication:m,type:u};return e.dispatch((0,s.TwoFactorAuthStatusUpdated)(y)),{success:!0,info:y}}catch(r){e.dispatch((0,s.TwoFactorAuthStatusError)());let t=u.CarbonError.fromAnyError(r).addContextInfo("Refresh 2FA info","refresh-two-factor-authentication-service.ts");return(0,l.sendExceptionLog)({error:t}),{success:!1}}};t.refreshTwoFactorAuthenticationInfoService=p},75739:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.requestTOTPActivationService=void 0;let a=r(20648),o=r(28323),n=r(21837),i=r(74907),s=r(93748),c=async(e,{phoneNumber:t,country:r})=>{try{let{storeService:n}=e,i=n.getState(),c=(0,s.userLoginSelector)(i);if(!c)return{success:!1,error:{code:a.AuthenticationCode.UNKNOWN_ERROR}};let l=await (0,o.requestTOTPActivation)(n,c,{phoneNumber:t,country:r});if((0,o.isApiError)(l))return{success:!1,error:{code:l.code}};return{success:!0,...l}}catch(e){return{success:!1,error:{code:(0,n.isCarbonError)(e)&&e.errorCode===i.HttpErrorCode.NETWORK_ERROR?a.AuthenticationCode.NETWORK_ERROR:a.AuthenticationCode.UNKNOWN_ERROR}}}};t.requestTOTPActivationService=c},89372:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.config=void 0;let a=r(20564),o=r(41145),n=r(63234),i=r(1408),s=r(47592),c=r(75743),l=r(29509),u=r(25913),d=r(40799),p=r(58305),S=r(72622),g=r(90682),m=r(63026);t.config={commands:{enableWebAuthnAuthentication:{handler:p.enableWebAuthnAuthentication},initEnableWebAuthnAuthentication:{handler:d.initEnableWebAuthnAuthentication},initRegisterWebAuthnAuthenticator:{handler:a.initRegisterWebAuthnAuthenticator},registerWebAuthnAuthenticator:{handler:o.registerWebAuthnAuthenticator},refreshWebAuthnAuthenticators:{handler:i.refreshWebAuthnAuthenticators},refreshAvailableWebAuthnAuthenticators:{handler:n.refreshAvailableWebAuthnAuthenticators},initOpenSessionWithWebAuthnAuthenticator:{handler:s.initOpenSessionWithWebAuthnAuthenticator},openSessionWithWebAuthnAuthenticator:{handler:c.openSessionWithWebAuthnAuthenticator},disableWebAuthnAuthentication:{handler:S.disableWebAuthnAuthentication},removeWebAuthnAuthenticator:{handler:m.removeWebAuthnAuthenticator},initUserVerificationWithWebAuthn:{handler:g.initUserVerificationWithWebAuthn}},queries:{getWebAuthnAuthenticators:{selector:l.authenticatorsSelector},getWebAuthnAuthenticationOptedIn:{selector:l.webAuthnAuthenticationOptedInSelector}},liveQueries:{liveWebAuthnAuthenticators:{operator:u.webAuthnAuthenticators$},liveWebAuthnAuthenticationOptedIn:{operator:u.webAuthnAuthenticationOptedIn$}}}},3360:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.PUBKEY_ALGORITHM_RSA_PKCS1256=t.PUBKEY_ALGORITHM_ECDSA256=void 0,t.PUBKEY_ALGORITHM_ECDSA256=-7,t.PUBKEY_ALGORITHM_RSA_PKCS1256=-257},86254:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.buildAssertionPublicKeyOptions=t.buildAttestationPublicKeyOptions=void 0;let a=r(3360);t.buildAttestationPublicKeyOptions=function(e,t,r,o,n,i){return{rp:{id:e,name:"Dashlane"},user:{id:t,name:r,displayName:r},challenge:o,timeout:n,pubKeyCredParams:[{alg:a.PUBKEY_ALGORITHM_ECDSA256,type:"public-key"},{alg:a.PUBKEY_ALGORITHM_RSA_PKCS1256,type:"public-key"}],excludeCredentials:i,authenticatorSelection:{userVerification:"discouraged"}}},t.buildAssertionPublicKeyOptions=function(e,t,r,a){return{rpId:e,challenge:t,timeout:r,allowCredentials:a,userVerification:"discouraged"}}},25913:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.webAuthnAuthenticationOptedIn$=t.webAuthnAuthenticators$=void 0;let a=r(95121),o=r(15237),n=r(29509);t.webAuthnAuthenticators$=()=>(0,a.pipe)((0,o.map)(n.authenticatorsSelector),(0,o.distinctUntilChanged)()),t.webAuthnAuthenticationOptedIn$=()=>(0,a.pipe)((0,o.map)(n.webAuthnAuthenticationOptedInSelector),(0,o.distinctUntilChanged)())},72622:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.disableWebAuthnAuthentication=void 0;let a=r(20648),o=r(93748),n=r(30081);async function i(e){let{webAuthnAuthenticationService:t,storeService:r}=e,i=(0,o.userLoginSelector)(r.getState());if(!i)return{success:!1,error:{code:a.DisableWebAuthnAuthenticationError.MISSING_LOGIN}};try{if(!await t.deactivate(i))return{success:!1,error:{code:a.DisableWebAuthnAuthenticationError.WEBAUTHN_SERVICE_DEACTIVATE_FAILED}};return(0,n.sendUserSettingsLog)(e),{success:!0}}catch(e){return{success:!1,error:{code:a.DisableWebAuthnAuthenticationError.WEBAUTHN_SERVICE_DEACTIVATE_FAILED}}}}t.disableWebAuthnAuthentication=i},58305:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.enableWebAuthnAuthentication=void 0;let a=r(20648),o=r(29509),n=r(93748),i=r(30081),s={UNKNOWN_ERROR:{success:!1,error:{code:a.EnableWebAuthnAuthenticationError.UNKNOWN_ERROR}},WEBAUTHN_SERVICE_INIT_FAILED:{success:!1,error:{code:a.EnableWebAuthnAuthenticationError.WEBAUTHN_SERVICE_INIT_FAILED}},USER_HAS_OTP:{success:!1,error:{code:a.EnableWebAuthnAuthenticationError.USER_HAS_OTP}}};async function c(e,t,r,a){let o=t.response,n={authenticationType:"webauthn.create",name:e,isRoaming:r,credential:{id:t.id,type:t.type,rawId:t.rawId,response:o}};return await a.initialize(n)?{success:!0}:s.WEBAUTHN_SERVICE_INIT_FAILED}async function l(e,t){let r=e.response,a={authenticationType:"webauthn.get",credential:{id:e.id,type:e.type,rawId:e.rawId,response:r}};return await t.initialize(a)?{success:!0}:s.WEBAUTHN_SERVICE_INIT_FAILED}async function u(e,t){let{webAuthnAuthenticationService:r,storeService:u}=e,{authenticationType:d,credential:p,isRoaming:S}=t,g=(0,n.userLoginSelector)(u.getState());if((0,o.hasOtp2TypeSelector)(u.getState()))return s.USER_HAS_OTP;try{switch(d){case a.WebAuthnCallTypes.CREATE:{let t=await c(g,p,S,r);return t.success&&(0,i.sendUserSettingsLog)(e),t}case a.WebAuthnCallTypes.GET:{let t=await l(p,r);return t.success&&(0,i.sendUserSettingsLog)(e),t}default:return s.UNKNOWN_ERROR}}catch(e){return s.UNKNOWN_ERROR}}t.enableWebAuthnAuthentication=u},40799:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.initEnableWebAuthnAuthentication=void 0;let a=r(42387),o=r(20648),n=r(28323),i=r(93748),s=r(29509),c=r(8748),l=r(1408),u=r(86254);async function d(e,t){let{storeService:r}=e,{relyingPartyId:d}=t,p=r.getState(),S=(0,i.userLoginSelector)(r.getState()),g=(0,s.webAuthnUserIdSelector)(p);g||(g=(0,a.v4)(),r.dispatch((0,c.webAuthnUserIdUpdated)(g)));let m=(0,s.authenticatorsAsCredentialSelector)(p);m&&0!==m.length||(await (0,l.refreshWebAuthnAuthenticators)(e),m=(0,s.authenticatorsAsCredentialSelector)(r.getState()));let y=m?.length>0?o.WebAuthnCallTypes.GET:o.WebAuthnCallTypes.CREATE;try{let e;let t=await (0,n.requestWebauthnRegistration)(r,S);if((0,n.isApiError)(t))return{success:!1,error:{code:o.InitEnableWebAuthnAuthenticationError.UNKNOWN_ERROR}};let{challenge:a,expirationDateUnix:i}=t;return e=y===o.WebAuthnCallTypes.CREATE?(0,u.buildAttestationPublicKeyOptions)(d,g,S,a,i,m):(0,u.buildAssertionPublicKeyOptions)(d,a,i,m),{success:!0,response:{publicKeyOptions:e,webAuthnType:y}}}catch(e){return{success:!1,error:{code:o.InitEnableWebAuthnAuthenticationError.UNKNOWN_ERROR}}}}t.initEnableWebAuthnAuthentication=d},47592:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.initOpenSessionWithWebAuthnAuthenticator=void 0;let a=r(83533),o=r(20648),n=r(8665),i=r(91733),s=r(22089);async function c(e,t){let{relyingPartyId:r,login:c}=t,{webAuthnAuthenticationService:l}=e;try{if(!await l.shouldTrigger(c))return{success:!1,error:{code:o.InitOpenSessionWithWebAuthnAuthenticatorError.CANNOT_TRIGGER_WEBAUTHN_AUTHENTICATION}};(0,s.sendAskBiometricAuthenticationEventLog)(e,a.VerificationMode.None);let t=await (0,n.startWebAuthnAuthentication)(e,c,r);if(!1===t.success){let e=o.InitOpenSessionWithWebAuthnAuthenticatorError.UNKNOWN_ERROR;return t.error.code===i.StartWebAuthnAuthenticationError.CANNOT_REFRESH_WEBAUTHN_AUTHENTICATORS&&(e=o.InitOpenSessionWithWebAuthnAuthenticatorError.UNAVAILABLE_AUTHENTICATORS),{success:!1,error:{code:e}}}return{success:!0,response:{publicKeyOptions:t.response.publicKeyOptions,authenticatorsInfo:t.response.authenticatorsInfo.map(({credentialId:e,isRoaming:t})=>({credentialId:e,isRoaming:t}))}}}catch(e){return{success:!1,error:{code:o.InitOpenSessionWithWebAuthnAuthenticatorError.UNKNOWN_ERROR}}}}t.initOpenSessionWithWebAuthnAuthenticator=c},20564:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.initRegisterWebAuthnAuthenticator=void 0;let a=r(42387),o=r(20648),n=r(28323),i=r(8748),s=r(93748),c=r(29509),l=r(86254),u=r(1408);async function d(e,t){let{storeService:r}=e,{relyingPartyId:d}=t,p=(0,s.userLoginSelector)(r.getState()),S=(0,c.webAuthnUserIdSelector)(r.getState());S||(S=(0,a.v4)(),r.dispatch((0,i.webAuthnUserIdUpdated)(S)));let g=(0,c.authenticatorsAsCredentialSelector)(r.getState());g&&0!==g.length||(await (0,u.refreshWebAuthnAuthenticators)(e),g=(0,c.authenticatorsAsCredentialSelector)(r.getState()));try{let e=await (0,n.requestWebauthnRegistration)(r,p);if((0,n.isApiError)(e))return{success:!1,error:{code:o.InitRegisterWebAuthnAuthenticatorError.UNKNOWN_ERROR}};let{challenge:t,expirationDateUnix:a}=e,i=(0,l.buildAttestationPublicKeyOptions)(d,S,p,t,a,g);return{success:!0,response:{publicKeyOptions:i}}}catch(e){return{success:!1,error:{code:o.InitRegisterWebAuthnAuthenticatorError.UNKNOWN_ERROR}}}}t.initRegisterWebAuthnAuthenticator=d},90682:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.initUserVerificationWithWebAuthn=void 0;let a=r(20648),o=r(8665),n=r(91733),i=r(93748),s={[n.StartWebAuthnAuthenticationError.CANNOT_FETCH_WEBAUTHN_CHALLENGE]:a.InitUserVerificationWithWebAuthnError.CANNOT_FETCH_WEBAUTHN_CHALLENGE,[n.StartWebAuthnAuthenticationError.CANNOT_REFRESH_WEBAUTHN_AUTHENTICATORS]:a.InitUserVerificationWithWebAuthnError.CANNOT_REFRESH_WEBAUTHN_AUTHENTICATORS};async function c(e,t){try{let{storeService:r}=e,n=r.getState();if(!(0,i.isAuthenticatedSelector)(n))return{success:!1,error:{code:a.InitUserVerificationWithWebAuthnError.LOGGED_OUT}};let c=(0,i.userLoginSelector)(n),l=await (0,o.startWebAuthnAuthentication)(e,c,t.relyingPartyId);if(!1===l.success){let e=s[l.error.code]??a.InitUserVerificationWithWebAuthnError.UNKNOWN_ERROR;return{success:!1,error:{code:e}}}return{success:!0,response:{publicKeyOptions:l.response.publicKeyOptions}}}catch(e){return{success:!1,error:{code:a.InitUserVerificationWithWebAuthnError.UNKNOWN_ERROR}}}}t.initUserVerificationWithWebAuthn=c},75743:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.openSessionWithWebAuthnAuthenticator=void 0;let a=r(20648),o=r(72287),n=r(22089);async function i(e,t){let{credential:r,login:i,isRoamingAuthenticator:s}=t,{storeService:c,webAuthnAuthenticationService:l}=e;try{let t={authenticationType:"webauthn.get",credential:{id:r.id,type:r.type,rawId:r.rawId,response:r.response}};await l.process(i,t);let u=c.getUserSession().masterPassword;if(!u)return(0,n.sendBiometricLoginErrorLog)(e),{success:!1,error:{code:a.OpenSessionWithWebAuthnAuthenticatorError.MP_MISSING_IN_SESSION_ERROR}};let d=(0,o.makeLoginController)(e);return await d.openSessionWithMasterPassword(i,u,{triggeredByRememberMeType:"webauthn",isWebAuthnAuthenticatorRoaming:s,loginType:"Biometric"}),{success:!0}}catch(t){return(0,n.sendBiometricLoginErrorLog)(e),{success:!1,error:{code:a.OpenSessionWithWebAuthnAuthenticatorError.UNKNOWN_ERROR}}}}t.openSessionWithWebAuthnAuthenticator=i},63234:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.refreshAvailableWebAuthnAuthenticators=void 0;let a=r(20648),o=r(29509),n=r(28323),i=r(8748);async function s(e,t){let{storeService:r}=e,{login:s}=t;if(!(0,o.sessionKeysSelector)(r.getState()))return{success:!1,error:{code:a.RefreshAvailableWebAuthnAuthenticatorsError.MISSING_SESSION_KEYS_IN_STORE}};try{let e=await (0,n.getAvailableWebAuthnAuthenticators)(r,s);if((0,n.isApiError)(e))return{success:!1,error:{code:a.RefreshAvailableWebAuthnAuthenticatorsError.UNKNOWN_ERROR}};let t=e.authenticators.map(e=>({...e,canOpenSession:!0}));return r.dispatch((0,i.webAuthnAvailableAuthenticatorsListUpdated)(t)),{success:!0,response:{authenticators:t}}}catch(e){return{success:!1,error:{code:a.RefreshAvailableWebAuthnAuthenticatorsError.UNKNOWN_ERROR}}}}t.refreshAvailableWebAuthnAuthenticators=s},1408:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.refreshWebAuthnAuthenticators=void 0;let a=r(20648),o=r(28323),n=r(93748),i=r(8748);async function s(e){let{storeService:t}=e,r=(0,n.userLoginSelector)(t.getState());try{let e=await (0,o.getWebAuthnAuthenticators)(t,r);if((0,o.isApiError)(e))return{success:!1,error:{code:a.RefreshWebAuthnAuthenticatorsError.UNKNOWN_ERROR}};let n=e.authenticators.map(e=>({...e,canOpenSession:!1}));return t.dispatch((0,i.webAuthnAuthenticatorsListUpdated)(n)),{success:!0,response:{authenticators:n}}}catch(e){return{success:!1,error:{code:a.RefreshWebAuthnAuthenticatorsError.UNKNOWN_ERROR}}}}t.refreshWebAuthnAuthenticators=s},41145:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.registerWebAuthnAuthenticator=void 0;let a=r(20648),o=r(93748),n=r(28323),i=r(29509),s=r(8748);async function c(e,t){let{credential:r,isRoaming:c}=t,{storeService:l,webAuthnAuthenticationService:u}=e,d=l.getState(),p=(0,o.userLoginSelector)(d);if((0,i.hasOtp2TypeSelector)(d))return{success:!1,error:{code:a.RegisterWebAuthnAuthenticatorError.USER_HAS_OTP}};try{let e={authenticationType:"webauthn.create",name:p,isRoaming:c,credential:{id:r.id,type:r.type,rawId:r.rawId,response:r.response}};if((0,i.authenticatorsSelector)(d).length){let t=await (0,n.completeWebAuthnAuthenticatorRegistration)(l,p,{authenticator:e});if((0,n.isApiError)(t))return{success:!1,error:{code:a.RegisterWebAuthnAuthenticatorError.UNKNOWN_ERROR}}}else await u.initialize(e);return l.dispatch((0,s.webAuthnAuthenticatorAdded)({name:e.name,isRoaming:e.isRoaming,credentialId:e.credential.id,canOpenSession:!0})),{success:!0}}catch(e){return{success:!1,error:{code:a.RegisterWebAuthnAuthenticatorError.UNKNOWN_ERROR}}}}t.registerWebAuthnAuthenticator=c},63026:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.removeWebAuthnAuthenticator=void 0;let a=r(20648),o=r(93748),n=r(28323),i=r(29509),s=r(72622),c=r(8748);async function l(e,t,r){let o=await (0,n.deactivateWebAuthnAuthenticator)(e,t,{credentialId:r});return(0,n.isApiError)(o)?{success:!1,error:{code:a.RemoveWebAuthnAuthenticatorError.CANNOT_REMOVE_WEBAUTHN_AUTHENTICATOR}}:{success:!0}}async function u(e,t){let{credentialId:r}=t,{storeService:n}=e,u=n.getState(),d=(0,o.userLoginSelector)(u),p=(0,i.webAuthnAuthenticationOptedInSelector)(u),S=(0,i.authenticatorsSelector)(u);try{let t=null;return p&&1===S.length&&await (0,s.disableWebAuthnAuthentication)(e),(t=await l(n,d,r)).success&&n.dispatch((0,c.webAuthnAuthenticatorRemoved)(r)),t}catch(e){return{success:!1,error:{code:a.RemoveWebAuthnAuthenticatorError.UNKNOWN_ERROR}}}}t.removeWebAuthnAuthenticator=u},8665:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.startWebAuthnAuthentication=void 0;let a=r(86254),o=r(63234),n=r(91733),i=r(28323);async function s(e,t,r){let{storeService:s}=e,c=await (0,o.refreshAvailableWebAuthnAuthenticators)(e,{login:t});if(!c.success)return{success:!1,error:{code:n.StartWebAuthnAuthenticationError.CANNOT_REFRESH_WEBAUTHN_AUTHENTICATORS}};let l=c.response.authenticators.map(e=>({id:e.credentialId,type:"public-key"})),u=await (0,i.requestWebauthnOpenSession)(s,t);if((0,i.isApiError)(u))return{success:!1,error:{code:n.StartWebAuthnAuthenticationError.CANNOT_FETCH_WEBAUTHN_CHALLENGE}};let{challenge:d,expirationDateUnix:p}=u;return{success:!0,response:{publicKeyOptions:(0,a.buildAssertionPublicKeyOptions)(r,d,p,l),authenticatorsInfo:c.response.authenticators}}}t.startWebAuthnAuthentication=s},91733:function(e,t){var r;Object.defineProperty(t,"__esModule",{value:!0}),t.StartWebAuthnAuthenticationError=void 0,(r=t.StartWebAuthnAuthenticationError||(t.StartWebAuthnAuthenticationError={})).CANNOT_REFRESH_WEBAUTHN_AUTHENTICATORS="CANNOT_REFRESH_WEBAUTHN_AUTHENTICATORS",r.CANNOT_FETCH_WEBAUTHN_CHALLENGE="CANNOT_FETCH_WEBAUTHN_CHALLENGE"},95474:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.bootstrap=void 0;let a=r(93154);t.bootstrap=e=>{e.register(a.config)}},27762:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.bootstrap=t.getLocalAccounts=t.appKeysSelector=t.sessionKeysSelector=t.ukiSelector=t.deviceKeysSelector=t.authenticationReducer=void 0;var a=r(67513);Object.defineProperty(t,"authenticationReducer",{enumerable:!0,get:function(){return a.authenticationReducer}});var o=r(29509);Object.defineProperty(t,"deviceKeysSelector",{enumerable:!0,get:function(){return o.deviceKeysSelector}}),Object.defineProperty(t,"ukiSelector",{enumerable:!0,get:function(){return o.ukiSelector}}),Object.defineProperty(t,"sessionKeysSelector",{enumerable:!0,get:function(){return o.sessionKeysSelector}}),Object.defineProperty(t,"appKeysSelector",{enumerable:!0,get:function(){return o.appKeysSelector}});var n=r(92846);Object.defineProperty(t,"getLocalAccounts",{enumerable:!0,get:function(){return n.getLocalAccounts}});var i=r(95474);Object.defineProperty(t,"bootstrap",{enumerable:!0,get:function(){return i.bootstrap}})},14297:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.reactivationStatus$=void 0;let a=r(95121),o=r(15237),n=r(29509);t.reactivationStatus$=()=>(0,a.pipe)((0,o.map)(n.reactivationStatusSelector),(0,o.distinctUntilChanged)())},29509:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.reactivationStatusSelector=t.rememberMeFor14DaysOptedInSelector=t.webAuthnAuthenticationOptedInSelector=t.rememberMeTypeSelector=t.authenticatorsAsCredentialSelector=t.authenticatorsSelector=t.webAuthnUserIdSelector=t.platformInfoSelector=t.hasOtp2TypeSelector=t.otpTypeSelector=t.userAuthenticationDataSelector=t.localUsersAuthenticationDataSelector=t.localAccountsInitializedSelector=t.localAccountsListSelector=t.getUserDeviceWasRegisteredWithDeviceKeysSelector=t.sessionKeysSelector=t.getDeviceAccessKeysFromSession=t.getDeviceAccessKeySelector=t.getDeviceKeysFromSession=t.deviceKeysSelector=t.getUkiFromSession=t.ukiSelector=t.dashlaneServerDeltaTimestampSelector=t.appKeysSelector=void 0;let a=r(51414),o=r(15535),n=r(31935),i=r(95121),s=r(77323);t.appKeysSelector=e=>e.userSession.sdkAuthentication.appKeys,t.dashlaneServerDeltaTimestampSelector=e=>e.userSession.sdkAuthentication.dashlaneServerDeltaTimestamp,t.ukiSelector=e=>{let t=e.userSession.localSettings.uki;return t||e.authentication.currentUser&&e.authentication.currentUser.deviceKeys&&(0,a.convertDeviceKeysToUki)(e.authentication.currentUser.deviceKeys)||null},t.getUkiFromSession=({queries:{currentSessionInfo:e}})=>(0,i.firstValueFrom)(e().pipe((0,i.map)(s.getSuccessOrThrow),(0,i.map)(e=>(0,a.convertDeviceKeysToUki)(e.deviceKeys)))),t.deviceKeysSelector=e=>{if(e.authentication.currentUser&&e.authentication.currentUser.deviceKeys)return e.authentication.currentUser.deviceKeys;let t=e.userSession.localSettings.uki;return(0,a.convertUkiToDeviceKeys)(t)},t.getDeviceKeysFromSession=({queries:{currentSessionInfo:e}})=>(0,i.firstValueFrom)(e().pipe((0,i.map)(s.getSuccessOrThrow),(0,i.map)(e=>e.deviceKeys)));let c=(e,t)=>{let r=e.authentication.localUsers[t];return r&&r.deviceAccessKey?r.deviceAccessKey:(0,o.getCommonAppSetting)("deviceId")||null};t.getDeviceAccessKeySelector=(e,t)=>c(e,t),t.getDeviceAccessKeysFromSession=({queries:{localSessions:e}},t)=>(0,i.firstValueFrom)(e().pipe((0,i.map)(s.getSuccessOrThrow),(0,i.map)(e=>e[t]?.deviceAccessKey))),t.sessionKeysSelector=({userSession:{session:e}})=>e.sessionKeys&&e.sessionKeys.accessKey&&e.sessionKeys.secretKey?{...e.sessionKeys}:null,t.getUserDeviceWasRegisteredWithDeviceKeysSelector=(e,t)=>{let r=e.authentication.localUsers[t];return!!r&&!r.deviceRegisteredWithLegacyKey},t.localAccountsListSelector=e=>e.authentication.localAccounts.accountsList,t.localAccountsInitializedSelector=e=>e.authentication.localAccounts.accountsListInitialized,t.localUsersAuthenticationDataSelector=e=>e.authentication.localUsers,t.userAuthenticationDataSelector=e=>e.authentication.currentUser,t.otpTypeSelector=e=>e.userSession?.account?e.userSession.account.otpType:null,t.hasOtp2TypeSelector=e=>(0,t.otpTypeSelector)(e)===n.OtpType.OTP_LOGIN,t.platformInfoSelector=e=>e.device.platform.info,t.webAuthnUserIdSelector=e=>e.authentication.webAuthnAuthentication.webAuthnUserId,t.authenticatorsSelector=e=>e.authentication.webAuthnAuthentication.authenticators,t.authenticatorsAsCredentialSelector=e=>(0,t.authenticatorsSelector)(e).map(e=>({id:e.credentialId,type:"public-key"})),t.rememberMeTypeSelector=e=>e.authentication.currentUser.rememberMeType,t.webAuthnAuthenticationOptedInSelector=e=>"webauthn"===(0,t.rememberMeTypeSelector)(e),t.rememberMeFor14DaysOptedInSelector=e=>"autologin"===(0,t.rememberMeTypeSelector)(e),t.reactivationStatusSelector=e=>e.authentication.localAccounts.reactivationStatus},34493:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.setupSubscriptions=void 0;let a=r(13706);t.setupSubscriptions=function(e,t){e.carbonSessionOpened.on(()=>{(0,a.loadRememberMeTypeToStore)(t)})}},10651:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.config=void 0;let a=r(38986);t.config={commands:{},queries:{getSingleCompanyForAutofill:{selector:a.autofillViewedCompanySelector},getMultipleCompaniesForAutofill:{selector:a.autofillViewedQueriedCompaniesSelector},getMultipleCredentialsForAutofill:{selector:a.autofillViewedQueriedCredentialsByDomainSelector},getSingleDriverLicenseForAutofill:{selector:a.autofillViewedDriverLicenseSelector},getMultipleDriverLicensesForAutofill:{selector:a.autofillViewedQueriedDriverLicensesSelector},getSingleEmailForAutofill:{selector:a.autofillViewedEmailSelector},getMultipleEmailsForAutofill:{selector:a.autofillViewedQueriedEmailsSelector},getSingleFiscalIdForAutofill:{selector:a.autofillViewedFiscalIdSelector},getMultipleFiscalIdsForAutofill:{selector:a.autofillViewedQueriedFiscalIdsSelector},getSingleGeneratedPasswordForAutofill:{selector:a.autofillViewedGeneratedPasswordSelector},getMultipleGeneratedPasswordsForAutofill:{selector:a.autofillViewedQueriedGeneratedPasswordsSelector},getSingleIdCardForAutofill:{selector:a.autofillViewedIdCardSelector},getMultipleIdCardsForAutofill:{selector:a.autofillViewedQueriedIdCardsSelector},getSingleIdentityForAutofill:{selector:a.autofillViewedIdentitySelector},getMultipleIdentitiesForAutofill:{selector:a.autofillViewedQueriedIdentitiesSelector},getSingleNoteForAutofill:{selector:a.autofillViewedNoteSelector},getSinglePasskeyForAutofill:{selector:a.autofillViewedPasskeySelector},getSinglePassportForAutofill:{selector:a.autofillViewedPassportSelector},getMultiplePassportsForAutofill:{selector:a.autofillViewedQueriedPassportsSelector},getSinglePaymentCardForAutofill:{selector:a.autofillViewedPaymentCardSelector},getMultiplePaymentCardsForAutofill:{selector:a.autofillViewedQueriedPaymentCardsSelector},getSinglePersonalWebsiteForAutofill:{selector:a.autofillViewedPersonalWebsiteSelector},getMultiplePersonalWebsitesForAutofill:{selector:a.autofillViewedQueriedPersonalWebsitesSelector},getSinglePhoneForAutofill:{selector:a.autofillViewedPhoneSelector},getMultiplePhonesForAutofill:{selector:a.autofillViewedQueriedPhonesSelector},getSingleSocialSecurityIdForAutofill:{selector:a.autofillViewedSocialSecurityIdSelector},getMultipleSocialSecurityIdsForAutofill:{selector:a.autofillViewedQueriedSocialSecurityIdsSelector},getAutofillSettingOnUrlForAutofill:{selector:a.getAutofillSettingOnUrlForAutofillSelector}},liveQueries:{}}},95608:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.bootstrap=void 0;let a=r(10651);t.bootstrap=e=>{e.register(a.config)}},61510:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.getDomainMatchTypeForHermes=t.getAgeFromIdentity=t.defaultToZero=t.defaultToUS=t.defaultToEmptyString=void 0;let a=r(25903),o=r(20648),n=r(83533),i=r(36190),s=r(11531);t.defaultToEmptyString=(0,a.defaultTo)(""),t.defaultToUS=(0,a.defaultTo)(o.Country.US),t.defaultToZero=(0,a.defaultTo)(0),t.getAgeFromIdentity=e=>{let t=new Date(0).getUTCFullYear(),r=(0,i.epochToDate)((0,i.vaultDateToViewDate)(e.BirthDate));return Math.abs(new Date(Date.now()-r.getTime()).getUTCFullYear()-t)},t.getDomainMatchTypeForHermes=(e,t)=>{switch((0,s.getCredentialByDomainMatchType)(e,t)){case s.DomainMatchType.DashlaneDefinedLinkedWebsite:return n.MatchType.AssociatedWebsite;case s.DomainMatchType.UserDefinedLinkedWebsite:return n.MatchType.UserAssociatedWebsite;case s.DomainMatchType.None:case s.DomainMatchType.MainWebsite:default:return n.MatchType.Regular}}},83619:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.bootstrap=void 0;var a=r(95608);Object.defineProperty(t,"bootstrap",{enumerable:!0,get:function(){return a.bootstrap}})},38986:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.getAutofillSettingOnUrlForAutofillSelector=t.autofillViewedQueriedSocialSecurityIdsSelector=t.autofillViewedSocialSecurityIdSelector=t.autofillViewedQueriedPersonalWebsitesSelector=t.autofillViewedPersonalWebsiteSelector=t.autofillViewedQueriedPhonesSelector=t.autofillViewedPhoneSelector=t.autofillViewedQueriedPaymentCardsSelector=t.autofillViewedPaymentCardSelector=t.autofillViewedQueriedPassportsSelector=t.autofillViewedPassportSelector=t.autofillViewedPasskeySelector=t.autofillViewedNoteSelector=t.autofillViewedQueriedIdentitiesSelector=t.autofillViewedIdentitySelector=t.autofillViewedQueriedIdCardsSelector=t.autofillViewedIdCardSelector=t.autofillViewedQueriedGeneratedPasswordsSelector=t.autofillViewedGeneratedPasswordSelector=t.autofillViewedQueriedFiscalIdsSelector=t.autofillViewedFiscalIdSelector=t.autofillViewedQueriedEmailsSelector=t.autofillViewedEmailSelector=t.autofillViewedQueriedDriverLicensesSelector=t.autofillViewedDriverLicenseSelector=t.autofillViewedQueriedCredentialsByDomainSelector=t.autofillViewedQueriedCompaniesSelector=t.autofillViewedCompanySelector=void 0;let a=r(25903),o=r(20648),n=r(12857),i=r(97915),s=r(83527),c=r(92330),l=r(49386),u=r(39442),d=r(36755),p=r(67584),S=r(8362),g=r(59047),m=r(71156),y=r(92558),f=r(99008),E=r(52581),A=r(90296),h=r(31002),_=r(93748),T=r(99040),v=r(74595),I=r(82822);t.autofillViewedCompanySelector=(e,t)=>{let r=(0,i.companySelector)(e,t);return(0,v.companyAutofillView)(r)},t.autofillViewedQueriedCompaniesSelector=(0,a.compose)((0,T.viewListResults)(v.companyListView),i.queryCompaniesSelector),t.autofillViewedQueriedCredentialsByDomainSelector=(e,t)=>{let{domain:r,...a}=t,o=(r?(0,s.getQueryByDomainSelector)(r):c.querySelector)(e,a),n={...o,items:o.items.map(e=>({credential:e,domain:r,sharingStatus:{isShared:!1}}))};return(0,T.viewListResults)(v.credentialListView)(n)},t.autofillViewedDriverLicenseSelector=(e,t)=>{let r=(0,l.driverLicenseWithIdentitySelector)(e,t);return(0,v.driverLicenseAutofillView)(r)},t.autofillViewedQueriedDriverLicensesSelector=(0,a.compose)((0,T.viewListResults)(v.driverLicenseListView),l.queryDriverLicensesSelector),t.autofillViewedEmailSelector=(e,t)=>{let r=(0,u.emailSelector)(e,t);return(0,v.emailAutofillView)(r)},t.autofillViewedQueriedEmailsSelector=(0,a.compose)((0,T.viewListResults)(v.emailListView),u.queryEmailsSelector),t.autofillViewedFiscalIdSelector=(e,t)=>{let r=(0,d.fiscalIdSelector)(e,t);return(0,v.fiscalIdAutofillView)(r)},t.autofillViewedQueriedFiscalIdsSelector=(0,a.compose)((0,T.viewListResults)(v.fiscalIdListView),d.queryFiscalIdsSelector),t.autofillViewedGeneratedPasswordSelector=(e,t)=>{let r=(0,p.generatedPasswordSelector)(e,t);return(0,v.generatedPasswordAutofillView)(r)},t.autofillViewedQueriedGeneratedPasswordsSelector=(0,a.compose)((0,T.viewListResults)(v.generatedPasswordListView),p.queryGeneratedPasswordsSelector),t.autofillViewedIdCardSelector=(e,t)=>{let r=(0,S.idCardWithIdentitySelector)(e,t);return(0,v.idCardAutofillView)(r)},t.autofillViewedQueriedIdCardsSelector=(0,a.compose)((0,T.viewListResults)(v.idCardListView),S.queryIdCardsSelector),t.autofillViewedIdentitySelector=(e,t)=>{let r=(0,m.identitySelector)(e,t);return(0,v.identityAutofillView)(r)},t.autofillViewedQueriedIdentitiesSelector=(0,a.compose)((0,T.viewListResults)(v.identityListView),m.queryIdentitiesSelector),t.autofillViewedNoteSelector=(e,t)=>{let r=(0,g.noteSelector)(e,t);return(0,v.noteAutofillView)(r)},t.autofillViewedPasskeySelector=(e,t)=>{let r=(0,I.passkeySelector)(e,t);return(0,v.passkeyAutofillView)(r)},t.autofillViewedPassportSelector=(e,t)=>{let r=(0,y.passportWithIdentitySelector)(e,t);return(0,v.passportAutofillView)(r)},t.autofillViewedQueriedPassportsSelector=(0,a.compose)((0,T.viewListResults)(v.passportListView),y.queryPassportsWithIdentitySelector),t.autofillViewedPaymentCardSelector=(e,t)=>{let r=(0,f.paymentCardSelector)(e,t);return(0,v.paymentCardAutofillView)(r)},t.autofillViewedQueriedPaymentCardsSelector=(0,a.compose)((0,T.viewListResults)(v.paymentCardListView),f.queryPaymentCardsSelector),t.autofillViewedPhoneSelector=(e,t)=>{let r=(0,A.phoneSelector)(e,t);return(0,v.phoneAutofillView)(r)},t.autofillViewedQueriedPhonesSelector=(0,a.compose)((0,T.viewListResults)(v.phoneListView),A.queryPhonesSelector),t.autofillViewedPersonalWebsiteSelector=(e,t)=>{let r=(0,E.personalWebsiteSelector)(e,t);return(0,v.personalWebsiteAutofillView)(r)},t.autofillViewedQueriedPersonalWebsitesSelector=(0,a.compose)((0,T.viewListResults)(v.personalWebsiteListView),E.queryPersonalWebsitesSelector),t.autofillViewedSocialSecurityIdSelector=(e,t)=>{let r=(0,h.socialSecurityIdWithIdentitySelector)(e,t);return(0,v.socialSecurityIdAutofillView)(r)},t.autofillViewedQueriedSocialSecurityIdsSelector=(0,a.compose)((0,T.viewListResults)(v.socialSecurityIdListView),h.querySocialSecurityIdsSelector),t.getAutofillSettingOnUrlForAutofillSelector=(e,t)=>{let r=new n.ParsedURL(t).getRootDomain(),a=(0,_.personalSettingsSelector)(e),i=a.DisabledUrlsList.includes(t);return a.DisabledDomainsList.includes(r)||i?o.AutofillOptions.ANALYSIS_ENABLED_ONLY_ON_LOGINS_AND_PASSWORDS:o.AutofillOptions.ANALYSIS_ENABLED_ON_ALL_FORMS}},74595:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.passkeyAutofillView=t.socialSecurityIdListView=t.socialSecurityIdAutofillView=t.phoneListView=t.phoneAutofillView=t.personalWebsiteListView=t.personalWebsiteAutofillView=t.paymentCardListView=t.paymentCardAutofillView=t.passportListView=t.passportAutofillView=t.noteAutofillView=t.idCardListView=t.idCardAutofillView=t.identityListView=t.identityAutofillView=t.generatedPasswordListView=t.generatedPasswordAutofillView=t.fiscalIdListView=t.fiscalIdAutofillView=t.emailListView=t.emailAutofillView=t.driverLicenseListView=t.driverLicenseAutofillView=t.credentialListView=t.credentialAutofillView=t.companyListView=t.companyAutofillView=void 0;let a=r(51086),o=r(20648),n=r(25903),i=r(91711),s=r(36049),c=r(36190),l=r(32107),u=r(61510),d=r(19298),p=e=>({id:e.Id,lastUse:e.LastUse,localeFormat:e.LocaleFormat,spaceId:e.SpaceId});t.companyAutofillView=e=>({...p(e),vaultType:a.VaultSourceType.Company,name:(0,u.defaultToEmptyString)(e.Name),jobTitle:(0,u.defaultToEmptyString)(e.JobTitle)}),t.companyListView=e=>e.map(t.companyAutofillView),t.credentialAutofillView=(e,t,r)=>({...p(t),vaultType:a.VaultSourceType.Credential,autoProtected:(0,n.defaultTo)(!1,t.AutoProtected),autoLogin:(0,n.defaultTo)(!1,t.AutoLogin),email:(0,u.defaultToEmptyString)(t.Email),hasOtp:!!t.OtpSecret||!!t.OtpUrl,matchType:(0,u.getDomainMatchTypeForHermes)(e,t),login:(0,u.defaultToEmptyString)(t.Login),otpSecret:(0,u.defaultToEmptyString)(t.OtpSecret),otpUrl:(0,u.defaultToEmptyString)(t.OtpUrl),password:(0,u.defaultToEmptyString)(t.Password),subdomainOnly:t.SubdomainOnly||!1,sharingStatus:r,title:(0,u.defaultToEmptyString)(t.Title||(0,s.getDomainForCredential)(t)),secondaryLogin:t.SecondaryLogin,url:(0,u.defaultToEmptyString)(t.Url),userAddedLinkedWebsites:(0,l.getUserAddedLinkedWebsiteDomains)(t)}),t.credentialListView=e=>e.map(({domain:e,credential:r,sharingStatus:a})=>(0,t.credentialAutofillView)(e,r,a)),t.driverLicenseAutofillView=e=>{let t=(0,c.epochToDate)((0,c.vaultDateToViewDate)(e.ExpireDate)),r=(0,c.epochToDate)((0,c.vaultDateToViewDate)(e.DeliveryDate));return{...p(e),vaultType:a.VaultSourceType.DriverLicense,country:(0,c.vaultCountryToViewCountry)(e.LocaleFormat),creationDate:(0,u.defaultToZero)(e.CreationDatetime),expirationDay:t.getDate(),expirationMonth:t.getMonth()+c.ZERO_INDEX_BASED_MONTH_OFFSET,expirationYear:t.getFullYear(),expirationDateFull:`${t.getFullYear()}-${t.getMonth()+c.ZERO_INDEX_BASED_MONTH_OFFSET}-${t.getDate()}`,idNumber:(0,u.defaultToEmptyString)(e.Number),issueDay:r.getDate(),issueMonth:r.getMonth()+c.ZERO_INDEX_BASED_MONTH_OFFSET,issueYear:r.getFullYear(),issueDateFull:`${r.getFullYear()}-${r.getMonth()+c.ZERO_INDEX_BASED_MONTH_OFFSET}-${r.getDate()}`,name:(0,c.identityToName)(e.identity)||e.Fullname||"",spaceId:e.SpaceId,state:e.State}},t.driverLicenseListView=e=>e.map(t.driverLicenseAutofillView),t.emailAutofillView=e=>({...p(e),vaultType:a.VaultSourceType.Email,email:(0,u.defaultToEmptyString)(e.Email),name:(0,u.defaultToEmptyString)(e.EmailName),type:e.Type||"NO_TYPE"}),t.emailListView=e=>e.map(t.emailAutofillView),t.fiscalIdAutofillView=e=>({...p(e),vaultType:a.VaultSourceType.FiscalId,country:(0,c.vaultCountryToViewCountry)(e.LocaleFormat),idNumber:(0,u.defaultToEmptyString)(e.FiscalNumber),teledeclarantNumber:(0,u.defaultToEmptyString)(e.TeledeclarantNumber),creationDate:(0,u.defaultToZero)(e.CreationDatetime)}),t.fiscalIdListView=e=>e.map(t.fiscalIdAutofillView),t.generatedPasswordAutofillView=e=>({vaultType:a.VaultSourceType.GeneratedPassword,domain:(0,u.defaultToEmptyString)(e.Domain),generatedDate:e.GeneratedDate,password:e.Password,id:e.Id}),t.generatedPasswordListView=e=>e.map(t.generatedPasswordAutofillView),t.identityAutofillView=e=>({...p(e),vaultType:a.VaultSourceType.Identity,age:(0,u.getAgeFromIdentity)(e),birthDate:(0,u.defaultToEmptyString)(e.BirthDate),birthPlace:(0,u.defaultToEmptyString)(e.BirthPlace),firstName:(0,u.defaultToEmptyString)(e.FirstName),lastName2:(0,u.defaultToEmptyString)(e.LastName2),lastName:(0,u.defaultToEmptyString)(e.LastName),middleName:(0,u.defaultToEmptyString)(e.MiddleName),middleNameInitial:(0,u.defaultToEmptyString)(e.MiddleName),pseudo:(0,u.defaultToEmptyString)(e.Pseudo),title:e.Title}),t.identityListView=e=>e.map(t.identityAutofillView),t.idCardAutofillView=e=>{let t=(0,c.epochToDate)((0,c.vaultDateToViewDate)(e.ExpireDate)),r=(0,c.epochToDate)((0,c.vaultDateToViewDate)(e.DeliveryDate));return{...p(e),vaultType:a.VaultSourceType.IdCard,country:(0,c.vaultCountryToViewCountry)(e.LocaleFormat),creationDate:(0,u.defaultToZero)(e.CreationDatetime),expirationDay:t.getDate(),expirationMonth:t.getMonth()+c.ZERO_INDEX_BASED_MONTH_OFFSET,expirationYear:t.getFullYear(),expirationDateFull:`${t.getFullYear()}-${t.getMonth()+c.ZERO_INDEX_BASED_MONTH_OFFSET}-${t.getDate()}`,idNumber:(0,u.defaultToEmptyString)(e.Number),issueDay:r.getDate(),issueMonth:r.getMonth()+c.ZERO_INDEX_BASED_MONTH_OFFSET,issueYear:r.getFullYear(),issueDateFull:`${r.getFullYear()}-${r.getMonth()+c.ZERO_INDEX_BASED_MONTH_OFFSET}-${r.getDate()}`,name:(0,c.identityToName)(e.identity)||e.Fullname||"",spaceId:e.SpaceId}},t.idCardListView=e=>e.map(t.idCardAutofillView),t.noteAutofillView=e=>({...p(e),vaultType:a.VaultSourceType.Note}),t.passportAutofillView=e=>{let t=(0,c.epochToDate)((0,c.vaultDateToViewDate)(e.ExpireDate)),r=(0,c.epochToDate)((0,c.vaultDateToViewDate)(e.DeliveryDate));return{...p(e),vaultType:a.VaultSourceType.Passport,idNumber:(0,u.defaultToEmptyString)(e.Number),country:(0,c.vaultCountryToViewCountry)(e.LocaleFormat),expirationDay:t.getDate(),expirationMonth:t.getMonth()+c.ZERO_INDEX_BASED_MONTH_OFFSET,expirationYear:t.getFullYear(),expirationDateFull:`${t.getFullYear()}-${t.getMonth()+c.ZERO_INDEX_BASED_MONTH_OFFSET}-${t.getDate()}`,issueDay:r.getDate(),issueMonth:r.getMonth()+c.ZERO_INDEX_BASED_MONTH_OFFSET,issueYear:r.getFullYear(),issueDateFull:`${r.getFullYear()}-${r.getMonth()+c.ZERO_INDEX_BASED_MONTH_OFFSET}-${r.getDate()}`,name:(0,c.identityToName)(e.identity)||e.Fullname||"",deliveryPlace:(0,u.defaultToEmptyString)(e.DeliveryPlace),creationDate:(0,u.defaultToZero)(e.CreationDatetime)}},t.passportListView=e=>e.map(t.passportAutofillView),t.paymentCardAutofillView=e=>({...p(e),vaultType:a.VaultSourceType.PaymentCard,bank:(0,u.defaultToEmptyString)(e.Bank),cardNumber:(0,u.defaultToEmptyString)(e.CardNumber),cardNumberLastDigits:(0,i.getLastDigitsFromCardNumber)(e.CardNumber),color:e.Color||i.defaultColor,expireMonth:(0,u.defaultToEmptyString)(e.ExpireMonth),expireYear:(0,u.defaultToEmptyString)(e.ExpireYear),name:(0,u.defaultToEmptyString)(e.Name),ownerName:(0,u.defaultToEmptyString)(e.OwnerName),securityCode:(0,u.defaultToEmptyString)(e.SecurityCode),type:e.Type}),t.paymentCardListView=e=>e.map(t.paymentCardAutofillView),t.personalWebsiteAutofillView=e=>({...p(e),vaultType:a.VaultSourceType.PersonalWebsite,name:(0,u.defaultToEmptyString)(e.Name),website:(0,u.defaultToEmptyString)(e.Website)}),t.personalWebsiteListView=e=>e.map(t.personalWebsiteAutofillView);let S={[o.PhoneType.PHONE_TYPE_ANY]:d.PhoneType.Any,[o.PhoneType.PHONE_TYPE_FAX]:d.PhoneType.Fax,[o.PhoneType.PHONE_TYPE_LANDLINE]:d.PhoneType.Landline,[o.PhoneType.PHONE_TYPE_MOBILE]:d.PhoneType.Mobile,[o.PhoneType.PHONE_TYPE_WORK_FAX]:d.PhoneType.WorkFax,[o.PhoneType.PHONE_TYPE_WORK_LANDLINE]:d.PhoneType.WorkLandline,[o.PhoneType.PHONE_TYPE_WORK_MOBILE]:d.PhoneType.WorkMobile};t.phoneAutofillView=e=>({...p(e),vaultType:a.VaultSourceType.Phone,name:(0,u.defaultToEmptyString)(e.PhoneName),numberInternational:(0,u.defaultToEmptyString)(e.NumberNational),number:(0,u.defaultToEmptyString)(e.Number),type:S[e.Type]}),t.phoneListView=e=>e.map(t.phoneAutofillView),t.socialSecurityIdAutofillView=e=>({...p(e),vaultType:a.VaultSourceType.SocialSecurityId,name:(0,c.identityToName)(e.identity)||e.SocialSecurityFullname||"",idNumber:(0,u.defaultToEmptyString)(e.SocialSecurityNumber),country:(0,c.vaultCountryToViewCountry)(e.LocaleFormat),creationDate:(0,u.defaultToZero)(e.CreationDatetime)}),t.socialSecurityIdListView=e=>e.map(t.socialSecurityIdAutofillView),t.passkeyAutofillView=e=>({...p(e),credentialId:e.CredentialId,rpId:e.RpId,rpName:e.RpName,userDisplayName:e.UserDisplayName,userHandle:e.UserHandle,vaultType:a.VaultSourceType.Passkey,counter:e.Counter,keyAlgorithm:e.KeyAlgorithm})},7470:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.config=void 0;let a=r(30021),o=r(84535);t.config={commands:{changeMasterPassword:{handler:a.changeMasterPassword}},queries:{},liveQueries:{liveChangeMasterPasswordStatus:{subject:o.getChangeMasterPasswordStatus$}}}},84535:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.getChangeMasterPasswordStatus$=t.emitChangeMasterPasswordStatus=void 0;let a=new(r(95121)).Subject;t.emitChangeMasterPasswordStatus=e=>a.next(e),t.getChangeMasterPasswordStatus$=()=>a},38233:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.bootstrap=void 0;let a=r(7470);t.bootstrap=e=>{e.register(a.config)}},30021:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.changeMasterPassword=void 0;let a=r(20648),o=r(84535),n=r(51700),i=r(96525),s=r(64155),c=r(94491),l=r(86318),u=r(28323),d=r(72287),p=r(9779),S=r(93748),g=r(34056),m=r(10039),y=r(83533),f=r(25361),E=r(95121),A=r(77323),h=r(21837),_=r(80896),T=r(86969),v=r(33170),I=async(e,t)=>{let{applicationModulesAccess:r,storeService:I,masterPasswordEncryptorService:D,remoteDataEncryptorService:P,sessionService:O,localStorageService:C,storageService:b,eventLoggerService:R,moduleClients:N}=e,{queries:{isMasterPasswordLeaked:w,isMasterPasswordWeak:L},commands:{temporaryResetMasterPasswordLeaked:U}}=N.masterPasswordSecurity,{flow:M}=t,F=await (0,n.preValidationForChangeMP)(e,t);if(!1===F.success)return F;let k=I.getState(),K=(0,S.isRemoteKeyActivatedSelector)(k)?P:D;(0,o.emitChangeMasterPasswordStatus)({type:a.ChangeMasterPasswordStepNeeded.DOWNLOAD,value:10});let B=(0,S.userLoginSelector)(k);if(!B)return(0,n.makeReturnErrorObject)(a.ChangeMasterPasswordCode.UNEXPECTED_STATE,M);try{await N.session.commands.prepareLocalDataFlush(),I.dispatch((0,g.changeMPStart)())}catch(t){let e=h.CarbonError.fromAnyError(t).addContextInfo("CHANGE_MASTER_PASSWORD","prepareLocalDataFlushError").addAdditionalInfo({comment:"Failed to prepare local data on graphene"});throw(0,_.sendExceptionLog)({error:e}),t}let G=await (0,u.getDataForMasterPasswordChange)(I,B,{});if((0,u.isApiError)(G))return(0,f.logChangeMasterPasswordError)(R,y.ChangeMasterPasswordError.DownloadError),I.dispatch((0,g.changeMPDone)()),(0,n.makeUnexpectedErrorObject)(G.message,M);let{serverKey:j}=I.getUserSession();if(!(0,n.isOtpStatusValid)(G.otpStatus,j))return(0,f.logChangeMasterPasswordError)(R,y.ChangeMasterPasswordError.LoginError),I.dispatch((0,g.changeMPDone)()),(0,n.makeReturnErrorObject)(a.ChangeMasterPasswordCode.OTP_PROBLEM,M);let{timestamp:V}=G,{transactions:W,sharingKeys:H}=G.data;try{let u,S,D;let P=await (0,n.deCipherAllTransactions)(O,K,W),F=C.getInstance(),k=await F.doesLocalKeyExist(),G=null;k&&(G=await F.getLocalKey());let{publicKey:j}=H,x=await (0,n.decipherPrivateKey)(I,K,H);switch(await (0,m.cleanRememberMeStorageData)(I,b,N.session),t.flow){case a.ChangeMPFlowPath.MP_TO_SSO:u=await (0,s.handleMigrationMPtoSso)(e,t,P,x,j,V);break;case a.ChangeMPFlowPath.SSO_TO_MP:u=await (0,c.handleMigrationSSOtoMP)(e,t,P,x,j,V);break;case a.ChangeMPFlowPath.TO_EMAIL_TOKEN:u=await (0,i.handleMigrationToEmailToken)(e,t,P,x,j,V);break;case a.ChangeMPFlowPath.ADMIN_ASSISTED_RECOVERY:case a.ChangeMPFlowPath.ACCOUNT_RECOVERY_KEY:case a.ChangeMPFlowPath.USER_CHANGING_MP:default:u=await (0,l.handleUserChangingMP)(e,t,P,x,j,V)}if(!u.success)return(0,f.logChangeMasterPasswordError)(R,y.ChangeMasterPasswordError.UnknownError),I.dispatch((0,g.changeMPDone)()),u;await N.session.commands.flushLocalData();let Y=!!I.getPersonalSettings().AccountRecoveryKey;try{await r.createClients().pinCode.commands.deactivate()}catch(t){let e=h.CarbonError.fromAnyError(t).addContextInfo("CHANGE_MASTER_PASSWORD","deactivatePinCode").addAdditionalInfo({comment:"Failed to deactivate pin code after successful mp change"});await (0,_.sendExceptionLog)({error:e})}try{Y&&(await (0,T.deactivateAccountRecoveryKey)(I,B,{reason:"VAULT_KEY_CHANGE"}),(0,f.logUserDeleteAccountRecoveryKey)(R),e.storeService.dispatch((0,v.editPersonalSettings)({AccountRecoveryKey:void 0,AccountRecoveryKeyId:void 0})))}catch(t){let e=h.CarbonError.fromAnyError(t).addContextInfo("CHANGE_MASTER_PASSWORD","deactivateRecoveryKey").addAdditionalInfo({comment:"Failed to deactivate recovery key after successful mp change"});await (0,_.sendExceptionLog)({error:e})}G&&await O.getInstance().user.persistLocalKey(G),await (0,p.storeSessionCredentialForRecovery)(I,C),(0,o.emitChangeMasterPasswordStatus)({type:a.ChangeMasterPasswordStepNeeded.DONE,value:100}),await (0,n.resetMigrationState)(e,M),M===a.ChangeMPFlowPath.ADMIN_ASSISTED_RECOVERY||M===a.ChangeMPFlowPath.MP_TO_SSO||M===a.ChangeMPFlowPath.SSO_TO_MP?await (0,d.sessionDidOpen)(e):Y&&await e.sessionService.getInstance().user.attemptSync(y.Trigger.ChangeMasterPassword);try{S=await (0,E.firstValueFrom)(w())}catch(t){let e=h.CarbonError.fromAnyError(t).addContextInfo("CHANGE_MASTER_PASSWORD","isMasterPasswordLeakedError").addAdditionalInfo({comment:"Failed to retrieve value from isMasterPasswordLeaked"});throw(0,_.sendExceptionLog)({error:e}),t}try{D=await (0,E.firstValueFrom)(L())}catch(t){let e=h.CarbonError.fromAnyError(t).addContextInfo("CHANGE_MASTER_PASSWORD","isMasterPasswordWeakError").addAdditionalInfo({comment:"Failed to retrieve value from isMasterPasswordWeak"});throw(0,_.sendExceptionLog)({error:e}),t}let q=!!(0,A.isSuccess)(S)&&S.data,$=!!(0,A.isSuccess)(D)&&D.data;(0,f.logChangeMasterPasswordComplete)(R,q,$),I.dispatch((0,g.changeMPDone)()),U(void 0);let{commands:{temporarySendMasterPasswordChangedEvent:Q}}=r.createClients().changeMasterPassword;return Q(void 0),{success:!0,response:{reason:a.ChangeMasterPasswordCode.SUCCESS}}}catch(r){if((0,f.logChangeMasterPasswordError)(R,y.ChangeMasterPasswordError.UnknownError),t.flow!==a.ChangeMPFlowPath.MP_TO_SSO&&t.flow!==a.ChangeMPFlowPath.SSO_TO_MP){let r=(0,n.extractCurrentPassword)(k,t);(0,n.revertOnError)(e,K,{currentPassword:r,serverKey:j})}else(0,n.logoutUserOnError)(e);return(0,n.makeUnexpectedErrorObject)(r.message,M)}};t.changeMasterPassword=I},96525:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.handleMigrationToEmailToken=void 0;let a=r(83533),o=r(20648),n=r(93748),i=r(84535),s=r(51700),c=r(28323),l=r(49789),u=r(25361),d=async(e,t,r,d,p,S)=>{let{storeService:g,sessionService:m,masterPasswordEncryptorService:y,eventLoggerService:f}=e,{newPassword:E,flow:A,currentPassword:h}=t,{serverKey:_}=g.getUserSession(),T=g.getState(),v=(0,n.userLoginSelector)(T);if(!v)return(0,u.logChangeMasterPasswordError)(f,a.ChangeMasterPasswordError.LoginError),(0,s.makeReturnErrorObject)(o.ChangeMasterPasswordCode.UNEXPECTED_STATE,A);let I=(0,s.returnProperCryptoConfig)(g);y.setInstance({raw:E},"",I),g.dispatch((0,l.updateMasterPassword)(E)),g.dispatch((0,l.updateServerKey)("")),g.dispatch((0,l.updateRemoteKey)(null));let{authTicket:D}=(0,n.authTicketInfoSelector)(T),P=await (0,s.cipherTransactionWithNewMP)(g,m,y,r,A),O=await (0,s.cipherPrivateKey)(y,d),C={timestamp:S,transactions:(0,s.formatTransaction)(P),updateVerification:{type:"email_token"},sharingKeys:{publicKey:p,privateKey:O},authTicket:D};(0,i.emitChangeMasterPasswordStatus)({type:o.ChangeMasterPasswordStepNeeded.UPLOADING,value:95});let b=await (0,c.uploadDataForMasterPasswordChange)(g,v,C);if((0,c.isApiError)(b))return(0,u.logChangeMasterPasswordError)(f,a.ChangeMasterPasswordError.UploadError),(0,s.revertOnError)(e,y,{currentPassword:h,serverKey:_}),(0,s.makeUnexpectedErrorObject)(b.message,A);let R=await (0,c.confirmMasterPasswordChangeDone)(g,v,{});return(0,c.isApiError)(R)?((0,u.logChangeMasterPasswordError)(f,a.ChangeMasterPasswordError.ConfirmationError),(0,s.revertOnError)(e,y,{currentPassword:h,serverKey:_}),(0,s.makeUnexpectedErrorObject)(R.message,A)):(await e.applicationModulesAccess.createClients().session.commands.updateUserSessionKey({email:(0,n.userLoginSelector)(g.getState()),sessionKey:{type:"mp",masterPassword:E,secondaryKey:""}}),{success:!0,response:{reason:o.ChangeMasterPasswordCode.SUCCESS}})};t.handleMigrationToEmailToken=d},64155:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.handleMigrationMPtoSso=void 0;let a=r(83533),o=r(20648),n=r(95174),i=r(93748),s=r(84535),c=r(51700),l=r(28323),u=r(25361),d=async(e,t,r,d,p,S)=>{let{storeService:g,sessionService:m,remoteDataEncryptorService:y,eventLoggerService:f}=e,{newPassword:E,flow:A}=t,h=g.getState(),_=(0,i.userLoginSelector)(h);if(!_)return(0,u.logChangeMasterPasswordError)(f,a.ChangeMasterPasswordError.LoginError),(0,c.makeReturnErrorObject)(o.ChangeMasterPasswordCode.UNEXPECTED_STATE,A);let{remoteKey:T,serverKeyBase64:v}=await (0,n.prepareRemoteDataEncryptionServices)(e,E),{authTicket:I}=(0,i.authTicketInfoSelector)(h),D=await (0,c.cipherTransactionWithNewMP)(g,m,y,r,A),P=await (0,c.cipherPrivateKey)(y,d),O={timestamp:S,transactions:(0,c.formatTransaction)(D),remoteKeys:[T],updateVerification:{type:"sso",ssoServerKey:v},sharingKeys:{publicKey:p,privateKey:P},authTicket:I};(0,s.emitChangeMasterPasswordStatus)({type:o.ChangeMasterPasswordStepNeeded.UPLOADING,value:95});let C=await (0,l.uploadDataForMasterPasswordChange)(g,_,O);if((0,l.isApiError)(C))return(0,u.logChangeMasterPasswordError)(f,a.ChangeMasterPasswordError.UploadError),(0,c.logoutUserOnError)(e),(0,c.makeUnexpectedErrorObject)(C.message,A);let b=await (0,l.confirmMasterPasswordChangeDone)(g,_,{});return(0,l.isApiError)(b)?((0,u.logChangeMasterPasswordError)(f,a.ChangeMasterPasswordError.ConfirmationError),(0,c.logoutUserOnError)(e),(0,c.makeUnexpectedErrorObject)(b.message,A)):(await e.applicationModulesAccess.createClients().session.commands.updateUserSessionKey({email:(0,i.userLoginSelector)(g.getState()),sessionKey:{type:"sso",ssoKey:""}}),{success:!0,response:{reason:o.ChangeMasterPasswordCode.SUCCESS}})};t.handleMigrationMPtoSso=d},94491:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.handleMigrationSSOtoMP=void 0;let a=r(83533),o=r(20648),n=r(93748),i=r(84535),s=r(51700),c=r(28323),l=r(49789),u=r(25361),d=async(e,t,r,d,p,S)=>{let{storeService:g,sessionService:m,masterPasswordEncryptorService:y,eventLoggerService:f}=e,{newPassword:E,flow:A}=t,h=g.getState(),_=(0,n.userLoginSelector)(h);if(!_)return(0,u.logChangeMasterPasswordError)(f,a.ChangeMasterPasswordError.LoginError),(0,s.makeReturnErrorObject)(o.ChangeMasterPasswordCode.UNEXPECTED_STATE,A);let T=(0,s.returnProperCryptoConfig)(g);y.setInstance({raw:E},"",T),g.dispatch((0,l.updateMasterPassword)(E)),g.dispatch((0,l.updateServerKey)("")),g.dispatch((0,l.updateRemoteKey)(null));let{authTicket:v}=(0,n.authTicketInfoSelector)(h),I=await (0,s.cipherTransactionWithNewMP)(g,m,y,r,A),D=await (0,s.cipherPrivateKey)(y,d),P={timestamp:S,transactions:(0,s.formatTransaction)(I),updateVerification:{type:"email_token"},sharingKeys:{publicKey:p,privateKey:D},authTicket:v};(0,i.emitChangeMasterPasswordStatus)({type:o.ChangeMasterPasswordStepNeeded.UPLOADING,value:95});let O=await (0,c.uploadDataForMasterPasswordChange)(g,_,P);if((0,c.isApiError)(O))return(0,u.logChangeMasterPasswordError)(f,a.ChangeMasterPasswordError.UploadError),(0,s.logoutUserOnError)(e),(0,s.makeUnexpectedErrorObject)(O.message,A);let C=await (0,c.confirmMasterPasswordChangeDone)(g,_,{});return(0,c.isApiError)(C)?((0,u.logChangeMasterPasswordError)(f,a.ChangeMasterPasswordError.ConfirmationError),(0,s.logoutUserOnError)(e),(0,s.makeUnexpectedErrorObject)(C.message,A)):(await e.applicationModulesAccess.createClients().session.commands.updateUserSessionKey({email:(0,n.userLoginSelector)(g.getState()),sessionKey:{type:"mp",masterPassword:E,secondaryKey:""}}),{success:!0,response:{reason:o.ChangeMasterPasswordCode.SUCCESS}})};t.handleMigrationSSOtoMP=d},86318:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.handleUserChangingMP=void 0;let a=r(83533),o=r(20648),n=r(93748),i=r(84535),s=r(51700),c=r(28323),l=r(49789),u=r(25361),d=async(e,t,r,d,p,S)=>{let{storeService:g,sessionService:m,masterPasswordEncryptorService:y,eventLoggerService:f}=e,E=g.getState(),{newPassword:A,flow:h}=t,_=(0,s.extractCurrentPassword)(E,t),{serverKey:T}=g.getUserSession(),v=(0,n.userLoginSelector)(E);if(!v)return(0,u.logChangeMasterPasswordError)(f,a.ChangeMasterPasswordError.LoginError),(0,s.makeReturnErrorObject)(o.ChangeMasterPasswordCode.UNEXPECTED_STATE,h);y.setInstance({raw:A},T),g.dispatch((0,l.updateMasterPassword)(A));let I=await (0,s.cipherTransactionWithNewMP)(g,m,y,r),D=await (0,s.cipherPrivateKey)(y,d),P={timestamp:S,transactions:(0,s.formatTransaction)(I),sharingKeys:{publicKey:p,privateKey:D},uploadReason:h===o.ChangeMPFlowPath.ADMIN_ASSISTED_RECOVERY?"complete_account_recovery":void 0};(0,i.emitChangeMasterPasswordStatus)({type:o.ChangeMasterPasswordStepNeeded.UPLOADING,value:95});let O=await (0,c.uploadDataForMasterPasswordChange)(g,v,P);if((0,c.isApiError)(O))return(0,u.logChangeMasterPasswordError)(f,a.ChangeMasterPasswordError.UploadError),(0,s.revertOnError)(e,y,{currentPassword:_,serverKey:T}),(0,s.makeUnexpectedErrorObject)(O.message,h);let C=await (0,c.confirmMasterPasswordChangeDone)(g,v,{});return(0,c.isApiError)(C)?((0,u.logChangeMasterPasswordError)(f,a.ChangeMasterPasswordError.ConfirmationError),(0,s.revertOnError)(e,y,{currentPassword:_,serverKey:T}),(0,s.makeUnexpectedErrorObject)(C.message,h)):(await e.applicationModulesAccess.createClients().session.commands.updateUserSessionKey({email:(0,n.userLoginSelector)(g.getState()),sessionKey:{type:"mp",masterPassword:A,secondaryKey:T}}),{success:!0,response:{reason:o.ChangeMasterPasswordCode.SUCCESS}})};t.handleUserChangingMP=d},43705:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.bootstrap=void 0;var a=r(38233);Object.defineProperty(t,"bootstrap",{enumerable:!0,get:function(){return a.bootstrap}})},25361:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.logUserDeleteAccountRecoveryKey=t.logChangeMasterPasswordError=t.logChangeMasterPasswordComplete=t.logChangeMasterPasswordCancel=t.logChangeMasterPasswordStart=void 0;let a=r(83533),o=(e,t,r,o,n)=>{e.logEvent(new a.UserChangeMasterPasswordEvent({flowStep:t,errorName:r||void 0,isLeaked:o,isWeak:n}))};t.logChangeMasterPasswordStart=e=>o(e,a.FlowStep.Start),t.logChangeMasterPasswordCancel=e=>o(e,a.FlowStep.Cancel),t.logChangeMasterPasswordComplete=(e,t,r)=>o(e,a.FlowStep.Complete,void 0,t,r),t.logChangeMasterPasswordError=(e,t)=>o(e,a.FlowStep.Error,t),t.logUserDeleteAccountRecoveryKey=e=>{e.logEvent(new a.UserDeleteAccountRecoveryKeyEvent({deleteKeyReason:a.DeleteKeyReason.VaultKeyChanged}))}},65356:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.changeMPinProgressSelector=void 0,t.changeMPinProgressSelector=e=>e.userSession.changeMPData.changeMPinProgress},27121:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.cipherPrivateKey=void 0;let a=r(34978),o=async(e,t)=>{let r=(0,a.utf16ToDeflatedUtf8)(t,{skipDeflate:!0});return await e.getInstance().encrypt(r)};t.cipherPrivateKey=o},80104:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.cipherTransactionWithNewMP=void 0;let a=r(20648),o=r(51700),n=r(82779),i=r(1520),s=r(27498),c=r(50527),l=r(60355),u=r(33170),d=async(e,t,r,d,p,S=!0)=>{let{announce:g}=t.getInstance().user.getSyncArgs(),m=await Promise.all(d.map(async t=>{if(p&&"SETTINGS"===t.type&&t.content){let r={...t,content:await (0,o.getBaseModelFromXml)(g,t.content)};switch(p){case a.ChangeMPFlowPath.MP_TO_SSO:let n={...r.content,CryptoUserPayload:c.CRYPTO_NODERIVATION_HMAC64};return{...r,content:(0,s.getTransactionXml)(n)};case a.ChangeMPFlowPath.SSO_TO_MP:let i={forceSalt:(0,l.getRandomValues)(16),cryptoConfig:(0,o.returnProperCryptoConfig)(e)},d=(0,o.returnProperSettingContent)(e,r,i);return e.dispatch((0,u.editPersonalSettings)(d)),{...t,content:(0,s.getTransactionXml)(d)};case a.ChangeMPFlowPath.ADMIN_ASSISTED_RECOVERY:case a.ChangeMPFlowPath.ACCOUNT_RECOVERY_KEY:case a.ChangeMPFlowPath.USER_CHANGING_MP:case a.ChangeMPFlowPath.TO_EMAIL_TOKEN:}}return t})),y=m.length,f=S?(0,o.initializeProgress)(a.ChangeMasterPasswordStepNeeded.ENCRYPTING,100,y):null,E=async(e,t)=>{f&&f(),t(await (0,i.encryptSingleTransaction)(r,e))};return await new Promise(e=>{(0,n.asyncMapLimit)(m,E,e,100)})};t.cipherTransactionWithNewMP=d},61642:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.deCipherAllTransactions=void 0;let a=r(20648),o=r(40257),n=r(51700),i=r(82779),s=r(1520),c=r(89815),l=r(80896),u=r(21837),d=async(e,t,r,d=!0)=>{let{announce:p}=e.getInstance().user.getSyncArgs(),S=t.getInstance(),g=r.length,m=d?(0,n.initializeProgress)(a.ChangeMasterPasswordStepNeeded.DECRYPTING,100,g):null,y=async(e,t)=>{if(m&&m(),e.content)try{let r=await (0,s.decryptTransactionContent)(S,p,e);t({...e,content:r})}catch(r){if(e.type===o.TransactionType.SETTINGS){let t=u.CarbonError.fromAnyError(r).addContextInfo("CHANGE_MP","decipherAllTransactions").addAdditionalInfo({comment:r.message??`Transaction of type ${e.type} couldn't be decrypted`});throw(0,l.sendExceptionLog)({error:t}),r}t(null)}else t(e)},f=await new Promise(e=>{(0,i.asyncMapLimit)(r,y,e,100)});return(0,c.sanitizeTransactions)(f)};t.deCipherAllTransactions=d},19413:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.decipherPrivateKey=void 0;let a=r(34978),o=r(49789),n=async(e,t,r)=>{let n=await t.getInstance().decrypt(r.privateKey),i=(0,a.deflatedUtf8ToUtf16)(n,{skipInflate:!0}),s={privateKey:i,publicKey:r.publicKey};return e.dispatch((0,o.updateKeyPair)(s)),i};t.decipherPrivateKey=n},6808:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.formatTransaction=void 0,t.formatTransaction=e=>e.map(({action:e,content:t,identifier:r,time:a,type:o})=>({action:e,content:t,identifier:r,time:a,type:o}))},82082:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.getBaseModelFromXml=void 0;let a=r(56886),o=r(1520),n=r(79937),i=async(e,t)=>{let r=await (0,o.parseTransactionContentXml)(e,t);return n.fixPersonalSettingTypes.fromTransaction((0,a.fixKwType)(r))};t.getBaseModelFromXml=i},51700:function(e,t,r){var a=this&&this.__createBinding||(Object.create?function(e,t,r,a){void 0===a&&(a=r);var o=Object.getOwnPropertyDescriptor(t,r);(!o||("get"in o?!t.__esModule:o.writable||o.configurable))&&(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,a,o)}:function(e,t,r,a){void 0===a&&(a=r),e[a]=t[r]}),o=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||a(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),o(r(27121),t),o(r(80104),t),o(r(19413),t),o(r(61642),t),o(r(6808),t),o(r(82082),t),o(r(92021),t),o(r(10996),t),o(r(87102),t),o(r(29865),t),o(r(73952),t),o(r(7454),t),o(r(6958),t),o(r(47607),t),o(r(50959),t),o(r(12784),t)},92021:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.initializeProgress=void 0;let a=r(20648),o=r(84535);t.initializeProgress=(e,t,r)=>{let n=e===a.ChangeMasterPasswordStepNeeded.DECRYPTING?10:50,i=0;return()=>{(++i%t==0||i===r)&&(0,o.emitChangeMasterPasswordStatus)({type:e,value:n+Math.round(40*i/r)})}}},10996:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.isOtpStatusValid=void 0,t.isOtpStatusValid=(e,t)=>{switch(e){case"login":return t&&t.length>0;case"disabled":case"newDevice":return!t||0===t.length;default:return!1}}},87102:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.logoutUserOnError=void 0;let a=r(34056),o=r(62923),n=r(93748);t.logoutUserOnError=({storeService:e,storageService:t,sessionService:r,moduleClients:i})=>{let s=(0,n.userLoginSelector)(e.getState());e.dispatch((0,a.changeMPDone)()),s&&(0,o.wipeOutLocalAccounts)(t,i["carbon-legacy"],[s]),r.close()}},29865:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.makeReturnErrorObject=void 0;let a=r(20648),o=r(84535),n=r(80896);t.makeReturnErrorObject=(e,t)=>{(0,o.emitChangeMasterPasswordStatus)({type:a.ChangeMasterPasswordStepNeeded.ERROR,value:100});let r=Error(`[ChangeMP] ${t}: ${e}`);return(0,n.sendExceptionLog)({error:r}),{success:!1,error:{code:e}}}},73952:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.makeUnexpectedErrorObject=void 0;let a=r(20648),o=r(80896);t.makeUnexpectedErrorObject=(e,t)=>{let r=Error(`[ChangeMP] - Unexpected - ${t}: ${e}`);return(0,o.sendExceptionLog)({error:r}),{success:!1,error:{code:a.ChangeMasterPasswordCode.UNKNOWN_ERROR,message:e}}}},7454:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.preValidationForChangeMP=t.extractCurrentPassword=void 0;let a=r(20648),o=r(73302),n=r(63860),i=r(30103),s=r(93748),c=r(7108),l=r(66416),u=r(51700),d=r(49087),p=r(12418);t.extractCurrentPassword=(e,t)=>t.flow===a.ChangeMPFlowPath.ADMIN_ASSISTED_RECOVERY?(0,c.recoveryDataSelector)(e).currentPassword:t.currentPassword;let S=async(e,t)=>{let{applicationModulesAccess:r,masterPasswordEncryptorService:c,storeService:S}=e,{newPassword:g,flow:m}=t;if(!await (0,n.waitUntilSyncComplete)(S))return(0,u.makeReturnErrorObject)(a.ChangeMasterPasswordCode.SYNC_PROGRESS,m);let y=S.getState(),f=await (0,l.makeFeatureFlipsSelectors)(r).featureFlipsSelector();if(!S.getAccountInfo().isAuthenticated)return(0,u.makeReturnErrorObject)(a.ChangeMasterPasswordCode.INNACTIVE_SESSION,m);if(f[o.CHANGEMP_WEB_BLOCKED_FEATURE_FLIP])return(0,u.makeReturnErrorObject)(a.ChangeMasterPasswordCode.FEATURE_BLOCKED,m);let E=await (0,i.evaluatePasswordStrengthOutOfFive)(g);if(!g||!E||E<p.minAcceptablePasswordStrength)return(0,u.makeReturnErrorObject)(a.ChangeMasterPasswordCode.MP_STRENGTH_ERROR,m);let A=(0,s.isRemoteKeyActivatedSelector)(y),{authTicket:h,date:_}=(0,s.authTicketInfoSelector)(y);if(!(0,s.userLoginSelector)(y))return(0,u.makeReturnErrorObject)(a.ChangeMasterPasswordCode.UNEXPECTED_STATE,m);switch(t.flow){case a.ChangeMPFlowPath.MP_TO_SSO:if(!h||!_||Date.now()-_>9e5)return(0,u.makeReturnErrorObject)(a.ChangeMasterPasswordCode.INVALID_TOKEN,m);if(A)return(0,u.makeReturnErrorObject)(a.ChangeMasterPasswordCode.UNEXPECTED_STATE,m);break;case a.ChangeMPFlowPath.SSO_TO_MP:if(!h||!_||Date.now()-_>9e5)return(0,u.makeReturnErrorObject)(a.ChangeMasterPasswordCode.INVALID_TOKEN,m);if(!A)return(0,u.makeReturnErrorObject)(a.ChangeMasterPasswordCode.UNEXPECTED_STATE,m);break;case a.ChangeMPFlowPath.ADMIN_ASSISTED_RECOVERY:break;case a.ChangeMPFlowPath.TO_EMAIL_TOKEN:case a.ChangeMPFlowPath.USER_CHANGING_MP:case a.ChangeMPFlowPath.ACCOUNT_RECOVERY_KEY:{let{currentPassword:e}=t;if(m!==a.ChangeMPFlowPath.ACCOUNT_RECOVERY_KEY&&e===g)return(0,u.makeReturnErrorObject)(a.ChangeMasterPasswordCode.MP_ERROR,m);if(!await (0,d.validateMasterPassword)(S,c,e))return(0,u.makeReturnErrorObject)(a.ChangeMasterPasswordCode.WRONG_PASSWORD,m)}break;default:return(0,u.makeReturnErrorObject)(a.ChangeMasterPasswordCode.UNEXPECTED_STATE,m)}return{success:!0}};t.preValidationForChangeMP=S},6958:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.resetMigrationState=void 0;let a=r(20648),o=r(72375),n=r(76380),i=async(e,t)=>{if(t===a.ChangeMPFlowPath.USER_CHANGING_MP||t===a.ChangeMPFlowPath.TO_EMAIL_TOKEN||t===a.ChangeMPFlowPath.ACCOUNT_RECOVERY_KEY)return;let{storeService:r}=e;r.dispatch((0,o.resetRecoverySessionData)()),r.dispatch((0,n.resetSSOSettings)()),t===a.ChangeMPFlowPath.MP_TO_SSO&&r.dispatch((0,n.storeSSOSettings)({ssoUser:!0}))};t.resetMigrationState=i},47607:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.returnProperCryptoConfig=void 0;let a=r(34978),o=r(92180),n=r(76369);t.returnProperCryptoConfig=e=>{let t=a.ARGON2_DEFAULT_PAYLOAD,r=(0,n.currentSpaceInfoSelector)(e.getState());r?.cryptoForcedPayload&&(t=r.cryptoForcedPayload);try{return(0,o.parsePayload)(t).cryptoConfig}catch(e){return(0,o.makeFlexibleMarkerCryptoConfig)("argon2d")}}},50959:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.returnProperSettingContent=void 0;let a=r(34978),o=r(93308),n=r(13206),i=r(76369);t.returnProperSettingContent=(e,t,r)=>{let s=a.ARGON2_DEFAULT_PAYLOAD,c=(0,i.currentSpaceInfoSelector)(e.getState());return c?.cryptoForcedPayload&&(s=c.cryptoForcedPayload),{...(0,n.makeBasePersonalSettings)(),...t.content,CryptoUserPayload:s,CryptoFixedSalt:(0,o.bufferToBase64)(r.forceSalt)}}},12784:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.revertOnError=void 0;let a=r(34056),o=r(49789),n=async(e,t,r)=>{let{currentPassword:n,serverKey:i}=r,{storeService:s}=e;t.setInstance({raw:n},i),s.dispatch((0,o.updateMasterPassword)(n)),s.dispatch((0,o.updateServerKey)(i)),s.dispatch((0,a.changeMPDone)())};t.revertOnError=n},73302:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.CHANGEMP_WEB_BLOCKED_FEATURE_FLIP=void 0,t.CHANGEMP_WEB_BLOCKED_FEATURE_FLIP="disableChangeMpOnWeb"},60595:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.subscribeToDebugEvents=void 0;let a=r(22560),o=e=>(t,r)=>{let{message:a,details:o={}}=r;t[e]({date:new Date().toJSON(),message:a,optionalParams:Object.keys(o).reduce((e,t)=>[...e,o[t]],[])})},n=e=>{switch(e){case a.LogLevel.Error:return o("error");case a.LogLevel.Warn:return o("warning");case a.LogLevel.Info:return o("info");case a.LogLevel.Debug:case a.LogLevel.Verbose:default:return o("log")}};t.subscribeToDebugEvents=function(e){(0,a.redirectConsoleLogs)(t=>{let{level:r=a.LogLevel.Debug}=t;n(r)(e,t)})}},3055:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.carbonE2EConnector=void 0;let a=r(12791);t.carbonE2EConnector={registerFreeTrial:(0,a.slot)(),getTeamTokens:(0,a.slot)(),confirmFreeTrial:(0,a.slot)(),getPremiumStatus:(0,a.slot)(),proposeMembers:(0,a.slot)(),acceptTeamInvite:(0,a.slot)(),getTokenForTestUser:(0,a.slot)(),getServiceProviderToken:(0,a.slot)(),createOrUpdateDarkWebBreach:(0,a.slot)(),addPrivateBreach:(0,a.slot)(),createPublicBreach:(0,a.slot)(),forceBreachRefresh:(0,a.slot)(),getUserCryptoPayload:(0,a.slot)()}},3100:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.subscribeToE2EEvents=void 0;let a=r(86363),o=r(47674),n=r(47207),i=r(916),s=r(52013),c=r(28738);t.subscribeToE2EEvents=function(e,t){let r=(0,o.getCoreServices)(t),l=(0,a.makeTeamAdminController)(r.storeService,r.wsService);e.registerFreeTrial.on(l.registerFreeTrial),e.getTeamTokens.on(l.getTeamTokens),e.confirmFreeTrial.on(l.confirmFreeTrial),e.getPremiumStatus.on(l.getPremiumStatus),e.proposeMembers.on(l.proposeMembers),e.acceptTeamInvite.on(l.acceptTeamInvite),e.getTokenForTestUser.on(e=>(0,n.getTokenForKwUser)(r,e)),e.getServiceProviderToken.on(e=>(0,i.getServiceProviderToken)(r,e)),e.createOrUpdateDarkWebBreach.on(e=>(0,c.createOrUpdateDarkWebBreachHelper)(r,e)),e.addPrivateBreach.on(e=>(0,c.addPrivateBreachHelper)(r,e)),e.createPublicBreach.on(e=>(0,c.createPublicBreachHelper)(r,e)),e.forceBreachRefresh.on(()=>{(0,s.forceBreachRefreshHandler)(r)}),e.getUserCryptoPayload.on(()=>r.storeService.getPersonalSettings().CryptoUserPayload)}},50880:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.subscribeToE2EEvents=t.carbonE2EConnector=void 0;var a=r(3055);Object.defineProperty(t,"carbonE2EConnector",{enumerable:!0,get:function(){return a.carbonE2EConnector}});var o=r(3100);Object.defineProperty(t,"subscribeToE2EEvents",{enumerable:!0,get:function(){return o.subscribeToE2EEvents}})},25047:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.setEventBus=void 0;let r=null;t.setEventBus=e=>{r=e},t.default=function(){return r}},75169:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.setEventBus=void 0;let r=null;t.setEventBus=e=>{r=e},t.default=function(){return r}},3996:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.subscribeToMaverickEvents=void 0;let a=r(34682),o=r(47674),n=r(60686),i=r(75169);t.subscribeToMaverickEvents=function(e,t){(0,i.setEventBus)(e);let r=(0,o.getCoreServices)(t),s=(0,a.makeDataManagementController)(r);e.savePersonalDataItem.on(e=>{s.savePersonalDataItem(e)}),e.filledDataItem.on(e=>s.updateMetadataItemFilledOnPage(e.id,e.url,e.dataType)),e.updateWebOnboardingMode.on(e=>(0,n.updateWebOnboardingMode)(r.storeService,r.sessionService,e))}},16436:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.setEventBus=void 0;let r=null;t.setEventBus=e=>{r=e},t.default=function(){return r}},37265:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.subscribeToExtensionEvents=void 0;let a=r(15535),o=r(27762),n=r(80896),i=r(60686),s=r(4455),c=r(47674),l=r(6956),u=r(72287),d=r(16436);t.subscribeToExtensionEvents=function(e,t){(0,d.setEventBus)(e);let r=(0,c.getCoreServices)(t),{storeService:p,storageService:S}=r,g=(0,u.makeLoginController)(r),m=(0,l.makeSessionController)(r);e.getAccountInfo.on(()=>m.getAndTriggerRefreshAccountInfo()),e.getLocalAccountsList.on(()=>(0,o.getLocalAccounts)(p,S).then(e=>({localAccounts:e}))),e.getAnonymousLogsMetadata.on(()=>({anonymouscomputerid:(0,a.getCommonAppSetting)("anonymousComputerId")})),e.askWebsiteInfo.on(({fullUrl:e})=>m.askWebsiteInfo(e)),e.checkIfMasterPasswordIsValid.on(e=>m.validateMasterPassword(e.masterPassword).then(e=>({isMasterPasswordValid:e}))),e.closeSession.on(()=>m.closeSession()),e.lockSession.on(()=>m.lockSession()),e.openSession.on(({login:e,password:t})=>g.openSession(e,{password:t})),e.openSessionWithToken.on(({login:e,password:t,token:r,persistData:a,deviceName:o})=>{g.openSessionWithToken(e,t,r,a?s.PersistData.PERSIST_DATA_YES:s.PersistData.PERSIST_DATA_NO,o)}),e.openSessionWithDashlaneAuthenticator.on(({login:e,password:t,persistData:r,deviceName:a})=>{g.openSessionWithDashlaneAuthenticator(e,t,r?s.PersistData.PERSIST_DATA_YES:s.PersistData.PERSIST_DATA_NO,a)}),e.cancelDashlaneAuthenticatorRegistration.on(()=>{g.cancelDashlaneAuthenticatorRegistration()}),e.openSessionResendToken.on(e=>{g.openSessionResendToken(e.login)}),e.openSessionWithOTP.on(e=>{g.openSessionWithOTP(e.login,e.password,e.otp)}),e.openSessionWithOTPForNewDevice.on(({login:e,password:t,otp:r,persistData:a,deviceName:o})=>{g.openSessionWithOTPForNewDevice(e,t,r,a?s.PersistData.PERSIST_DATA_YES:s.PersistData.PERSIST_DATA_NO,o)}),e.sessionForceSync.on(e=>{m.sessionForceSync(e.trigger)}),e.updateWebOnboardingMode.on(e=>{i.updateWebOnboardingMode(r.storeService,r.sessionService,e)}),e.exceptionLog.on(e=>(0,n.sendTypedExceptionLog)("extensionException",e))}},7254:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.subscribeToLeelooEvents=void 0;let a=r(97880),o=r(80896),n=r(4455),i=r(27762),s=r(47674),c=r(6956),l=r(60686),u=r(72287),d=r(12589),p=r(86363),S=r(37238),g=r(66879),m=r(19997),y=r(34682),f=r(25047);t.subscribeToLeelooEvents=function(e,t){(0,f.setEventBus)(e);let r=(0,s.getCoreServices)(t),{storeService:E,localStorageService:A,wsService:h,sessionService:_,storageService:T}=r,v=(0,a.makeAccountCreationController)(r),I=(0,c.makeSessionController)(r),D=(0,u.makeLoginController)(r),P=(0,y.makeDataManagementController)(r),O=(0,d.makeRecoveryController)(E,h),C=(0,m.makeSettingsController)(E,h),b=(0,p.makeTeamAdminController)(E,h),R=(0,g.makeSharingService)(E,h),N=(0,S.makeDirectorySyncController)({storeService:E,localStorageService:A,wsService:h,sessionService:_,sharingService:R});e.getUki.on(()=>I.getUki()),e.savePaymentCard.on(e=>{P.savePaymentCardFromClient(e)}),e.savePersonalDataItem.on(e=>P.savePersonalDataItem(e)),e.getAccountInfo.on(()=>I.getAndTriggerRefreshAccountInfo()),e.getLocalAccountsList.on(()=>(0,i.getLocalAccounts)(E,T).then(e=>({localAccounts:e}))),e.cancelPremiumSubscription.on(()=>I.cancelPremiumSubscription()),e.getInvoices.on(()=>I.getInvoices().then(e=>({invoices:e}))),e.closeSession.on(()=>I.closeSession()),e.lockSession.on(()=>I.lockSession()),e.resumeSession.on(()=>I.resumeSession()),e.getPersonalSettings.on(()=>I.getPersonalSettings().then(e=>e)),e.openSession.on(({login:e,password:t})=>D.openSession(e,{password:t})),e.openSessionWithToken.on(({login:e,password:t,token:r,persistData:a,deviceName:o})=>{D.openSessionWithToken(e,t,r,a?n.PersistData.PERSIST_DATA_YES:n.PersistData.PERSIST_DATA_NO,o)}),e.openSessionWithDashlaneAuthenticator.on(({login:e,password:t,persistData:r,deviceName:a})=>{D.openSessionWithDashlaneAuthenticator(e,t,r?n.PersistData.PERSIST_DATA_YES:n.PersistData.PERSIST_DATA_NO,a)}),e.cancelDashlaneAuthenticatorRegistration.on(()=>{D.cancelDashlaneAuthenticatorRegistration()}),e.openSessionResendToken.on(e=>{D.openSessionResendToken(e.login)}),e.openSessionWithOTP.on(e=>{D.openSessionWithOTP(e.login,e.password,e.otp,void 0,e.withBackupCode)}),e.openSessionWithOTPForNewDevice.on(({login:e,password:t,otp:r,persistData:a,deviceName:o,withBackupCode:i})=>{D.openSessionWithOTPForNewDevice(e,t,r,a?n.PersistData.PERSIST_DATA_YES:n.PersistData.PERSIST_DATA_NO,o,i)}),e.sessionForceSync.on(e=>I.sessionForceSync(e.trigger)),e.exceptionLog.on(e=>(0,o.sendTypedExceptionLog)("leelooException",e)),e.teamUpdated.on(e=>b.teamUpdateHandler(e).then(e=>({errors:e}))),e.createUserGroup.on(e=>b.createUserGroupAction(_,e)),e.deleteUserGroup.on(e=>b.deleteUserGroupAction(e)),e.renameUserGroup.on(e=>b.renameUserGroupAction(e)),e.inviteUserGroupMembers.on(e=>b.inviteUserGroupMembersAction(e)),e.revokeUserGroupMembers.on(e=>b.revokeUserGroupMembersAction(e)),e.updateUserGroupMembers.on(e=>b.updateUserGroupMembersAction(e)),e.createAccountStep1.on(e=>v.createAccount(e)),e.createAccountStep2.on(e=>v.confirmAccountCreation(e)),e.checkLogin.on(e=>v.checkLogin(e)),e.getMasterPasswordResetDemandList.on(e=>O.getMasterPasswordResetDemandList(e)),e.acceptMasterPasswordResetDemand.on(e=>O.acceptMasterPasswordResetDemand(e)),e.checkIfMasterPasswordIsValid.on(e=>I.validateMasterPassword(e.masterPassword).then(e=>({isMasterPasswordValid:e}))),e.declineMasterPasswordResetDemand.on(e=>O.declineMasterPasswordResetDemand(e)),e.getMembers.on(e=>b.getMembers(e)),e.addTeamAdmin.on(e=>b.addTeamAdmin(e)),e.removeTeamAdmin.on(e=>b.removeTeamAdmin(e)),e.setTeamSettings.on(e=>C.setTeamSettings(e)),e.updateWebOnboardingMode.on(e=>l.updateWebOnboardingMode(E,_,e)),e.checkDirectorySyncKeyResponse.on(e=>{let{teamId:t,publicKey:r,requestId:a,response:o}=e;"validated"===o?N.keyValidatedByTacAdmin(t,r):"rejected"===o&&N.keyRejectedByTacAdmin(t,a)})}},1080:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.config=void 0;let a=r(68449),o=r(94413);t.config={commands:{changeUserCrypto:{handler:o.changeUserCrypto}},queries:{getCanUserChangeCrypto:{selector:a.canUserSelectCryptoSelector},getUserDerivationMethod:{selector:a.userDerivationMethodSelector}},liveQueries:{liveUserDerivationMethod:{operator:a.userDerivationMethodSelector$}}}},93111:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.bootstrap=void 0;let a=r(1080);t.bootstrap=e=>{e.register(a.config)}},87376:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.bootstrap=void 0;var a=r(93111);Object.defineProperty(t,"bootstrap",{enumerable:!0,get:function(){return a.bootstrap}})},68449:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.userDerivationMethodSelector$=t.userDerivationMethodSelector=t.canUserSelectCryptoSelector=t.teamCryptoForcedPayloadSelector=void 0;let a=r(95121),o=r(15237),n=r(20648),i=r(48434),s=r(92180),c=r(93748);t.teamCryptoForcedPayloadSelector=e=>{let t=(0,i.activeSpacesSelector)(e)[0];return t?.details.info.cryptoForcedPayload??""},t.canUserSelectCryptoSelector=e=>!(0,t.teamCryptoForcedPayloadSelector)(e),t.userDerivationMethodSelector=e=>{switch((0,c.userDefaultCryptoSelector)(e)){case s.ARGON2_DEFAULT_PAYLOAD:return n.SupportedDerivationMethods.ARGON2D;case s.PBKDF2_DEFAULT_PAYLOAD:return n.SupportedDerivationMethods.PBKDF2;case s.KWC3_DEFAULT_PAYLOAD:return n.SupportedDerivationMethods.KWC3;default:return null}},t.userDerivationMethodSelector$=()=>(0,a.pipe)((0,o.map)(t.userDerivationMethodSelector),(0,o.distinctUntilChanged)())},94413:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.changeUserCrypto=void 0;let a=r(83533),o=r(59447),n=r(23927);async function i(e,{newDerivationMethod:t}){let{storeService:r}=e,i=r.getPersonalSettings().CryptoUserPayload,s=(0,n.getNewCryptoPayload)(t);if(!s)throw Error(`[changeUserCrypto] - client sent wrong derivation value (${t})`);return await (0,o.migrateUserCrypto)(e,i,s,a.CryptoMigrationType.SettingsChange)}t.changeUserCrypto=i},95984:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.decryptAllTransactions=void 0;let a=r(1520),o=r(40257);async function n(e,t,r){let{announce:n}=r.getInstance().user.getSyncArgs(),i=e.map(async e=>({...e,content:await (0,a.decryptTransactionContent)(t.getInstance(),n,e).catch(t=>{if(e.type!==o.TransactionType.SETTINGS)return"";throw t})}));return(await Promise.all(i)).filter(e=>!!e.content)}t.decryptAllTransactions=n},32326:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.decryptAllUserData=void 0;let a=r(51700),o=r(95984);async function n(e,t,r,{transactions:n,sharingKeys:i}){try{let s=await (0,o.decryptAllTransactions)(n,r,e),c=await (0,a.decipherPrivateKey)(t,r,i);return{clearTransactions:s,clearPrivateKey:c}}catch(e){throw Error(`decipherAllUserData failed with error: ${e}`)}}t.decryptAllUserData=n},6441:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.getDataToMigrate=void 0;let a=r(83533),o=r(28323),n=r(93748);async function i(e,t){try{let t=e.getState(),r=(0,n.userLoginSelector)(t),a=await (0,o.getDataForMasterPasswordChange)(e,r,{});if((0,o.isApiError)(a))throw Error(`getDataDoMigrate failed with error: ${a}`);return{transactions:a.data.transactions,sharingKeys:a.data.sharingKeys,timestamp:a.timestamp}}catch(e){throw t(a.CryptoMigrationStatus.ErrorDownload),Error(`getDataDoMigrate failed with error: ${e}`)}}t.getDataToMigrate=i},23927:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.getNewCryptoPayload=void 0;let a=r(20648),o=r(92180);t.getNewCryptoPayload=function(e){switch(e){case a.SupportedDerivationMethods.ARGON2D:return o.ARGON2_DEFAULT_PAYLOAD;case a.SupportedDerivationMethods.PBKDF2:return o.PBKDF2_DEFAULT_PAYLOAD;case a.SupportedDerivationMethods.KWC3:return o.KWC3_DEFAULT_PAYLOAD;default:return}}},26301:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.reEncryptAllUserData=void 0;let a=r(83533),o=r(51700),n=r(1520);async function i(e,{clearTransactions:t,clearPrivateKey:r},i){try{let a=t.map(t=>(0,n.encryptSingleTransaction)(e,t)),i=await Promise.all(a),s=await (0,o.cipherPrivateKey)(e,r);return{encryptedTransactions:i,encryptedPrivateKey:s}}catch(e){throw i(a.CryptoMigrationStatus.ErrorReencryption),Error(`reEncryptAllUserData failed with error: ${e}`)}}t.reEncryptAllUserData=i},59476:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.resetMasterPasswordEncryptorService=void 0;let a=r(92180),o=r(93748);t.resetMasterPasswordEncryptorService=function(e,t){let{storeService:r,masterPasswordEncryptorService:n}=e,i=r.getState(),s=(0,o.masterPasswordSelector)(i),c=(0,o.serverKeySelector)(i),l=t===a.KWC3_DEFAULT_PAYLOAD?(0,a.getLegacyCryptoConfig)(t):(0,a.parsePayload)(t).cryptoConfig;n.setInstance({raw:s},c,l)}},67854:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.updateAndPersistLocalData=void 0;let a=r(83533),o=r(93308),n=r(60355),i=r(33170);async function s(e,t,r,s,c){try{e.dispatch((0,i.editPersonalSettings)({CryptoUserPayload:s,CryptoFixedSalt:(0,o.bufferToBase64)((0,n.getRandomValues)(16))})),await t.getInstance().user.persistPersonalSettings();let a=await r.getInstance().getLocalKey();await t.getInstance().user.persistLocalKey(a)}catch(e){throw c(a.CryptoMigrationStatus.ErrorUpdateLocalData),Error(`updateAndPersistLocalData failed with error: ${e}`)}}t.updateAndPersistLocalData=s},56527:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.uploadDataOnServer=void 0;let a=r(83533),o=r(51700),n=r(28323),i=r(44370),s=r(93748);async function c(e,t,r){try{let r=e.getState(),a=(0,s.userLoginSelector)(r),c={...t,transactions:(0,o.formatTransaction)(t.transactions)},l=await (0,i.uploadDataForCryptoChange)(e,a,c);if((0,n.isApiError)(l))throw Error(`uploadDataForCryptoChange failed with error: ${l}`)}catch(e){throw r(a.CryptoMigrationStatus.ErrorUpload),Error(`uploadDataForCryptoChange failed with error: ${e}`)}}t.uploadDataOnServer=c},59447:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.migrateUserCrypto=void 0;let a=r(83533),o=r(20648),n=r(92180),i=r(80896),s=r(63860),c=r(32326),l=r(6441),u=r(26301),d=r(59476),p=r(67854),S=r(56527),g={[n.KWC3_DEFAULT_PAYLOAD]:a.CryptoAlgorithm.Kwc3,[n.ARGON2_DEFAULT_PAYLOAD]:a.CryptoAlgorithm.Argon2d,[n.PBKDF2_DEFAULT_PAYLOAD]:a.CryptoAlgorithm.Pbkdf2};async function m(e,t,r,n){try{let{sessionService:i,storeService:m,masterPasswordEncryptorService:y,localStorageService:f,eventLoggerService:E}=e;if(!await (0,s.waitUntilSyncComplete)(m))return{success:!1,error:{code:o.CryptoMigrationApiErrorType.ChangeUserCryptoFailed}};let A=e=>E.logEvent(new a.UserMigrateCryptoEvent({newCrypto:g[r],previousCrypto:g[t],type:n,status:e})),{transactions:h,sharingKeys:_,timestamp:T}=await (0,l.getDataToMigrate)(m,A),{clearTransactions:v,clearPrivateKey:I}=await (0,c.decryptAllUserData)(i,m,y,{transactions:h,sharingKeys:_});(0,d.resetMasterPasswordEncryptorService)(e,r);let{encryptedTransactions:D,encryptedPrivateKey:P}=await (0,u.reEncryptAllUserData)(y,{clearTransactions:v,clearPrivateKey:I},A);return await (0,S.uploadDataOnServer)(m,{timestamp:T,transactions:D,sharingKeys:{publicKey:_.publicKey,privateKey:P}},A),await (0,p.updateAndPersistLocalData)(m,i,f,r,A),await i.getInstance().user.attemptSync(a.Trigger.SettingsChange),A(a.CryptoMigrationStatus.Success),{success:!0}}catch(r){return(0,d.resetMasterPasswordEncryptorService)(e,t),(0,i.sendExceptionLog)({funcName:"migrateUserCrypto",fileName:"/carbon/src/CryptoMigration/services/migrate-user-crypto.ts",message:`Migration from KWC3 to Argon2 failed with error: ${r}`}),{success:!1,error:{code:o.CryptoMigrationApiErrorType.ChangeUserCryptoFailed,message:r.message}}}}t.migrateUserCrypto=m},33990:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.setupSubscriptions=void 0;let a=r(59447),o=r(83533),n=r(68449),i=r(92180),s=r(93748);t.setupSubscriptions=function(e,t){e.carbonSessionOpened.on(()=>{let{storeService:e}=t,r=e.getState(),c=(0,n.teamCryptoForcedPayloadSelector)(r),l=(0,s.userDefaultCryptoSelector)(r);if(!c&&l===i.KWC3_DEFAULT_PAYLOAD){(0,a.migrateUserCrypto)(t,i.KWC3_DEFAULT_PAYLOAD,i.ARGON2_DEFAULT_PAYLOAD,o.CryptoMigrationType.MigrateLegacy);return}if(c&&c!==l){(0,a.migrateUserCrypto)(t,l,c,o.CryptoMigrationType.TeamEnforced);return}})}},79725:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.config=void 0;let a=r(36071),o=r(67199);t.config={commands:{getDarkWebInsightsReportResults:{handler:a.getDarkWebInsightsReportResults},getDarkWebInsightsSummary:{handler:o.getDarkWebInsightsSummary}},queries:{},liveQueries:{}}},87767:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.bootstrap=void 0;let a=r(79725);t.bootstrap=e=>{e.register(a.config)}},18219:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.bootstrap=void 0;var a=r(87767);Object.defineProperty(t,"bootstrap",{enumerable:!0,get:function(){return a.bootstrap}})},36071:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.getDarkWebInsightsReportResults=void 0;let a=r(20648),o=r(93748),n=r(28323),i=r(48142);async function s(e,t){let{storeService:r}=e,s=r.getState(),c=(0,o.userLoginSelector)(s),l=await (0,i.getDarkWebInsightReport)(r,c,t);return(0,n.isApiError)(l)?{success:!1,error:{code:a.DarkWebInsightsApiErrorType.GetDarkWebInsightsFailed,message:`get Dark Web Insights Report failed: ${l.message}`}}:{success:!0,data:l}}t.getDarkWebInsightsReportResults=s},67199:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.getDarkWebInsightsSummary=void 0;let a=r(20648),o=r(93748),n=r(28323),i=r(51413);async function s(e){let{storeService:t}=e,r=t.getState(),s=(0,o.userLoginSelector)(r),c=await (0,i.getDarkWebInsightsSummaryRequest)(t,s);return(0,n.isApiError)(c)?{success:!1,error:{code:a.DarkWebInsightsApiErrorType.GetDarkWebInsightsSummaryFailed,message:`get Dark Web Insights Summary failed: ${c.message}`}}:{success:!0,data:c}}t.getDarkWebInsightsSummary=s},19986:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.isCredentialSmartCategorized=t.isSpaceQuarantined=void 0;let a=r(12857),o=r(32107);t.isSpaceQuarantined=function(e){return!!e&&"accepted"!==e.details.status.toLowerCase()&&!!e.details.info&&!!e.details.info.forcedDomainsEnabled&&!!e.details.info.removeForcedContentEnabled},t.isCredentialSmartCategorized=function(e,t){if(!e)return!1;let r="";if(e.Url){let t=new a.ParsedURL(e.Url).getRootDomain();r=t?t.toLowerCase():""}let n=e.Email?e.Email.toLowerCase():"",i=e.Login?e.Login.toLowerCase():"",s=e.SecondaryLogin?e.SecondaryLogin.toLowerCase():"",c=(0,o.getUserAddedLinkedWebsiteDomains)(e).map(e=>e.toLowerCase());return t.filter(e=>{let t=e.toLowerCase();return r.includes(t)||n.includes(t)||i.includes(t)||s.includes(t)||c.some(e=>e.includes(t))}).length>0}},68849:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.config=void 0;let a=r(82276),o=r(39483),n=r(67431),i=r(34622),s=r(52237),c=r(32952),l=r(69472),u=r(2725),d=r(47847),p=r(56042),S=r(42107),g=r(91095),m=r(9509),y=r(27052),f=r(52339),E=r(32826),A=r(86200);t.config={commands:{...A.vaultConfig.commands,...a.config.commands,...o.config.commands,...n.config.commands,...i.config.commands,...p.config.commands,...s.config.commands,...S.config.commands,...c.config.commands,...E.importApiConfig.commands,...l.config.commands,...u.config.commands,...g.config.commands,...m.config.commands,...d.config.commands,...f.config.commands},queries:{...A.vaultConfig.queries,...a.config.queries,...n.config.queries,...p.config.queries,...S.config.queries,...E.importApiConfig.queries,...l.config.queries,...g.config.queries,...m.config.queries,...y.config.queries},liveQueries:{...a.config.liveQueries,...n.config.liveQueries,...S.config.liveQueries,...E.importApiConfig.liveQueries,...l.config.liveQueries,...g.config.liveQueries,...m.config.liveQueries}}},13760:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.getNewBankAccount=t.defaultToUS=t.defaultToEmptyString=void 0;let a=r(25903),o=r(19298),n=r(67179),i=r(61681);t.defaultToEmptyString=(0,a.defaultTo)(""),t.defaultToUS=(0,a.defaultTo)(o.Country.US),t.getNewBankAccount=e=>{let r=(0,n.getUnixTimestamp)();return{kwType:"KWBankStatement",Id:(0,i.generateItemUuid)(),LastBackupTime:0,LocaleFormat:(0,t.defaultToUS)(e.country),SpaceId:(0,t.defaultToEmptyString)(e.spaceId),CreationDatetime:r,UserModificationDatetime:r,BankAccountName:(0,t.defaultToEmptyString)(e.name),BankAccountOwner:(0,t.defaultToEmptyString)(e.owner),BankAccountIBAN:(0,t.defaultToEmptyString)(e.IBAN),BankAccountBIC:(0,t.defaultToEmptyString)(e.BIC),BankAccountBank:(0,t.defaultToEmptyString)(e.bank)}}},1043:function(e,t,r){var a=this&&this.__createBinding||(Object.create?function(e,t,r,a){void 0===a&&(a=r);var o=Object.getOwnPropertyDescriptor(t,r);(!o||("get"in o?!t.__esModule:o.writable||o.configurable))&&(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,a,o)}:function(e,t,r,a){void 0===a&&(a=r),e[a]=t[r]}),o=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||a(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),o(r(13760),t)},65726:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.makeBankAccountSpecificProps=t.makeNewBankAccount=t.makeUpdatedBankAccount=void 0;let a=r(25903),o=r(67179),n=r(54286);async function i(e,t,r){let a=(0,n.makeUpdatedPersonalDataItemBase)({platformInfo:e,existingItem:r,updatedItem:t,itemUpdateDate:(0,o.getUnixTimestamp)()});return{...r,...a,...c(t.content)}}async function s(e,t){return{...(0,n.makeNewPersonalDataItemBase)(e,t),...c(t.content)}}function c(e){let t=(0,a.defaultTo)("");return{BankAccountName:t(e.name),BankAccountOwner:t(e.owner),BankAccountIBAN:t(e.IBAN),BankAccountBIC:t(e.BIC),BankAccountBank:t(e.bank)}}t.makeUpdatedBankAccount=i,t.makeNewBankAccount=s,t.makeBankAccountSpecificProps=c},53383:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.getBankAccountMappers=void 0;let a=r(15074);t.getBankAccountMappers=()=>({spaceId:e=>e.SpaceId,accountName:e=>e.BankAccountName,bankName:e=>e.BankAccountBank,lastUse:a.lastUseMapper,id:e=>e.Id})},82858:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.bankAccountMatch=t.searchGetters=void 0;let a=r(23674),o=r(92595);t.searchGetters=[(0,o.stringProp)("BankAccountName"),(0,o.stringProp)("BankAccountOwner"),(0,o.stringProp)("BankAccountBank")],t.bankAccountMatch=(0,a.match)(t.searchGetters)},1586:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.queryBankAccountsSelector=t.bankAccountSelector=t.bankAccountsSelector=void 0;let a=r(82858),o=r(7299),n=r(24445),i=r(49548),s=r(53383),c=r(49705),l=r(38728);t.bankAccountsSelector=(0,i.createSelector)(e=>e.userSession.personalData.bankAccounts,c.quarantinedSpacesSelector,l.filterOutQuarantinedItems),t.bankAccountSelector=(e,r)=>{let a=(0,t.bankAccountsSelector)(e);return(0,n.findDataModelObject)(r,a)},t.queryBankAccountsSelector=(0,o.getQuerySelector)(t.bankAccountsSelector,()=>a.bankAccountMatch,e=>(0,s.getBankAccountMappers)())},82276:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.config=void 0;let a=r(54938),o=r(1277),n=r(55719);t.config={commands:{updateBreachStatus:{handler:n.updateBreachStatusHandler}},queries:{getBreaches:{selector:a.viewedQueriedBreachesSelector},getBreachesPage:{selector:a.breachesPageSelector},getBreachesPaginationToken:{selector:a.breachesPaginationTokenSelector}},liveQueries:{liveBreaches:{operator:o.breaches$},liveBreachesBatch:{operator:o.breachesBatch$}}}},5485:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.clearInstance=t.getInstance=void 0;let a=r(20648),o=r(80896),n=r(27762),i=r(93748),s=r(66416),c=r(33230),l=r(96802),u=r(20959),d=r(51693),p=r(93625),S=r(31571),g=r(54938);class m{constructor(e,t,r,a,o){this.storeService=e,this.applicationModulesAccess=t,this.credentialVault=r,this.breachVault=a,this.gateway=o,this.refreshInProgress=!1}async refresh(e){try{if(this.refreshInProgress)return{vaultSyncNeeded:!1};this.refreshInProgress=!0,this.storeService.dispatch((0,p.updateBreachesUpdaterStatus)(a.BreachesUpdaterStatus.SYNCING));let t=!!(e&&e.forceRefresh);if(!await this.isFeatureFlipped()||!this.isSessionOpened()||!this.isRefreshNeeded(t))return this.storeService.dispatch((0,p.updateBreachesUpdaterStatus)(a.BreachesUpdaterStatus.SKIPPED)),this.refreshInProgress=!1,{vaultSyncNeeded:!1};let{breachVault:r,credentialVault:o}=this,n=await this.fetchLatestPublicBreaches(),i=await this.fetchLatestPrivateBreaches();this.resetTimer();let s=o.getAllCredentials(),l=r.getAllBreaches(),u=[...n.breaches,...i.breaches],d=(0,c.getChangesFromIncomingBreaches)(s,l,u);await r.applyChangesFromSync(d,n.revision,i.refreshDate);let S=this.isVaultSyncNeeded(d);return this.storeService.dispatch((0,p.updateBreachesUpdaterStatus)(S?a.BreachesUpdaterStatus.UPDATED:a.BreachesUpdaterStatus.UNCHANGED)),{vaultSyncNeeded:S}}catch(t){this.storeService.dispatch((0,p.updateBreachesUpdaterStatus)(a.BreachesUpdaterStatus.ERROR));let e=Error(`[Breaches] - refresh: ${t}`);return(0,o.sendExceptionLog)({error:e,code:a.ExceptionCriticality.WARNING}),{vaultSyncNeeded:!1}}finally{this.refreshInProgress=!1}}async isFeatureFlipped(){let{applicationModulesAccess:e}=this,t=await (0,s.makeFeatureFlipsSelectors)(e).featureFlipsSelector();return!!t&&t[m.BREACHES_REFRESH_FEATURE_FLIP]}isSessionOpened(){let{storeService:e}=this,t=e.getState(),r=(0,i.userLoginSelector)(t);return!!((0,n.ukiSelector)(t)&&r)}isRefreshNeeded(e){let t=this.storeService.getState(),r=(0,g.lastBreachRefreshTimestampSelector)(t);return e||Date.now()-r>=m.BREACHES_REFRESH_INTERVAL_MS}resetTimer(){this.storeService.dispatch((0,S.updateBreachRefreshTimestamp)(Date.now()))}isVaultSyncNeeded(e){return e.updates.length+e.deletions.length>0}async fetchLatestPublicBreaches(){let e=this.breachVault.getLatestPublicBreachesRevision();return this.gateway.getLatestPublicBreaches(e)}async fetchLatestPrivateBreaches(){let e;let t=this.breachVault.getPrivateBreachesRefreshDate(),r=[];try{let a=await this.gateway.getLatestPrivateBreaches(t);a&&(r=a.breaches,e=a.refreshDate)}catch(t){let e=Error(`[Breaches] - refresh: fetchPrivateBreaches error: ${t}`);(0,o.sendExceptionLog)({error:e,code:a.ExceptionCriticality.WARNING})}return{breaches:r,refreshDate:e}}}m.BREACHES_REFRESH_INTERVAL_MS=864e5,m.BREACHES_REFRESH_FEATURE_FLIP="breachesFetchWeb";let y=null;t.getInstance=(e,t,r)=>(null===y&&(y=new m(t,e,new u.CredentialVault(t),new l.BreachVault(t),new d.BreachesWS(r,t))),y),t.clearInstance=()=>{y=null}},33230:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.getChangesFromIncomingBreaches=void 0;let a=r(20648),o=r(36049),n=r(832),i=r(26530),s=r(20791),c=r(30272),l=e=>({updates:[],deletions:[e.Id]}),u=e=>({updates:[e],deletions:[]}),d=()=>({updates:[],deletions:[]}),p=(e,t)=>({updates:[...e.updates,...t.updates],deletions:[...e.deletions,...t.deletions]}),S=(e,t,r)=>{let a=f(e.LeakedPasswords||[]),o=f([...e.LeakedPasswords,...r]),i=a.length!==o.length?n.BreachStatus.PENDING:e.Status;return{...e,Content:t,ContentRevision:t.lastModificationRevision,LeakedPasswords:o,Status:i}},g=(e,t)=>(t.content.domains??[]).reduce((t,r)=>[...t,...e.get(r)??[]],[]),m=e=>t=>1e3*(t.ModificationDatetime||t.CreationDatetime||0)<Date.parse(e),y=e=>!!e.Password,f=e=>Array.from(new Set(e)),E=(e,t)=>{let{content:r}=e,{leakedPasswords:o}=e,n=(0,c.hasBreachLeakedDataOfType)(r,a.BreachLeakedDataType.Password),i=o;if(n){let{eventDate:e}=r;i=[...o,...t.filter(m(e)).filter(y).map(e=>e.Password)]}return f(i||[])},A=(e,t,r)=>{let a=!(0,i.isDataLeaksBreachContent)(e),o=r.length>0,n=(0,c.hasBreachLeakedPrivateInfo)(e),s=t.length>0;return a&&!o&&(!n||!s)},h=function(e,t,r){let{content:a}=r,{id:o,lastModificationRevision:n}=a,i=(0,c.findByBreachId)(o,t);if(i){if(n<=i.ContentRevision)return d();if((0,c.isBreachDeleted)(a))return l(i)}let p=g(e,r),m=E(r,p);return A(a,p,m)?d():i?u(S(i,a,m)):u((0,s.makeBreachFromContent)(a,m))};t.getChangesFromIncomingBreaches=function(e,t,r){let a=new Map;return e.forEach(e=>{let t=(0,o.getDomainForCredential)(e)||"",r=a.get(t)??[];a.set(t,[...r,e])}),r.reduce((e,r)=>p(e,h(a,t,r)),{updates:[],deletions:[]})}},20791:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.makeBreachFromContent=void 0;let a=r(20648),o=r(61681),n=r(832);t.makeBreachFromContent=(e,t)=>({kwType:a.DataModelType.KWSecurityBreach,LastBackupTime:0,Id:(0,o.generateItemUuid)(),BreachId:e.id,Content:e,ContentRevision:e.lastModificationRevision,Status:n.BreachStatus.PENDING,LeakedPasswords:t})},55719:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.updateBreachStatus=t.updateBreachStatusHandler=void 0;let a=r(83533),o=r(92830),n=r(17620),i=r(80896),s=r(22560),c=r(54938);async function l(e,t){let{storeService:r,sessionService:o}=e;try{return u(r,t),(0,n.getDebounceSync)(r,o)({immediateCall:!0},a.Trigger.Save),{success:!0}}catch(e){return s.Debugger.error(e),(0,i.sendExceptionLog)({error:e}),{success:!1}}}function u(e,t){if(!e.isAuthenticated())throw Error("No session available to update Breach");let r=e.getState(),a=(0,c.breachSelector)(r,t.id);if(!a)throw Error("Breach does not exist, cant update");let n={...a,Status:t.status};e.dispatch((0,o.savePersonalDataItem)(n,n.kwType))}t.updateBreachStatusHandler=l,t.updateBreachStatus=u},51693:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.BreachesWS=void 0;let a=r(25903),o=r(74907),n=r(20648),i=r(92146),s=r(67972),c=r(86324),l=r(25434),u=r(93308),d=r(5552),p=r(80896),S=r(93748),g=r(27762),m=r(96523),y=r(26530),f=r(30272),E=r(96523),A=r(34978);t.BreachesWS=class{constructor(e,t){this.wsService=e,this.storeService=t}async getLatestPublicBreaches(e){let t=this.storeService.getState(),r=(0,S.userLoginSelector)(t),a=(0,g.ukiSelector)(t);if(null===r||null===a)throw Error("[Breaches] - getLatestPublicBreaches: no current authenticated user");let o=await this.wsService.breaches.get({login:r,uki:a,revision:e});if(!(0,d.isWSResponseSuccess)(o))throw Error(`[Breaches] getLatestPublicBreaches: ${o.message}(statusCode: ${o.code})`);let{content:n}=o,{latest:i,filesToDownload:s,revision:c}=n,l=[...i,...await this.downloadFileBreaches(s)].filter(y.isSupportedBreachContent);return{revision:c,breaches:(0,f.deduplicateBreachContents)(l).map(e=>(0,E.makeIncomingBreach)(e,[]))}}async getLatestPrivateBreaches(e){let t=this.storeService.getState(),r=(0,S.premiumStatusSelector)(t);if(!(0,m.hasDarkWebMonitoringFeature)(r))return null;let a=(0,S.userLoginSelector)(t),o=(0,g.ukiSelector)(t);if(null===a||null===o)throw Error("[Breaches] - getLatestPrivateBreaches: no current authenticated user");let n=await this.wsService.dataleaks.leaks({login:a,uki:o,wantsDetails:!0,includeDisabled:!1,lastUpdateDate:e});if(!(0,d.isWSResponseSuccess)(n)){if((0,E.isBreachesWSResponseNotModified)(n))return{breaches:[],refreshDate:e};let t=n.error&&n.error.code?`, code: ${n.error.code}`:"";throw Error(`[Breaches] - getLatestPrivateBreaches: ${n.message} (statusCode: ${n.code}${t})`)}let{content:i}=n,{details:s,leaks:c,lastUpdateDate:l}=i,u=await this.extractLeakedPasswords(s),p=c.filter(y.isSupportedBreachContent);return{breaches:(0,f.deduplicateBreachContents)(p).map(e=>(0,E.makeIncomingBreach)(e,u[e.id]||[])),refreshDate:l}}async downloadFileBreaches(e){return(0,a.flatten)(await (0,i.asyncMap)(e,this.downloadFileBreach))}async downloadFileBreach(e){try{let{data:t}=await (0,o.get)(e);return t.breaches}catch(t){let e=Error(`[Breaches] - downloadFileBreach: ${t}`);return(0,p.sendExceptionLog)({error:e,code:n.ExceptionCriticality.ERROR}),[]}}async extractLeakedPasswords(e){try{if(!e||!e.cipheredKey||!e.cipheredInfo)return{};let t=this.storeService.getState(),r=(0,S.sharingKeysSelector)(t);if(!r||!r.publicKey||!r.privateKey)return{};let{privateKey:a}=r,o=(0,s.makeAsymmetricEncryption)({hashAlgorithm:c.HashAlgorithm.SHA_1}),n=await o.decrypt(a,e.cipheredKey),i=(0,l.makeDataEncryptorService)(this.storeService),d=(0,u.base64ToBuffer)(n),p=(0,u.arrayBufferToText)(d);i.setInstance({raw:p},"");let g=await i.getInstance().decrypt(e.cipheredInfo),m=(0,A.deflatedUtf8ToUtf16)(g,{skipInflate:!0}),y=JSON.parse(m);return(0,E.getLeakedPasswordFromIncomingDataLeakDetails)(y)}catch(t){let e=Error(`[Breaches] - extractLeakedPasswords: ${t}`);return(0,p.sendExceptionLog)({error:e}),{}}}}},23160:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.isIncomingDataLeakPasswordInfo=t.isIncomingDataLeakBreachDetails=void 0;let a=r(25903);t.isIncomingDataLeakBreachDetails=e=>(0,a.is)(Object,e)&&"string"==typeof e.breachId&&""!==e.breachId&&Array.isArray(e.data),t.isIncomingDataLeakPasswordInfo=e=>(0,a.is)(Object,e)&&"password"===e.type&&"plaintext"===e.hashMethod&&"string"==typeof e.value&&""!==e.value},96523:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.hasDarkWebMonitoringFeature=t.isBreachesWSResponseNotModified=t.getLeakedPasswordFromIncomingDataLeakDetails=t.makeIncomingBreach=void 0;let a=r(23160);t.makeIncomingBreach=(e,t)=>({content:e,leakedPasswords:t}),t.getLeakedPasswordFromIncomingDataLeakDetails=e=>{if(!Array.isArray(e))return{};let t=e=>(0,a.isIncomingDataLeakPasswordInfo)(e)?e.value:null;return e.reduce((e,r)=>{if(!(0,a.isIncomingDataLeakBreachDetails)(r))return e;let{breachId:o,data:n}=r,i=n.map(t).filter(Boolean);return i.length?{...e,[o]:i}:e},{})},t.isBreachesWSResponseNotModified=e=>304===e.code,t.hasDarkWebMonitoringFeature=function(e){if(!e)return!1;let{capabilities:t}=e;return!!t?.dataLeak?.enabled}},96802:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.BreachVault=void 0;let a=r(93625),o=r(37313),n=r(98770),i=r(54938);t.BreachVault=class{constructor(e){this.storeService=e}async applyChangesFromSync(e,t,r){let i=(0,a.breachesUpdated)(e,t,r),s=null,{updates:c,deletions:l}=e,u=c.length+l.length,d=(0,o.getInstance)(),p=(0,n.getInstance)();try{u&&(s=p.lockTopic("iconsUpdates"),await d.add("iconsUpdates",{type:"breachUpdates",breachesIds:c.map(e=>e.Id)})),this.storeService.dispatch(i),u&&p.releaseTopic("iconsUpdates",s)}catch(e){throw s&&p.releaseTopic("iconsUpdates",s),e}}getAllBreaches(){let e=this.storeService.getState();return(0,i.breachesSelector)(e)}getLatestPublicBreachesRevision(){let e=this.storeService.getState();return(0,i.publicBreachesRevisionSelector)(e)}getPrivateBreachesRefreshDate(){let e=this.storeService.getState();return(0,i.privateBreachesLastUpdateTimestamp)(e)}}},20959:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.CredentialVault=void 0;let a=r(91966);t.CredentialVault=class{constructor(e){this.storeService=e}getAllCredentials(){let e=this.storeService.getState();return(0,a.credentialsSelector)(e)}}},21175:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.listView=t.itemView=t.detailItemView=void 0;let a=r(25903),o=r(98584),n=r(26530),i=r(40631),s=(0,a.defaultTo)([]);function c({name:e,domains:t}){if(e)return e;if(t.length>0){let[e]=t;return e}return""}function l(e,t){if(t&&0!==t.length)return(0,i.getIcon)(e)(t[0])}function u(e,t){let r=t.Content,a=(0,n.isDataLeaksBreach)(t)?t.Content.impactedEmails:[];return{domains:s(r.domains),breachType:(0,o.breachTypeMapper)(t),domainIcon:l(e,t.Content.domains),eventDate:r.eventDate,id:t.Id,impactedEmails:a,name:c(r),status:t.Status}}t.detailItemView=function(e,t){let r=t.Content,a=(0,n.isDataLeaksBreach)(t)?t.Content.impactedEmails:[],i=new Set;return{breachType:(0,o.breachTypeMapper)(t),domains:s(r.domains),domainIcon:l(e,t.Content.domains),eventDate:r.eventDate,id:t.Id,impactedEmails:a,kwType:t.kwType,leakedData:s(r.leakedData),leakedPasswords:s(t.LeakedPasswords),name:c(r),status:t.Status,compromisedCredentialIds:[...i]}},t.itemView=u,t.listView=function(e,t){return t.map(t=>u(e,t))}},30272:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.hasBreachLeakedPrivateInfo=t.hasBreachLeakedDataOfType=t.isBreachDeleted=t.findByBreachId=t.deduplicateBreachContents=void 0;let a=r(25903),o=r(20648),n=r(832),i=r(26530),s=(0,a.takeLast)(1);t.deduplicateBreachContents=(0,a.pipe)((0,a.groupBy)((0,a.prop)("id")),(0,a.mapObjIndexed)((0,a.sortBy)((0,a.prop)("lastModificationRevision"))),(0,a.mapObjIndexed)(e=>s(e)),a.values,a.flatten),t.findByBreachId=(e,t)=>t.find(t=>t.BreachId===e),t.isBreachDeleted=e=>e.status===n.BreachEnvStatus.Deleted,t.hasBreachLeakedDataOfType=(e,t)=>(e.leakedData||[]).findIndex(e=>t===e)>=0;let c=(e,t)=>(e.leakedData||[]).findIndex(e=>t.some(t=>t===e))>=0;t.hasBreachLeakedPrivateInfo=e=>(0,i.isDataLeaksBreachContent)(e)||c(e,[o.BreachLeakedDataType.Email,o.BreachLeakedDataType.Username,o.BreachLeakedDataType.CreditCard,o.BreachLeakedDataType.Phone,o.BreachLeakedDataType.Address,o.BreachLeakedDataType.SSN,o.BreachLeakedDataType.IP,o.BreachLeakedDataType.Location,o.BreachLeakedDataType.PersonalInfo,o.BreachLeakedDataType.SocialNetwork])},26530:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.isPublicBreach=t.isDataLeaksBreach=t.isDataLeaksBreachContent=t.isBreach=t.isSupportedBreach=t.isSupportedBreachContent=void 0;let a=r(25903),o=e=>(0,a.is)(Object,e);function n(e){return o(e)&&"number"==typeof e.breachModelVersion&&1===e.breachModelVersion&&Array.isArray(e.domains)&&"string"==typeof e.eventDate&&"string"==typeof e.id}function i(e){return s(e)&&n(e.Content)}function s(e){return!!e&&"KWSecurityBreach"===e.kwType}function c(e){return"impactedEmails"in e&&Array.isArray(e.impactedEmails)&&e.impactedEmails.length>0}t.isSupportedBreachContent=n,t.isSupportedBreach=i,t.isBreach=s,t.isDataLeaksBreachContent=c,t.isDataLeaksBreach=e=>i(e)&&c(e.Content),t.isPublicBreach=e=>i(e)&&!c(e.Content)},1277:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.getBreach$=t.breaches$=t.breachesBatch$=void 0;let a=r(95121),o=r(15237),n=r(27011),i=r(92594),s=r(63890),c=r(54938);t.breachesBatch$=e=>{let t=(0,n.parseToken)(e),r=(0,c.getViewedBreachesBatchSelector)(t);return(0,a.pipe)((0,o.map)(r),(0,o.distinctUntilChanged)(i.sameBatch))},t.breaches$=(0,s.getLivePersonalInfo)(c.getLiveBreachesSelector),t.getBreach$=function(e){let t=(0,c.getViewedBreachSelector)(e);return(0,a.pipe)((0,o.map)(t),(0,o.distinctUntilChanged)())}},98584:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.getBreachMappers=t.breachTypeMapper=void 0;let a=r(26530);function o(e){return(0,a.isDataLeaksBreach)(e)?"private":"public"}t.breachTypeMapper=o,t.getBreachMappers=()=>({breachType:e=>o(e),eventDate:e=>(function({eventDate:e}){return Date.parse(e)})(e.Content),id:e=>e.Id,status:e=>e.Status})},50932:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.getBreachesBatch=t.viewBreachesBatch=t.getBreachesFirstToken=t.getBreacheSortToken=t.getBreachesFilterToken=void 0;let a=r(25903),o=r(22300),n=r(21175);t.getBreachesFilterToken=({filterCriteria:e})=>({filterCriteria:e||[]}),t.getBreacheSortToken=({sortCriteria:e})=>({uniqField:"id",sortCriteria:e||[]}),t.getBreachesFirstToken=(e,t,r,a)=>(0,o.generateFirstToken)(e,t,r.initialBatchSize||30,a),t.viewBreachesBatch=(e,t)=>(0,n.listView)(e,t),t.getBreachesBatch=(0,a.curry)((e,t,r)=>(0,o.getBatch)(r,e,t))},81768:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.breachMatch=t.searchGetters=void 0;let a=r(23674);t.searchGetters=[],t.breachMatch=(0,a.match)(t.searchGetters)},54938:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.lastBreachRefreshTimestampSelector=t.getViewedBreachSelector=t.getViewedBreachesBatchSelector=t.getLiveBreachesSelector=t.fieldMappersSelector=t.breachesQuerySelector=t.breachesPaginationTokenSelector=t.breachesPageSelector=t.viewedQueriedBreachesSelector=t.breachMappersSelector=t.breachSelector=t.privateBreachesLastUpdateTimestamp=t.publicBreachesRevisionSelector=t.breachesSelector=void 0;let a=r(95121),o=r(49548),n=r(26530),i=r(24445),s=r(99040),c=r(7299),l=r(27011),u=r(22300),d=r(67803),p=r(21175),S=r(98584),g=r(81768),m=r(50932),y=r(24432),f=(0,o.createSelector)(e=>e.userSession.personalData.securityBreaches,e=>e.filter(n.isSupportedBreach));t.breachesSelector=(0,o.createSelector)(f,e=>[...e.reduce((e,t)=>{let r=e.get(t.BreachId);return(!r||r.LastBackupTime<t.LastBackupTime)&&e.set(t.BreachId,t),e},new Map).values()]),t.publicBreachesRevisionSelector=e=>e.userSession.personalData.securityBreachesMetadata.latestPublicBreachesRevision,t.privateBreachesLastUpdateTimestamp=e=>e.userSession.personalData.securityBreachesMetadata.latestDataLeaksBreachesUpdate,t.breachSelector=function(e,r){let a=(0,t.breachesSelector)(e);return(0,i.findDataModelObject)(r,a)},t.breachMappersSelector=e=>(0,S.getBreachMappers)();let E=()=>g.breachMatch,A=(0,c.getQuerySelector)(t.breachesSelector,E,t.breachMappersSelector),h=(0,o.createSelector)(y.iconsSelector,e=>t=>(0,m.viewBreachesBatch)(e,t));t.viewedQueriedBreachesSelector=(e,t)=>{let r=A(e,t),a=h(e);return(0,s.viewListResults)(a)(r)},t.breachesPageSelector=function(e,r){let a=(0,l.parseToken)(r),{sortToken:o,filterToken:n}=a,i=(0,S.getBreachMappers)(),s=(0,t.breachesQuerySelector)(e,{sortToken:o,filterToken:n}),c=h(e),d=(0,u.generateNextToken)(i,a,s),p=(0,u.generatePrevToken)(i,a,s),g=(0,u.getBatch)(i,a,s),m=(0,l.stringifyToken)(d),y=(0,l.stringifyToken)(p);return{batch:c(g),nextToken:m,prevToken:y}},t.breachesPaginationTokenSelector=(e,r)=>{let a=(0,m.getBreacheSortToken)(r),o=(0,m.getBreachesFilterToken)(r),n=(0,S.getBreachMappers)(),i={sortToken:a,filterToken:o},s=(0,t.breachesQuerySelector)(e,i),c=(0,m.getBreachesFirstToken)(n,i,r,s);return(0,l.stringifyToken)(c)};let _=(0,l.createOptimizedSortTokenSelector)((e,{sortToken:t})=>t,a.identity),T=(0,l.createOptimizedFilterTokenSelector)((e,{filterToken:t})=>t,a.identity);t.breachesQuerySelector=(0,o.createSelector)(S.getBreachMappers,E,_,T,t.breachesSelector,l.queryData),t.fieldMappersSelector=(0,o.createSelector)(t.breachesSelector,S.getBreachMappers),t.getLiveBreachesSelector=(0,d.makeLiveSelectorGetter)(t.breachesSelector,h,E,t.breachMappersSelector),t.getViewedBreachesBatchSelector=e=>{let{sortToken:r,filterToken:a}=e,n={sortToken:r,filterToken:a},i=(0,m.getBreachesBatch)(e),s=(0,o.createSelector)(e=>(0,t.breachesQuerySelector)(e,n),t.fieldMappersSelector,i),c=(0,l.optimizeBatchSelector)(s);return(0,o.createSelector)(y.iconsSelector,c,m.viewBreachesBatch)},t.getViewedBreachSelector=function(e){let r=(0,o.createSelector)(t.breachesSelector,t=>(0,i.findDataModelObject)(e,t));return(0,o.createSelector)(y.iconsSelector,r,p.detailItemView)},t.lastBreachRefreshTimestampSelector=e=>e.userSession.breachRefreshMetaData.lastBreachRefreshTimestamp},65666:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.setupSubscriptions=void 0;let a=r(5485);t.setupSubscriptions=function(e,t){let{applicationModulesAccess:r,storeService:o,wsService:n}=t;e.syncSuccess.on(()=>{(0,a.getInstance)(r,o,n).refresh({forceRefresh:!1})})}},832:function(e,t){var r,a,o;Object.defineProperty(t,"__esModule",{value:!0}),t.BreachCriticality=t.BreachEnvStatus=t.BreachStatus=void 0,(r=t.BreachStatus||(t.BreachStatus={})).PENDING="PENDING",r.VIEWED="VIEWED",r.ACKNOWLEDGED="ACKNOWLEDGED",(a=t.BreachEnvStatus||(t.BreachEnvStatus={})).Legacy="legacy",a.Live="live",a.Staging="staging",a.Deleted="deleted",(o=t.BreachCriticality||(t.BreachCriticality={}))[o.Info=1]="Info",o[o.Warning=2]="Warning",o[o.Error=3]="Error"},10515:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.getCurrentData=t.getChangeSet=t.getChangedProperties=t.getChangedPropertiesForRemoval=void 0;let a=r(25903),o=r(61681),n=r(67179),i={KWAuthentifiant:{Email:"",Login:"",Note:"",Password:"",SecondaryLogin:"",Title:"",Url:"",UserSelectedUrl:"",LinkedServices:{associated_domains:[]}},KWSecureNote:{Content:"",Title:""},KWSecret:{Content:"",Title:""}};function s(e){let t=i[e.kwType];return Object.keys(t).filter(r=>"LinkedServices"===r?e[r]?.associated_domains&&e[r].associated_domains.length>0:e[r]&&e[r]!==t[r])}t.getChangedPropertiesForRemoval=s;let c=(e,t)=>e.length===t.length&&e.sort().join("")===t.sort().join("");function l(e,t){return Object.keys(i[e.kwType]).filter(r=>"LinkedServices"===r?!c((e[r]?.associated_domains??[]).map(e=>e.domain),(t[r]?.associated_domains??[]).map(e=>e.domain)):e[r]&&""!==e[r]&&e[r]!==t[r])}function u(e){return Object.keys(i[e.kwType]).reduce((t,r)=>("LinkedServices"===r?t[r]=e[r]?.associated_domains?e[r]:{associated_domains:[]}:t[r]=e[r]||"",t),{})}t.getChangedProperties=l,t.getChangeSet=function(e){let{change:t,deviceName:r,oldItem:i,userLogin:c,platformInfo:d}=e;if((0,a.isNil)(i))return null;let p="removal"===t.type?s(i):l(i,t.updatedItem);return 0===p.length?null:{kwType:"KWChangeSet",ChangedProperties:p,CurrentData:u(i),Id:(0,o.generateItemUuid)(),Platform:d.platformName,DeviceName:r||"",ModificationDate:(0,n.getUnixTimestamp)(),Removed:(0,a.defaultTo)(!1,"removal"===t.type),User:c}},t.getCurrentData=u},45657:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.makeRemovalChange=t.makeUpdateChange=void 0,t.makeUpdateChange=e=>({type:"update",updatedItem:e}),t.makeRemovalChange=e=>({type:"removal",itemId:e.Id,itemKwType:e.kwType})},3313:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.getUpdatedItemChangeHistory=t.isChangeHistoryCandidate=t.getEmptyChangeHistory=void 0;let a=r(25903),o=r(20648),n=r(61681),i=r(10515),s=r(40257),c=r(24445);function l(e){let[t,r,a]="removal"===e.type?[e.itemId,e.itemKwType,""]:[e.updatedItem.Id,e.updatedItem.kwType,e.updatedItem.Title||""];return{kwType:"KWDataChangeHistory",ChangeSets:[],Id:(0,n.generateItemUuid)(),ObjectId:t,ObjectTitle:a,ObjectType:(0,s.getTransactionTypeFromDataModelType)(r),LastBackupTime:0}}t.getEmptyChangeHistory=l;let u=(e,t)=>(0,a.equals)(t.CurrentData,e.CurrentData);t.isChangeHistoryCandidate=function(e){return(0,o.isCredential)(e)||(0,o.isNote)(e)||(0,o.isSecret)(e)},t.getUpdatedItemChangeHistory=function(e){let{deviceName:t,personalData:r,change:n,userLogin:s,platformInfo:d}=e,[p,S,g]="removal"===n.type?[n.itemId,n.itemKwType,""]:[n.updatedItem.Id,n.updatedItem.kwType,n.updatedItem.Title],m=o.DATAMODELOBJECT_TYPE_TO_CARBON_STORE_KEY[S],y=(0,c.findDataModelObject)(p,r[m]),f=(0,i.getChangeSet)({deviceName:t,change:n,oldItem:y,userLogin:s,platformInfo:d});if(!f)return null;let E=r.changeHistories.find(e=>e?.ObjectId?.toUpperCase()===(p||"").toUpperCase())||l(n),A=E?.ChangeSets??[],h=(0,a.last)(A);return h&&u(h,f)?null:{...E,ObjectTitle:g,ChangeSets:A.concat(f)}}},39483:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.config=void 0;let a=r(11668);t.config={commands:{addCollection:{handler:a.addCollectionHandler},deleteCollection:{handler:a.deleteCollectionHandler},removeItemsFromCollections:{handler:a.removeItemsFromCollectionsHandler},updateCollection:{handler:a.updateCollectionHandler}},queries:{},liveQueries:{}}},65622:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.addCollectionHandler=t.getNewCollection=void 0;let a=r(20648),o=r(83533),n=r(17620),i=r(92830),s=r(67179),c=r(61681),l=r(80896),u=r(4803);function d(e){let t=(0,s.getUnixTimestamp)();return{kwType:"KWCollection",Id:(0,c.generateItemUuid)(),LastBackupTime:0,LastUse:t,LocaleFormat:a.Country.UNIVERSAL,SpaceId:e.spaceId,CreationDatetime:t,UserModificationDatetime:t,Name:e.name,VaultItems:e.vaultItems.map(e=>({Id:e.id,Type:e.type}))}}async function p({storeService:e,sessionService:t},r){if(!e.isAuthenticated())throw Error("No session available to addCollection");let a=d((0,u.sanitizeInputPersonalData)(r));if(!a.SpaceId){let t=await (0,n.getDefaultSpaceId)(e);a.SpaceId=t}return e.dispatch((0,i.savePersonalDataItem)(a,a.kwType)),t.getInstance().user.persistPersonalData(),a.Id}async function S(e,t){try{let r=await p(e,t);return(0,n.getDebounceSync)(e.storeService,e.sessionService)({immediateCall:!0},o.Trigger.Save),{success:!0,id:r}}catch(e){return(0,l.sendExceptionLog)({error:e}),{success:!1}}}t.getNewCollection=d,t.addCollectionHandler=S},23111:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.deleteCollectionHandler=void 0;let a=r(20648),o=r(83533),n=r(17620),i=r(80896),s=r(93625);async function c({storeService:e,sessionService:t},r){if(!e.isAuthenticated())throw Error("No session available to deleteCollection");let o=(0,s.removePersonalItem)(a.DataModelType.KWCollection,r,null);e.dispatch(o),t.getInstance().user.persistPersonalData()}async function l(e,t){try{return await c(e,t.id),(0,n.getDebounceSync)(e.storeService,e.sessionService)({immediateCall:!0},o.Trigger.Save),{success:!0}}catch(e){return(0,i.sendExceptionLog)({error:e}),{success:!1}}}t.deleteCollectionHandler=l},11668:function(e,t,r){var a=this&&this.__createBinding||(Object.create?function(e,t,r,a){void 0===a&&(a=r);var o=Object.getOwnPropertyDescriptor(t,r);(!o||("get"in o?!t.__esModule:o.writable||o.configurable))&&(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,a,o)}:function(e,t,r,a){void 0===a&&(a=r),e[a]=t[r]}),o=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||a(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),o(r(65622),t),o(r(23111),t),o(r(11028),t),o(r(99383),t)},11028:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.removeItemsFromCollectionsHandler=void 0;let a=r(2676),o=r(99383);async function n(e,t){let r;let n=e.storeService.getState(),i=(0,a.collectionsSelector)(n),s=[];if(i.forEach(e=>{r=e.VaultItems.length,e.VaultItems=e.VaultItems.filter(e=>!t.ids.includes(e.Id)),r!==e.VaultItems.length&&s.push(e)}),!s.length)return;let c=s.map(t=>(0,o.updateCollectionHandler)(e,{id:t.Id,name:t.Name,spaceId:t.SpaceId,vaultItems:t.VaultItems.map(e=>({id:e.Id,type:e.Type}))}));return{success:!(await Promise.all(c)).some(e=>!e.success)}}t.removeItemsFromCollectionsHandler=n},99383:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.updateCollectionHandler=void 0;let a=r(83533),o=r(17620),n=r(92830),i=r(67179),s=r(80896),c=r(4803),l=r(2676),u=e=>({LastUse:(0,i.getUnixTimestamp)(),Name:e.name,SpaceId:e.spaceId,VaultItems:e.vaultItems.map(e=>({Id:e.id,Type:e.type}))});async function d(e,t,r){if(!e.isAuthenticated())throw Error("No session available to updateCollection");let a=function(e,t){let r=(0,l.collectionSelector)(e,t.id);if(!r)throw Error("[updateCollection]: unable to find collection to update.");return{...r,...u(t)}}(e.getState(),(0,c.sanitizeInputPersonalData)(r));return e.dispatch((0,n.savePersonalDataItem)(a,a.kwType)),t.getInstance().user.persistPersonalData()}async function p(e,t){try{return await d(e.storeService,e.sessionService,t),(0,o.getDebounceSync)(e.storeService,e.sessionService)({immediateCall:!0},a.Trigger.Save),{success:!0}}catch(e){return(0,s.sendExceptionLog)({error:e}),{success:!1}}}t.updateCollectionHandler=p},34457:function(e,t,r){var a=this&&this.__createBinding||(Object.create?function(e,t,r,a){void 0===a&&(a=r);var o=Object.getOwnPropertyDescriptor(t,r);(!o||("get"in o?!t.__esModule:o.writable||o.configurable))&&(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,a,o)}:function(e,t,r,a){void 0===a&&(a=r),e[a]=t[r]}),o=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||a(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),o(r(11668),t),o(r(2676),t),o(r(71524),t)},2676:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.collectionSelector=t.collectionsSelector=void 0;let a=r(24445);t.collectionsSelector=e=>e.userSession.personalData.collections,t.collectionSelector=(e,r)=>{let o=(0,t.collectionsSelector)(e);return(0,a.findDataModelObject)(r,o)}},71524:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.getCollectionNamesContainingVaultItemId=void 0,t.getCollectionNamesContainingVaultItemId=(e,t,r=[])=>t.flatMap(t=>t.VaultItems.some(t=>t.Id===e)?t.Name:[]).concat(r.flatMap(t=>t.vaultItems.some(t=>t.id===e)?t.name:[]))},67431:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.config=void 0;let a=r(2666),o=r(18216),n=r(55518),i=r(32305),s=r(18990),c=r(93641),l=r(86735),u=r(242),d=r(16006);t.config={commands:{addCredential:{handler:u.createCredential},updateCredential:{handler:d.updateCredentialHandler}},queries:{getCredential:{selector:i.viewedCredentialSelector},getCredentials:{selector:s.viewedQueriedCredentialsSelector},getCredentialsByDomain:{selector:c.viewedQueriedCredentialsByDomainSelector},getCredentialsCount:{selector:a.credentialsCountSelector},getCredentialsPage:{selector:o.credentialsPageSelector},getCredentialsPaginationToken:{selector:n.credentialsPaginationTokenSelector}},liveQueries:{liveCredential:{operator:l.getCredential$},liveCredentials:{operator:l.credentials$},liveCredentialsByDomain:{operator:l.credentialsByDomain$},liveCredentialsBatch:{operator:l.credentialsBatch$},liveCredentialsCount:{operator:l.credentialsCount$}}}},13302:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.countCredentials=void 0;let a=r(27011);t.countCredentials=(e,t,r,o)=>(0,a.filterData)(e,t,r,o).length},36049:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.getDomainForCredential=void 0;let a=r(12857);t.getDomainForCredential=e=>new a.ParsedURL(e.Url).getRootDomain()},16006:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.updateCredentialHandler=void 0;let a=r(22560),o=r(80896),n=r(11369);async function i(e,t){let{storeService:r,sessionService:i,eventLoggerService:s,applicationModulesAccess:c}=e;try{return await (0,n.updateCredential)({storeService:r,sessionService:i,eventLoggerService:s,applicationModulesAccess:c},t),{success:!0}}catch(e){return(0,a.logError)(e),(0,o.sendExceptionLog)({error:e}),{success:!1}}}t.updateCredentialHandler=i},82242:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.getCredentialsDisplayTitles=void 0;let a=r(36049);t.getCredentialsDisplayTitles=function(e){return new Map(e.reduce((e,t)=>{let{Id:r,Title:o}=t,n=o||(0,a.getDomainForCredential)(t);return e.concat([[r,n]])},[]))}},3469:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.viewCredential=t.afterCredentialSaved=t.notifySharersCredentialUpdated=t.makeCredentialSpecificProps=t.makeNewCredential=t.makeUpdatedCredential=t.beforeCredentialChange=t.sharedFields=t.SaveFrom=void 0;let a=r(25903),o=r(49204),n=r(20648),i=r(12857),s=r(2901),c=r(74915),l=r(41954),u=r(92830),d=r(67179);t.SaveFrom=(0,o.Enum)("MANUAL","SAVE_PASSWORD","DATACAPTURE","IMPORT");let p=r(80896),S=r(54286),g=r(5053),m=r(26260),y=r(96538),f=r(18543),E=r(40631),A=r(20648);t.sharedFields=["Email","Login","Note","OtpSecret","OtpUrl","Password","SecondaryLogin","Title","Url","UseFixedUrl","UserSelectedUrl","LinkedServices"];let h=(e,t)=>({...e,content:{...e.content,category:t}}),_=(0,a.defaultTo)("");async function T(e,t,r){let a=(0,d.getUnixTimestamp)(),o=await I(t,r,a);return{...r,...(0,S.makeUpdatedPersonalDataItemBase)({platformInfo:e,existingItem:r,updatedItem:t,itemUpdateDate:a}),...o}}async function v(e,t){let r=(0,d.getUnixTimestamp)(),a=await I(t,null,r);return function(e){let{Title:t,Url:r}=e;return{...e,Title:t||_(new i.ParsedURL(r).getRootDomain())}}({...(0,S.makeNewPersonalDataItemBase)(e,t,r),...a})}async function I(e,t,r=(0,d.getUnixTimestamp)()){let{content:o}=e,i={associated_domains:o.linkedWebsites?.addedByUser?.map(e=>({source:A.LinkedWebsiteSource.Manual,domain:e}))??t?.LinkedServices?.associated_domains??[]},u=({itemField:e,existingItemField:r,defaultValue:n})=>(0,a.isNil)(o[e])?t&&!(0,a.isNil)(t[r])?t[r]:n:o[e],{email:p,login:S,secondaryLogin:g}=(0,l.normalizeUsernames)(u({itemField:"email",existingItemField:"Email",defaultValue:""}),u({itemField:"login",existingItemField:"Login",defaultValue:""}),u({itemField:"secondaryLogin",existingItemField:"SecondaryLogin",defaultValue:""})),m=u({itemField:"password",existingItemField:"Password",defaultValue:""}),y=!t||t.Password!==m;return{AutoLogin:u({itemField:"autoLogin",existingItemField:"AutoLogin",defaultValue:!0}),AutoProtected:u({itemField:"protectWithMasterPassword",existingItemField:"AutoProtected",defaultValue:!1}),Category:u({itemField:"category",existingItemField:"Category",defaultValue:""}),Checked:u({itemField:"checked",existingItemField:"Checked",defaultValue:!1}),Email:p,Login:S,Note:u({itemField:"note",existingItemField:"Note",defaultValue:""}),Password:m,SecondaryLogin:g,Status:"ACCOUNT_NOT_VERIFIED",Strength:m?await (0,s.evaluatePasswordStrength)(m):0,SubdomainOnly:u({itemField:"onlyForThisSubdomain",existingItemField:"SubdomainOnly",defaultValue:!1}),Title:u({itemField:"title",existingItemField:"Title",defaultValue:""}),...function(e,t){let{url:r}=e.content,a=void 0===r,o=t?.UserSelectedUrl??"",i=t?.UseFixedUrl??!1,s=t?.TrustedUrlGroup??[],l=e.origin===n.SaveOrigin.MANUAL,u=!a&&t?.Url!==r,d=(0,c.cleanUrlForPersonalData)(a?t?.Url:r,{keepQueryString:l}),p=l&&u?{UserSelectedUrl:d,UseFixedUrl:!0}:{UserSelectedUrl:o,UseFixedUrl:i};return{Url:d,TrustedUrlGroup:(0,c.getUpdatedTrustedUrlList)(s,d),...p}}(e,t),OtpSecret:u({itemField:"otpSecret",existingItemField:"OtpSecret",defaultValue:void 0}),OtpUrl:u({itemField:"otpUrl",existingItemField:"OtpUrl",defaultValue:void 0}),LinkedServices:i,...y?{ModificationDatetime:r}:{}}}async function D(e,r,o,n){if((0,a.equals)((0,a.pick)(t.sharedFields,r),(0,a.pick)(t.sharedFields,o)))return!0;try{return await (0,S.notifySharersOnUpdate)(e,o,n),!0}catch(t){let e=Error(`[Sharing] - Failed to update shared item: ${t}`);return(0,p.sendExceptionLog)({error:e}),!1}}t.beforeCredentialChange=function(e,t){let r=t.credentialCategories,a=e.content.category;if(!a||r.find(e=>e.Id===a))return e;let o=r.find(e=>e.CategoryName===a);return o?h(e,o.Id):h(e,"")},t.makeUpdatedCredential=T,t.makeNewCredential=v,t.makeCredentialSpecificProps=I,t.notifySharersCredentialUpdated=D,t.afterCredentialSaved=function(e,t){(0,g.associateGeneratedPasswordsToCredential)(e.getPersonalData().generatedPasswords,t).forEach(t=>{e.dispatch((0,u.saveGeneratedPassword)(t))})},t.viewCredential=function(e,t,r,a,o,n){if(!e)return;let i=(0,y.getSharingStatusDetail)(a,t,r),s=(0,E.getIcon)(o),c=(0,f.getSmartCategorizedSpace)(n);return(0,m.detailView)(i,s,c,e)}},86735:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.credentialsByDomain$=t.credentials$=t.credentialsCount$=t.getCredential$=t.credentialsBatch$=void 0;let a=r(95121),o=r(15237),n=r(2666),i=r(2708),s=r(95597),c=r(27372),l=r(49287),u=r(27011),d=r(92594),p=r(63890);t.credentialsBatch$=e=>{let t=(0,u.parseToken)(e),r=(0,c.getViewedCredentialsBatchSelector)(t);return(0,a.pipe)((0,o.map)(r),(0,o.distinctUntilChanged)(d.sameBatch))},t.getCredential$=e=>{let t=(0,s.getViewedCredentialSelector)(e);return(0,a.pipe)((0,o.map)(t),(0,o.distinctUntilChanged)())},t.credentialsCount$=e=>{let t=(0,u.parseToken)(e);return(0,a.pipe)((0,o.map)(e=>(0,n.credentialsCountSelector)(e,t)),(0,o.distinctUntilChanged)())},t.credentials$=(0,p.getLivePersonalInfo)(i.getLiveCredentialsSelector),t.credentialsByDomain$=e=>{let{domain:t,...r}=(0,u.parseToken)(e),n=(0,l.getLiveCredentialsByDomainSelector)(t)(r);return(0,a.pipe)((0,o.map)(n),(0,o.distinctUntilChanged)((e,t)=>e.matchingCount===t.matchingCount&&(0,d.sameBatch)(e.items,t.items)))}},35022:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.getCredentialMappers=void 0;let a=r(25903),o=r(15074),n=(0,a.curry)((e,t)=>e.get(t.Id)||""),i=e=>!!e.Attachments&&e.Attachments.length>0,s=(0,a.curry)((e,t)=>!!e[t.Id]);t.getCredentialMappers=(e,t)=>({hasAttachments:i,id:e=>e.Id,isLimited:s(e),lastUse:o.lastUseMapper,login:e=>e.Login,numberUse:e=>e.NumberUse,spaceId:e=>e.SpaceId,title:n(t),email:e=>e.Email})},21617:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.getCredentialsBatch=t.viewCredentialsBatch=t.getCredentialsFirstToken=t.getCredentialsSortToken=t.getCredentialsFilterToken=void 0;let a=r(25903),o=r(22300),n=r(89717),i=r(40631);t.getCredentialsFilterToken=({filterCriteria:e})=>({filterCriteria:e||[]}),t.getCredentialsSortToken=({sortCriteria:e})=>({uniqField:"id",sortCriteria:e||[]}),t.getCredentialsFirstToken=(e,t,r,a)=>(0,o.generateFirstToken)(e,t,r.initialBatchSize||30,a),t.viewCredentialsBatch=(e,t)=>{let r=(0,i.getIcon)(t);return(0,n.listView)(r,e)},t.getCredentialsBatch=(0,a.curry)((e,t,r)=>(0,o.getBatch)(r,e,t))},21064:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.credentialMatcher=void 0;let a=r(23674),o=r(92595),n=r(32107);t.credentialMatcher=(0,a.match)([(0,o.stringProp)("Email"),(0,o.stringProp)("Login"),(0,o.stringProp)("Title"),(0,o.stringProp)("Note"),(0,o.stringProp)("SecondaryLogin"),e=>(0,n.getDashlaneDefinedLinkedWebsites)(e.Url).join(" "),e=>(0,n.getUserAddedLinkedWebsitesRootDomains)(e).join(" ")])},12602:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.countAllCredentialsSelector=void 0,t.countAllCredentialsSelector=e=>e.userSession.personalData.credentials.length},13768:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.credentialSelector=void 0;let a=r(91966),o=r(24445);t.credentialSelector=(e,t)=>{let r=(0,a.credentialsSelector)(e);return(0,o.findDataModelObject)(t,r)}},11531:function(e,t,r){var a,o;Object.defineProperty(t,"__esModule",{value:!0}),t.getCredentialsByDomainSelector=t.getCredentialByDomainMatchType=t.DomainMatchType=void 0;let n=r(49548),i=r(12857),s=r(91966),c=r(32107);(o=a=t.DomainMatchType||(t.DomainMatchType={})).MainWebsite="MainWebsite",o.DashlaneDefinedLinkedWebsite="DashlaneDefinedLinkedWebsite",o.UserDefinedLinkedWebsite="UserDefinedLinkedWebsite",o.None="None",t.getCredentialByDomainMatchType=(e,t)=>e?e===new i.ParsedURL(t.Url).getRootDomain()?a.MainWebsite:(0,c.getDashlaneDefinedLinkedWebsites)(t.Url).includes(e)?a.DashlaneDefinedLinkedWebsite:(0,c.getUserAddedLinkedWebsitesRootDomains)(t).includes(e)?a.UserDefinedLinkedWebsite:a.None:a.None;let l=(e,r)=>e.filter(e=>{let o=(0,t.getCredentialByDomainMatchType)(r,e);return[a.MainWebsite,a.DashlaneDefinedLinkedWebsite,a.UserDefinedLinkedWebsite].includes(o)});t.getCredentialsByDomainSelector=e=>(0,n.createSelector)(s.credentialsSelector,t=>l(t,e))},2666:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.credentialsCountSelector=void 0;let a=r(49548),o=r(58157),n=r(91966),i=r(21064),s=r(13302),c=r(72778);t.credentialsCountSelector=(0,a.createSelector)([o.fieldMappersSelector,c.filterTokenSelector,n.credentialsSelector],(e,t,r)=>(0,s.countCredentials)(e,i.credentialMatcher,t,r))},87865:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.credentialDisplayTitlesSelector=void 0;let a=r(49548),o=r(91966),n=r(82242);t.credentialDisplayTitlesSelector=(0,a.createSelector)(o.credentialsSelector,n.getCredentialsDisplayTitles)},18216:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.credentialsPageSelector=void 0;let a=r(22300),o=r(27011),n=r(58157),i=r(18186),s=r(70786);t.credentialsPageSelector=(e,t)=>{let r=(0,o.parseToken)(t),{sortToken:c,filterToken:l}=r,u=(0,n.fieldMappersSelector)(e),d=(0,i.credentialsQuerySelector)(e,{sortToken:c,filterToken:l}),p=(0,s.listViewSelector)(e),S=(0,a.generateNextToken)(u,r,d),g=(0,a.generatePrevToken)(u,r,d),m=(0,a.getBatch)(u,r,d),y=(0,o.stringifyToken)(S),f=(0,o.stringifyToken)(g);return{batch:p(m),nextToken:y,prevToken:f}}},55518:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.credentialsPaginationTokenSelector=void 0;let a=r(21617),o=r(58157),n=r(18186),i=r(27011);t.credentialsPaginationTokenSelector=(e,t)=>{let r=(0,a.getCredentialsSortToken)(t),s=(0,a.getCredentialsFilterToken)(t),c=(0,o.fieldMappersSelector)(e),l={sortToken:r,filterToken:s},u=(0,n.credentialsQuerySelector)(e,l),d=(0,a.getCredentialsFirstToken)(c,l,t,u);return(0,i.stringifyToken)(d)}},18186:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.credentialsQuerySelector=void 0;let a=r(49548),o=r(58157),n=r(72778),i=r(31139),s=r(91966),c=r(21064),l=r(27011);t.credentialsQuerySelector=(0,a.createSelector)([o.fieldMappersSelector,i.sortTokenSelector,n.filterTokenSelector,s.credentialsSelector],(e,t,r,a)=>(0,l.queryData)(e,c.credentialMatcher,t,r,a))},91966:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.credentialsSelector=void 0;let a=r(49548),o=r(90410),n=r(86546),i=r(49705),s=r(38728),c=(0,a.createSelector)([e=>(0,n.hasCredentialsDedupViewSelector)(e)?(0,n.dedupedCredentialsSelector)(e):(0,o.unsafeAllCredentialsSelector)(e)],e=>e);t.credentialsSelector=(0,a.createSelector)(c,i.quarantinedSpacesSelector,s.filterOutQuarantinedItems)},86546:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.hasCredentialsDedupViewSelector=t.dedupedCredentialsSelector=void 0;let a=r(49548),o=r(8836),n=r(74061),i=r(90410),s={Alias:n.genericMerge,Attachments:n.concatMerge,AutoLogin:n.strictEqual,AutoProtected:n.boolEqual,Category:n.genericMerge,Checked:n.strictEqual,ConnectionOptions:n.genericMerge,CreationDatetime:n.minMerge,Email:n.strictEqual,LastUse:n.maxMerge,LinkedServices:n.strictEqual,Login:n.strictEqual,ModificationDatetime:n.maxMerge,Note:n.genericMerge,NumberUse:n.sumMerge,OtpSecret:n.strictEqual,OtpUrl:n.strictEqual,Password:n.strictEqual,Port:n.genericMerge,SID:n.genericMerge,SecondaryLogin:n.strictEqual,Server:n.genericMerge,SharedObject:n.strictEqual,SpaceId:n.strictEqual,Status:n.strictEqual,Strength:n.strictEqual,SubdomainOnly:n.boolEqual,Title:n.strictEqual,TrustedUrlGroup:n.concatMerge,Url:n.strictEqual,UseFixedUrl:n.strictEqual,UserModificationDatetime:n.maxMerge,UserSelectedUrl:n.strictEqual,kwType:n.strictEqual,limitedPermissions:n.strictEqual};t.dedupedCredentialsSelector=(0,a.createSelector)(i.unsafeAllCredentialsSelector,(0,o.dedupItems)(["Password","Title","Url"],s)),t.hasCredentialsDedupViewSelector=e=>e.userSession.credentialsDedupViewState.credentialsDedupView},58157:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.fieldMappersSelector=void 0;let a=r(49548),o=r(35022),n=r(87865),i=r(90456);t.fieldMappersSelector=(0,a.createSelector)(i.limitedSharingItemsSelector,n.credentialDisplayTitlesSelector,o.getCredentialMappers)},72778:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.filterTokenSelector=void 0;let a=r(25903),o=r(27011);t.filterTokenSelector=(0,o.createOptimizedFilterTokenSelector)((e,{filterToken:t})=>t,a.identity)},49287:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.getLiveCredentialsByDomainSelector=void 0;let a=r(67803),o=r(70786),n=r(58157),i=r(21064),s=r(11531);t.getLiveCredentialsByDomainSelector=e=>(0,a.makeLiveSelectorGetter)((0,s.getCredentialsByDomainSelector)(e),o.listViewSelector,()=>i.credentialMatcher,n.fieldMappersSelector)},2708:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.getLiveCredentialsSelector=void 0;let a=r(67803),o=r(91966),n=r(70786),i=r(58157),s=r(21064);t.getLiveCredentialsSelector=(0,a.makeLiveSelectorGetter)(o.credentialsSelector,n.listViewSelector,()=>s.credentialMatcher,i.fieldMappersSelector)},95597:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.getViewedCredentialSelector=void 0;let a=r(49548),o=r(53175),n=r(90456),i=r(91966),s=r(24432),c=r(93748),l=r(24445),u=r(48434),d=r(3469);t.getViewedCredentialSelector=e=>{let t=(0,a.createSelector)(i.credentialsSelector,t=>(0,l.findDataModelObject)(e,t));return(0,a.createSelector)(t,o.sharingDataSelector,c.userIdSelector,n.limitedSharingItemsSelector,s.iconsSelector,u.spacesSelector,d.viewCredential)}},27372:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.getViewedCredentialsBatchSelector=void 0;let a=r(49548),o=r(18186),n=r(58157),i=r(24432),s=r(21617),c=r(27011);t.getViewedCredentialsBatchSelector=e=>{let{sortToken:t,filterToken:r}=e,l={sortToken:t,filterToken:r},u=(0,s.getCredentialsBatch)(e),d=(0,a.createSelector)(e=>(0,o.credentialsQuerySelector)(e,l),n.fieldMappersSelector,u),p=(0,c.optimizeBatchSelector)(d);return(0,a.createSelector)(p,i.iconsSelector,s.viewCredentialsBatch)}},70786:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.listViewSelector=void 0;let a=r(49548),o=r(21617),n=r(24432);t.listViewSelector=(0,a.createSelector)(n.iconsSelector,e=>t=>(0,o.viewCredentialsBatch)(t,e))},83527:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.getQueryByDomainSelector=void 0;let a=r(7299),o=r(58157),n=r(21064),i=r(11531);t.getQueryByDomainSelector=e=>(0,a.getQuerySelector)((0,i.getCredentialsByDomainSelector)(e),()=>n.credentialMatcher,o.fieldMappersSelector)},92330:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.querySelector=void 0;let a=r(7299),o=r(91966),n=r(58157),i=r(21064);t.querySelector=(0,a.getQuerySelector)(o.credentialsSelector,()=>i.credentialMatcher,n.fieldMappersSelector)},31139:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.sortTokenSelector=void 0;let a=r(25903),o=r(27011);t.sortTokenSelector=(0,o.createOptimizedSortTokenSelector)((e,{sortToken:t})=>t,a.identity)},90410:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.unsafeAllCredentialsSelector=void 0,t.unsafeAllCredentialsSelector=e=>e.userSession.personalData.credentials},32305:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.viewedCredentialSelector=void 0;let a=r(3469),o=r(90456),n=r(53175),i=r(13768),s=r(93748),c=r(24432),l=r(48434);t.viewedCredentialSelector=(e,t)=>{let r=(0,i.credentialSelector)(e,t);if(!r)return;let u=(0,n.sharingDataSelector)(e),d=(0,s.userIdSelector)(e),p=(0,o.limitedSharingItemsSelector)(e),S=(0,c.iconsSelector)(e),g=(0,l.spacesSelector)(e);return(0,a.viewCredential)(r,u,d,p,S,g)}},93641:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.viewedQueriedCredentialsByDomainSelector=void 0;let a=r(83527),o=r(70786),n=r(99040);t.viewedQueriedCredentialsByDomainSelector=(e,t)=>{let{domain:r,...i}=t,s=(0,a.getQueryByDomainSelector)(r)(e,i),c=(0,o.listViewSelector)(e);return(0,n.viewListResults)(c)(s)}},18990:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.viewedQueriedCredentialsSelector=void 0;let a=r(99040),o=r(92330),n=r(70786);t.viewedQueriedCredentialsSelector=(e,t)=>{let r=(0,o.querySelector)(e,t),i=(0,n.listViewSelector)(e);return(0,a.viewListResults)(i)(r)}},242:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.createCredential=t.createBaseCredentialModel=void 0;let a=r(25903),o=r(12857),n=r(20648),i=r(41954),s=r(4803),c=r(2901),l=r(61681),u=r(67179),d=r(46592),p=r(61586),S=r(54286),g=r(17620);async function m({storeService:e,sessionService:r,eventLoggerService:l,applicationModulesAccess:u},m,y){if(!e.isAuthenticated())throw Error("No session available to updateCredential");let f=await (0,g.getDefaultSpaceId)(e),E=(0,p.getUrlFields)(m.url,!0),{email:A,login:h,secondaryLogin:_}=(0,i.normalizeUsernames)(m.email,m.login,m.secondaryLogin),T=e.getPlatformInfo(),v=(0,a.defaultTo)("",m.password),I=(0,a.defaultTo)(f,m.spaceId),D=v?await (0,c.evaluatePasswordStrength)(v):0,P=new o.ParsedURL(m.url).getRootDomain(),O=(0,s.sanitizeInputPersonalData)({...(0,t.createBaseCredentialModel)(n.Country[T.country]),AutoProtected:m.protectWithMasterPassword,Title:P,Email:A,Login:h,SubdomainOnly:m.onlyForThisSubdomain,SecondaryLogin:_,Password:v,Strength:D,Status:"ACCOUNT_NOT_VERIFIED",SpaceId:I,AutoLogin:m.autoLogin??!0,...E,...(y||(()=>({})))(m)});return(0,d.saveCredentialAsPersonalDataItem)({storeService:e,sessionService:r,eventLoggerService:l,applicationModulesAccess:u},O),u&&(0,S.shouldSendCreateOrModifiedCredentialActivityLog)(e,O)&&await (0,S.computeAndSendCreatedCredentialActivityLog)(u,{domainUrl:O.Url}),{credentialId:O.Id}}t.createBaseCredentialModel=(e=n.Country.NO_TYPE)=>{let t=(0,u.getUnixTimestamp)();return{kwType:"KWAuthentifiant",Id:(0,l.generateItemUuid)(),CreationDatetime:t,LastBackupTime:0,LastUse:t,LocaleFormat:e}},t.createCredential=m},61586:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.getUrlFields=t.getCategoryIdByName=void 0;let a=r(74915);t.getCategoryIdByName=(e,t)=>{let r=e.credentialCategories;if(!t)return"";if(r.find(e=>e.Id===t))return t;let a=r.find(e=>e.CategoryName===t);return a?.Id},t.getUrlFields=(e,t,r)=>{let o=r?.Url!==e,n=(0,a.cleanUrlForPersonalData)(e,{keepQueryString:t}),i=t&&o?{UserSelectedUrl:n,UseFixedUrl:!0}:{UserSelectedUrl:r?.UserSelectedUrl??"",UseFixedUrl:r?.UseFixedUrl??!1};return{Url:n,TrustedUrlGroup:(0,a.getUpdatedTrustedUrlList)(r?.TrustedUrlGroup??[],n),...i}}},46592:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.saveCredentialAsPersonalDataItem=void 0;let a=r(83533),o=r(19298),n=r(92830),i=r(37313),s=r(98770),c=r(29509),l=r(3313),u=r(45657),d=r(17620),p=r(3469),S=r(18049);async function g({storeService:e,sessionService:t,eventLoggerService:r,applicationModulesAccess:g},m,y){y&&(0,p.notifySharersCredentialUpdated)(e,y,m,g);let f=e.getPersonalData(),E=(0,l.getUpdatedItemChangeHistory)({deviceName:e.getLocalSettings().deviceName,personalData:f,change:(0,u.makeUpdateChange)(m),userLogin:e.getUserLogin(),platformInfo:(0,c.platformInfoSelector)(e.getState())}),A=null,h=(0,i.getInstance)(),_=(0,s.getInstance)();try{A=_.lockTopic("iconsUpdates"),e.dispatch((0,n.savePersonalDataItem)(m,m.kwType,E)),await t.getInstance().user.persistPersonalData(),(0,p.afterCredentialSaved)(e,m);let i={type:"credentialUpdates",credentialIds:[m.Id]};await h.add("iconsUpdates",i),y?(0,S.logEditVaultItem)(e,r,m,y):(0,S.logAddVaultItem)(e,r,m);let{commands:s}=g.createClients().vaultItemsCrud;await s.emitTemporaryVaultItemEvent({ids:[m.Id],eventType:y?o.EventType.Updated:o.EventType.Created}),(0,d.getDebounceSync)(e,t)({immediateCall:!0},a.Trigger.Save)}finally{A&&_.releaseTopic("iconsUpdates",A)}}t.saveCredentialAsPersonalDataItem=g},11369:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.updateCredential=void 0;let a=r(13768),o=r(67179),n=r(46592),i=r(61586),s=r(54286);async function c({storeService:e,sessionService:t,eventLoggerService:r,applicationModulesAccess:c},l,u){if(!e.isAuthenticated())throw Error("No session available to updateCredential");let d=e.getState(),p=(0,a.credentialSelector)(d,l.id);if(!p)throw Error("Credential does not exist, cant update");let S=l.update.url?(0,i.getUrlFields)(l.update.url,l.update.isUrlSelectedByUser,p):{},g={...p,...S,Password:void 0!==l.update.password?l.update.password:p.Password,Email:l.update.email??p.Email,Login:l.update.login??p.Login,Checked:void 0!==l.update.isExcludedFromHealth?l.update.isExcludedFromHealth:p.Checked,LinkedServices:l.update.linkedServices??p.LinkedServices,ModificationDatetime:(0,o.getUnixTimestamp)(),...(u||(()=>({})))(l)};(0,n.saveCredentialAsPersonalDataItem)({storeService:e,sessionService:t,eventLoggerService:r,applicationModulesAccess:c},g,p),c&&(0,s.shouldSendCreateOrModifiedCredentialActivityLog)(e,g)&&await (0,s.computeAndSendModifiedCredentialActivityLog)(c,{domainUrl:g.Url})}t.updateCredential=c},5817:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.isAmazonWebsite=void 0;let a=r(12857);t.isAmazonWebsite=e=>"amazon"===new a.ParsedURL(e).getRootDomainName()},74915:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.getUpdatedTrustedUrlList=t.cleanUrlForPersonalData=t.getBestUrl=t.getFirstTrustedUrl=t.getBaseTrustedUrls=void 0;let a=r(25579),o=r(25903),n=r(12857),i=r(5817),s=r(67179),c=e=>e.UseFixedUrl&&e.UserSelectedUrl?e.UserSelectedUrl:null,l=e=>new n.ParsedURL(e).getUrlWithFallbackHttpsProtocol(),u=(0,o.compose)(e=>{let{protocol:t,hostname:r,port:o}=(0,a.parse)(e);return t&&/^https?:/.test(t)?(0,a.format)({protocol:t,hostname:r,port:o}):null},l,o.trim),d=e=>!(0,o.isNil)(e);function p(e,t){if(!e)return"";if((0,i.isAmazonWebsite)(e))return e;let r={keepQueryString:!1,...t},a=e;return r.keepQueryString||(a=function(e){let t=e.indexOf("?");return t>-1?e.slice(0,t):e}(a)),l(a)}t.getBaseTrustedUrls=(0,o.compose)(e=>e.filter(d),(0,o.map)(u),(0,o.map)((0,o.defaultTo)("")),(0,o.map)((0,o.prop)("TrustedUrl")),(0,o.defaultTo)([])),t.getFirstTrustedUrl=e=>(0,o.defaultTo)("")((0,o.head)((0,t.getBaseTrustedUrls)(e.TrustedUrlGroup))),t.getBestUrl=e=>{let r=c(e);return r&&r.length?r:e.Url&&e.Url.length?e.Url:(0,t.getFirstTrustedUrl)(e)},t.cleanUrlForPersonalData=p,t.getUpdatedTrustedUrlList=function(e,t){let r=p(t),a=new n.ParsedURL(r).getRootDomain(),o=(e||[]).filter(e=>new n.ParsedURL(e.TrustedUrl).getRootDomain()===a);if(o.some(e=>e.TrustedUrl===r))return o;let i=o.length>=20?o.length-20+1:0;return o.slice(i).concat({TrustedUrl:r,TrustedUrlExpire:(0,s.getUnixTimestamp)().toString()})}},41954:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.normalizeUsernames=void 0;let a=r(25903),o=r(36598);t.normalizeUsernames=function(e,t,r){let n=(0,a.defaultTo)(""),i=e,s=t;return(0,o.looksLikeEmail)(t)?(i=t,(0,o.looksLikeEmail)(e)?(i=e,s=""):s=e):(0,o.looksLikeEmail)(e)||((0,a.isEmpty)(e)||(s=e),(0,o.looksLikeEmail)(t)?i=t:((0,a.isEmpty)(t)||(s=t),i="")),{email:n(i),login:n(s),secondaryLogin:n(r)}}},26260:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.detailView=void 0;let a=r(25903),o=r(31180),n=r(36049),i=r(32107),s=(0,a.defaultTo)(""),c=(0,a.defaultTo)(!1);t.detailView=(0,a.curry)((e,t,r,a)=>{let l=e(a.Id),u=t(a.Url),d=s(a.Password),p=r(a),S={addedByDashlane:(0,i.getDashlaneDefinedLinkedWebsites)(a.Url),addedByUser:(0,i.getUserAddedLinkedWebsiteDomains)(a)};return{...(0,o.dataModelDetailView)(a),autoLogin:a.AutoLogin||!1,autoProtected:c(a.AutoProtected),domainIcon:u,email:s(a.Email),forceCategorizedSpace:p,linkedWebsites:S,login:s(a.Login),note:s(a.Note),hasOtp:!!a.OtpSecret||!!a.OtpUrl,otpSecret:s(a.OtpSecret),otpUrl:s(a.OtpUrl),password:d,secondaryLogin:a.SecondaryLogin,sharingStatus:l,strength:a.Strength||0,subdomainOnly:a.SubdomainOnly||!1,title:s(a.Title||(0,n.getDomainForCredential)(a)),url:s(a.Url||a.UserSelectedUrl)}})},89717:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.listView=t.itemView=void 0;let a=r(25903),o=r(31180),n=r(36049),i=(0,a.defaultTo)("");t.itemView=(0,a.curry)((e,t)=>({...(0,o.dataModelItemView)(t),autoProtected:(0,a.defaultTo)(!1,t.AutoProtected),domainIcon:e(t.Url),email:i(t.Email),login:i(t.Login),password:i(t.Password),title:i(t.Title||(0,n.getDomainForCredential)(t)),url:i(t.Url||t.UserSelectedUrl)})),t.listView=(e,r)=>{let a=(0,t.itemView)(e);return r.map(a)}},34682:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.makeDataManagementController=void 0;let a=r(83533),o=r(75972),n=r(42568),i=r(17620),s=r(75021),c={immediateCall:!0};async function l(e,t,r){let{storeService:i,sessionService:l,eventLoggerService:u,applicationModulesAccess:d}=e;if("KWPaymentMean_creditCard"===r.kwType)return(0,o.savePaymentCard)({storeService:i,sessionService:l,eventLoggerService:u},r.content),t(c,a.Trigger.Save),Promise.resolve({success:!0,itemId:""});{let o=await (0,n.addPersonalDataItem)({storeService:i,sessionService:l,eventLoggerService:u,applicationModulesAccess:d},r),p=i.getState(),S=(0,s.isSharedSelector)(p,r.content.id);return"KWAuthentifiant"===r.kwType&&r.shouldSkipSync||(S?await e.sessionService.getInstance().user.attemptSync(a.Trigger.SettingsChange):t(c,a.Trigger.Save)),o}}t.makeDataManagementController=e=>{let t=(0,i.getDebounceSync)(e.storeService,e.sessionService);return{savePaymentCardFromClient:r=>{var n,i,s;return n={storeService:e.storeService,sessionService:e.sessionService,eventLoggerService:e.eventLoggerService},i=t,s=r,void((0,o.savePaymentCard)(n,s),i(c,a.Trigger.Save))},savePersonalDataItem:r=>l({storeService:e.storeService,sessionService:e.sessionService,eventLoggerService:e.eventLoggerService,applicationModulesAccess:e.applicationModulesAccess},t,r),updateMetadataItemFilledOnPage:(r,o,i)=>{var s,c,l,u,d;return s=e.storeService,c=t,l=r,u=o,d=i,void((0,n.updatePersonalDataUsageMetadata)(s,l,u,d),c({},a.Trigger.SaveMeta))}}}},8836:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.dedupItems=t.merge=void 0,t.merge=(e,t,r)=>{let a={};return Object.keys(r).every(o=>{let n=r[o](e[o],t[o]);return n.success&&(a[o]=n.result),n.success})?{success:!0,result:{...e,...t,...a}}:{success:!1}},t.dedupItems=(e,r)=>a=>{let o=[],n={};for(let i of a){let a=e.reduce((e,t)=>`${e}${i[t]}`,"");if(a in n){let e=n[a],s=!1;for(let a of e){let e=o[a],n=(0,t.merge)(i,e,r);if(n.success){o[a]=n.result,s=!0;break}}s||(o.push(i),e.push(o.length-1))}else o.push(i),n[a]=[o.length-1]}return o}},74061:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.concatMerge=t.minMerge=t.maxMerge=t.sumMerge=t.genericMerge=t.boolEqual=t.strictEqual=void 0,t.strictEqual=(e,t)=>e===t?{success:!0,result:e}:{success:!1},t.boolEqual=(e,t)=>!!e==!!t?{success:!0,result:e}:{success:!1},t.genericMerge=(e,t)=>e===t?{success:!0,result:e}:e&&t?{success:!1}:{success:!0,result:e||t};let r=e=>(t,r)=>({success:!0,result:void 0===t&&void 0===r?void 0:e(t??0,r??0)});t.sumMerge=r((e,t)=>e+t),t.maxMerge=r(Math.max),t.minMerge=r(Math.min),t.concatMerge=(e,t)=>({success:!0,result:void 0===e&&void 0===t?void 0:[...e??[],...t??[]]})},50354:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.getRemoveChangeHistory=void 0;let a=r(3313),o=r(29509),n=r(93748),i=r(50830),s=r(45657);t.getRemoveChangeHistory=function(e,t){let r=e.getState(),c=(0,i.personalDataSelector)(r),l=(0,o.platformInfoSelector)(r),u=(0,n.userLoginSelector)(r),{localSettings:d}=e.getState().userSession,p=d.deviceName,S=(0,s.makeRemovalChange)(t);return(0,a.getUpdatedItemChangeHistory)({change:S,deviceName:p,personalData:c,userLogin:u,platformInfo:l})}},48505:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.deletePersonalDataItem=t.findPersonalDataItemToDelete=void 0;let a=r(95121),o=r(20648),n=r(77323),i=r(22560),s=r(93625),c=r(50354),l=r(24445),u=r(80896),d=r(18049),p=r(83533),S=r(76369),g=r(54286),m=["addresses","bankAccounts","companies","credentialCategories","credentials","driverLicenses","emails","fiscalIds","idCards","identities","notes","passkeys","passports","paymentCards","paypalAccounts","personalWebsites","phones","secrets","secureFileInfo","socialSecurityIds"];function y(e,t,r){let a=null,n=e.getPersonalData(),i=r?o.DATAMODELOBJECT_TYPE_TO_CARBON_STORE_KEY[r]??null:null;if(r&&!i)return null;for(let e of i?[i]:m)if(a=(0,l.findDataModelObject)(t,n[e]))break;return a}function f(e,t){let r=Error(`[DataManagement] - deletePersonalDataItem: ${e}`);return(0,u.sendExceptionLog)({error:r}),i.Debugger.error(r),{success:!1,reason:t,message:e}}async function E(e,t){let r=await (0,a.firstValueFrom)(e.queries.getSharingStatusForItem({itemId:t}));if((0,n.isFailure)(r))return f("Unable to retrieve item's sharing status.",o.RemovePersonalDataItemFailureReason.INTERNAL_ERROR);let{isSharedViaUserGroup:i,isShared:s}=(0,n.getSuccess)(r);if(!s)return!1;if(i)return f("Unshare the item before deleting it",o.RemovePersonalDataItemFailureReason.FORBIDDEN_GROUP_ITEM);let c=await (0,a.firstValueFrom)(e.queries.getIsLastAdminForItem({itemId:t}));if((0,n.isFailure)(c))return f("Unable to determine if user is the last admin for shared item",o.RemovePersonalDataItemFailureReason.INTERNAL_ERROR);let{isLastAdmin:l}=(0,n.getSuccess)(c);return!l||f("Unshare the item before deleting it",o.RemovePersonalDataItemFailureReason.FORBIDDEN_LAST_ADMIN)}async function A({storeService:e,eventLoggerService:t,applicationModulesAccess:r,sharingItemsApi:a},i,l){let u=null;try{if(!e.isAuthenticated())return f("No session available to delete personal item",o.RemovePersonalDataItemFailureReason.NOT_AUTHORIZED);let A=y(e,i);if(!A)return f(`Unable to find personal item to delete: ${i}`,o.RemovePersonalDataItemFailureReason.NOT_FOUND);let h=(0,o.isCredential)(A);if(h||(0,o.isNote)(A)||(0,o.isSecret)(A)){if(!l?.ignoreSharing){let e=await E(a,A.Id);if("boolean"!=typeof e)return e;if(!0===e){var m;let e=await (m=A.Id,a.commands.refuseSharedItem({vaultItemId:m}).then(e=>{if((0,n.isFailure)(e))throw Error("Unexpected sharingItemsApi.commands.refuseSharedItem functional error, throwing...")}).catch(e=>f(e.message,o.RemovePersonalDataItemFailureReason.LEAVE_SHARING_FAILED)));if(e)return e}}u=(0,c.getRemoveChangeHistory)(e,A)}(0,d.logDeleteVaultItem)(e,t,A,p.UpdateCredentialOrigin.Manual,null);let _=(0,s.removePersonalItem)(A.kwType,A.Id,u);if(e.dispatch(_),h&&void 0!==r){let t=(0,S.currentTeamIdSelector)(e.getState());A.SpaceId===t&&await (0,g.computeAndSendDeletedCredentialActivityLog)(r,{domainUrl:A.Url})}return{success:!0}}catch(e){return f(e.message,o.RemovePersonalDataItemFailureReason.INTERNAL_ERROR)}}t.findPersonalDataItemToDelete=y,t.deletePersonalDataItem=A},52339:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.config=void 0;let a=r(45892);t.config={commands:{duplicateVaultItem:{handler:a.duplicateVaultItemHandler}},queries:{},liveQueries:{}}},45892:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.duplicateVaultItemHandler=void 0;let a=r(24961),o=async({storeService:e},{vaultItemId:t})=>({newVaultItemId:await (0,a.duplicateSharedElements)(e,t)});t.duplicateVaultItemHandler=o},24961:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.duplicateSharedElements=void 0;let a=r(20648),o=r(92830),n=r(61681),i=r(24445),s=r(37313),c=r(98770);async function l(e,t){let r=null,l=(0,s.getInstance)(),u=(0,c.getInstance)(),{notes:d,credentials:p,changeHistories:S,secrets:g}=e.getPersonalData(),m=[...d,...p,...g],y=(0,i.findDataModelObject)(t,m);if(!y)return null;let f=(0,n.generateItemUuid)(),E={...y,Id:f},A=S.find(e=>e.ObjectId.toUpperCase()===t.toUpperCase());(0,a.isCredential)(y)&&(r=u.lockTopic("iconsUpdates"),await l.add("iconsUpdates",{credentialIds:[f],type:"credentialUpdates"}));let h=(0,o.savePersonalDataItem)(E,E.kwType,A);return e.dispatch(h),r&&u.releaseTopic("iconsUpdates",r),f}t.duplicateSharedElements=l},56042:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.config=void 0;let a=r(18669),o=r(96838);t.config={commands:{getPersonalDataExport:{handler:a.getPersonalDataExport}},queries:{getIsForcedDomainsEnabled:{selector:o.isForcedDomainsEnabledSelector}},liveQueries:{}}},96838:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.isForcedDomainsEnabledSelector=void 0;let a=r(93748);t.isForcedDomainsEnabledSelector=e=>{let t=(0,a.activeSpacesSelector)(e)[0];return t?.info?.forcedDomainsEnabled??!1}},67978:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.getCredentialsExport=void 0;let a=r(20648),o=r(51427),n=r(89574);t.getCredentialsExport=function(e){let t=e.credentials,r=e.collections,i=(0,n.getCollectionsByItemId)(r,a.DataModelType.KWAuthentifiant),s=[{headerKey:"username",dataKey:"Email"},{headerKey:"username2",dataKey:"Login"},{headerKey:"username3",dataKey:"SecondaryLogin"},{headerKey:"title",dataKey:"Title"},{headerKey:"password",dataKey:"Password"},{headerKey:"note",dataKey:"Note"},{headerKey:"url",dataKey:"Url"},{headerKey:"category",dataKey:"Category"},{headerKey:"otpUrl",dataKey:"OtpUrl"}];return(0,n.formatDataToCSV)([(0,n.formatHeader)(s),t.map(e=>{let[t="",r="",a=""]=[e.Email,e.Login,e.SecondaryLogin].filter(e=>void 0!==e&&""!==e),c=e.OtpUrl??(e.OtpSecret?`otpauth://totp/?secret=${e.OtpSecret.toLowerCase()}&algorithm=SHA1&digits=6&period=30&lock=false`:"");return s.map(s=>{let l=e[s.dataKey]??"";if("Category"===s.dataKey)return(0,o.handleSpecialCharacter)((0,n.getItemCollections)(i,e.Id));if("Email"===s.dataKey)return(0,o.handleSpecialCharacter)(t);if("Login"===s.dataKey)return(0,o.handleSpecialCharacter)(r);if("SecondaryLogin"===s.dataKey)return(0,o.handleSpecialCharacter)(a);if("Note"===s.dataKey&&""!==l)return(0,o.handleSpecialCharacter)(l);if("Password"===s.dataKey){let e=`${l}`;return(0,o.handleSpecialCharacter)(e)}{if("OtpUrl"===s.dataKey)return(0,o.handleSpecialCharacter)(c);let e=`${l}`;return(0,o.handleSpecialCharacter)(e)}}).join(",")}).join("\r\n")])}},86966:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.getCSVExport=void 0;let a=r(67978),o=r(73595),n=r(57577),i=r(76855),s=r(20708),c=[{filename:"credentials",generator:a.getCredentialsExport},{filename:"personalInfo",generator:s.getPersonalInfoExport},{filename:"securenotes",generator:o.getSecureNotesExport},{filename:"payments",generator:n.getPaymentsExport},{filename:"ids",generator:i.getIdsExport}],l=e=>new Promise((t,r)=>{let a=new FileReader;a.readAsDataURL(e),a.onloadend=()=>{let e=a.result;e?t(e.toString()):r(Error("Error creating CSV export."))}});async function u(e){let t=await Promise.all([r.e("185"),r.e("577"),r.e("954"),r.e("393"),r.e("766")]).then(r.bind(r,40710));t.configure({useWebWorkers:!1});let a=new t.ZipWriter(new t.BlobWriter("application/zip")),o=[];for(let{filename:r,generator:n}of c){let i=n(e);o.push(a.add(`${r}.csv`,new t.BlobReader(new Blob([i],{type:"text/csv"}))))}await Promise.all(o);let n=await a.close();return await l(n)}t.getCSVExport=u},25962:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.getDashlaneSecureExport=void 0;let a=r(25903),o=r(34978),n=r(56708);async function i(e,t){let r=(0,a.join)(";",(0,a.pluck)("Id",t));t.forEach(e=>{delete e.Attachments});let i=(0,n.getDashlaneXml)(t),s=(0,o.utf16ToDeflatedUtf8)(i),c=await e.encrypt(s);return(0,a.join)("\n",["-------------------- Dashlane Secured Export ----------------------","--------------------        Id BEGIN         ----------------------",r,"--------------------         Id END          ----------------------","--------------------       Data BEGIN        ----------------------",c,"--------------------        Data END         ----------------------","--------------------       Files BEGIN       ----------------------","--------------------        Files END        ----------------------\n"])}t.getDashlaneSecureExport=i},76855:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.getIdsExport=void 0;let a=r(36190),o=r(51427),n=r(89574);t.getIdsExport=function(e){let t=new Map;e.identities.forEach(e=>{t.set(e.Id,e)});let r=e.idCards,i=e.passports,s=e.driverLicenses,c=e.socialSecurityIds,l=e.fiscalIds,u=[{headerKey:"type",dataKey:"type"},{headerKey:"number",dataKey:"Number"},{headerKey:"name",dataKey:"Fullname"},{headerKey:"issue_date",dataKey:"DeliveryDate"},{headerKey:"expiration_date",dataKey:"ExpireDate"},{headerKey:"place_of_issue",dataKey:"DeliveryPlace"},{headerKey:"state",dataKey:"State"}];return(0,n.formatDataToCSV)([(0,n.formatHeader)(u),r.map(e=>{let r=t.get(e.LinkedIdentity);return u.map(t=>{let n=`${e[t.dataKey]??""}`;if("type"===t.dataKey)return"card";if("Fullname"===t.dataKey&&r){let e=(0,a.identityToName)(r)??n;return(0,o.handleSpecialCharacter)(e)}return(0,o.handleSpecialCharacter)(n)}).join(",")}).join("\r\n"),i.map(e=>{let r=t.get(e.LinkedIdentity);return u.map(t=>{let n=`${e[t.dataKey]??""}`;if("type"===t.dataKey)return"passport";if("Fullname"===t.dataKey&&r){let e=(0,a.identityToName)(r)??n;return(0,o.handleSpecialCharacter)(e)}return(0,o.handleSpecialCharacter)(n)}).join(",")}).join("\r\n"),s.map(e=>{let r=t.get(e.LinkedIdentity);return u.map(t=>{let n=`${e[t.dataKey]??""}`;if("type"===t.dataKey)return"license";if("Fullname"===t.dataKey&&r){let e=(0,a.identityToName)(r)??n;return(0,o.handleSpecialCharacter)(e)}return(0,o.handleSpecialCharacter)(n)}).join(",")}).join("\r\n"),c.map(e=>{let r=t.get(e.Id);return u.map(t=>{let n=`${e[t.dataKey]??""}`;if("type"===t.dataKey)return"social_security";if("Number"===t.dataKey){let t=e.SocialSecurityNumber;return(0,o.handleSpecialCharacter)(t)}if("Fullname"===t.dataKey){let t=r?(0,a.identityToName)(r):e.SocialSecurityFullname;return(0,o.handleSpecialCharacter)(t)}return(0,o.handleSpecialCharacter)(n)}).join(",")}).join("\r\n"),l.map(e=>u.map(t=>{let r=`${e[t.dataKey]??""}`;if("type"===t.dataKey)return(0,o.handleSpecialCharacter)("tax_number");if("Number"===t.dataKey){let t=e.FiscalNumber;return(0,o.handleSpecialCharacter)(t)}{let e=`${r}`;return(0,o.handleSpecialCharacter)(e)}}).join(",")).join("\r\n")])}},57577:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.getPaymentsExport=void 0;let a=r(51427),o=r(89574);t.getPaymentsExport=function(e){let t=e.bankAccounts,r=e.paymentCards,n=[{headerKey:"type",dataKey:"Type"},{headerKey:"account_name",dataKey:"BankAccountName"},{headerKey:"account_holder",dataKey:"BankAccountOwner"},{headerKey:"cc_number",dataKey:"CardNumber"},{headerKey:"code",dataKey:"SecurityCode"},{headerKey:"expiration_month",dataKey:"ExpireMonth"},{headerKey:"expiration_year",dataKey:"ExpireYear"},{headerKey:"routing_number",dataKey:"BankAccountBIC"},{headerKey:"account_number",dataKey:"BankAccountIBAN"},{headerKey:"country",dataKey:"LocaleFormat"},{headerKey:"issuing_bank",dataKey:"BankAccountBank"},{headerKey:"note",dataKey:"CCNote"},{headerKey:"name",dataKey:"Name"}];return(0,o.formatDataToCSV)([(0,o.formatHeader)(n),t.map(e=>n.map(t=>{let r=`${e[t.dataKey]??""}`;if("Type"===t.dataKey)return(0,a.handleSpecialCharacter)("bank");{let e=`${r}`;return(0,a.handleSpecialCharacter)(e)}}).join(",")).join("\r\n"),r.map(e=>n.map(t=>{let r=`${e[t.dataKey]??""}`;if("Type"===t.dataKey)return(0,a.handleSpecialCharacter)("payment_card");if("BankAccountName"!==t.dataKey)return(0,a.handleSpecialCharacter)(r);{let t=e.OwnerName;return(0,a.handleSpecialCharacter)(t)}}).join(",")).join("\r\n")])}},18669:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.getPersonalDataExport=t.getFilteredPersonalData=t.filterNonExportableData=void 0;let a=r(95121),o=r(77323),n=r(20648),i=r(25962),s=r(25434),c=r(92180),l=r(48140),u=r(49705),d=r(38728),p=r(39635),S=r(1586),g=r(34457),m=r(97915),y=r(91966),f=r(8362),E=r(49386),A=r(39442),h=r(36755),_=r(71156),T=r(68352),v=r(82098),I=r(82822),D=r(92558),P=r(99008),O=r(52581),C=r(90296),b=r(31002),R=r(96838),N=r(86966),w=async(e,t,r)=>{let i=e.map(e=>e.Id),s=await (0,a.firstValueFrom)(r.queries.getPermissionForItems({itemIds:i}));if((0,o.isFailure)(s))throw Error("Could not retrieve item permission for export");let c=(0,o.getSuccess)(s);return e.filter(e=>{let r=!1,a=c[e.Id],o=!a||a.capabilities.canReveal;return t&&(0,n.isDataModelObject)(e)&&(r=e.SpaceId!==l.PERSONAL_SPACE_ID),!r&&o})};t.filterNonExportableData=w;let L=(e,t)=>{let r=(0,u.quarantinedSpacesSelector)(e);return(0,d.filterOutQuarantinedItems)(t,r)},U=async(e,r)=>{let a=(0,R.isForcedDomainsEnabledSelector)(e),o=L(e,(0,y.credentialsSelector)(e)),i=await (0,t.filterNonExportableData)(o,a,r),s=L(e,(0,T.secretsSelector)(e)),c=await (0,t.filterNonExportableData)(s,a,r),l=L(e,(0,v.notesSelector)(e)),u=await (0,t.filterNonExportableData)(l,a,r);return{addresses:L(e,(0,p.addressesSelector)(e)),bankAccounts:L(e,(0,S.bankAccountsSelector)(e)),collections:L(e,(0,g.collectionsSelector)(e)),companies:L(e,(0,m.companiesSelector)(e)),credentials:i,driverLicenses:L(e,(0,E.driverLicensesSelector)(e)),emails:L(e,(0,A.emailsSelector)(e)),fiscalIds:L(e,(0,h.fiscalIdsSelector)(e)),idCards:L(e,(0,f.idCardsSelector)(e)),identities:L(e,(0,_.identitiesSelector)(e)),notes:u,passkeys:L(e,(0,I.passkeysSelector)(e).filter(n.isLegacyPasskey)),passports:L(e,(0,D.passportsSelector)(e)),paymentCards:L(e,(0,P.paymentCardsSelector)(e)),personalWebsites:L(e,(0,O.personalWebsitesSelector)(e)),phones:L(e,(0,C.phonesSelector)(e)),secrets:c,socialSecurityIds:L(e,(0,b.socialSecurityIdsSelector)(e))}};async function M(e,r){let{storeService:a}=e,o=a.getState(),{exportType:l,password:u}=r,d=e.applicationModulesAccess.createClients().sharingItems,p=await (0,t.getFilteredPersonalData)(o,d);switch(l){case"csv":return{success:!0,response:{filename:"dashlane-credential-export.zip",content:await (0,N.getCSVExport)(p)}};case"secure-dashlane":{if(!u)return{success:!1,error:{code:n.GetPersonalDataExportErrorMessage.UNDEFINED_PASSWORD_ERROR}};let e=(0,s.makeDataEncryptorService)(a),t=(0,c.makeFlexibleMarkerCryptoConfig)("argon2d");e.setInstance({raw:u},"",t);let r=Object.values(p).flat().map(e=>({...e}));return{success:!0,response:{filename:"Dashlane Export.dash",content:await (0,i.getDashlaneSecureExport)(e.getInstance(),r)}}}default:return{success:!1,error:{code:n.GetPersonalDataExportErrorMessage.UNSUPPORTED_DATATYPE_ERROR}}}}t.getFilteredPersonalData=U,t.getPersonalDataExport=M},20708:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.getPersonalInfoExport=void 0;let a=r(51839),o=r(20648),n=r(51427),i=r(89574),s=e=>{let{LocaleFormat:t,Number:r}=e;if(t&&t!==o.Country.UNIVERSAL&&t!==o.Country.NO_TYPE&&(0,a.isSupportedCountry)(t)){let t=o.Country[e.LocaleFormat],n=(0,a.getCountryCallingCode)(t);return`+${n}${r}`}return r};t.getPersonalInfoExport=function(e){let t=e.identities,r=e.emails,a=e.phones,o=e.addresses,c=e.companies,l=e.personalWebsites,u=[{headerKey:"type",dataKey:"type"},{headerKey:"title",dataKey:"Title"},{headerKey:"first_name",dataKey:"FirstName"},{headerKey:"middle_name",dataKey:"MiddleName"},{headerKey:"last_name",dataKey:"LastName"},{headerKey:"login",dataKey:"Pseudo"},{headerKey:"date_of_birth",dataKey:"BirthDate"},{headerKey:"place_of_birth",dataKey:"BirthPlace"},{headerKey:"email",dataKey:"Email"},{headerKey:"email_type",dataKey:"Type"},{headerKey:"item_name",dataKey:"Name"},{headerKey:"phone_number",dataKey:"Number"},{headerKey:"address",dataKey:"AddressFull"},{headerKey:"country",dataKey:"Country"},{headerKey:"state",dataKey:"State"},{headerKey:"city",dataKey:"City"},{headerKey:"zip",dataKey:"ZipCode"},{headerKey:"address_recipient",dataKey:"Receiver"},{headerKey:"address_building",dataKey:"Building"},{headerKey:"address_apartment",dataKey:"Door"},{headerKey:"address_floor",dataKey:"Floor"},{headerKey:"address_door_code",dataKey:"DigitCode"},{headerKey:"job_title",dataKey:"JobTitle"},{headerKey:"url",dataKey:"Website"}];return(0,i.formatDataToCSV)([(0,i.formatHeader)(u),t.map(e=>u.map(t=>{let r=`${e[t.dataKey]??""}`;if("type"===t.dataKey)return(0,n.handleSpecialCharacter)("name");{let e=`${r}`;return(0,n.handleSpecialCharacter)(e)}}).join(",")).join("\r\n"),r.map(e=>u.map(t=>{let r=`${e[t.dataKey]??""}`;if("type"===t.dataKey)return(0,n.handleSpecialCharacter)("email");if("Type"===t.dataKey)return"PERSO"===r?(0,n.handleSpecialCharacter)("personal"):(0,n.handleSpecialCharacter)("business");if("Name"===t.dataKey){let t=e.EmailName??"";return(0,n.handleSpecialCharacter)(t)}{let e=`${r}`;return(0,n.handleSpecialCharacter)(e)}}).join(",")).join("\r\n"),a.map(e=>u.map(t=>{let r=`${e[t.dataKey]??""}`;if("type"===t.dataKey)return(0,n.handleSpecialCharacter)("number");if("Type"===t.dataKey)return(0,n.handleSpecialCharacter)("");if("Name"===t.dataKey){let t=e.PhoneName??"";return(0,n.handleSpecialCharacter)(t)}if("Number"===t.dataKey){let t=s(e);return(0,n.handleSpecialCharacter)(t)}{let e=`${r}`;return(0,n.handleSpecialCharacter)(e)}}).join(",")).join("\r\n"),o.map(e=>u.map(t=>{let r=`${e[t.dataKey]??""}`;if("type"===t.dataKey)return(0,n.handleSpecialCharacter)("address");if("Name"===t.dataKey){let t=e.AddressName??"";return(0,n.handleSpecialCharacter)(t)}{let e=`${r}`;return(0,n.handleSpecialCharacter)(e)}}).join(",")).join("\r\n"),c.map(e=>u.map(t=>{let r=`${e[t.dataKey]??""}`;if("type"===t.dataKey)return(0,n.handleSpecialCharacter)("company");{let e=`${r}`;return(0,n.handleSpecialCharacter)(e)}}).join(",")).join("\r\n"),l.map(e=>u.map(t=>{let r=`${e[t.dataKey]??""}`;if("type"===t.dataKey)return(0,n.handleSpecialCharacter)("website");{let e=`${r}`;return(0,n.handleSpecialCharacter)(e)}}).join(",")).join("\r\n")])}},73595:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.getSecureNotesExport=void 0;let a=r(20648),o=r(51427),n=r(89574);t.getSecureNotesExport=function(e){let t=e.notes,r=e.collections,i=(0,n.getCollectionsByItemId)(r,a.DataModelType.KWSecureNote),s=[{headerKey:"title",dataKey:"Title"},{headerKey:"note",dataKey:"Content"},{headerKey:"category",dataKey:"Category"}];return(0,n.formatDataToCSV)([(0,n.formatHeader)(s),t.map(e=>s.map(t=>{let r=e[t.dataKey]??"";if("Content"===t.dataKey&&""!==r)return(0,o.handleSpecialCharacter)(r);if("Category"===t.dataKey)return(0,o.handleSpecialCharacter)((0,n.getItemCollections)(i,e.Id));{let e=`${r}`;return(0,o.handleSpecialCharacter)(e)}}).join(",")).join("\r\n")])}},51427:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.handleSpecialCharacter=void 0,t.handleSpecialCharacter=function(e){return void 0===e?"":e.match(/[,"\n\r]/g)?['"',...e.split("").map(e=>'"'===e?'""':e),'"'].join(""):e}},89574:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.getItemCollections=t.getCollectionsByItemId=t.formatDataToCSV=t.formatHeader=void 0,t.formatHeader=e=>e.map(e=>e.headerKey).join(","),t.formatDataToCSV=function(e){return e.filter(e=>e.length>0).join("\r\n")},t.getCollectionsByItemId=(e,t)=>e.reduce((e,r)=>(r.VaultItems.reduce((e,r)=>r.Type!==t?e:[...e,r.Id],[]).forEach(t=>{e[t]?e[t].push(r.Name):e[t]=[r.Name]}),e),{}),t.getItemCollections=(e,t)=>{let r=e[t];return r?r.join(", "):""}},42107:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.config=void 0;let a=r(67584),o=r(43901);t.config={commands:{saveGeneratedPassword:{handler:o.saveGeneratedPasswordHandler}},queries:{getGeneratedPasswords:{selector:a.viewedQueriedGeneratedPasswordsSelector}},liveQueries:{}}},5053:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.findAssociatedCredential=t.associateGeneratedPasswordsToCredential=void 0;let a=r(36049);t.associateGeneratedPasswordsToCredential=function(e,t){return e.filter(e=>!e.AuthId&&e.Domain===(0,a.getDomainForCredential)(t)&&e.Password===t.Password).map(e=>({...e,AuthId:t.Id}))},t.findAssociatedCredential=function(e,t){if(e?.AuthId)return(t||[]).find(t=>t.Id===e.AuthId)}},57376:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.createGeneratedPassword=void 0;let a=r(20648),o=r(61681),n=r(67179);t.createGeneratedPassword=({Id:e=(0,o.generateItemUuid)(),LastBackupTime:t=0,AuthId:r,Domain:i,GeneratedDate:s=(0,n.getUnixTimestamp)(),Password:c,SpaceId:l,Platform:u})=>({kwType:a.DataModelType.KWGeneratedPassword,AuthId:r,Domain:i,GeneratedDate:s,Id:e,SpaceId:l,Password:c,LastBackupTime:t,Platform:u})},43901:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.saveGeneratedPasswordHandler=void 0;let a=r(19767);async function o(e,t){let{storeService:r,sessionService:o}=e;return(0,a.saveGeneratedPassword)(r,o,t.password,t.url)}t.saveGeneratedPasswordHandler=o},19767:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.generateAndSavePassword=t.saveGeneratedPassword=t.generatePassword=t.fixIncoherentSettings=t.getDefaultPasswordGenerationSettings=t.passwordGeneratorDefaultSettings=t.associateGeneratedPasswordsToCredential=void 0;let a=r(75895),o=r(25903),n=r(51860),i=r(20648),s=r(22560),c=r(61681),l=r(67179),u=r(92830),d=r(80896),p=r(57376),S=r(29509);var g=r(5053);function m(e){let r=(0,o.reject)(e=>(0,o.isNil)(e)||(0,o.isEmpty)(e))({length:e.GeneratorDefaultSize,digits:e.GeneratorDefaultDigits,letters:e.GeneratorDefaultLetters,symbols:e.GeneratorDefaultSymbols,avoidAmbiguous:e.GeneratorDefaultAvoidAmbiguousChars});return y((0,o.merge)(t.passwordGeneratorDefaultSettings,r))}function y(e){return e.digits||e.letters||e.symbols||(e.digits=!0,e.letters=!0,e.symbols=!0),(void 0===e.length||e.length<1)&&(e.length=t.passwordGeneratorDefaultSettings.length),e}function f(e,t){let r=(0,o.isNil)(t)?m(e):y(t);if(!r.digits&&!r.letters&&r.symbols){let a=Error("Should not generate password from symbols only"),o={length:e.GeneratorDefaultSize,digits:e.GeneratorDefaultDigits,letters:e.GeneratorDefaultLetters,symbols:e.GeneratorDefaultSymbols,avoidAmbiguous:e.GeneratorDefaultAvoidAmbiguousChars},n=`customSettings = ${JSON.stringify(t)}
personalSettingsGeneratorDefaults = ${JSON.stringify(o)}`;s.default.error(a),(0,d.sendExceptionLog)({error:a,code:i.ExceptionCriticality.WARNING,precisions:n}),r.digits=!0,r.letters=!0,r.symbols=!0}return(0,n.generate)(r)}function E(e,t,r,a){let o=(0,p.createGeneratedPassword)({Domain:a??"",GeneratedDate:(0,l.getUnixTimestamp)(),Id:(0,c.generateItemUuid)(),Password:r,LastBackupTime:0,Platform:(0,S.platformInfoSelector)(e.getState()).platformName});e.dispatch(u.saveGeneratedPassword(o)),t.getInstance().user.persistPersonalData()}Object.defineProperty(t,"associateGeneratedPasswordsToCredential",{enumerable:!0,get:function(){return g.associateGeneratedPasswordsToCredential}}),t.passwordGeneratorDefaultSettings={length:16,digits:!0,letters:!0,symbols:!0,avoidAmbiguous:!0},t.getDefaultPasswordGenerationSettings=m,t.fixIncoherentSettings=y,t.generatePassword=f,t.saveGeneratedPassword=E,t.generateAndSavePassword=function(e,t,r){if(!e.isAuthenticated())return s.default.log("No session available to generateAndSavePassword"),null;let o=f(e.getPersonalSettings());return a(()=>{E(e,t,o,r)}),o}},18734:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.getGeneratedPasswordMappers=void 0,t.getGeneratedPasswordMappers=()=>({id:e=>e.Id,domain:e=>e.Domain,generatedDate:e=>e.GeneratedDate})},85762:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.generatedPasswordMatch=t.searchGetters=void 0;let a=r(92595),o=r(23674);t.searchGetters=[(0,a.stringProp)("Domain")],t.generatedPasswordMatch=(0,o.match)(t.searchGetters)},67584:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.generatedPasswordsQuerySelector=t.getLiveGeneratedPasswordsSelector=t.viewedQueriedGeneratedPasswordsSelector=t.queryGeneratedPasswordsSelector=t.getGeneratedPasswordMappersSelector=t.generatedPasswordMappersSelector=t.generatedPasswordSelector=t.generatedPasswordsSelector=t.countAllGeneratedPasswordsSelector=void 0;let a=r(25903),o=r(99040),n=r(96262),i=r(7299),s=r(85762),c=r(18734),l=r(49548),u=r(27011),d=r(95121),p=r(49705),S=r(67803),g=r(38728),m=r(24445);t.countAllGeneratedPasswordsSelector=e=>e.userSession.personalData.generatedPasswords.length,t.generatedPasswordsSelector=(0,l.createSelector)([e=>e.userSession.personalData.generatedPasswords,p.quarantinedSpacesSelector],g.filterOutQuarantinedItems),t.generatedPasswordSelector=(e,r)=>{let a=(0,t.generatedPasswordsSelector)(e);return(0,m.findDataModelObject)(r,a)},t.generatedPasswordMappersSelector=e=>(0,c.getGeneratedPasswordMappers)();let y=()=>s.generatedPasswordMatch,f=(0,c.getGeneratedPasswordMappers)();t.getGeneratedPasswordMappersSelector=()=>f,t.queryGeneratedPasswordsSelector=(0,i.getQuerySelector)(t.generatedPasswordsSelector,y,t.generatedPasswordMappersSelector),t.viewedQueriedGeneratedPasswordsSelector=(0,a.compose)((0,o.viewListResults)(n.listView),t.queryGeneratedPasswordsSelector),t.getLiveGeneratedPasswordsSelector=(0,S.makeLiveSelectorGetter)(t.generatedPasswordsSelector,()=>n.listView,y,t.getGeneratedPasswordMappersSelector);let E=(0,u.createOptimizedSortTokenSelector)((e,{sortToken:t})=>t,d.identity),A=(0,u.createOptimizedFilterTokenSelector)((e,{filterToken:t})=>t,d.identity);t.generatedPasswordsQuerySelector=(0,l.createSelector)(c.getGeneratedPasswordMappers,y,E,A,t.generatedPasswordsSelector,u.queryData)},96262:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.listView=t.itemView=void 0;let a=(0,r(25903).defaultTo)("");t.itemView=e=>({domain:a(e.Domain),generatedDate:e.GeneratedDate,password:e.Password,id:e.Id,platform:e.Platform}),t.listView=e=>e.map(t.itemView)},17702:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.makeEmptyIconUrls=t.computeIconUrls=void 0,t.computeIconUrls=(e,t)=>t.reduce((t,r)=>{let a=e.find(e=>e&&e.type===r);return t[r]=a?a.url:null,t},{}),t.makeEmptyIconUrls=e=>(0,t.computeIconUrls)([],e)},52822:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.getFormattedDomainsFromUrls=t.decryptIconsDomains=void 0;let a=r(25903),o=r(12857),n=r(59587);t.decryptIconsDomains=(e,t)=>{let r=Array.from(e.keys()),a=new Map,o=t.reduce((e,t)=>(e[(0,n.computeHashMD5)(t)]=t,e),{});return r.forEach(t=>{let r=o[t];a.set(r,e.get(t))}),a},t.getFormattedDomainsFromUrls=e=>(0,a.uniq)(e.map(e=>new o.ParsedURL(e).getRootDomain())).filter(e=>"string"==typeof e&&e.length)},43747:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.clearInstance=t.getInstance=t.setInstance=void 0;let a=r(93174),o=r(57743),n=null;t.setInstance=(e,t,r)=>n=n||new a.IconsUpdater(t,e,new o.IconsWS(r)),t.getInstance=()=>n,t.clearInstance=()=>{n&&n.teardown(),n=null}},93174:function(e,t,r){var a,o;Object.defineProperty(t,"__esModule",{value:!0}),t.IconsUpdater=void 0;let n=r(95121),i=r(15237),s=r(42387),c=r(54938),l=r(13768),u=r(91966),d=r(22560),p=r(24432),S=r(93748),g=r(43392),m=r(91783),y=r(86602),f=r(80896),E=r(62829),A=r(27698),h=r(16436),_=r(85749);(o=a||(a={})).BreachesOperation="breachesOperation",o.CredentialsOperation="credentialsOperation",o.RefreshOperation="refreshOperation";let T=(e,t)=>async({credentialIds:r,iconTypes:a})=>{let o=e.getState(),n=r.map(e=>(0,l.credentialSelector)(o,e)).filter(e=>!!e),i=await (0,y.fetchIconsForCredentials)(o,t,n,a);(0,h.default)()&&i.length>0&&(e.dispatch((0,g.iconsUpdated)(i)),(0,A.reportDataUpdate)(e))},v=(e,t)=>async({breachesIds:r,iconTypes:a})=>{let o=e.getState(),n=r.map(e=>(0,c.breachSelector)(o,e)).filter(e=>!!e),i=await (0,y.fetchIconsForBreaches)(o,t,n,a);i.length>0&&e.dispatch((0,g.iconsUpdated)(i))},I=(e,t)=>async({iconTypes:r})=>{let a=e.getState();if(!(0,S.richIconsSettingSelector)(a)){e.dispatch((0,g.clearIconsCache)());return}let o=(0,p.iconsCacheSelector)(a);if((0,E.isIconsCacheValid)(o))return;let n=(0,u.credentialsSelector)(a),i=(0,c.breachesSelector)(a),s=await (0,y.fetchIconsForAllItems)(t,n,i,r);e.dispatch((0,g.iconsRefreshed)(s)),(0,h.default)()&&(0,A.reportDataUpdate)(e)};t.IconsUpdater=class{constructor(e,t,r){this.localStorageService=e,this.storeService=t,this.gateway=r,this._operation$=new n.Subject,this.subs=new Set,this.handleRefreshIcons=async()=>{let e=(0,s.v4)(),t=new Promise(t=>{let r=this._operationResults$.subscribe(a=>{a.id===e&&(t(a.success),r.unsubscribe(),this.subs.delete(r))});this.subs.add(r)});return this.triggerRefreshOperation(e),await t},this.handleCredentialUpdates=async e=>{let t=(0,s.v4)(),r=new Promise(e=>{let r=this._operationResults$.subscribe(a=>{a.id===t&&(e(a.success),r.unsubscribe(),this.subs.delete(r))});this.subs.add(r)});return this.triggerCredentialsOperation(t,e),await r},this.handleBreachesUpdates=async e=>{let t=(0,s.v4)(),r=new Promise(e=>{let r=this._operationResults$.subscribe(a=>{a.id===t&&(e(a.success),r.unsubscribe(),this.subs.delete(r))});this.subs.add(r)});return this.triggerBreachesOperation(t,e),await r},this.triggerCredentialsOperation=(e,t,r=_.defaultIconTypes)=>{this._operation$.next({credentialIds:t,id:e,type:a.CredentialsOperation,iconTypes:r})},this.triggerBreachesOperation=(e,t,r=_.defaultIconTypes)=>{this._operation$.next({breachesIds:t,id:e,type:a.BreachesOperation,iconTypes:r})},this.triggerRefreshOperation=(e,t=_.defaultIconTypes)=>{this._operation$.next({id:e,type:a.RefreshOperation,iconTypes:t})},this.handleOperation=async(e,t)=>{let{type:r,id:a}=t,o={id:a,type:r},n=this.localStorageService.getInstance(),i=this.storeService.getState();try{return await e(t),await n.storeIcons((0,p.iconsCacheSelector)(i)),{...o,success:!0}}catch(a){let e=`[Icons Updater] - handle operation: operation ${t.type} failed with ${a}`;d.default.error(e);let r=Error(e);return(0,f.sendExceptionLog)({error:r}),console.error(r),{...o,success:!1}}},this.onOperation=async e=>{switch(e.type){case a.CredentialsOperation:return this.handleOperation(T(this.storeService,this.gateway),e);case a.BreachesOperation:return this.handleOperation(v(this.storeService,this.gateway),e);case a.RefreshOperation:return this.handleOperation(I(this.storeService,this.gateway),e);default:return(0,m.assertUnreachable)(e)}},this.setupOperationsHandling=()=>{let e=this._operation$.pipe((0,i.concatMap)(this.onOperation),(0,i.share)()),t=e.subscribe();this.subs.add(t),this._operationResults$=e},this.setupOperationsHandling()}teardown(){this.subs.forEach(e=>e.unsubscribe())}}},62829:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.isIconsCacheValid=void 0;let a=r(67179),o=(7+Math.random())*86400;t.isIconsCacheValid=e=>!!e&&!!e.lastUpdateTimeSeconds&&(0,a.getUnixTimestamp)()-e.lastUpdateTimeSeconds<o},85749:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.defaultIconTypes=void 0,t.defaultIconTypes=["46x30@2x","160x106@2x","118x98@2x"]},86602:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.fetchIconsForAllItems=t.fetchIconsForCredentials=t.getCredentialsWithWebsiteIcon=t.fetchIconsForBreaches=t.getIconsUrlsForBreaches=t.getIconsUrlsForCredentials=void 0;let a=r(25903),o=r(12857),n=r(52822),i=r(24432),s=r(17702),c=r(93748);t.getIconsUrlsForCredentials=e=>e.map(e=>e.Url),t.getIconsUrlsForBreaches=e=>e.reduce((e,t)=>{let r=t.Content.domains;return r&&0!==r.length?[...e,r[0]]:e},[]);let l=async(e,r,o,s)=>{if(!(0,c.richIconsSettingSelector)(e))return Promise.resolve([]);let l=(0,t.getIconsUrlsForBreaches)(o),u=(0,n.getFormattedDomainsFromUrls)(l),d=Array.from((0,n.decryptIconsDomains)((0,i.iconsSelector)(e),u).keys()),p=(0,a.difference)(u,d);return r.getIcons(p,s)};t.fetchIconsForBreaches=l,t.getCredentialsWithWebsiteIcon=(e,t,r)=>{let n={backgroundColor:null,mainColor:null,urls:(0,s.makeEmptyIconUrls)(r)};return e.map(e=>{let r=t.get(new o.ParsedURL(e.Url).getRootDomain()),i=(0,a.defaultTo)(n,r);return{...e,domainIcon:i}})};let u=async(e,r,o,s)=>{if(!(0,c.richIconsSettingSelector)(e))return[];let l=(0,t.getIconsUrlsForCredentials)(o),u=(0,n.getFormattedDomainsFromUrls)(l),d=Array.from((0,n.decryptIconsDomains)((0,i.iconsSelector)(e),u).keys()),p=(0,a.difference)(u,d);return r.getIcons(p,s)};t.fetchIconsForCredentials=u;let d=async(e,r,a,o)=>{let i=[...(0,t.getIconsUrlsForBreaches)(a),...(0,t.getIconsUrlsForCredentials)(r)],s=(0,n.getFormattedDomainsFromUrls)(i);return e.getIcons(s,o)};t.fetchIconsForAllItems=d},52205:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.iconsUpdatesHook=void 0;let a=r(91783),o=r(43747),n=async e=>{let t=(0,o.getInstance)();if(!t)return!1;switch(e.type){case"breachUpdates":return t.handleBreachesUpdates(e.breachesIds);case"credentialUpdates":return t.handleCredentialUpdates(e.credentialIds);case"refresh":return t.handleRefreshIcons();default:return(0,a.assertUnreachable)(e)}};t.iconsUpdatesHook=n},64654:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.formatFetchedIcons=t.makeIconDataWithDomain=t.getDomainsIconsToBeFetched=t.getDomainIconsToBeFetched=void 0;let a=r(25903),o=r(17702),n=(0,a.defaultTo)(null);t.getDomainIconsToBeFetched=(e,t)=>t.reduce((t,r)=>[...t,{domain:e,type:r}],[]),t.getDomainsIconsToBeFetched=(e,r)=>e.reduce((e,a)=>[...e,...(0,t.getDomainIconsToBeFetched)(a,r)],[]),t.makeIconDataWithDomain=(e,t)=>{let r=(0,a.head)(e)||{};return{urls:(0,o.computeIconUrls)(e,t),backgroundColor:n(r.backgroundColor),mainColor:n(r.mainColor),domain:n(r.domain)}},t.formatFetchedIcons=(e,r,a)=>{let o=r.length;return[...Array(a)].reduce((a,n,i)=>{let s=i*o,c=e.slice(s,s+o);return[...a,(0,t.makeIconDataWithDomain)(c,r)]},[])}},57743:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.IconsWS=void 0;let a=r(64654),o=r(5552);t.IconsWS=class{constructor(e){this.wsService=e}async getIcons(e,t){if(!e||!e.length)return[];let r=(0,a.getDomainsIconsToBeFetched)(e,t),n=await this.wsService.iconCrawler.getIcons(r);if(!(0,o.isWSResponseSuccess)(n))throw Error(`[Icons] getIcons: ${n.message}(statusCode: ${n.code})`);let{content:i}=n;return(0,a.formatFetchedIcons)(i,t,e.length)}}},40631:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.getIcon=void 0;let a=r(12857),o=r(59587);t.getIcon=e=>t=>{let r=new a.ParsedURL(t).getRootDomain();if(!r)return;let n=(0,o.computeHashMD5)(r);return e.get(n)}},24432:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.iconsSelector=t.iconsCacheSelector=void 0,t.iconsCacheSelector=e=>e.userSession.iconsCache,t.iconsSelector=e=>(0,t.iconsCacheSelector)(e).domains},56266:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.setupSubscriptions=void 0;let a=r(37313),o=r(98770),n=async()=>{let e=(0,a.getInstance)(),t=(0,o.getInstance)(),r=t.lockTopic("iconsUpdates");await e.add("iconsUpdates",{type:"refresh"}),t.releaseTopic("iconsUpdates",r)};t.setupSubscriptions=function(e,t){e.syncSuccess.on(async()=>{await n()}),e.syncFailure.on(async()=>{await n()})}},34622:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.config=void 0;let a=r(3956);t.config={commands:{addDriverLicense:{handler:a.addDriverLicenseHandler},editDriverLicense:{handler:a.editDriverLicenseHandler}},queries:void 0,liveQueries:void 0}},2350:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.addDriverLicenseHandler=void 0;let a=r(20648),o=r(36190),n=r(77247),i=({expirationDate:e,idNumber:t,issueDate:r,name:n,state:i})=>({DateOfBirth:"",DeliveryDate:(0,o.viewDateToVaultDate)(r),ExpireDate:(0,o.viewDateToVaultDate)(e),Fullname:n??"",LinkedIdentity:"",Number:t??"",kwType:a.DataModelType.KWDriverLicence,State:i??"",Sex:""});t.addDriverLicenseHandler=(e,t)=>(0,n.addIdHandler)(e,t,i)},74931:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.editDriverLicenseHandler=t.handleDriverLicenseFields=void 0;let a=r(49386),o=r(36190),n=r(1793);t.handleDriverLicenseFields=(e,t)=>({DeliveryDate:void 0===e.issueDate?t.DeliveryDate:(0,o.viewDateToVaultDate)(e.issueDate),ExpireDate:void 0===e.expirationDate?t.ExpireDate:(0,o.viewDateToVaultDate)(e.expirationDate),Fullname:e.name??t.Fullname,Number:e.idNumber??t.Number,State:e.state??t.State,LinkedIdentity:void 0===e.name?t.LinkedIdentity:"",Attachments:void 0===e.attachments?t.Attachments:e.attachments}),t.editDriverLicenseHandler=(e,r)=>(0,n.updateIdHandler)(e,r,t.handleDriverLicenseFields,a.driverLicenseSelector)},3956:function(e,t,r){var a=this&&this.__createBinding||(Object.create?function(e,t,r,a){void 0===a&&(a=r);var o=Object.getOwnPropertyDescriptor(t,r);(!o||("get"in o?!t.__esModule:o.writable||o.configurable))&&(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,a,o)}:function(e,t,r,a){void 0===a&&(a=r),e[a]=t[r]}),o=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||a(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),o(r(2350),t),o(r(74931),t)},4276:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.getDriverLicenseMappers=void 0;let a=r(15074),o=r(36190);t.getDriverLicenseMappers=()=>({spaceId:e=>e.SpaceId,name:e=>(0,o.identityToName)(e.identity)||e.Fullname,idNumber:e=>e.Number,lastUse:a.lastUseMapper,id:e=>e.Id,creationDate:e=>e.CreationDatetime})},85674:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.driverLicenseMatch=t.searchGetters=void 0;let a=r(23674),o=r(92595),n=r(36190);t.searchGetters=[(0,o.stringProp)("Number"),e=>(0,n.identityToName)(e.identity)||e.Fullname],t.driverLicenseMatch=(0,a.match)(t.searchGetters)},49386:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.queryDriverLicensesSelector=t.driverLicenseWithIdentitySelector=t.driverLicenseSelector=t.driverLicensesSelector=void 0;let a=r(49548),o=r(85674),n=r(7299),i=r(24445),s=r(4276),c=r(71156),l=r(38728),u=r(49705);t.driverLicensesSelector=(0,a.createSelector)(e=>e.userSession.personalData.driverLicenses,u.quarantinedSpacesSelector,l.filterOutQuarantinedItems),t.driverLicenseSelector=(e,r)=>{let a=(0,t.driverLicensesSelector)(e);return(0,i.findDataModelObject)(r,a)};let d=(0,a.createSelector)([t.driverLicensesSelector,c.identitiesByIdSelector],(e,t)=>e.map(e=>({...e,identity:t[e.LinkedIdentity]})));t.driverLicenseWithIdentitySelector=(0,a.createSelector)([t.driverLicenseSelector,e=>(0,c.identitiesByIdSelector)(e)],(e,t)=>({...e,identity:t[e.LinkedIdentity]})),t.queryDriverLicensesSelector=(0,n.getQuerySelector)(d,()=>o.driverLicenseMatch,e=>(0,s.getDriverLicenseMappers)())},52237:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.config=void 0;let a=r(63171);t.config={commands:{addFiscalId:{handler:a.addFiscalIdHandler},editFiscalId:{handler:a.editFiscalIdHandler}},queries:void 0,liveQueries:void 0}},48618:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.addFiscalIdHandler=void 0;let a=r(20648),o=r(77247),n=({idNumber:e,teledeclarantNumber:t})=>({FiscalNumber:e??"",kwType:a.DataModelType.KWFiscalStatement,TeledeclarantNumber:t??""});t.addFiscalIdHandler=(e,t)=>(0,o.addIdHandler)(e,t,n)},9744:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.editFiscalIdHandler=t.handleFiscalIdFields=void 0;let a=r(36755),o=r(1793);t.handleFiscalIdFields=(e,t)=>({FiscalNumber:e.idNumber??t.FiscalNumber,TeledeclarantNumber:e.teledeclarantNumber??t.TeledeclarantNumber,Attachments:void 0===e.attachments?t.Attachments:e.attachments}),t.editFiscalIdHandler=(e,r)=>(0,o.updateIdHandler)(e,r,t.handleFiscalIdFields,a.fiscalIdSelector)},63171:function(e,t,r){var a=this&&this.__createBinding||(Object.create?function(e,t,r,a){void 0===a&&(a=r);var o=Object.getOwnPropertyDescriptor(t,r);(!o||("get"in o?!t.__esModule:o.writable||o.configurable))&&(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,a,o)}:function(e,t,r,a){void 0===a&&(a=r),e[a]=t[r]}),o=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||a(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),o(r(48618),t),o(r(9744),t)},64891:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.getFiscalIdMappers=void 0;let a=r(15074);t.getFiscalIdMappers=()=>({spaceId:e=>e.SpaceId,idNumber:e=>e.FiscalNumber,teledeclarantNumber:e=>e.TeledeclarantNumber,lastUse:a.lastUseMapper,id:e=>e.Id,creationDate:e=>e.CreationDatetime})},4358:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.fiscalIdMatch=t.searchGetters=void 0;let a=r(23674),o=r(92595);t.searchGetters=[(0,o.stringProp)("FiscalNumber"),(0,o.stringProp)("TeledeclarantNumber")],t.fiscalIdMatch=(0,a.match)(t.searchGetters)},36755:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.queryFiscalIdsSelector=t.fiscalIdSelector=t.fiscalIdsSelector=void 0;let a=r(49548),o=r(4358),n=r(7299),i=r(24445),s=r(64891),c=r(38728),l=r(49705);t.fiscalIdsSelector=(0,a.createSelector)(e=>e.userSession.personalData.fiscalIds,l.quarantinedSpacesSelector,c.filterOutQuarantinedItems),t.fiscalIdSelector=(e,r)=>{let a=(0,t.fiscalIdsSelector)(e);return(0,i.findDataModelObject)(r,a)},t.queryFiscalIdsSelector=(0,n.getQuerySelector)(t.fiscalIdsSelector,()=>o.fiscalIdMatch,e=>(0,s.getFiscalIdMappers)())},32952:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.config=void 0;let a=r(59418);t.config={commands:{addIdCard:{handler:a.addIdCardHandler},editIdCard:{handler:a.editIdCardHandler}},queries:void 0,liveQueries:void 0}},30151:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.addIdCardHandler=void 0;let a=r(20648),o=r(36190),n=r(77247),i=({expirationDate:e,idNumber:t,issueDate:r,name:n})=>({DateOfBirth:"",DeliveryDate:(0,o.viewDateToVaultDate)(r),ExpireDate:(0,o.viewDateToVaultDate)(e),Fullname:n??"",LinkedIdentity:"",Number:t??"",kwType:a.DataModelType.KWIDCard,Sex:""});t.addIdCardHandler=(e,t)=>(0,n.addIdHandler)(e,t,i)},2057:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.editIdCardHandler=t.handleIdCardFields=void 0;let a=r(8362),o=r(36190),n=r(1793);t.handleIdCardFields=(e,t)=>({DeliveryDate:void 0===e.issueDate?t.DeliveryDate:(0,o.viewDateToVaultDate)(e.issueDate),ExpireDate:void 0===e.expirationDate?t.ExpireDate:(0,o.viewDateToVaultDate)(e.expirationDate),Fullname:e.name??t.Fullname,Number:e.idNumber??t.Number,LinkedIdentity:void 0===e.name?t.LinkedIdentity:"",Attachments:void 0===e.attachments?t.Attachments:e.attachments}),t.editIdCardHandler=(e,r)=>(0,n.updateIdHandler)(e,r,t.handleIdCardFields,a.idCardSelector)},59418:function(e,t,r){var a=this&&this.__createBinding||(Object.create?function(e,t,r,a){void 0===a&&(a=r);var o=Object.getOwnPropertyDescriptor(t,r);(!o||("get"in o?!t.__esModule:o.writable||o.configurable))&&(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,a,o)}:function(e,t,r,a){void 0===a&&(a=r),e[a]=t[r]}),o=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||a(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),o(r(30151),t),o(r(2057),t)},69343:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.getIdCardMappers=void 0;let a=r(15074),o=r(36190);t.getIdCardMappers=()=>({spaceId:e=>e.SpaceId,name:e=>(0,o.identityToName)(e.identity)||e.Fullname,idNumber:e=>e.Number,lastUse:a.lastUseMapper,id:e=>e.Id,creationDate:e=>e.CreationDatetime})},45366:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.idCardMatch=t.searchGetters=void 0;let a=r(23674),o=r(92595),n=r(36190);t.searchGetters=[(0,o.stringProp)("Number"),e=>(0,n.identityToName)(e.identity)||e.Fullname],t.idCardMatch=(0,a.match)(t.searchGetters)},8362:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.queryIdCardsSelector=t.idCardWithIdentitySelector=t.idCardSelector=t.idCardsSelector=void 0;let a=r(49548),o=r(45366),n=r(7299),i=r(24445),s=r(69343),c=r(71156),l=r(38728),u=r(49705);t.idCardsSelector=(0,a.createSelector)(e=>e.userSession.personalData.idCards,u.quarantinedSpacesSelector,l.filterOutQuarantinedItems),t.idCardSelector=(e,r)=>{let a=(0,t.idCardsSelector)(e);return(0,i.findDataModelObject)(r,a)};let d=(0,a.createSelector)([t.idCardsSelector,c.identitiesByIdSelector],(e,t)=>e.map(e=>({...e,identity:t[e.LinkedIdentity]})));t.idCardWithIdentitySelector=(0,a.createSelector)([t.idCardSelector,e=>(0,c.identitiesByIdSelector)(e)],(e,t)=>({...e,identity:t[e.LinkedIdentity]})),t.queryIdCardsSelector=(0,n.getQuerySelector)(d,()=>o.idCardMatch,e=>(0,s.getIdCardMappers)())},2725:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.config=void 0;let a=r(30522);t.config={commands:{addPassport:{handler:a.addPassportHandler},editPassport:{handler:a.editPassportHandler}},queries:void 0,liveQueries:void 0}},12194:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.addPassportHandler=void 0;let a=r(20648),o=r(36190),n=r(77247),i=({expirationDate:e,idNumber:t,issueDate:r,name:n,deliveryPlace:i})=>({DateOfBirth:"",DeliveryDate:(0,o.viewDateToVaultDate)(r),ExpireDate:(0,o.viewDateToVaultDate)(e),Fullname:n??"",LinkedIdentity:"",Number:t??"",kwType:a.DataModelType.KWPassport,DeliveryPlace:i??"",Sex:""});t.addPassportHandler=(e,t)=>(0,n.addIdHandler)(e,t,i)},76416:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.editPassportHandler=t.handlePassportFields=void 0;let a=r(92558),o=r(36190),n=r(1793);t.handlePassportFields=(e,t)=>({DeliveryDate:void 0===e.issueDate?t.DeliveryDate:(0,o.viewDateToVaultDate)(e.issueDate),ExpireDate:void 0===e.expirationDate?t.ExpireDate:(0,o.viewDateToVaultDate)(e.expirationDate),Fullname:e.name??t.Fullname,Number:e.idNumber??t.Number,DeliveryPlace:e.deliveryPlace??t.DeliveryPlace,LinkedIdentity:void 0===e.name?t.LinkedIdentity:"",Attachments:void 0===e.attachments?t.Attachments:e.attachments}),t.editPassportHandler=(e,r)=>(0,n.updateIdHandler)(e,r,t.handlePassportFields,a.passportSelector)},30522:function(e,t,r){var a=this&&this.__createBinding||(Object.create?function(e,t,r,a){void 0===a&&(a=r);var o=Object.getOwnPropertyDescriptor(t,r);(!o||("get"in o?!t.__esModule:o.writable||o.configurable))&&(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,a,o)}:function(e,t,r,a){void 0===a&&(a=r),e[a]=t[r]}),o=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||a(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),o(r(12194),t),o(r(76416),t)},21433:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.getPassportMappers=void 0;let a=r(15074),o=r(36190);t.getPassportMappers=()=>({spaceId:e=>e.SpaceId,name:e=>(0,o.identityToName)(e.identity)||e.Fullname,idNumber:e=>e.Number,lastUse:a.lastUseMapper,id:e=>e.Id,creationDate:e=>e.CreationDatetime})},55957:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.passportMatch=t.searchGetters=void 0;let a=r(23674),o=r(92595),n=r(36190);t.searchGetters=[(0,o.stringProp)("Number"),e=>(0,n.identityToName)(e.identity)||e.Fullname],t.passportMatch=(0,a.match)(t.searchGetters)},92558:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.queryPassportsWithIdentitySelector=t.passportMappersSelector=t.passportWithIdentitySelector=t.passportSelector=t.passportsSelector=void 0;let a=r(49548),o=r(55957),n=r(7299),i=r(24445),s=r(21433),c=r(71156),l=r(38728),u=r(49705);t.passportsSelector=(0,a.createSelector)(e=>e.userSession.personalData.passports,u.quarantinedSpacesSelector,l.filterOutQuarantinedItems),t.passportSelector=(e,r)=>{let a=(0,t.passportsSelector)(e);return(0,i.findDataModelObject)(r,a)};let d=(0,a.createSelector)([t.passportsSelector,c.identitiesByIdSelector],(e,t)=>e.map(e=>({...e,identity:t[e.LinkedIdentity]})));t.passportWithIdentitySelector=(0,a.createSelector)([t.passportSelector,e=>(0,c.identitiesByIdSelector)(e)],(e,t)=>({...e,identity:t[e.LinkedIdentity]})),t.passportMappersSelector=e=>(0,s.getPassportMappers)(),t.queryPassportsWithIdentitySelector=(0,n.getQuerySelector)(d,()=>o.passportMatch,t.passportMappersSelector)},47847:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.config=void 0;let a=r(3447);t.config={commands:{addSocialSecurityId:{handler:a.addSocialSecurityIdHandler},editSocialSecurityId:{handler:a.editSocialSecurityIdHandler}},queries:void 0,liveQueries:void 0}},62103:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.addSocialSecurityIdHandler=void 0;let a=r(20648),o=r(77247),n=e=>({DateOfBirth:"",LinkedIdentity:"",SocialSecurityFullname:e.name??"",SocialSecurityNumber:e.idNumber??"",kwType:a.DataModelType.KWSocialSecurityStatement,Sex:""});t.addSocialSecurityIdHandler=(e,t)=>(0,o.addIdHandler)(e,t,n)},85646:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.editSocialSecurityIdHandler=t.handleSocialSecurityIdFields=void 0;let a=r(31002),o=r(1793);t.handleSocialSecurityIdFields=(e,t)=>({SocialSecurityFullname:e.name??t.SocialSecurityFullname,SocialSecurityNumber:e.idNumber??t.SocialSecurityNumber,LinkedIdentity:void 0===e.name?t.LinkedIdentity:"",Attachments:void 0===e.attachments?t.Attachments:e.attachments}),t.editSocialSecurityIdHandler=(e,r)=>(0,o.updateIdHandler)(e,r,t.handleSocialSecurityIdFields,a.socialSecurityIdSelector)},3447:function(e,t,r){var a=this&&this.__createBinding||(Object.create?function(e,t,r,a){void 0===a&&(a=r);var o=Object.getOwnPropertyDescriptor(t,r);(!o||("get"in o?!t.__esModule:o.writable||o.configurable))&&(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,a,o)}:function(e,t,r,a){void 0===a&&(a=r),e[a]=t[r]}),o=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||a(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),o(r(62103),t),o(r(85646),t)},35264:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.getSocialSecurityIdMappers=void 0;let a=r(15074),o=r(36190);t.getSocialSecurityIdMappers=()=>({spaceId:e=>e.SpaceId,name:e=>(0,o.identityToName)(e.identity)||e.SocialSecurityFullname,idNumber:e=>e.SocialSecurityNumber,lastUse:a.lastUseMapper,id:e=>e.Id,creationDate:e=>e.CreationDatetime})},60301:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.socialSecurityIdMatch=t.searchGetters=void 0;let a=r(23674),o=r(92595),n=r(36190);t.searchGetters=[(0,o.stringProp)("SocialSecurityNumber"),e=>(0,n.identityToName)(e.identity)||e.SocialSecurityFullname],t.socialSecurityIdMatch=(0,a.match)(t.searchGetters)},31002:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.querySocialSecurityIdsSelector=t.socialSecurityIdWithIdentitySelector=t.socialSecurityIdSelector=t.socialSecurityIdsSelector=void 0;let a=r(49548),o=r(60301),n=r(7299),i=r(24445),s=r(35264),c=r(71156),l=r(49705),u=r(38728);t.socialSecurityIdsSelector=(0,a.createSelector)(e=>e.userSession.personalData.socialSecurityIds,l.quarantinedSpacesSelector,u.filterOutQuarantinedItems),t.socialSecurityIdSelector=(e,r)=>{let a=(0,t.socialSecurityIdsSelector)(e);return(0,i.findDataModelObject)(r,a)};let d=(0,a.createSelector)([t.socialSecurityIdsSelector,c.identitiesByIdSelector],(e,t)=>e.map(e=>({...e,identity:t[e.LinkedIdentity]})));t.socialSecurityIdWithIdentitySelector=(0,a.createSelector)([t.socialSecurityIdSelector,e=>(0,c.identitiesByIdSelector)(e)],(e,t)=>({...e,identity:t[e.LinkedIdentity]})),t.querySocialSecurityIdsSelector=(0,n.getQuerySelector)(d,()=>o.socialSecurityIdMatch,e=>(0,s.getSocialSecurityIdMappers)())},77247:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.addIdHandler=void 0;let a=r(83533),o=r(20648),n=r(17620),i=r(92830),s=r(67179),c=r(61681),l=r(22560),u=r(80896),d=r(4803),p=r(36190),S=r(18049),g=async({sessionService:e,storeService:t,eventLoggerService:r},g,m)=>{if(""===g.idNumber)return Promise.resolve({success:!1,error:{code:o.AddIdResultErrorCode.MISSING_ID_NUMBER}});try{let l;if(!t.isAuthenticated())return Promise.resolve({success:!1,error:{code:o.IdErrorCode.NOT_AUTHENTICATED}});let u=(l=(0,d.sanitizeInputPersonalData)(g),{...(({country:e,spaceId:t})=>{let r=(0,s.getUnixTimestamp)();return{CreationDatetime:r,Id:(0,c.generateItemUuid)(),LastBackupTime:0,LocaleFormat:(0,p.viewCountryToVaultCountry)(e),SpaceId:t,UserModificationDatetime:r}})(l),...m(l)});if(!u.SpaceId){let e=await (0,n.getDefaultSpaceId)(t);u.SpaceId=e}return t.dispatch((0,i.savePersonalDataItem)(u,u.kwType)),e.getInstance().user.persistPersonalData(),(0,n.getDebounceSync)(t,e)({immediateCall:!0},a.Trigger.Save),(0,S.logAddVaultItem)(t,r,u),Promise.resolve({success:!0,id:u.Id})}catch(t){let e=Error(`[IDs] - addIdHandler: ${t}`);return(0,u.sendExceptionLog)({error:e}),(0,l.logError)(e),Promise.resolve({success:!1,error:{code:o.IdErrorCode.INTERNAL_ERROR}})}};t.addIdHandler=g},1793:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.updateIdHandler=void 0;let a=r(83533),o=r(20648),n=r(17620),i=r(92830),s=r(67179),c=r(22560),l=r(80896),u=r(4803),d=r(36190),p=r(18049);t.updateIdHandler=({sessionService:e,storeService:t,eventLoggerService:r},S,g,m)=>{if(""===S.idNumber)return Promise.resolve({success:!1,error:{code:o.UpdateIdResultErrorCode.MISSING_ID_NUMBER}});try{if(!t.isAuthenticated())return Promise.resolve({success:!1,error:{code:o.IdErrorCode.NOT_AUTHENTICATED}});let c=t.getState(),l=(0,u.sanitizeInputPersonalData)(S),y=m(c,S.id);if(!y)return Promise.resolve({success:!1,error:{code:o.IdErrorCode.NOT_FOUND}});let f={...y,...{...(({country:e,spaceId:t},r)=>({SpaceId:t??r.SpaceId,LocaleFormat:void 0===e?r.LocaleFormat:(0,d.viewCountryToVaultCountry)(e)}))(l,y),...g(l,y)},UserModificationDatetime:(0,s.getUnixTimestamp)()},E=f.kwType;t.dispatch((0,i.savePersonalDataItem)(f,E)),e.getInstance().user.persistPersonalData(),(0,n.getDebounceSync)(t,e)({immediateCall:!0},a.Trigger.Save);let A=m(c,S.id);return(0,p.logEditVaultItem)(t,r,f,A),Promise.resolve({success:!0})}catch(t){let e=Error(`[IDs] - updateIdHandler: ${t}`);return(0,l.sendExceptionLog)({error:e}),(0,c.logError)(e),Promise.resolve({success:!1,error:{code:o.IdErrorCode.INTERNAL_ERROR}})}}},36190:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.identityToName=t.viewCountryToVaultCountry=t.vaultCountryToViewCountry=t.vaultDateToViewDate=t.viewDateToVaultDate=t.epochToDate=t.ZERO_INDEX_BASED_MONTH_OFFSET=void 0;let a=r(20648);t.ZERO_INDEX_BASED_MONTH_OFFSET=1,t.epochToDate=e=>new Date(1e3*e);let o=e=>{let r=(0,t.epochToDate)(e);return`${r.getUTCFullYear()}-${r.getUTCMonth()+1}-${r.getUTCDate()}`},n=e=>{if(!e)return 0;let[t,r,a]=e.split(/[-/]/).map(e=>Number.parseInt(e,10)),o=new Date;return o.setUTCHours(0,0,0,0),Math.floor(o.setUTCFullYear(t,r-1,a)/1e3)};t.viewDateToVaultDate=e=>null===e?"":o(e),t.vaultDateToViewDate=e=>{if(!e)return null;let t=n(e);return Number.isNaN(t)?null:t},t.vaultCountryToViewCountry=e=>{let t=a.Country[e];return void 0===t||t===a.Country.NO_TYPE?a.Country.UNIVERSAL:t},t.viewCountryToVaultCountry=t.vaultCountryToViewCountry,t.identityToName=e=>e?[e.FirstName,e.MiddleName,e.LastName,e.LastName2].filter(Boolean).join(" "):""},32826:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.importApiConfig=void 0;let a=r(28168),o=r(13),n=r(47845),i=r(34058),s=r(40976);t.importApiConfig={commands:{importPersonalData:{handler:n.importPersonalDataHandler},previewPersonalData:{handler:i.previewPersonalDataHandler},dismissPersonalDataImportNotifications:{handler:s.dismissDataImportHandler}},queries:{getImportPersonalDataStatus:{selector:o.importPersonalDataStateSelector}},liveQueries:{liveImportPersonalDataStatus:{operator:a.importPersonalDataState$}}}},40976:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.dismissDataImportHandler=t.dismissDataImport=void 0;let a=r(20648),o=r(85101),n=async e=>{await e.waitReady(),e.onNewState({status:a.ImportPersonalDataStateType.Idle})};t.dismissDataImport=n,t.dismissDataImportHandler=e=>(0,t.dismissDataImport)((0,o.makeImportService)(e))},47845:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.importPersonalDataHandler=t.importPersonalData=void 0;let a=r(20648),o=r(22560),n=r(80896),i=r(85101),s=async(e,t)=>{try{e.onNewState({status:a.ImportPersonalDataStateType.Processing,name:t.name});let r=t.content;return(async()=>{try{let o=await e.importPersonalDataItems(r);e.onNewState({status:a.ImportPersonalDataStateType.Success,name:t.name,totalCount:o.totalCount,successCount:o.successCount,duplicateCount:o.duplicateCount})}catch(s){let r=`[import] - importError: ${s}`,i=Error(r);(0,n.sendExceptionLog)({error:i}),(0,o.logError)(i),e.onNewState({status:a.ImportPersonalDataStateType.Error,name:t.name})}})(),{success:!0}}catch(i){let r=Error(`[import] - formatError: ${i}`);return(0,n.sendExceptionLog)({error:r}),(0,o.logError)(r),e.onNewState({status:a.ImportPersonalDataStateType.Error,name:t.name}),{success:!1,error:a.ImportPersonalDataErrorType.Unknown}}};t.importPersonalData=s,t.importPersonalDataHandler=(e,r)=>(0,t.importPersonalData)((0,i.makeImportService)(e),r)},34058:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.previewPersonalDataHandler=t.previewPersonalData=void 0;let a=r(20648),o=r(85101),n=async(e,t)=>{if(!e.canDoImport())return{success:!1,error:a.PreviewPersonalDataErrorType.Unavailable};try{return await e.previewPersonalDataArchive(t)}catch(e){return{success:!1,error:a.PreviewPersonalDataErrorType.InvalidFormat}}};t.previewPersonalData=n,t.previewPersonalDataHandler=(e,r)=>{let a=(0,o.makeImportService)(e);return(0,t.previewPersonalData)(a,r)}},28168:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.importPersonalDataState$=void 0;let a=r(95121),o=r(15237),n=r(13);t.importPersonalDataState$=()=>(0,a.pipe)((0,o.map)(n.importPersonalDataStateSelector,(0,o.distinctUntilChanged)()))},13:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.isImportPersonalDataAvailableSelector=t.importPersonalDataStateSelector=void 0;let a=r(20648),o=r(65356);t.importPersonalDataStateSelector=e=>e.userSession.importPersonalData.state??{status:a.ImportPersonalDataStateType.Idle},t.isImportPersonalDataAvailableSelector=e=>!(0,o.changeMPinProgressSelector)(e)&&(0,t.importPersonalDataStateSelector)(e).status!==a.ImportPersonalDataStateType.Processing},89231:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.getUniqueVaultItemIdentifier=void 0;let a=r(25903),o={Attachments:!1},n={...o,Title:!0,Email:!0,Login:!0,SecondaryLogin:!0,Password:!0,Strength:!1,Note:!0,Checked:!1,Status:!1,SharedObject:!1,ModificationDatetime:!1,Category:!1,Url:!0,UserSelectedUrl:!1,UseFixedUrl:!1,TrustedUrlGroup:!1,NumberUse:!1,AutoLogin:!1,AutoProtected:!1,SubdomainOnly:!1,Type:!1,Server:!1,Port:!1,Alias:!1,SID:!1,ConnectionOptions:!1,domainIcon:!1,limitedPermissions:!1,OtpSecret:!0,OtpUrl:!0,LinkedServices:!1},i={...o,Title:!0,Content:!0,Secured:!1},s={...o,Title:!0,Category:!1,Type:!1,limitedPermissions:!1,Content:!0,Secured:!1,CreationDate:!1,UpdateDate:!1},c={...o,LinkedIdentity:!1,Fullname:!0,Sex:!0,DateOfBirth:!0,Number:!0,ExpireDate:!0,DeliveryDate:!0},l={...o,Email:!0,Type:!1,EmailName:!0},u={...o,Type:!1,Number:!0,NumberNational:!0,NumberInternational:!0,PhoneName:!0,PersonalNote:!0},d={...o,Title:!0,FirstName:!0,MiddleName:!0,LastName:!0,LastName2:!0,Pseudo:!1,BirthDate:!0,BirthPlace:!0},p={...o,Counter:!1,CredentialId:!0,ItemName:!0,KeyAlgorithm:!0,Note:!0,PrivateKey:!0,CloudPasskey:!0,RpId:!0,RpName:!0,UserDisplayName:!0,UserHandle:!0},S={...o,LinkedIdentity:!1,Fullname:!0,Sex:!0,DateOfBirth:!0,Number:!0,ExpireDate:!0,DeliveryDate:!0,DeliveryPlace:!0},g={...o,PersonalNote:!0,Name:!0,Website:!0},m={...o,Number:!0,LinkedIdentity:!1,Fullname:!0,Sex:!0,DateOfBirth:!0,DeliveryDate:!0,ExpireDate:!0,State:!0},y={...o,PersonalNote:!0,Name:!0,JobTitle:!0},f={...o,PersonalNote:!0,State:!0,AddressName:!0,Receiver:!0,AddressFull:!0,City:!0,ZipCode:!0,Country:!0,StreetNumber:!0,StreetTitle:!0,StreetName:!0,StateNumber:!0,StateLevel2:!0,Building:!0,Stairs:!0,Floor:!0,Door:!0,DigitCode:!0,LinkedPhone:!1},E={...o,Name:!0,CardNumber:!0,CardNumberLastDigits:!0,OwnerName:!0,SecurityCode:!0,ExpireMonth:!0,ExpireYear:!0,StartMonth:!0,StartYear:!0,IssueNumber:!0,Color:!1,Bank:!0,CCNote:!0,Type:!1},A={...o,BankAccountName:!0,BankAccountOwner:!0,BankAccountIBAN:!0,BankAccountBIC:!0,BankAccountBank:!0},h=e=>Object.keys(e).filter(t=>!!e[t]),_={KWAddress:h(f),KWAuthentifiant:h(n),KWBankStatement:h(A),KWCollection:h({Attachments:!1,Name:!0,VaultItems:!0}),KWCompany:h(y),KWDataChangeHistory:[],KWDriverLicence:h(m),KWEmail:h(l),KWFiscalStatement:[],KWGeneratedPassword:[],KWIDCard:h(c),KWIdentity:h(d),KWMerchand:[],KWMiscData:[],KWPasskey:h(p),KWPassport:h(S),KWPaymentMean_creditCard:h(E),KWPaymentMean_paypal:[],KWPersonalWebsite:h(g),KWPhone:h(u),KWPurchaseAccount:[],KWPurchaseCategory:[],KWPurchasePaidBasket:[],KWPurchaseTrueArticle:[],KWSecureFileInfo:[],KWSecret:h(i),KWSecureNote:h(s),KWSecurityBreach:[],KWSettingsManagerApp:[],KWSocialSecurityStatement:[],KWWebSite:[]},T=(e,t)=>{let r={};return e.forEach(e=>{r[e]=t[e]??""}),(0,a.isEmpty)(r)?"":JSON.stringify(r)};t.getUniqueVaultItemIdentifier=e=>T(_[e.kwType],e)},53776:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.getImportableItemsFromUserFile=t.getExistingVaultItemUniqueIdentifiers=t.getAllExistingCollections=void 0;let a=r(20648),o=r(35192),n=r(4803),i=r(48140),s=r(77164),c=r(89231),l=r(72393),u=[a.DataModelType.KWAddress,a.DataModelType.KWAuthentifiant,a.DataModelType.KWCompany,a.DataModelType.KWDriverLicence,a.DataModelType.KWEmail,a.DataModelType.KWIDCard,a.DataModelType.KWIdentity,a.DataModelType.KWPassport,a.DataModelType.KWPaymentMean_creditCard,a.DataModelType.KWPersonalWebsite,a.DataModelType.KWPhone,a.DataModelType.KWSecureNote,a.DataModelType.KWSocialSecurityStatement,a.DataModelType.KWWebSite],d=(e,t)=>e+"_"+t,p=(e,t)=>{for(let r=1;;r++){let a=e+" - "+r,o=!1;if(t.forEach(e=>{e.isShared||e.item?.Name!==a||(o=!0)}),!o)return a}},S="shared";t.getAllExistingCollections=(e,t)=>{let r=new Map;return e.forEach(e=>{r.set(d(e.name,S),{item:null,isShared:!0})}),t.forEach(e=>{r.set(d(e.Name,e.SpaceId),{item:e,isShared:!1})}),r},t.getExistingVaultItemUniqueIdentifiers=e=>{let t=new Set;for(let r of Object.values(Object.entries(e).filter(([e])=>(0,s.isDataKeyVaultItem)(e)).reduce((e,[t,r])=>({...e,[t]:r}),{})))r.forEach(e=>{if((0,a.isDataModelObject)(e)){let r=(0,c.getUniqueVaultItemIdentifier)(e);r&&t.add(r)}});return t};let g=(e,t,r)=>{r&&t?e.SpaceId=r.teamId:e.SpaceId&&(e.SpaceId=r?.teamId??i.PERSONAL_SPACE_ID)},m=async e=>((0,a.isCredential)(e)?e=await (0,l.prepareCredentialForImport)(e):(0,a.isNote)(e)&&(e=(0,l.prepareSecureNoteForImport)(e)),e),y=async(e,t,r,i)=>{let{storeService:s}=e,{spaces:y}=s.getSpaceData(),f=s.getState(),E=!(0,o.isPersonalSpaceEnabledSelector)(f),A=y.find(e=>e.details.status===a.SpaceStatus.Accepted),h=[],_=0,T=0;for(let e of t){if(u.includes(e.kwType))_++;else if("KWSecureNoteCategory"===e.kwType||"KWAuthCategory"===e.kwType)continue;let t=await m((0,n.sanitizeInputPersonalData)((0,l.convertImportable)(e)));if(g(t,E,A),(0,a.isCollection)(t)){let e=h.find(e=>(0,a.isCollection)(e)&&e.SpaceId===t.SpaceId&&e.Name===t.Name);if(e){e.VaultItems=[...e.VaultItems,...t.VaultItems];continue}let r=i.get(d(t.Name,t.SpaceId))||i.get(d(t.Name,S));if(r&&!r.isShared){let e={...t,Id:r.item.Id,VaultItems:[...t.VaultItems,...r.item.VaultItems]};h.push(e);continue}if(r?.isShared){t.Name=p(t.Name,i),h.push(t);continue}}(0,a.isCollection)(t)||!r.has((0,c.getUniqueVaultItemIdentifier)(t))?h.push(t):T++}return{itemsToImport:h,importableItemCount:_,duplicateItemCount:T}};t.getImportableItemsFromUserFile=y},53420:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.importPersonalDataItems=void 0;let a=r(20648),o=r(83533),n=r(76369),i=r(54286),s=r(17620),c=r(72393),l=r(53776),u=async(e,t)=>{let{storeService:r,sessionService:u,localStorageService:d,applicationModulesAccess:p}=e,S=r.getState(),g=(0,s.getDebounceSync)(r,u),m=0,y=0,f=(0,l.getExistingVaultItemUniqueIdentifiers)(S.userSession.personalData),{itemsToImport:E,importableItemCount:A,duplicateItemCount:h}=await (0,l.getImportableItemsFromUserFile)(e,t,f,(0,l.getAllExistingCollections)(S.userSession.sharingData.collections??[],S.userSession.personalData.collections));for(let[e,t]of(0,c.groupByType)(E).entries()){if((0,c.savePersonalDataItemsForImport)({storeService:r,sessionService:u,localStorageService:d,applicationModulesAccess:p},e,t),e!==a.DataModelType.KWCollection&&(m+=t.length),e===a.DataModelType.KWAuthentifiant){let e=(0,n.currentTeamIdSelector)(S);(y=t.filter(t=>t.SpaceId===e).length)>=1&&await (0,i.computeAndSendCSVImportActivityLog)(p,{domainUrl:null,importCount:y})}e===a.DataModelType.KWCollection&&t.forEach(e=>{e?.SpaceId&&(0,i.computeAndSendCollectionImportActivityLog)(p,{collectionName:e?.Name,itemCount:e?.VaultItems.length}).catch(()=>{})})}return g({immediateCall:!0},o.Trigger.Save),{successCount:m,totalCount:A,duplicateCount:h}};t.importPersonalDataItems=u},72393:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.savePersonalDataItemsForImport=t.groupByType=t.prepareSecureNoteForImport=t.prepareCredentialForImport=t.convertImportable=void 0;let a=r(20648),o=r(19298),n=r(92830),i=r(29509),s=r(3313),c=r(45657),l=r(67179),u=r(2901),d=r(61681),p=r(27012),S=r(80896);t.convertImportable=e=>({...e,Id:e.Id?e.Id:(0,d.generateItemUuid)(),SpaceId:e.SpaceId??"",LocaleFormat:e.LocaleFormat??a.Country.UNIVERSAL});let g=async e=>({...e,Strength:e.Password?await (0,u.evaluatePasswordStrength)(e.Password):0});t.prepareCredentialForImport=g,t.prepareSecureNoteForImport=e=>{let t=(0,l.getUnixTimestamp)();return{...e,CreationDatetime:t,LocaleFormat:a.Country.US,UserModificationDatetime:t,LastBackupTime:0,Title:e.Title??`Untitled - ${t.toLocaleString()}`,Content:e.Content??"",Secured:e.Secured??!1,Type:a.NoteTypes.includes(e.Type)?e.Type:"GRAY",Attachments:e.Attachments??[]}},t.groupByType=e=>{let t=new Map;for(let r of e){let e=t.get(r.kwType);e?e.push(r):t.set(r.kwType,[r])}return t};let m=async(e,t)=>{if(t.length)try{let{commands:r}=e.createClients().vaultItemsCrud;await r.emitTemporaryVaultItemEvent({ids:[...t],eventType:o.EventType.Created}),p.carbonEventHooks.iconsUpdates({type:"credentialUpdates",credentialIds:t})}catch(t){let e=Error(`Failed to handle health & credential health updates with ${t}`);(0,S.sendExceptionLog)({error:e});return}};t.savePersonalDataItemsForImport=({storeService:e,sessionService:t,applicationModulesAccess:r},o,l)=>{if(!l.length)return;let u=e.getPersonalData(),d=l.reduce((t,r)=>{let o=null;return(0,s.isChangeHistoryCandidate)(r)&&(o=(0,s.getUpdatedItemChangeHistory)({deviceName:e.getLocalSettings().deviceName??"",personalData:u,change:(0,c.makeUpdateChange)(r),userLogin:e.getUserLogin(),platformInfo:(0,i.platformInfoSelector)(e.getState())})),{changeHistories:[...t.changeHistories,...o?[o]:[]],credentialIds:[...t.credentialIds,...(0,a.isCredential)(r)?[r.Id]:[]]}},{changeHistories:[],credentialIds:[]});e.dispatch((0,n.savePersonalDataItems)(l,o,d.changeHistories)),t.getInstance().user.persistPersonalData(),m(r,d.credentialIds)}},85101:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.makeImportService=void 0;let a=r(20648),o=r(29509),n=r(91783),i=r(15237),s=r(28168),c=r(13),l=r(55486),u=r(53420),d=r(8280),p=r(76168),S=async(e,t)=>{let r=(0,o.platformInfoSelector)(e.getState());switch(t.format){case a.ImportFormats.Csv:{let e=(0,d.getImportablePersonalData)(t.content,a.Country[r.country]);if(0===e.items.length)return{success:!1,error:a.PreviewPersonalDataErrorType.InvalidFormat};return{success:!0,data:{items:e.items,headers:e.headers}}}case a.ImportFormats.Dash:{let r=(0,p.parseDashData)(t.content.data);if(!await (0,p.checkPassword)(e,r,t.password))return{success:!1,error:a.PreviewPersonalDataErrorType.BadPassword};return{success:!0,data:{items:(await (0,p.getSaveEventsFromDash)(e,r,t.password)).map(e=>({baseDataModel:e,rawData:{}})),headers:[]}}}}(0,n.assertUnreachable)(t)};t.makeImportService=e=>{let{storeService:t}=e;return{previewPersonalDataArchive:e=>S(t,e),canDoImport:()=>(0,c.isImportPersonalDataAvailableSelector)(t.getState()),importPersonalDataItems:t=>(0,u.importPersonalDataItems)(e,t),onNewState:e=>t.dispatch((0,l.notifyNewImportPersonalDataStateAction)(e)),waitReady:async()=>{await (0,s.importPersonalDataState$)()(t.getState$()).pipe((0,i.first)(e=>e.status!==a.ImportPersonalDataStateType.Processing)).toPromise()}}}},48288:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.getFieldLevelProcessor=void 0;let a=r(20648),o=r(41758),n=(e,t)=>"title"===e?null:t,i=(e,t)=>{switch(e){case"reprompt":if("0"===t)return null;break;case"name":if("--"===t)return null;break;case"type":return null}return t};t.getFieldLevelProcessor=e=>{switch(e){case a.ImportSource.Safari:return n;case a.ImportSource.Bitwarden:return i;case a.ImportSource.Lastpass:return o.fieldProcessorForLastPass;default:return null}}},87417:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.getItemTypeProcessor=void 0;let a=r(20648),o=r(41758);t.getItemTypeProcessor=e=>e===a.ImportSource.Lastpass?o.itemTypeProcessorForLastPass:null},65598:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.parseCustomKeeperCredentialData=t.getKeeperImportHeaders=void 0,t.getKeeperImportHeaders=e=>{let t=["Folder","Title","Login","Password","Website Address","Notes","Shared Folder"],r=Math.max(0,e-t.length);return r&&t.push(...[...Array(r).keys()].map((e,t)=>`Custom ${t+1}`)),t},t.parseCustomKeeperCredentialData=(e,t)=>{Object.keys(e).forEach(r=>{let a=e[r];"TFC:Keeper"===a?delete e[r]:"string"==typeof a&&a.startsWith("otpauth://")&&(t.OtpUrl=a,delete e[r])})}},41758:function(e,t,r){var a,o,n,i,s;Object.defineProperty(t,"__esModule",{value:!0}),t.fieldProcessorForLastPass=t.itemTypeProcessorForLastPass=t.processAndPushLastPassNote=t.parseLastPassSecureNote=t.LPNoteTypeField=t.LastPassNoteType=t.LAST_PASS_SECURE_NOTE_URL=void 0;let c=r(60974),l=r(20648),u=r(10705),d=r(84816);t.LAST_PASS_SECURE_NOTE_URL="http://sn",(n=t.LastPassNoteType||(t.LastPassNoteType={})).BankAccountType="Bank Account",n.PaymentCardType="Credit Card",t.LPNoteTypeField={NoteType:"NoteType"},(i=a||(a={})).BankName="Bank Name",i.AccountType="Account Type",i.RoutingNumber="Routing Number",i.AccountNumber="Account Number",i.SWIFTCode="SWIFT Code",i.IBANNumber="IBAN Number",i.Pin="Pin",i.BranchAddress="Branch Address",i.BranchPhone="BranchPhone",i.Notes="Notes",(s=o||(o={})).NameOnCard="Name on Card",s.Type="Type",s.Number="Number",s.SecurityCode="Security Code",s.StartDate="Start Date",s.ExpirationDate="Expiration Date",s.Notes="Notes",s.Language="Language",t.parseLastPassSecureNote=e=>{let r={};try{switch(e.split("\n").forEach(e=>{let[t,a]=e.split(":");r[t]=a}),r.NoteType){case"Bank Account":{let e={BankAccountName:r["Bank Name"],BankAccountOwner:"",BankAccountIBAN:r["IBAN Number"]?r["IBAN Number"]:r["Account Number"],BankAccountBIC:r["SWIFT Code"]?r["SWIFT Code"]:r["Routing Number"],BankAccountBank:"",kwType:l.DataModelType.KWBankStatement};return{type:"Bank Account",data:e}}case"Credit Card":{let e,a;let o=r["Expiration Date"];if(o){let[t,r]=o.split(",");e=(e=`${(0,c.getMonth)(new Date(`${t} 1`))+1}`).length<=2?e:"",a=4!==r.length||isNaN(r)?"":r}let n={CardNumber:r.Number,OwnerName:r["Name on Card"],SecurityCode:r["Security Code"],ExpireMonth:e,ExpireYear:a,CCNote:r.Notes,kwType:l.DataModelType.KWPaymentMean_creditCard};delete r[t.LPNoteTypeField.NoteType],delete r["Expiration Date"],delete r.Language,r["Payment Type"]=r.Type,delete r[t.LPNoteTypeField.NoteType];let i=Object.keys(n),s=Object.values(n);return Object.keys(r).forEach(e=>{(i.includes(e)||s.includes(r[e]))&&delete r[e]}),{type:"Credit Card",data:{...r,...n}}}default:return null}}catch{return null}},t.processAndPushLastPassNote=(e,r,a,o,n)=>{if(e.url?.includes(t.LAST_PASS_SECURE_NOTE_URL)){delete e.url;let i=(0,t.parseLastPassSecureNote)(e.extra),s=i?.type==="Bank Account"?u.BANK_ACCOUNT_HEADERS:i?.type==="Credit Card"?u.PAYMENT_CARD_HEADERS:u.SECURE_NOTES_HEADERS;switch(Object.keys(i?.data??{}).forEach(e=>{let t=Object.keys(s).find(t=>s[t].has(e.toLocaleLowerCase()));!n.has(e)&&e&&n.set(e,{original:e,matched:t??""})}),i?.type){case"Bank Account":{let t={baseDataModel:(0,d.buildBankAccountObj)(i.data,r,n),rawData:e};o.bankAccounts.push(t);return}case"Credit Card":{let t={baseDataModel:(0,d.buildPaymentCardObj)(i.data,r,n,a),rawData:e};o.paymentCards.push(t);return}default:{let t={baseDataModel:(0,d.buildNoteObj)(e,r,n),rawData:e};o.notes.push(t);return}}}},t.itemTypeProcessorForLastPass=e=>{if(e.url?.includes(t.LAST_PASS_SECURE_NOTE_URL)){let r=e.extra.split("\n"),a="";for(let e=0;e<r.length;e++){let[o,n]=r[e]?r[e].split(":"):[];o===t.LPNoteTypeField.NoteType&&(a=n)}switch(a){case"Bank Account":return l.SupportedVaultTypes.BANK_ACCOUNT;case"Credit Card":return l.SupportedVaultTypes.PAYMENT_CARD;default:return l.SupportedVaultTypes.NOTE}}return null},t.fieldProcessorForLastPass=(e,t)=>{switch(e){case"fav":if(!t||t.includes("0"))return null;break;case"grouping":if(!t||t.includes("(none)"))return null}return t}},8280:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.getImportablePersonalData=t.parseCSV=void 0;let a=r(20648),o=r(12857),n=r(65598),i=r(41758),s=r(84816),c=r(34457);function l(e,t,r){t===a.ImportSource["1Password"]&&(e.Category=e.Category.replaceAll(";",",")),e.Category.split(",").forEach(t=>{let a=r.collections.find(e=>e.baseDataModel.Name===t);a||(a={baseDataModel:(0,c.getNewCollection)({name:t,vaultItems:[],spaceId:""}),rawData:{}},r.collections.push(a)),a.baseDataModel.VaultItems.push({Id:e.Id,Type:e.kwType})})}let u=/^otpauth:\/\/.*/,d=(e,t,r,n)=>{let c={credentials:[],notes:[],bankAccounts:[],paymentCards:[],collections:[]},d=new Map;for(let p=0;p<e.length;p++){let S=e[p].reduce((e,r,a)=>(e[t[a]]=r,e),{}),g=(0,s.determineBestItemType)(S,r),m=(0,s.getHeadersAndIndexMap)(t,g),y=new Map;if(m.forEach(e=>{d.has(e.original)&&(d.get(e.original)?.matched||!e.matched)||d.set(e.original,e),e.matched&&y.set(e.original,e)}),[a.SupportedVaultTypes.BANK_ACCOUNT,a.SupportedVaultTypes.NOTE,a.SupportedVaultTypes.PAYMENT_CARD].includes(g)&&r===a.ImportSource.Lastpass){(0,i.processAndPushLastPassNote)(S,r,n,c,y);continue}switch(g){case a.SupportedVaultTypes.CREDENTIAL:!function(e,t,r,a,n){let i={baseDataModel:(0,s.buildCredentialObj)(e,t,r,a),rawData:e};i.baseDataModel.Category&&l(i.baseDataModel,t,n),i.baseDataModel.OtpUrl&&!u.test(i.baseDataModel.OtpUrl)&&(i.baseDataModel.OtpUrl="otpauth://totp/?secret="+i.baseDataModel.OtpUrl);let c=new o.ParsedURL(i.baseDataModel.Url);i.baseDataModel.Url&&c.isUrlValid()&&(i.baseDataModel.Url=c.getPIIStrippedURL()),n.credentials.push(i)}(S,r,y,n,c);break;case a.SupportedVaultTypes.PAYMENT_CARD:!function(e,t,r,a,o){let n={baseDataModel:(0,s.buildPaymentCardObj)(t,e,o,r),rawData:t};a.paymentCards.push(n)}(r,S,n,c,y);break;case a.SupportedVaultTypes.BANK_ACCOUNT:!function(e,t,r,a){let o={baseDataModel:(0,s.buildBankAccountObj)(t,e,a),rawData:t};r.bankAccounts.push(o)}(r,S,c,y);break;case a.SupportedVaultTypes.NOTE:default:!function(e,t,r,a){let o={baseDataModel:(0,s.buildNoteObj)(e,t,r),rawData:e};o.baseDataModel.Category&&l(o.baseDataModel,t,a),a.notes.push(o)}(S,r,y,c)}}return{...c,headers:[...d.values()]}},p=(e,t)=>{let r;let a=/(?=["'])(?:"[^"\\]*(?:\\[\s\S][^"\\]*)*"|'[^'\\]*(?:\\[\s\S][^'\\]*)*')|,,|,\n/gi;for(;r=a.exec(e.trim());){let e=",,"===r[0]?r.index:r.index-1;r.input[e]&&","!==r.input[e]&&t.push([]),",\n"!==r[0]&&t[t.length-1].push(r[0].replace(new RegExp(/","/gi),",").replace(new RegExp(/^"|"$/gi),"").replace(new RegExp(/^,,$/gi),""))}},S=(e,t)=>{let r;let a=/(,|\r?\n|\r|^)(?:"([^"]*(?:""[^"]*)*)"|([^,\r\n]*))/gi;for(;r=a.exec(e.trim());)r[1].length&&","!==r[1]&&t.push([]),t[t.length-1].push(void 0!==r[2]?r[2].replace(RegExp('^"|"$|"(?=,")|(?<=",)"|""',"gi"),'"'):r[3])};function g(e,t,r){let o={credentials:[],notes:[],paymentCards:[],bankAccounts:[],headers:[],collections:[]};if(!e)return o;let{csvHead:i,csvRows:c}=function(e,t){let r=[[]];if(e.startsWith('"')?p(e,r):S(e,r),t===a.ImportSource.Keeper){let e=r.reduce((e,t)=>Math.max(e,t.length),0);r.unshift((0,n.getKeeperImportHeaders)(e))}let[o,...i]=r;return{csvHead:o,csvRows:i}}(e,t),l=i.map(e=>e.toLowerCase());return c.length&&(0,s.areHeadersValid)(l)?d(c,l,t,r):o}t.parseCSV=g,t.getImportablePersonalData=(e,t)=>{let{headers:r,...a}=g(e.data,e.importSource,t);return{headers:r,items:Object.values(a).flat()}}},76168:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.getSaveEventsFromDash=t.getXmlData=t.checkPassword=t.parseDashData=void 0;let a=r(20648),o=r(56886),n=r(33795),i=r(34978),s=r(25434),c=r(56708),l=r(22560),u=r(80896),d=r(61681),p=e=>RegExp(`-+\\s+${e} BEGIN\\s+-+
(.+)
-+\\s+${e} END`);t.parseDashData=e=>{let[t,r]=["Id","Data"].map(p).map(t=>t.exec(e)).map(e=>e?.[1]);return{ids:t?.split(";")??[],encryptedData:r??""}};let S=async(e,t,r)=>{let a=(0,s.makeDataEncryptorService)(e);a.setInstance({raw:r},"");try{return(0,i.deflatedUtf8ToUtf16)(await a.getInstance().decrypt(t.encryptedData)),!0}catch(r){let e=Error(`[import] - checkPassword: ${r}, ${t.encryptedData}`);(0,u.sendExceptionLog)({error:e}),(0,l.logError)(e)}return!1};t.checkPassword=S;let g=async(e,t,r)=>{let a=(0,s.makeDataEncryptorService)(e);a.setInstance({raw:r},"");let o=await a.getInstance().decrypt(t.encryptedData),n=(0,i.deflatedUtf8ToUtf16)(o),l=await (0,c.parseDashlaneXml)(n);return Array.isArray(l)?l:[l]};t.getXmlData=g;let m=async(e,r,i)=>{let s={},c=(await (0,t.getXmlData)(e,r,i)).map(e=>(0,n.fixPersonalDataItemFromExternalSource)((0,o.fixKwType)(e))).map(e=>{let t=(0,d.generateItemUuid)();return s[e.Id]=t,{...e,Id:t}});return c.forEach(e=>{(0,a.isCollection)(e)&&e.VaultItems.forEach(e=>{e.Id=s[e.Id]??e.Id})}),c};t.getSaveEventsFromDash=m},10705:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.TYPE_MAPPINGS=t.TYPE_HEADERS=t.HEADER_MAPPINGS=t.BANK_ACCOUNT_HEADERS=t.PAYMENT_CARD_HEADERS=t.CREDENTIAL_HEADERS=t.SECURE_NOTES_HEADERS=void 0;let a=r(20648);t.SECURE_NOTES_HEADERS={Title:new Set(["title","name"]),Content:new Set(["note","notes","comments","extra","content"]),Category:new Set(["category","grouping","tags","folders","folder","tag","collection","collections"])},t.CREDENTIAL_HEADERS={Title:new Set(["title","name","account","site name"]),Login:new Set(["username","login","login_username","login name","user name"]),Url:new Set(["url","website","domain","login_url","login url","login_uri","web site","website address"]),Email:new Set(["email"]),Password:new Set(["password","login_password"]),OtpUrl:new Set(["first one-time password","login_otp","login_totp","otp","otpauth","otpurl","otpsecret","totp"]),Note:new Set(["note","notes","comments","extra"]),Category:new Set(["category","grouping","tags","folders","folder","tag","collection","collections"])},t.PAYMENT_CARD_HEADERS={CardNumber:new Set(["number","cardnumber","cc_number"]),CCNote:new Set(["notes","ccnote","note"]),OwnerName:new Set(["name on card","ownername","account_name"]),SecurityCode:new Set(["security code","securitycode","code"]),ExpireMonth:new Set(["exp_month","expiremonth","expiration_month"]),ExpireYear:new Set(["exp_year","expireyear","expiration_year"]),Name:new Set(["name"])},t.BANK_ACCOUNT_HEADERS={BankAccountName:new Set(["bank name","bankaccountname","account_name"]),BankAccountIBAN:new Set(["iban number","account number","account_number","bankaccountiban"]),BankAccountBIC:new Set(["swift code","routing number","routing_number","bankaccountbic"]),BankAccountOwner:new Set(["account_holder"]),BankAccountBank:new Set(["issuing_bank"]),LocaleFormat:new Set(["country"])},t.HEADER_MAPPINGS={[a.SupportedVaultTypes.CREDENTIAL]:t.CREDENTIAL_HEADERS,[a.SupportedVaultTypes.NOTE]:t.SECURE_NOTES_HEADERS,[a.SupportedVaultTypes.PAYMENT_CARD]:t.PAYMENT_CARD_HEADERS,[a.SupportedVaultTypes.BANK_ACCOUNT]:t.BANK_ACCOUNT_HEADERS,[a.SupportedVaultTypes.COLLECTION]:{}},t.TYPE_HEADERS=new Set(["type","item type"]),t.TYPE_MAPPINGS={[a.SupportedVaultTypes.NOTE]:["securenote","note","secure note"],[a.SupportedVaultTypes.CREDENTIAL]:["password","login","credential"],[a.SupportedVaultTypes.BANK_ACCOUNT]:["bankaccount","bank"],[a.SupportedVaultTypes.PAYMENT_CARD]:["paymentcard","payment_card","creditcard","debitcard"],[a.SupportedVaultTypes.COLLECTION]:[]}},84816:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.areHeadersValid=t.determineBestItemType=t.getHeadersAndIndexMap=t.buildCredentialObj=t.buildBankAccountObj=t.buildPaymentCardObj=t.buildNoteObj=t.reduceVaultObj=t.constructBankAccount=t.constructPaymentCard=t.constructSecureNote=t.constructCredentialContent=t.formatCredentialData=t.buildNoteContent=void 0;let a=r(20648),o=r(12857),n=r(242),i=r(61586),s=r(75972),c=r(1043),l=r(10705),u=r(87417),d=r(48288),p=r(65598),S=r(61681),g=r(4803),m=r(67179),y=e=>{let t=(0,g.sanitizeInputPersonalData)(e),r=(0,m.getUnixTimestamp)();return{kwType:"KWSecureNote",CreationDatetime:r,Id:(0,S.generateItemUuid)(),LocaleFormat:a.Country.US,SpaceId:t.spaceId||"",UserModificationDatetime:r,LastBackupTime:0,Title:t.title||"Untitled note",Content:t.content||"",Secured:t.secured||!1,Type:t.type||"GRAY",Attachments:t.attachments||[]}},f=(e,t)=>{for(let r in e)t.includes(r)||delete e[r]};t.buildNoteContent=(e,t,r,o,n)=>{let i="";if((0,a.isCredential)(e))i=e.Note??"";else if((0,a.isNote)(e))e.Note&&(e.Content=e.Note,delete e.Note),i=e.Content;else{if(!(0,a.isPaymentCard)(e))return;i=e.CCNote}let s=!!i,c=!1,l={...e,...r};for(let e in l)if(!o.includes(e)&&!t.get(e)?.matched&&l[e]&&(n?n(e.toLocaleLowerCase(),l[e]):l[e])){let t=s&&!c?`


`:`
`;i+=`${t}${e}: ${l[e]}`,c=!0}i=i.trim(),(0,a.isCredential)(e)?e.Note=i:(0,a.isNote)(e)?e.Content=i:(0,a.isPaymentCard)(e)&&(e.CCNote=i)},t.formatCredentialData=e=>{let t=e.Url?.trim()??"",r=e.Url?.split(",")??[""];if(r.length>1&&new o.ParsedURL(r[0]).isUrlValid()&&r.slice(1).some(e=>new o.ParsedURL(e).isUrlValid())){let[r,...n]=e.Url?.split(",")??[];t=r.trim(),e.LinkedServices={associated_domains:[]},n.forEach(t=>{let r=new o.ParsedURL(t.trim());r.isUrlValid()&&e.LinkedServices?.associated_domains.push({domain:r.getPIIStrippedURL(),source:a.LinkedWebsiteSource.Manual})})}let n=new o.ParsedURL(t);e.Url=n.isUrlValid()?t:"";let i=new o.ParsedURL(e.Title?.trim());(!e.Title||i.isUrlValid({requireEtld:!0})&&i.getRootDomain()===n.getRootDomain())&&(e.Title=n.getRootDomain()??"")},t.constructCredentialContent=(e,t,r)=>({Title:"",Email:"",Login:"",Password:"",Note:"",...e,...(0,n.createBaseCredentialModel)(t),...(0,i.getUrlFields)(e.Url??"",!0),SpaceId:r??"",SubdomainOnly:!1,SecondaryLogin:"",Category:"",AutoLogin:!0,AutoProtected:!1,Strength:0}),t.constructSecureNote=(e,t)=>y({content:e.Content||"",title:e.Title||"",secured:!1,type:a.NoteTypes[0],spaceId:t||""}),t.constructPaymentCard=(e,t)=>(0,s.getNewPaymentCard)({ownerName:e.OwnerName??"",cardName:e.Name??"",cardNumber:e.CardNumber??"",securityCode:e.SecurityCode??"",expireMonth:e.ExpireMonth??"",expireYear:e.ExpireYear??"",...e,spaceId:t}),t.constructBankAccount=(e,t,r)=>(0,c.getNewBankAccount)({name:e.BankAccountName??"",owner:e.BankAccountOwner??"",IBAN:e.BankAccountIBAN??"",BIC:e.BankAccountBIC??"",bank:e.BankAccountBank??"",country:t,...e,spaceId:r??""});let E=(e,t)=>{let r=Object.keys(t),a={};return e.forEach((e,o)=>{let n=r.find(r=>t[r].has(e));a[n??e]={supported:!!n,index:o}}),a};t.reduceVaultObj=(e,t,r,a,o)=>Object.entries(e).reduce((e,[t,o])=>{let n=a.get(t)?.matched;return a.has(t)&&n&&(e[n]=r?r(t,"string"==typeof o?o:""):o),e},t({},o)),t.buildNoteObj=(e,r,a)=>{let o=["Title","Content","Category","Secured","Type","LocaleFormat","SpaceId","kwType","Id","LastBackupTime","CreationDate","UpdateDate","limitedPermissions","CreationDatetime","UserModificationDatetime","LastUse","Attachments"],n=(0,d.getFieldLevelProcessor)(r),i=(0,t.reduceVaultObj)(e,t.constructSecureNote,n,a);return(0,t.buildNoteContent)(i,a,e,o,n),f(i,o),i},t.buildPaymentCardObj=(e,r,a,o)=>{let n=["Name","CardNumber","CardNumberLastDigits","OwnerName","SecurityCode","ExpireMonth","ExpireYear","StartMonth","StartYear","IssueNumber","Color","Bank","CCNote","Type","LocaleFormat","SpaceId","kwType","Id","LastBackupTime","CreationDatetime","UserModificationDatetime","LastUse","Attachments"],i=(0,d.getFieldLevelProcessor)(r),s=(0,t.reduceVaultObj)(e,t.constructPaymentCard,i,a,o);return(0,t.buildNoteContent)(s,a,e,n,i),f(s,n),s},t.buildBankAccountObj=(e,r,a)=>{let o=(0,d.getFieldLevelProcessor)(r),n=(0,t.reduceVaultObj)(e,t.constructBankAccount,o,a);return f(n,["BankAccountName","BankAccountOwner","BankAccountIBAN","BankAccountBIC","BankAccountBank","LocaleFormat","SpaceId","kwType","Id","LastBackupTime","CreationDatetime","UserModificationDatetime","LastUse","Attachments"]),n},t.buildCredentialObj=(e,r,o,n)=>{let i=["Title","Email","Login","SecondaryLogin","Password","Strength","Category","Url","UseFixedUrl","TrustedUrlGroup","LocaleFormat","SpaceId","kwType","Id","LastBackupTime","CreationDatetime","LastUse","Note","SubdomainOnly","AutoLogin","AutoProtected","OtpSecret","UserSelectedUrl","Checked","Status","SharedObject","ModificationDatetime","NumberUse","Type","Server","Port","Alias","SID","ConnectionOptions","domainIcon","limitedPermissions","LinkedServices","UserModificationDatetime","Attachments","OtpUrl"],s=(0,d.getFieldLevelProcessor)(r),c=(0,t.reduceVaultObj)(e,t.constructCredentialContent,s,o,n);return r===a.ImportSource.Keeper&&(0,p.parseCustomKeeperCredentialData)(e,c),(0,t.buildNoteContent)(c,o,e,i,s),f(c,i),(0,t.formatCredentialData)(c),c},t.getHeadersAndIndexMap=(e,t)=>{let r=Object.entries(E(e,l.HEADER_MAPPINGS[t])).reduce((e,[t,r])=>({...e,[r.index]:r.supported?t:""}),{});return e.map((e,t)=>({original:e,matched:r[t]??""}))},t.determineBestItemType=(e,t)=>{let r=null,o=(0,u.getItemTypeProcessor)(t);if(o&&(r=o(e)),!r){for(let t in e)if(l.TYPE_HEADERS.has(t)&&(r=Object.keys(l.TYPE_MAPPINGS).find(r=>l.TYPE_MAPPINGS[r]?.includes(e[t].toLocaleLowerCase()))))break;if(!r){let t=Object.keys(e).map(e=>e.toLocaleLowerCase()),a={};Object.entries(l.HEADER_MAPPINGS).forEach(([r,o])=>{Object.values(o).forEach(o=>{a[r]=(a[r]||0)+[...o].filter(r=>t.includes(r)&&e[r]).length})}),r=Object.keys(a).reduce((e,t)=>a[e]>a[t]?e:t)}}return r||a.SupportedVaultTypes.NOTE},t.areHeadersValid=e=>!!e.length&&Object.values(Object.values(l.HEADER_MAPPINGS)).reduce((e,t)=>[...e,...Object.values(t).map(e=>Array.from(e))],[]).flat().some(t=>e.includes(t))},55486:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.notifyNewImportPersonalDataStateAction=t.NOTIFY_NEW_PERSONAL_DATA_STATE=void 0,t.NOTIFY_NEW_PERSONAL_DATA_STATE="NOTIFY_NEW_PERSONAL_DATA_STATE",t.notifyNewImportPersonalDataStateAction=e=>({type:t.NOTIFY_NEW_PERSONAL_DATA_STATE,newState:e})},51810:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.ImportDataStateReducer=void 0;let a=r(20648),o=r(55486);t.ImportDataStateReducer=(e,t)=>t.type===o.NOTIFY_NEW_PERSONAL_DATA_STATE?{state:t.newState}:e??{state:{status:a.ImportPersonalDataStateType.Idle}}},32107:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.getUserAddedLinkedWebsitesRootDomains=t.getUserAddedLinkedWebsiteDomains=t.getDashlaneDefinedLinkedWebsites=t.populateDashlaneDefinedLinkedWebsitesIndex=t.reduceLinkedDomainsLists=t.fromObjectToArray=void 0;let a=r(22789),o=r(52327),n=r(57301),i=r(12857);function s(e){let t=[];return Object.keys(e).forEach(r=>{t.push([r].concat(e[r]))}),t}t.fromObjectToArray=s;let c=(e,t)=>e.some(e=>t.includes(e)),l=(e,t)=>{let r=[],a=[];e.forEach(e=>c(e,t)?r.push(e):a.push(e));let o=r.concat([t]).flat();return a.concat([o])};function u(e){let t={};return e.forEach(e=>{e.forEach(r=>{t[r]=e})}),t}t.reduceLinkedDomainsLists=(e,t,r)=>e.concat(t,r).reduce(l,[]),t.populateDashlaneDefinedLinkedWebsitesIndex=u;let d=u((0,t.reduceLinkedDomainsLists)(a,s(n),s(o)).map(e=>[...new Set(e)]));t.getDashlaneDefinedLinkedWebsites=function(e){let t=new i.ParsedURL(e).getRootDomain();return t?d[t]||[t]:[]},t.getUserAddedLinkedWebsiteDomains=e=>(e.LinkedServices?.associated_domains??[]).map(e=>e.domain).filter(Boolean)??[],t.getUserAddedLinkedWebsitesRootDomains=e=>(0,t.getUserAddedLinkedWebsiteDomains)(e).map(e=>new i.ParsedURL(e).getRootDomain())},69472:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.config=void 0;let a=r(82822),o=r(95766);t.config={commands:{addPasskey:{handler:o.addPasskeyHandler},updatePasskey:{handler:o.updatePasskeyHandler}},queries:{getPasskey:{selector:a.viewedPasskeySelector},getPasskeys:{selector:a.viewedQueriedPasskeysSelector},getPasskeysForDomain:{selector:a.viewedQueriedPasskeysForDomainSelector}},liveQueries:{}}},97239:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.addPasskeyHandler=t.getNewPasskey=void 0;let a=r(83533),o=r(20648),n=r(17620),i=r(92830),s=r(67179),c=r(61681),l=r(80896),u=r(4803);function d(e){let t=(0,s.getUnixTimestamp)(),r={kwType:"KWPasskey",Id:(0,c.generateItemUuid)(),LastBackupTime:0,LastUse:t,LocaleFormat:o.Country.UNIVERSAL,SpaceId:e.spaceId,CreationDatetime:t,UserModificationDatetime:t,Counter:0,CredentialId:e.credentialId,ItemName:e.itemName,Note:e.note,RpId:e.rpId,RpName:e.rpName,UserDisplayName:e.userDisplayName,UserHandle:e.userHandle};return e.keyAlgorithm===o.WebAuthnKeyAlgorithm.CloudPasskey?{...r,KeyAlgorithm:e.keyAlgorithm,CloudPasskey:e.cloudPasskey}:{...r,KeyAlgorithm:e.keyAlgorithm,PrivateKey:e.privateKey}}async function p({storeService:e,sessionService:t},r){if(!e.isAuthenticated())throw Error("No session available to savePasskey");let a=d((0,u.sanitizeInputPersonalData)(r));if(!a.SpaceId){let t=await (0,n.getDefaultSpaceId)(e);a.SpaceId=t}return e.dispatch((0,i.savePersonalDataItem)(a,a.kwType)),t.getInstance().user.persistPersonalData(),a.Id}async function S(e,t){try{let r=await p(e,t);return(0,n.getDebounceSync)(e.storeService,e.sessionService)({immediateCall:!0},a.Trigger.Save),{success:!0,id:r}}catch(e){return(0,l.sendExceptionLog)({error:e}),{success:!1}}}t.getNewPasskey=d,t.addPasskeyHandler=S},95766:function(e,t,r){var a=this&&this.__createBinding||(Object.create?function(e,t,r,a){void 0===a&&(a=r);var o=Object.getOwnPropertyDescriptor(t,r);(!o||("get"in o?!t.__esModule:o.writable||o.configurable))&&(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,a,o)}:function(e,t,r,a){void 0===a&&(a=r),e[a]=t[r]}),o=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||a(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),o(r(97239),t),o(r(57617),t)},57617:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.updatePasskeyHandler=t.getUpdatedPasskey=t.getPasskeyModifiedProperties=void 0;let a=r(83533),o=r(82822),n=r(17620),i=r(92830),s=r(67179),c=r(80896),l=r(4803);function u(e,r){let a=(0,o.passkeySelector)(e,r.id);if(!a)throw Error("[updatePasskey]: unable to find passkey to update.");return{...a,...(0,t.getPasskeyModifiedProperties)(r,a)}}t.getPasskeyModifiedProperties=(e,t)=>{let r=(0,s.getUnixTimestamp)();return{Counter:e.counter??t.Counter,Note:e.note??t.Note,SpaceId:e.spaceId??t.SpaceId,ItemName:e.itemName??t.ItemName,LastUse:r}},t.getUpdatedPasskey=u,t.updatePasskeyHandler=function(e,t){try{let r=function({storeService:e,sessionService:t},r){if(!e.isAuthenticated())throw Error("No session available to updatePasskey");let a=e.getState(),o=u(a,(0,l.sanitizeInputPersonalData)(r));return e.dispatch((0,i.savePersonalDataItem)(o,o.kwType)),t.getInstance().user.persistPersonalData(),{success:!0}}(e,t);if(!r.success)return Promise.resolve(r);return(0,n.getDebounceSync)(e.storeService,e.sessionService)({immediateCall:!0},a.Trigger.Save),Promise.resolve({success:!0})}catch(e){return(0,c.sendExceptionLog)({error:e}),Promise.resolve({success:!1})}}},43254:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.getPasskeyMappers=void 0;let a=r(15074);t.getPasskeyMappers=()=>({id:e=>e.Id,itemName:e=>e.ItemName,lastUse:a.lastUseMapper,rpId:e=>e.RpId,spaceId:e=>e.SpaceId,userDisplayName:e=>e.UserDisplayName})},35793:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.passkeyMatch=t.searchGetters=void 0;let a=r(23674),o=r(92595);t.searchGetters=[(0,o.stringProp)("RpId"),(0,o.stringProp)("RpName"),(0,o.stringProp)("CredentialId")],t.passkeyMatch=(0,a.match)(t.searchGetters)},82822:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.viewedQueriedPasskeysForDomainSelector=t.queryPasskeysByDomainSelector=t.getPasskeysByFullDomainSelector=t.getViewedPasskeySelector=t.viewedPasskeySelector=t.getLivePasskeysSelector=t.viewedQueriedPasskeysSelector=t.queryPasskeysSelector=t.passkeyMappersSelector=t.passkeySelector=t.passkeysSelector=void 0;let a=r(25903),o=r(12857),n=r(35793),i=r(11733),s=r(7299),c=r(99040),l=r(67803),u=r(24445),d=r(49548),p=r(43254),S=e=>e.userSession.personalData.passkeys;t.passkeysSelector=S,t.passkeySelector=(e,t)=>{let r=S(e);return(0,u.findDataModelObject)(t,r)},t.passkeyMappersSelector=e=>(0,p.getPasskeyMappers)();let g=()=>n.passkeyMatch;t.queryPasskeysSelector=(0,s.getQuerySelector)(t.passkeysSelector,g,t.passkeyMappersSelector),t.viewedQueriedPasskeysSelector=(0,a.compose)((0,c.viewListResults)(i.listView),t.queryPasskeysSelector),t.getLivePasskeysSelector=(0,l.makeLiveSelectorGetter)(t.passkeysSelector,()=>i.listView,g,t.passkeyMappersSelector),t.viewedPasskeySelector=(e,r)=>{let a=(0,t.passkeySelector)(e,r);return(0,i.detailView)(a)},t.getViewedPasskeySelector=e=>{let r=(0,d.createSelector)(t.passkeysSelector,t=>(0,u.findDataModelObject)(e,t));return(0,d.createSelector)(r,i.detailView)};let m=(e,t)=>e.filter(e=>{let r=new o.ParsedURL(e.RpId).getHostname(),a=new o.ParsedURL(t).getHostname();return a===r||a.endsWith(`.${r}`)});t.getPasskeysByFullDomainSelector=e=>(0,d.createSelector)(t.passkeysSelector,t=>m(t,e)),t.queryPasskeysByDomainSelector=e=>(0,s.getQuerySelector)((0,t.getPasskeysByFullDomainSelector)(e),g,t.passkeyMappersSelector),t.viewedQueriedPasskeysForDomainSelector=(e,r)=>{let a=(0,t.queryPasskeysByDomainSelector)(r.domain)(e,r);return(0,c.viewListResults)(i.listView)(a)}},11733:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.listView=t.itemView=t.detailView=void 0;let a=r(20648),o=r(31180),n=e=>{let t={credentialId:e.CredentialId,counter:e.Counter,itemName:e.ItemName,note:e.Note,spaceId:e.SpaceId,rpId:e.RpId,rpName:e.RpName,userDisplayName:e.UserDisplayName,userHandle:e.UserHandle};return(0,a.isCloudPasskey)(e)?{...t,keyAlgorithm:e.KeyAlgorithm,cloudPasskey:e.CloudPasskey}:{...t,keyAlgorithm:e.KeyAlgorithm,privateKey:e.PrivateKey}};t.detailView=e=>({...(0,o.dataModelDetailView)(e),...n(e)}),t.itemView=e=>({...(0,o.dataModelItemView)(e),...n(e)}),t.listView=e=>e.map(t.itemView)},91711:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.RequestError=t.getPaymentTypeFromCardNumber=t.getLastDigitsFromCardNumber=t.defaultColor=t.defaultToFallbackColor=t.defaultToEmptyString=void 0;let a=r(25903),o=r(20648);t.defaultToEmptyString=(0,a.defaultTo)(""),t.defaultToFallbackColor=(0,a.defaultTo)(o.PaymentCardColor.BLUE_1),t.defaultColor="BLUE_1",t.getLastDigitsFromCardNumber=function(e){let r=(0,t.defaultToEmptyString)(e).trim();return r.length>=4?r.slice(-4):""},t.getPaymentTypeFromCardNumber=function(e){if(!e)return o.PaymentCardType.PAYMENT_TYPE_VISA;let t=(e,t)=>t.some(t=>e.startsWith(t));if(e.startsWith("4"))return o.PaymentCardType.PAYMENT_TYPE_VISA;if(t(e,["34","37"]))return o.PaymentCardType.PAYMENT_TYPE_AMEX;if(t(e,["50","51","52","53","54","55"]))return o.PaymentCardType.PAYMENT_TYPE_MASTERCARD;if(t(e,["6011","65"]))return o.PaymentCardType.PAYMENT_TYPE_DISCOVER;if(t(e,["300","301","302","303","304","305","36","38"]))return o.PaymentCardType.PAYMENT_TYPE_DINERSCLUB;else if(t(e,["2123","2131","1800","3"]))return o.PaymentCardType.PAYMENT_TYPE_JCB;else return o.PaymentCardType.PAYMENT_TYPE_MASTERCARD},t.RequestError=class extends Error{constructor(e,t){super(e),Object.setPrototypeOf(this,new.target.prototype),this.name="RequestError",this.code=t}}},75972:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.getUpdatedPaymentCard=t.getNewPaymentCard=t.savePaymentCard=void 0;let a=r(25903),o=r(20648),n=r(22560),i=r(93625),s=r(61681),c=r(67179),l=r(24445),u=r(91711),d=r(18049);function p(e){n.default.log("[Data] Creating new Payment Card");let t=(0,c.getUnixTimestamp)(),r=(0,u.defaultToEmptyString)(e.cardNumber).replace(/ /g,"");return{kwType:"KWPaymentMean_creditCard",Bank:"US-NO_TYPE",CardNumber:r,CardNumberLastDigits:(0,u.getLastDigitsFromCardNumber)(r),CreationDatetime:t,Color:(0,a.defaultTo)(o.PaymentCardColor.BLUE_1,e.color),ExpireMonth:(0,u.defaultToEmptyString)(e.expireMonth),ExpireYear:(0,u.defaultToEmptyString)(e.expireYear),Id:(0,s.generateItemUuid)(),IssueNumber:"",Name:(0,a.defaultTo)("Card",e.cardName),OwnerName:(0,u.defaultToEmptyString)(e.ownerName),CCNote:(0,u.defaultToEmptyString)(e.personalNote),LocaleFormat:o.Country.US,SecurityCode:(0,u.defaultToEmptyString)(e.securityCode),SpaceId:e.spaceId||"",StartYear:"",StartMonth:"",Type:(0,u.getPaymentTypeFromCardNumber)(r),UserModificationDatetime:t,LastBackupTime:0}}function S(e,t){let r=(0,l.findDataModelObject)(t.id,e);if(!r){n.default.log("Client asks to update an unknown Payment Card");return}n.default.log(`[Data] Updating existing Payment Card ${t.id}`);let o=(0,c.getUnixTimestamp)(),i=(0,u.defaultToEmptyString)(t.cardNumber).replace(/ /g,""),s={CardNumber:i,CardNumberLastDigits:(0,u.getLastDigitsFromCardNumber)(i),Color:t.color?t.color:r.Color,ExpireMonth:(0,u.defaultToEmptyString)(t.expireMonth),ExpireYear:(0,u.defaultToEmptyString)(t.expireYear),Name:(0,a.defaultTo)("Card",t.cardName),OwnerName:(0,u.defaultToEmptyString)(t.ownerName),SecurityCode:(0,u.defaultToEmptyString)(t.securityCode),SpaceId:(0,u.defaultToEmptyString)(t.spaceId),Type:(0,u.getPaymentTypeFromCardNumber)(t.cardNumber),UserModificationDatetime:o,CCNote:(0,u.defaultToEmptyString)(t.personalNote)};return{...r,...s}}t.savePaymentCard=function({storeService:e,sessionService:t,eventLoggerService:r},a){if(!e.isAuthenticated()){n.default.log("No session available to savePaymentCard");return}let o=e.getPersonalData(),s=a.id?S(o.paymentCards,a):p(a);if(a.id){let t=(0,l.findDataModelObject)(s.Id,o.paymentCards);(0,d.logEditVaultItem)(e,r,s,t)}else(0,d.logAddVaultItem)(e,r,s);e.dispatch((0,i.savePaymentCard)(s)),t.getInstance().user.persistPersonalData()},t.getNewPaymentCard=p,t.getUpdatedPaymentCard=S},74635:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.getPaymentCardMappers=void 0;let a=r(15074);t.getPaymentCardMappers=()=>({spaceId:e=>e.SpaceId,name:e=>e.Name,lastUse:a.lastUseMapper,id:e=>e.Id})},37269:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.paymentCardMatch=t.searchGetters=void 0;let a=r(92595),o=r(23674);t.searchGetters=[(0,a.stringProp)("Name"),(0,a.stringProp)("OwnerName")],t.paymentCardMatch=(0,o.match)(t.searchGetters)},99008:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.queryPaymentCardsSelector=t.paymentCardMappersSelector=t.paymentCardSelector=t.paymentCardsSelector=void 0;let a=r(37269),o=r(7299),n=r(24445),i=r(49548),s=r(74635),c=r(38728),l=r(49705);t.paymentCardsSelector=(0,i.createSelector)(e=>e.userSession.personalData.paymentCards,l.quarantinedSpacesSelector,c.filterOutQuarantinedItems),t.paymentCardSelector=(e,r)=>{let a=(0,t.paymentCardsSelector)(e);return(0,n.findDataModelObject)(r,a)},t.paymentCardMappersSelector=e=>(0,s.getPaymentCardMappers)(),t.queryPaymentCardsSelector=(0,o.getQuerySelector)(t.paymentCardsSelector,()=>a.paymentCardMatch,t.paymentCardMappersSelector)},18049:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.logDeleteVaultItem=t.logAddVaultItem=t.logEditVaultItem=void 0;let a=r(83533),o=r(20648),n=r(12857),i=r(48140),s=r(15700),c=r(34457),l=r(2676),u=(e,t,r,u,d,p,S)=>{let g=e.getState(),m=(0,l.collectionsSelector)(g),y=u.SpaceId===i.PERSONAL_SPACE_ID?a.Space.Personal:a.Space.Professional,f=void 0!==p?p.map(e=>(0,s.getHermesFieldFromProperty)(u,e)).filter(e=>e):void 0,E=s.dataModelTypeToItemType[u.kwType],A=(0,c.getCollectionNamesContainingVaultItemId)(u.Id,m).length;if(t.logEvent(new a.UserUpdateVaultItemEvent({action:r,itemId:u.Id,itemType:E,fieldsEdited:f,space:y,collectionCount:A,multiSelectId:S??void 0,updateCredentialOrigin:d})),u.kwType===o.DataModelType.KWAuthentifiant){let e=new n.ParsedURL(u.Url).getRootDomain();(0,a.hashDomain)("string"==typeof e?e:"").then(e=>{t.logEvent(new a.AnonymousUpdateCredentialEvent({action:r,domain:{id:e,type:a.DomainType.Web},fieldList:f,space:y}))})}};t.logEditVaultItem=(e,t,r,o,n)=>{let i=(0,s.getUpdatedProperties)(r,o);u(e,t,a.Action.Edit,r,n,i)},t.logAddVaultItem=(e,t,r,o)=>u(e,t,a.Action.Add,r,o),t.logDeleteVaultItem=(e,t,r,o,n)=>u(e,t,a.Action.Delete,r,o,void 0,n)},15700:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.getUpdatedProperties=t.getHermesFieldFromProperty=t.dataModelTypeToItemType=void 0;let a=r(83533),o=r(20648);t.dataModelTypeToItemType={[o.DataModelType.KWAuthentifiant]:a.ItemType.Credential,[o.DataModelType.KWSecureNote]:a.ItemType.SecureNote,[o.DataModelType.KWIdentity]:a.ItemType.Identity,[o.DataModelType.KWEmail]:a.ItemType.Email,[o.DataModelType.KWPhone]:a.ItemType.Phone,[o.DataModelType.KWAddress]:a.ItemType.Address,[o.DataModelType.KWCompany]:a.ItemType.Company,[o.DataModelType.KWPersonalWebsite]:a.ItemType.Website,[o.DataModelType.KWPaymentMean_creditCard]:a.ItemType.CreditCard,[o.DataModelType.KWBankStatement]:a.ItemType.BankStatement,[o.DataModelType.KWIDCard]:a.ItemType.IdCard,[o.DataModelType.KWSocialSecurityStatement]:a.ItemType.SocialSecurity,[o.DataModelType.KWDriverLicence]:a.ItemType.DriverLicense,[o.DataModelType.KWPassport]:a.ItemType.Passport,[o.DataModelType.KWFiscalStatement]:a.ItemType.FiscalStatement,[o.DataModelType.KWSecret]:a.ItemType.Secret};let n=(e,t)=>{switch(t){case"Email":return a.Field.Email;case"Login":return a.Field.Login;case"SecondaryLogin":return a.Field.SecondaryLogin;case"Password":return a.Field.Password;case"AutoLogin":return e.AutoLogin?a.Field.AutoLoginOn:a.Field.AutoLoginOff;case"AutoProtected":return e.AutoProtected?a.Field.MpProtectedOn:a.Field.MpProtectedOff;case"Url":return a.Field.Website;case"Category":return a.Field.Category;case"Note":return a.Field.Note;case"SubdomainOnly":return e.SubdomainOnly?a.Field.SubdomainOnlyOn:a.Field.SubdomainOnlyOff;case"Title":return a.Field.Title;case"SpaceId":return a.Field.Space}},i=(e,t)=>{switch(t){case"Title":return a.Field.Title;case"Content":return a.Field.Content;case"Category":return a.Field.Category;case"SpaceId":return a.Field.Space;case"Secured":return e.Secured?a.Field.MpProtectedOn:a.Field.MpProtectedOff}},s={Title:a.Field.Title,FirstName:a.Field.FirstName,MiddleName:a.Field.MiddleName,LastName:a.Field.LastName,BirthDate:a.Field.BirthDate,BirthPlace:a.Field.BirthPlace,Pseudo:a.Field.Pseudo,SpaceId:a.Field.Space},c={Email:a.Field.Email,Type:a.Field.Type,EmailName:a.Field.EmailName,SpaceId:a.Field.Space},l={Number:a.Field.Number,PhoneName:a.Field.PhoneName,Type:a.Field.Type,SpaceId:a.Field.Space},u={StreetNumber:a.Field.StreetNumber,StreetName:a.Field.StreetName,StreetTitle:a.Field.StreetTitle,City:a.Field.City,State:a.Field.State,StateLevel2:a.Field.StateLevel2,StateNumber:a.Field.StateNumber,ZipCode:a.Field.ZipCode,Country:a.Field.Country,AddressName:a.Field.AddressName,Receiver:a.Field.Receiver,Building:a.Field.Building,Floor:a.Field.Floor,Door:a.Field.Door,LinkedPhone:a.Field.LinkedPhone,PersonalNote:a.Field.Note,SpaceId:a.Field.Space},d={Name:a.Field.Name,JobTitle:a.Field.JobTitle,SpaceId:a.Field.Space},p={Website:a.Field.Website,Name:a.Field.Name,SpaceId:a.Field.Space},S={Name:a.Field.Name,OwnerName:a.Field.OwnerName,CardNumber:a.Field.CardNumber,SecurityCode:a.Field.SecurityCode,ExpireMonth:a.Field.ExpireDate,ExpireYear:a.Field.ExpireDate,Color:a.Field.Color,SpaceId:a.Field.Space},g={BankAccountName:a.Field.Name,BankAccountOwner:a.Field.Owner,BankAccountBIC:a.Field.Bic,BankAccountIBAN:a.Field.Iban,BankAccountBank:a.Field.Bank,SpaceId:a.Field.Space},m={Fullname:a.Field.Fullname,Number:a.Field.Number,DeliveryDate:a.Field.DeliveryDate,ExpireDate:a.Field.ExpireDate,LinkedIdentity:a.Field.LinkedIdentity,Sex:a.Field.Sex,DateOfBirth:a.Field.DateOfBirth,SpaceId:a.Field.Space},y={SocialSecurityFullname:a.Field.SocialSecurityFullname,SocialSecurityNumber:a.Field.SocialSecurityNumber,LinkedIdentity:a.Field.LinkedIdentity,Sex:a.Field.Sex,DateOfBirth:a.Field.DateOfBirth,SpaceId:a.Field.Space},f={Fullname:a.Field.Fullname,Number:a.Field.Number,DeliveryDate:a.Field.DeliveryDate,ExpireDate:a.Field.ExpireDate,State:a.Field.State,LinkedIdentity:a.Field.LinkedIdentity,Sex:a.Field.Sex,DateOfBirth:a.Field.DateOfBirth,SpaceId:a.Field.Space},E={Fullname:a.Field.Fullname,Number:a.Field.Number,DeliveryDate:a.Field.DeliveryDate,DeliveryPlace:a.Field.DeliveryPlace,ExpireDate:a.Field.ExpireDate,LinkedIdentity:a.Field.LinkedIdentity,Sex:a.Field.Sex,DateOfBirth:a.Field.DateOfBirth,SpaceId:a.Field.Space},A={FiscalNumber:a.Field.FiscalNumber,TeledeclarantNumber:a.Field.TeledeclarantNumber,SpaceId:a.Field.Space};t.getHermesFieldFromProperty=(e,t)=>{switch(e.kwType){case o.DataModelType.KWAuthentifiant:return n(e,t);case o.DataModelType.KWSecureNote:return i(e,t);case o.DataModelType.KWIdentity:return s[t];case o.DataModelType.KWEmail:return c[t];case o.DataModelType.KWPhone:return l[t];case o.DataModelType.KWAddress:return u[t];case o.DataModelType.KWCompany:return d[t];case o.DataModelType.KWPersonalWebsite:return p[t];case o.DataModelType.KWPaymentMean_creditCard:return S[t];case o.DataModelType.KWBankStatement:return g[t];case o.DataModelType.KWIDCard:return m[t];case o.DataModelType.KWSocialSecurityStatement:return y[t];case o.DataModelType.KWDriverLicence:return f[t];case o.DataModelType.KWPassport:return E[t];case o.DataModelType.KWFiscalStatement:return A[t]}},t.getUpdatedProperties=(e,t)=>Object.getOwnPropertyNames(e).filter(r=>{let a=void 0!==e[r],o=e[r]!==t[r];return a&&o})},15074:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.lastUseMapper=void 0,t.lastUseMapper=e=>e.LastUse||-1},42568:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.updatePersonalDataUsageMetadata=t.addPersonalDataItem=t.makePersonalDataItem=void 0;let a=r(20648),o=r(74915),n=r(3313),i=r(45657),s=r(17620),c=r(80896),l=r(67179),u=r(22560),d=r(92830),p=r(19442),S=r(8553),g=r(14950),m=r(64529),y=r(45018),f=r(35586),E=r(18299),A=r(3469),h=r(65726),_=r(37313),T=r(98770),v=r(4803),I=r(29509),D=r(18049),P=r(24445),O=r(54286),C=r(76760),b={[a.DataModelType.KWAddress]:{create:f.makeNewAddress,update:f.makeUpdatedAddress},[a.DataModelType.KWAuthentifiant]:{beforeChange:A.beforeCredentialChange,create:A.makeNewCredential,update:A.makeUpdatedCredential,notifySharersOnUpdate:A.notifySharersCredentialUpdated,afterSave:A.afterCredentialSaved},[a.DataModelType.KWBankStatement]:{create:h.makeNewBankAccount,update:h.makeUpdatedBankAccount},[a.DataModelType.KWCompany]:{create:p.makeNewCompany,update:p.makeUpdatedCompany},[a.DataModelType.KWEmail]:{create:S.makeNewEmail,update:S.makeUpdatedEmail},[a.DataModelType.KWIdentity]:{create:m.makeNewIdentity,update:m.makeUpdatedIdentity},[a.DataModelType.KWPersonalWebsite]:{create:g.makeNewPersonalWebsite,update:g.makeUpdatedPersonalWebsite},[a.DataModelType.KWPhone]:{create:y.makeNewPhone,update:y.makeUpdatedPhone},[a.DataModelType.KWSecureNote]:{create:E.makeNewNote,update:E.makeUpdatedNote,notifySharersOnUpdate:E.notifySharersNoteUpdated},[a.DataModelType.KWSecret]:{create:C.makeNewSecret,update:C.makeUpdatedSecret,notifySharersOnUpdate:C.notifySharersSecretUpdated}};async function R(e,t,r,o){var n;let i;t.content||(u.default.error(`[Data] PersonalInfoItem: ${t.kwType}, has no content`),c.sendExceptionLog({message:`[makePersonalDataItem] No content found for PersonalDataItem of kwType: ${t.kwType}`,code:a.ExceptionCriticality.WARNING}),t={...t,content:{}});let l=null;if(t.content.id){let e=(0,s.getCurrentItems)(t.kwType,r);l=(0,P.findDataModelObject)(t.content.id,e)}let d=b[t.kwType];if(!d)return u.default.error(`[Data] Could not make PersonalDataItem of kwType: ${t.kwType}`),null;t={...n=t,content:(0,v.sanitizeInputPersonalData)(n.content)};let p=(0,I.platformInfoSelector)(e.getState());if(d.beforeChange&&(t=d.beforeChange(t,r)),l){if(i=await d.update(p,t,l),d.notifySharersOnUpdate&&!await d.notifySharersOnUpdate(e,l,i,o))return null}else i=await d.create(p,t);return i}async function N({storeService:e,sessionService:t,eventLoggerService:r,applicationModulesAccess:o},c){if(!e.isAuthenticated())return u.default.log("No session available to addPersonalDataItem"),{success:!1,itemId:""};let l=e.getPersonalData(),p=await R(e,c,l,o);if(!p)return{success:!1,itemId:""};if(!p.SpaceId){let t=await (0,s.getDefaultSpaceId)(e);p.SpaceId=t}let S=!!c?.content.id,g=null,m=(0,_.getInstance)(),y=(0,T.getInstance)();if(S){let t=a.DATAMODELOBJECT_TYPE_TO_CARBON_STORE_KEY[p.kwType],o=(0,P.findDataModelObject)(p.Id,l[t]);(0,D.logEditVaultItem)(e,r,p,o)}else(0,D.logAddVaultItem)(e,r,p);let f=(0,I.platformInfoSelector)(e.getState()),E=(0,n.isChangeHistoryCandidate)(p)&&S?(0,n.getUpdatedItemChangeHistory)({deviceName:e.getLocalSettings().deviceName,personalData:l,change:(0,i.makeUpdateChange)(p),userLogin:e.getUserLogin(),platformInfo:f}):null;if(e.dispatch((0,d.savePersonalDataItem)(p,p.kwType,E)),(0,a.isCredential)(p)){g=y.lockTopic("iconsUpdates");let t={credentialIds:[p.Id],type:"credentialUpdates"};await m.add("iconsUpdates",t),p?.Password==="************"&&(0,u.logWarn)({message:"Saving credentials using a placeholder",tag:"Credentials"}),(0,O.shouldSendCreateOrModifiedCredentialActivityLog)(e,p,c.origin)&&(c.content.id?.length?await (0,O.computeAndSendModifiedCredentialActivityLog)(o,{domainUrl:c.content.url}):await (0,O.computeAndSendCreatedCredentialActivityLog)(o,{domainUrl:c.content.url}))}return b[c.kwType]?.afterSave&&b[c.kwType].afterSave(e,p),g&&y.releaseTopic("iconsUpdates",g),t.getInstance().user.persistPersonalData(),{success:!0,itemId:p.Id}}t.makePersonalDataItem=R,t.addPersonalDataItem=N,t.updatePersonalDataUsageMetadata=function(e,t,r,n){let i=a.DATAMODELOBJECT_TYPE_TO_CARBON_STORE_KEY[n],s=(0,o.cleanUrlForPersonalData)(r),p=e.getPersonalData()[i],S=Array.isArray(p)?(0,P.findDataModelObject)(t,p):null;if(!S){c.sendExceptionLog({message:`[PersonalData] - updatePersonalDataUsageMetadata: No ${i} found for provided ID to update usage metadata`,code:a.ExceptionCriticality.WARNING});return}u.default.log(`[Data] Updating ${i} ${t} usage metadata`);let g={...S,LastUse:(0,l.getUnixTimestamp)()};if((0,a.isCredential)(g)){let{NumberUse:e,TrustedUrlGroup:t}=g;g.NumberUse=("number"==typeof e?e:0)+1,g.TrustedUrlGroup=(0,o.getUpdatedTrustedUrlList)(t,s)}e.dispatch((0,d.savePersonalDataItem)(g,n))}},4803:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.sanitizeInputPersonalData=void 0;let a=r(25903),o=e=>"string"==typeof e?e.replace(RegExp("([^	\n\r -퟿-�\uD800\uDC00-\uDBFF\uDFFF])","gu"),""):e;t.sanitizeInputPersonalData=e=>(0,a.mapObjIndexed)(o,e)},50830:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.personalDataSelector=t.personalDataItemsOfTypeSelector=void 0;let a=r(20648);t.personalDataItemsOfTypeSelector=(e,t)=>e.userSession&&e.userSession.personalData&&t.reduce((t,r)=>t.concat(e.userSession.personalData[a.DATAMODELOBJECT_TYPE_TO_CARBON_STORE_KEY[r]]),[]),t.personalDataSelector=e=>e.userSession&&e.userSession.personalData},24445:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.filterDataModelObjects=t.findDataModelObject=void 0;let a=r(25903),o=r(75180);t.findDataModelObject=(e,t)=>{let r=(e||"").toUpperCase();return(t||[]).find(e=>!!e?.Id&&r===e.Id?.toUpperCase())},t.filterDataModelObjects=(e,t,r)=>{let n=(0,a.unnest)((0,a.values)((0,a.omit)(r,(0,a.pick)(o.PERSONAL_DATA_COLLECTIONS_KEYS,e)))),i=(0,a.map)(a.toUpper,t),s=(0,a.propSatisfies)(e=>(0,a.contains)((e||"").toUpperCase(),i),"Id");return(0,a.filter)(s,n)}},35586:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.makeAddressSpecificProps=t.makeNewAddress=t.makeUpdatedAddress=void 0;let a=r(25903),o=r(20648),n=r(54286),i=r(29485),s=r(67179),c=r(22560);async function l(e,t,r){return c.default.log(`[Data] Updating existing Address with id: ${r.Id}`),{...r,...(0,n.makeUpdatedPersonalDataItemBase)({platformInfo:e,existingItem:r,updatedItem:t,itemUpdateDate:(0,s.getUnixTimestamp)()}),...d(e,r,t)}}async function u(e,t){return c.default.log("[Data] Adding new Address"),{...(0,n.makeNewPersonalDataItemBase)(e,t),...d(e,null,t)}}function d(e,t,r){let n=(0,a.defaultTo)(""),s=r.content,c=(0,i.getLocaleFormat)(e,t,r);return{AddressFull:n(s.addressFull),AddressName:s.addressName||n(s.addressFull),Building:n(s.building),City:n(s.city),Country:o.Country[c].toLocaleLowerCase(),DigitCode:n(s.digitCode),Door:n(s.door),Floor:n(s.floor),LinkedPhone:n(s.linkedPhone),PersonalNote:n(s.personalNote),Receiver:n(s.receiver),Stairs:n(s.stairs),State:(0,i.getValidState)(c,s.state),StateLevel2:n(s.stateLevel2),StateNumber:n(s.stateNumber),StreetName:n(s.streetName),StreetNumber:n(s.streetNumber),StreetTitle:n(s.streetTitle),ZipCode:n(s.zipCode)}}t.makeUpdatedAddress=l,t.makeNewAddress=u,t.makeAddressSpecificProps=d},74945:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.getAddressMappers=void 0;let a=r(15074);t.getAddressMappers=()=>({spaceId:e=>e.SpaceId,lastUse:a.lastUseMapper,id:e=>e.Id})},64760:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.addressMatch=t.searchGetters=void 0;let a=r(92595),o=r(23674);t.searchGetters=[(0,a.stringProp)("AddressFull"),(0,a.stringProp)("AddressName"),(0,a.stringProp)("City"),(0,a.stringProp)("Receiver"),(0,a.stringProp)("StreetNumber"),(0,a.stringProp)("ZipCode")],t.addressMatch=(0,o.match)(t.searchGetters)},39635:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.queryAddressesSelector=t.addressSelector=t.addressesSelector=void 0;let a=r(64760),o=r(74945),n=r(7299),i=r(24445),s=r(49548),c=r(38728),l=r(49705);t.addressesSelector=(0,s.createSelector)(e=>e.userSession.personalData.addresses,l.quarantinedSpacesSelector,c.filterOutQuarantinedItems),t.addressSelector=(e,r)=>{let a=(0,t.addressesSelector)(e);return(0,i.findDataModelObject)(r,a)},t.queryAddressesSelector=(0,n.getQuerySelector)(t.addressesSelector,()=>a.addressMatch,e=>(0,o.getAddressMappers)())},19442:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.makeCompanySpecificProps=t.makeNewCompany=t.makeUpdatedCompany=void 0;let a=r(25903),o=r(54286),n=r(67179),i=r(22560);async function s(e,t,r){return i.default.log(`[Data] Updating existing Company with id: ${r.Id}`),{...r,...(0,o.makeUpdatedPersonalDataItemBase)({platformInfo:e,existingItem:r,updatedItem:t,itemUpdateDate:(0,n.getUnixTimestamp)()}),...l(t)}}async function c(e,t){return{...(0,o.makeNewPersonalDataItemBase)(e,t),...l(t)}}function l(e){let t=(0,a.defaultTo)("");return{JobTitle:t(e.content.jobTitle),Name:t(e.content.name),PersonalNote:t(e.content.personalNote)}}t.makeUpdatedCompany=s,t.makeNewCompany=c,t.makeCompanySpecificProps=l},64915:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.getCompanyMappers=void 0;let a=r(15074);t.getCompanyMappers=()=>({spaceId:e=>e.SpaceId,lastUse:a.lastUseMapper,id:e=>e.Id})},36714:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.companyMatch=t.searchGetters=void 0;let a=r(23674),o=r(92595);t.searchGetters=[(0,o.stringProp)("JobTitle"),(0,o.stringProp)("Name")],t.companyMatch=(0,a.match)(t.searchGetters)},97915:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.queryCompaniesSelector=t.companySelector=t.companiesSelector=void 0;let a=r(36714),o=r(64915),n=r(7299),i=r(24445),s=r(49548),c=r(38728),l=r(49705);t.companiesSelector=(0,s.createSelector)(e=>e.userSession.personalData.companies,l.quarantinedSpacesSelector,c.filterOutQuarantinedItems),t.companySelector=(e,r)=>{let a=(0,t.companiesSelector)(e);return(0,i.findDataModelObject)(r,a)},t.queryCompaniesSelector=(0,n.getQuerySelector)(t.companiesSelector,()=>a.companyMatch,e=>(0,o.getCompanyMappers)())},8553:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.makeEmailSpecificProps=t.makeNewEmail=t.makeUpdatedEmail=void 0;let a=r(25903),o=r(54286),n=r(67179),i=r(22560);async function s(e,t,r){return i.default.log(`[Data] Updating existing Email with id: ${r.Id}`),{...r,...(0,o.makeUpdatedPersonalDataItemBase)({platformInfo:e,existingItem:r,updatedItem:t,itemUpdateDate:(0,n.getUnixTimestamp)()}),...l(t)}}async function c(e,t){return i.default.log("[Data] Adding new Email"),{...(0,o.makeNewPersonalDataItemBase)(e,t),...l(t)}}function l(e){let t=(0,a.defaultTo)("");return{Email:t(e.content.email),EmailName:t(e.content.emailName),Type:e.content.type||"PERSO"}}t.makeUpdatedEmail=s,t.makeNewEmail=c,t.makeEmailSpecificProps=l},52773:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.getEmailMappers=void 0;let a=r(15074);t.getEmailMappers=()=>({spaceId:e=>e.SpaceId,lastUse:a.lastUseMapper,id:e=>e.Id})},70785:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.emailMatch=t.searchGetters=void 0;let a=r(23674),o=r(92595);t.searchGetters=[(0,o.stringProp)("Email"),(0,o.stringProp)("EmailName")],t.emailMatch=(0,a.match)(t.searchGetters)},39442:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.queryEmailsSelector=t.emailSelector=t.emailsSelector=t.countAllEmailsSelector=void 0;let a=r(70785),o=r(52773),n=r(7299),i=r(24445),s=r(49548),c=r(49705),l=r(38728);t.countAllEmailsSelector=e=>e.userSession.personalData.emails.length,t.emailsSelector=(0,s.createSelector)(e=>e.userSession.personalData.emails,c.quarantinedSpacesSelector,l.filterOutQuarantinedItems),t.emailSelector=(e,r)=>{let a=(0,t.emailsSelector)(e);return(0,i.findDataModelObject)(r,a)},t.queryEmailsSelector=(0,n.getQuerySelector)(t.emailsSelector,()=>a.emailMatch,e=>(0,o.getEmailMappers)())},64529:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.makeIdentitySpecificProps=t.makeNewIdentity=t.makeUpdatedIdentity=void 0;let a=r(25903),o=r(54286),n=r(22560),i=r(67179);async function s(e,t,r){return n.Debugger.log(`[Data] Updating existing Identity with id: ${r.Id}`),{...r,...(0,o.makeUpdatedPersonalDataItemBase)({platformInfo:e,existingItem:r,updatedItem:t,itemUpdateDate:(0,i.getUnixTimestamp)()}),...l(t)}}async function c(e,t){return n.Debugger.log("[Data] Adding new Identity"),{...(0,o.makeNewPersonalDataItemBase)(e,t),...l(t)}}function l(e){let t=(0,a.defaultTo)("");return{FirstName:t(e.content.firstName),MiddleName:t(e.content.middleName),LastName:t(e.content.lastName),LastName2:t(e.content.lastName2),Pseudo:t(e.content.pseudo),BirthDate:t(e.content.birthDate),BirthPlace:t(e.content.birthPlace),Title:t(e.content.title)}}t.makeUpdatedIdentity=s,t.makeNewIdentity=c,t.makeIdentitySpecificProps=l},24250:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.getIdentityMappers=void 0;let a=r(15074);t.getIdentityMappers=()=>({spaceId:e=>e.SpaceId,lastUse:a.lastUseMapper,id:e=>e.Id})},11474:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.identityMatch=t.searchGetters=void 0;let a=r(23674),o=r(92595);t.searchGetters=[(0,o.stringProp)("BirthDate"),(0,o.stringProp)("BirthPlace"),(0,o.stringProp)("FirstName"),(0,o.stringProp)("LastName"),(0,o.stringProp)("LastName2"),(0,o.stringProp)("MiddleName"),(0,o.stringProp)("Pseudo")],t.identityMatch=(0,a.match)(t.searchGetters)},71156:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.queryIdentitiesSelector=t.identityMappersSelector=t.identitySelector=t.identitiesByIdSelector=t.identitiesSelector=void 0;let a=r(11474),o=r(7299),n=r(24445),i=r(49548),s=r(24250),c=r(38728),l=r(49705);t.identitiesSelector=(0,i.createSelector)(e=>e.userSession.personalData.identities,l.quarantinedSpacesSelector,c.filterOutQuarantinedItems),t.identitiesByIdSelector=(0,i.createSelector)(t.identitiesSelector,e=>e.reduce((e,t)=>(e[t.Id]=t,e),{})),t.identitySelector=(e,r)=>{let a=(0,t.identitiesSelector)(e);return(0,n.findDataModelObject)(r,a)},t.identityMappersSelector=e=>(0,s.getIdentityMappers)(),t.queryIdentitiesSelector=(0,o.getQuerySelector)(t.identitiesSelector,()=>a.identityMatch,t.identityMappersSelector)},14950:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.makePersonalWebsiteSpecificProps=t.makeNewPersonalWebsite=t.makeUpdatedPersonalWebsite=void 0;let a=r(25903),o=r(54286),n=r(67179),i=r(22560);async function s(e,t,r){return i.default.log(`[Data] Updating existing PersonalWebsite with id: ${r.Id}`),{...r,...(0,o.makeUpdatedPersonalDataItemBase)({platformInfo:e,existingItem:r,updatedItem:t,itemUpdateDate:(0,n.getUnixTimestamp)()}),...l(t)}}async function c(e,t){return i.default.log("[Data] Adding new PersonalWebsite"),{...(0,o.makeNewPersonalDataItemBase)(e,t),...l(t)}}function l(e){let t=(0,a.defaultTo)("");return{Website:t(e.content.website),Name:t(e.content.name)}}t.makeUpdatedPersonalWebsite=s,t.makeNewPersonalWebsite=c,t.makePersonalWebsiteSpecificProps=l},2120:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.getPersonalWebsiteMappers=void 0;let a=r(15074);t.getPersonalWebsiteMappers=()=>({spaceId:e=>e.SpaceId,lastUse:a.lastUseMapper,id:e=>e.Id})},14681:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.personalWebsiteMatch=t.searchGetters=void 0;let a=r(23674),o=r(92595);t.searchGetters=[(0,o.stringProp)("Name"),(0,o.stringProp)("Website")],t.personalWebsiteMatch=(0,a.match)(t.searchGetters)},52581:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.queryPersonalWebsitesSelector=t.personalWebsiteMappersSelector=t.personalWebsiteSelector=t.personalWebsitesSelector=void 0;let a=r(49548),o=r(14681),n=r(7299),i=r(24445),s=r(2120),c=r(38728),l=r(49705);t.personalWebsitesSelector=(0,a.createSelector)(e=>e.userSession.personalData.personalWebsites,l.quarantinedSpacesSelector,c.filterOutQuarantinedItems),t.personalWebsiteSelector=(e,r)=>{let a=(0,t.personalWebsitesSelector)(e);return(0,i.findDataModelObject)(r,a)},t.personalWebsiteMappersSelector=e=>(0,s.getPersonalWebsiteMappers)(),t.queryPersonalWebsitesSelector=(0,n.getQuerySelector)(t.personalWebsitesSelector,()=>o.personalWebsiteMatch,t.personalWebsiteMappersSelector)},45018:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.parsePhoneNumbers=t.makePhoneSpecificProps=t.makeNewPhone=t.makeUpdatedPhone=void 0;let a=r(25903),o=r(51839),n=r(20648),i=r(54286),s=r(29485),c=r(67179),l=r(36598),u=r(22560);async function d(e,t,r){return u.default.log(`[Data] Updating existing Phone with id: ${r.Id}`),{...r,...(0,i.makeUpdatedPersonalDataItemBase)({platformInfo:e,existingItem:r,updatedItem:t,itemUpdateDate:(0,c.getUnixTimestamp)()}),...S(e,t)}}async function p(e,t){return u.default.log("[Data] Adding new Phone"),{...(0,i.makeNewPersonalDataItemBase)(e,t),...S(e,t)}}function S(e,t){let r=(0,a.defaultTo)(""),{Number:o,NumberInternational:i,NumberNational:s}=g(e,t);return{Number:o,NumberInternational:i,NumberNational:s,PersonalNote:r(t.content.personalNote),PhoneName:t.content.phoneName||s,Type:n.PhoneType[t.content.type]||n.PhoneType.PHONE_TYPE_ANY}}function g(e,t){let{localeFormat:r,number:a}=t.content;if(!a)return{Number:"",NumberInternational:"",NumberNational:""};let i=(0,s.isProposedLocaleLocalized)(r)&&n.Country[r]||n.Country[e.country]||n.Country.US;if(!(i?(0,o.isValidNumber)(a,i):(0,o.isValidNumber)(a)))return{Number:(0,l.removeNonDigitCharacters)(a),NumberInternational:a,NumberNational:a};let c=(0,o.parsePhoneNumber)(a,i),u=c.formatNational(),d=c.formatInternational();return{Number:(0,l.removeNonDigitCharacters)(a),NumberInternational:d,NumberNational:u}}t.makeUpdatedPhone=d,t.makeNewPhone=p,t.makePhoneSpecificProps=S,t.parsePhoneNumbers=g},5274:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.getPhoneMappers=void 0;let a=r(15074);t.getPhoneMappers=()=>({spaceId:e=>e.SpaceId,lastUse:a.lastUseMapper,id:e=>e.Id})},27893:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.phoneMatch=t.searchGetters=void 0;let a=r(23674),o=r(92595);t.searchGetters=[(0,o.stringProp)("Number"),(0,o.stringProp)("PhoneName")],t.phoneMatch=(0,a.match)(t.searchGetters)},90296:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.queryPhonesSelector=t.phoneSelector=t.phonesSelector=void 0;let a=r(27893),o=r(5274),n=r(7299),i=r(24445),s=r(49548),c=r(38728),l=r(49705);t.phonesSelector=(0,s.createSelector)(e=>e.userSession.personalData.phones,l.quarantinedSpacesSelector,c.filterOutQuarantinedItems),t.phoneSelector=(e,r)=>{let a=(0,t.phonesSelector)(e);return(0,i.findDataModelObject)(r,a)},t.queryPhonesSelector=(0,n.getQuerySelector)(t.phonesSelector,()=>a.phoneMatch,e=>(0,o.getPhoneMappers)())},63890:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.getLivePersonalInfo=void 0;let a=r(95121),o=r(15237),n=r(27011),i=r(92594);t.getLivePersonalInfo=e=>t=>{let r=e((0,n.parseToken)(t));return(0,a.pipe)((0,o.map)(r),(0,o.distinctUntilChanged)((e,t)=>(0,i.sameBatch)(e.items,t.items)&&e.matchingCount===t.matchingCount))}},23674:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.match=void 0;let a=r(82573);t.match=e=>(t,r)=>"string"==typeof t&&0!==t.length&&e.some(e=>{let o=e(r)||"";return(0,a.normalizeString)(o).includes(t)})},92595:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.stringProp=void 0;let a=r(25903);t.stringProp=e=>(0,a.prop)(e)},99040:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.viewListResults=void 0,t.viewListResults=e=>({items:t,matchingCount:r})=>({items:e(t),matchingCount:r})},76760:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.notifySharersSecretUpdated=t.makeSecretSpecificProps=t.makeNewSecret=t.makeUpdatedSecret=t.sharedFields=void 0;let a=r(25903),o=r(67179),n=r(80896),i=r(54286);async function s(e,t,r){return{...r,...(0,i.makeUpdatedPersonalDataItemBase)({platformInfo:e,existingItem:r,updatedItem:t,itemUpdateDate:(0,o.getUnixTimestamp)()}),...l(t.content)}}async function c(e,t){return{...(0,i.makeNewPersonalDataItemBase)(e,t),...l(t.content)}}function l(e){return{Title:e.title||"Untitled secret",Content:e.content||"",Secured:e.secured||!1}}async function u(e,r,o,s){if((0,a.equals)((0,a.pick)(t.sharedFields,r),(0,a.pick)(t.sharedFields,o)))return!0;try{return await (0,i.notifySharersOnUpdate)(e,o,s),!0}catch(t){let e=Error(`[Sharing] - notifySharersSecretUpdated: ${t}`);(0,n.sendExceptionLog)({error:e})}return!1}t.sharedFields=["Title","Content"],t.makeUpdatedSecret=s,t.makeNewSecret=c,t.makeSecretSpecificProps=l,t.notifySharersSecretUpdated=u},68352:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.secretsSelector=void 0;let a=r(49548),o=r(38728),n=r(49705);t.secretsSelector=(0,a.createSelector)(e=>e.userSession.personalData.secrets,n.quarantinedSpacesSelector,o.filterOutQuarantinedItems)},91095:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.config=void 0;let a=r(47585),o=r(16619),n=r(7868),i=r(18844),s=r(39306),c=r(95909);t.config={commands:{addSecureFile:{handler:a.addSecureFileHandler},validateSecureFile:{handler:s.validateSecureFileHandler},commitSecureFile:{handler:n.commitSecureFileHandler},clearSecureFileState:{handler:c.clearSecureFileStateHandler}},queries:{getFileUploadProgress:{selector:o.secureFileUploadSelector}},liveQueries:{liveFileUploadProgress:{operator:i.getFileUploadProgress$}}}},47585:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.addSecureFileHandler=t.createSecureFile=void 0;let a=r(20648),o=r(42387),n=r(27762),i=r(93748),s=r(12971),c=r(59587),l=r(92180),u=r(93308),d=r(60355),p=r(68662),S=r(76769),g=r(7300),m={success:!1,error:{code:a.SecureFileResultErrorCode.SERVER_ERROR}},y=e=>{switch(e){case a.SecureFileResultErrorCode.MAX_CONTENT_LENGTH_EXCEEDED:return a.SecureFileResultErrorCode.MAX_CONTENT_LENGTH_EXCEEDED;case a.SecureFileResultErrorCode.QUOTA_EXCEEDED:case a.SecureFileResultErrorCode.SOFT_QUOTA_EXCEEDED:case a.SecureFileResultErrorCode.HARD_QUOTA_EXCEEDED:return a.SecureFileResultErrorCode.QUOTA_EXCEEDED;default:return a.SecureFileResultErrorCode.SERVER_ERROR}},f=e=>"getAdditionalInfo"in e?{success:!1,error:{code:y(e.getAdditionalInfo().webServiceSubMessage)}}:m,E=(e,t,r,a,n,i)=>{let s=`{${(0,o.v4)()}}`,c=Math.floor(Date.now()/1e3);return{kwType:"KWSecureFileInfo",Id:s,LastBackupTime:0,CryptoKey:(0,u.bufferToBase64)(t),DownloadKey:"",Filename:a,LocalSize:e.byteLength,RemoteSize:r.byteLength,Type:n,CreationDatetime:c,UserModificationDatetime:c,Owner:i}};async function A(e,t,r,a){try{let{cryptoConfig:o}=(0,l.parsePayload)("$1$noderivation$aes256$cbchmac$16$"),n=(0,d.getRandomValues)(32),i=await (0,c.hashAndSplitKey)(n),S=(0,p.generateIV)(),g=await (0,s.encryptAES256)({key:i.aes,iv:S,clearData:e}),m=await (0,s.signHashHmacSHA256)({key:i.hmac,data:(0,u.concatBuffers)(S,g)}),y=(0,l.convertDashlaneSecureDataFlexibleToTransportableData)({salt:null,iv:S,hash:m,cipheredContent:g,cryptoConfig:o}),f=E(e,n,y,t,r,a);return{success:!0,secureFileDataBuffer:y,secureFileInfo:f}}catch(e){return{success:!1}}}async function h(e,t){try{let r=t.content.url,a=new FormData;for(let e of Object.keys(t.content.fields))a.append(e,t.content.fields[e]);a.append("key",`${t.content.key}`),a.append("acl",`${t.content.acl}`),a.append("file",new Blob([e]));let o=await fetch(r,{method:"POST",body:a});return 204===o.status}catch(e){return!1}}async function _({wsService:e,storeService:t},r){let o;let s=(0,i.userIdSelector)(t.getState());if(!(0,g.validateSecureFile)(r.fileName,r.fileType))return{success:!1,error:{code:a.SecureFileResultErrorCode.INVALID_FILE_TYPE}};t.dispatch((0,S.secureFileStartUploadAction)(r.serializedContent.length)),t.dispatch((0,S.secureFileStartCipheringAction)());try{let e=JSON.parse(r.serializedContent);o=new Uint8Array(e).buffer}catch(e){return{success:!1,error:{code:a.SecureFileResultErrorCode.INTERNAL_ERROR}}}let{secureFileDataBuffer:c,secureFileInfo:l}=await A(o,r.fileName,r.fileType,s),u=setInterval(()=>{t.dispatch((0,S.secureFileUploadChunkAction)(524288))},1e3),d=null;try{d=await e.secureFile.getUploadLink({contentLength:l.RemoteSize,secureFileInfoId:l.Id,login:s,uki:(0,n.ukiSelector)(t.getState())})}catch(e){return clearInterval(u),t.dispatch((0,S.secureFileUploadErrorAction)()),f(e)}return 200===d.code?(l.DownloadKey=d.content.key,await h(c,d))?(clearInterval(u),t.dispatch((0,S.secureFileUploadDoneAction)()),t.dispatch((0,S.secureFileUploadClearAction)()),{success:!0,secureFileInfo:l}):(clearInterval(u),m):(clearInterval(u),t.dispatch((0,S.secureFileUploadErrorAction)()),m)}t.createSecureFile=A,t.addSecureFileHandler=_},95909:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.clearSecureFileStateHandler=void 0;let a=r(76769);async function o({storeService:e},t){return e.dispatch((0,a.secureFileClearAction)(t)),Promise.resolve()}t.clearSecureFileStateHandler=o},7868:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.commitSecureFileHandler=void 0;let a=r(27762),o=r(93748),n=r(92830);async function i({wsService:e,sessionService:t,storeService:r},{secureFileInfo:i}){if(200!==(await e.secureFile.commit({key:i.DownloadKey,secureFileInfoId:i.Id,login:(0,o.userIdSelector)(r.getState()),uki:(0,a.ukiSelector)(r.getState())})).code)return{success:!1};try{return r.dispatch((0,n.savePersonalDataItem)(i,i.kwType)),t.getInstance().user.persistPersonalData(),{success:!0}}catch(e){return{success:!1}}}t.commitSecureFileHandler=i},39306:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.validateSecureFileHandler=void 0;let a=r(20648),o=r(7300);async function n(e,t){return(0,o.validateSecureFile)(t.fileName,t.fileType)?{success:!0}:{success:!1,error:{code:a.SecureFileResultErrorCode.INVALID_FILE_TYPE}}}t.validateSecureFileHandler=n},18844:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.getFileUploadProgress$=void 0;let a=r(95121),o=r(15237),n=r(16619);t.getFileUploadProgress$=()=>(0,a.pipe)((0,o.map)(n.secureFileUploadSelector),(0,o.distinctUntilChanged)())},16619:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.secureFileUploadSelector=void 0,t.secureFileUploadSelector=e=>e.userSession.secureFileStorageState.upload},7300:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.validateSecureFile=void 0;let a=r(19298),o=(e,t)=>"rar"===e&&!t,n=e=>a.allowedMimeTypes.includes(e),i=e=>a.allowedExtensions.includes(`.${e}`);t.validateSecureFile=(e,t)=>{let r=e.split(".").pop().toLowerCase();return o(r,t)||n(t)&&i(r)}},62640:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.updatedAt=t.createdAt=t.RequestError=void 0;let a=r(25903);t.RequestError=class extends Error{constructor(e,t){super(e),Object.setPrototypeOf(this,new.target.prototype),this.name="RequestError",this.code=t}},t.createdAt=e=>(0,a.isNil)(e.CreationDatetime)?(0,a.isNil)(e.CreationDate)?0:e.CreationDate:e.CreationDatetime,t.updatedAt=e=>(0,a.isNil)(e.UserModificationDatetime)?(0,a.isNil)(e.UpdateDate)?0:e.UpdateDate:e.UserModificationDatetime},18299:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.notifySharersNoteUpdated=t.makeNoteSpecificProps=t.makeNewNote=t.makeUpdatedNote=t.sharedFields=void 0;let a=r(25903),o=r(67179),n=r(80896),i=r(54286);async function s(e,t,r){return{...r,...(0,i.makeUpdatedPersonalDataItemBase)({platformInfo:e,existingItem:r,updatedItem:t,itemUpdateDate:(0,o.getUnixTimestamp)()}),...l(t.content,r)}}async function c(e,t){return{...(0,i.makeNewPersonalDataItemBase)(e,t),...l(t.content)}}function l(e,t){let r=t?t.CreationDate:(0,o.getUnixTimestamp)(),n=t?e.content!==t.Content?(0,o.getUnixTimestamp)():t.UpdateDate:r;return{Title:((0,a.isNil)(e.title)?t?.Title:e.title)||"Untitled note",Content:(0,a.isNil)(e.content)?(0,a.isNil)(t?.Content)?"":t?.Content:e.content,Category:(0,a.isNil)(e.category)?(0,a.isNil)(t?.Category)?"noCategory":t?.Category:e.category,Secured:(0,a.isNil)(e.secured)?!(0,a.isNil)(t?.Secured)&&t?.Secured:e.secured,Type:e.type||t?.Type||"GRAY",CreationDate:r,UpdateDate:n}}async function u(e,r,o,s){if((0,a.equals)((0,a.pick)(t.sharedFields,r),(0,a.pick)(t.sharedFields,o)))return!0;try{return await (0,i.notifySharersOnUpdate)(e,o,s),!0}catch(t){let e=Error(`[Sharing] - notifySharersNoteUpdated: ${t}`);return(0,n.sendExceptionLog)({error:e}),!1}}t.sharedFields=["Title","Content"],t.makeUpdatedNote=s,t.makeNewNote=c,t.makeNoteSpecificProps=l,t.notifySharersNoteUpdated=u},9534:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.getNoteMappers=void 0;let a=r(25903),o=r(62640),n=r(15074),i=e=>!!e.Attachments&&e.Attachments.length>0,s=(0,a.curry)((e,t)=>!!e[t.Id]);t.getNoteMappers=e=>({createdAt:o.createdAt,hasAttachments:i,id:e=>e.Id,isLimited:s(e),lastUse:n.lastUseMapper,spaceId:e=>e.SpaceId,title:e=>e.Title,updatedAt:o.updatedAt})},59047:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.fieldMappersSelector=t.noteSelector=void 0;let a=r(49548),o=r(90456),n=r(9534),i=r(24445),s=r(82098);t.noteSelector=(e,t)=>{let r=(0,s.notesSelector)(e);return(0,i.findDataModelObject)(t,r)},t.fieldMappersSelector=(0,a.createSelector)(o.limitedSharingItemsSelector,n.getNoteMappers)},82098:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.notesSelector=void 0;let a=r(49548),o=r(38728),n=r(49705);t.notesSelector=(0,a.createSelector)(e=>e.userSession.personalData.notes,n.quarantinedSpacesSelector,o.filterOutQuarantinedItems)},9509:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.config=void 0;let a=r(93748),o=r(75477),n=r(51236);t.config={commands:{updateProtectPasswordsSetting:{handler:n.updateProtectPasswordsSettingHandler},toggleDashlane:{handler:n.toggleDashlaneHandler},updateAutofillSettings:{handler:n.updateAutofillSettingsHandler},updateRichIconsSetting:{handler:n.updateRichIconsSettingHandler}},queries:{arePasswordsProtected:{selector:a.protectPasswordsSettingSelector},areRichIconsEnabled:{selector:a.richIconsSettingSelector}},liveQueries:{liveArePasswordsProtected:{operator:o.protectPasswordsSetting$},liveAreRichIconsEnabled:{operator:o.richIconsSetting$}}}},51236:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.updateAutofillSettingsHandler=t.toggleDashlaneHandler=t.updateRichIconsSettingHandler=t.updateProtectPasswordsSettingHandler=void 0;let a=r(20648),o=r(83533),n=r(80896),i=r(17620),s=r(80990),c=r(30081),l=r(10380);t.updateProtectPasswordsSettingHandler=(e,t)=>{try{return(0,s.updatePersonalSettings)(e.storeService,e.sessionService,{ProtectPasswords:t}),(0,c.sendUserSettingsLog)(e),Promise.resolve()}catch(t){let e=Error(`updateProtectPasswordsSettingHandler: ${t}`);(0,n.sendExceptionLog)({error:e,code:a.ExceptionCriticality.WARNING})}},t.updateRichIconsSettingHandler=({sessionService:e,storeService:t},r)=>{let c=(0,i.getDebounceSync)(t,e);try{return(0,s.updatePersonalSettings)(t,e,{RichIcons:r}),c({immediateCall:!0},o.Trigger.SettingsChange),Promise.resolve()}catch(t){let e=Error(`updateRichIconsSettingHandler: ${t}`);(0,n.sendExceptionLog)({error:e,code:a.ExceptionCriticality.WARNING})}},t.toggleDashlaneHandler=({sessionService:e,storeService:t},r)=>{let a=(0,i.getDebounceSync)(t,e),n=t.getPersonalSettings(),c=(0,l.toggleDashlaneOnSiteToPersonalSettingsPartial)(n,r);(0,s.updatePersonalSettings)(t,e,c),a({immediateCall:!0},o.Trigger.SettingsChange)},t.updateAutofillSettingsHandler=({sessionService:e,storeService:t},r)=>{let a=(0,i.getDebounceSync)(t,e);(0,s.updatePersonalSettings)(t,e,{AutofillSettings:r.AutofillSettings}),a({immediateCall:!0},o.Trigger.SettingsChange)}},75477:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.richIconsSetting$=t.protectPasswordsSetting$=void 0;let a=r(95121),o=r(15237),n=r(93748);t.protectPasswordsSetting$=()=>(0,a.pipe)((0,o.map)(n.protectPasswordsSettingSelector),(0,o.distinctUntilChanged)()),t.richIconsSetting$=()=>(0,a.pipe)((0,o.map)(n.richIconsSettingSelector),(0,o.distinctUntilChanged)())},10380:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.toggleDashlaneOnSiteToPersonalSettingsPartial=void 0;let a=r(25903),o=r(12857);t.toggleDashlaneOnSiteToPersonalSettingsPartial=function(e,t){let r=new o.ParsedURL(t.url).getRootDomain(),n=e.AutofillSettings;return{AutofillSettings:n={...n,disabledDomains:t.autofill?(0,a.without)([r],e.AutofillSettings.disabledDomains):(0,a.uniq)(e.AutofillSettings.disabledDomains.concat(r))}}}},80990:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.pickUpdatedPersonalSettings=t.isSaveCredentialDisabledOnDomain=t.signalSaveCredentialDisabled=t.updatePersonalSettings=void 0;let a=r(12857),o=r(22560),n=r(25903),i=r(33170);t.updatePersonalSettings=function(e,r,a){if(!e.isAuthenticated()){o.default.log("No session available to updatePersonalSettings");return}let n=(0,t.pickUpdatedPersonalSettings)(e.getPersonalSettings(),a);e.dispatch((0,i.editPersonalSettings)(n)),r.getInstance().user.persistPersonalSettings()},t.signalSaveCredentialDisabled=function(e,t,r){if(!e.isAuthenticated()){o.default.log("No session available, in theory this should not be called");return}let a=Array.isArray(e.getPersonalSettings().BanishedUrlsList)?e.getPersonalSettings().BanishedUrlsList:[];!(a.indexOf(r.fullDomain)>0)&&(e.dispatch((0,i.editPersonalSettings)({BanishedUrlsList:[...a,r.fullDomain]})),t.getInstance().user.persistPersonalSettings())},t.isSaveCredentialDisabledOnDomain=function(e,t){return e.isAuthenticated()?(Array.isArray(e.getPersonalSettings().BanishedUrlsList)?e.getPersonalSettings().BanishedUrlsList:[]).map(e=>new a.ParsedURL(e)).some(e=>e.getHostname()===t.fullDomain):(o.default.log("No session available, save credential is enabled by default"),!1)},t.pickUpdatedPersonalSettings=(e,t)=>{let r=(0,n.pick)(Object.keys(t))(e),a=(0,n.unapply)(n.identity);return(0,n.mergeAll)((0,n.difference)(a(t),a(r)))}},86471:function(e,t){var r;Object.defineProperty(t,"__esModule",{value:!0}),t.TeamDomainsMatchResult=void 0,(r=t.TeamDomainsMatchResult||(t.TeamDomainsMatchResult={}))[r.SomeFieldsMatch=0]="SomeFieldsMatch",r[r.NoFieldMatch=1]="NoFieldMatch"},37653:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.isItemToForceCategorize=t.isItemForceCategorizable=t.pickBestTeamSpace=t.pickBestTeamSpaceForForcedCategorization=t.pickBestTeamSpaceForForcedCategorizationForSharedItem=t.ForceCategorizableKWTypes=t.isTeamSpaceAfterGracePeriod=t.isTeamSpaceQuarantined=t.someFieldsMatchTeamDomains=void 0;let a=r(25903),o=r(20648),n=r(86471),i=r(74915),s=r(5053),c=r(32107);t.someFieldsMatchTeamDomains=(e,t)=>(t||[]).some(t=>{if("string"!=typeof t)return!1;let r=t.toLowerCase();return(e||[]).some(e=>"string"==typeof e&&e.toLowerCase().includes(r))});let l=e=>[e.Login,e.SecondaryLogin,e.Email,(0,i.getBestUrl)(e),...(0,c.getUserAddedLinkedWebsiteDomains)(e)],u=e=>[e.login,e.secondaryLogin,e.email,e.url,...e.linkedDomains??[]],d=(e,t)=>{let r=[e.Domain],a=(0,s.findAssociatedCredential)(e,t);return[...r,...a?l(a):[]]},p={[o.DataModelType.KWAuthentifiant]:l,[o.DataModelType.KWGeneratedPassword]:d,[o.DataModelType.KWEmail]:e=>[e.Email]};function S(e){let t=p[e.kwType];return t?t(e):[]}let g=e=>t=>e===t.teamId;t.isTeamSpaceQuarantined=e=>"revoked"===e.status,t.isTeamSpaceAfterGracePeriod=e=>(0,t.isTeamSpaceQuarantined)(e)&&!!e.shouldDelete,t.ForceCategorizableKWTypes=[o.DataModelType.KWAuthentifiant,o.DataModelType.KWEmail,o.DataModelType.KWGeneratedPassword],t.pickBestTeamSpaceForForcedCategorizationForSharedItem=(e,r)=>{let a=u(r),o=r.spaceId;return(0,t.pickBestTeamSpace)(e,a,o)},t.pickBestTeamSpaceForForcedCategorization=(e,r,a)=>{let n=r.SpaceId,i=(0,o.isGeneratedPassword)(r)?d(r,a):S(r);return(0,t.pickBestTeamSpace)(e,i,n)},t.pickBestTeamSpace=(e,r,o)=>{let i=e.reduce((e,a)=>{let o=(0,t.someFieldsMatchTeamDomains)(r,a.info.teamDomains);return{...e,[a.teamId]:o}},{}),s=e.filter(e=>i[e.teamId]||(0,t.isTeamSpaceQuarantined)(e)&&e.teamId===o),[c,l]=(0,a.partition)(t.isTeamSpaceQuarantined,s),[u,d]=(0,a.partition)(t.isTeamSpaceAfterGracePeriod,c),[p,S]=(0,a.partition)(g(o),l),m=[...u,...d,...p,...S];if(0===m.length)return null;let y=m[0],f=y.teamId===o&&!(0,t.isTeamSpaceQuarantined)(y),E=e.find(e=>e.teamId===o);return E?.status==="accepted"||f?null:{teamSpace:y,domainsMatchResult:i[y.teamId]?n.TeamDomainsMatchResult.SomeFieldsMatch:n.TeamDomainsMatchResult.NoFieldMatch}},t.isItemForceCategorizable=function(e){return e.kwType in p},t.isItemToForceCategorize=(e,r)=>{if(!r?.info)return!1;let{forcedDomainsEnabled:a,teamDomains:o}=r.info;if(!a)return!1;let n=S(e);return(0,t.someFieldsMatchTeamDomains)(n,o)}},49705:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.quarantinedSpacesSelector=t.forceCategorizableItemsSelector=t.spacesWithForcedCategorizationEnabledSelector=void 0;let a=r(49548),o=r(48434),n=r(37653),i=r(93192),s=r(50830);t.spacesWithForcedCategorizationEnabledSelector=e=>(e.userSession?.spaceData?.spaces||[]).filter(e=>e?.details?.info&&Array.isArray(e.details.info.teamDomains)&&e.details.info.teamDomains.length>0&&!!e.details.info.forcedDomainsEnabled),t.forceCategorizableItemsSelector=e=>(0,s.personalDataItemsOfTypeSelector)(e,n.ForceCategorizableKWTypes),t.quarantinedSpacesSelector=(0,a.createSelector)([o.spacesSelector],e=>e.filter(i.isQuarantined))},18543:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.getSmartCategorizedSpace=void 0;let a=r(19986),o=e=>e.filter(e=>e.details?.status==="accepted"&&e.details?.info?.forcedDomainsEnabled);t.getSmartCategorizedSpace=e=>t=>{let r=o(e),n=r?.[0]?.details?.info?.teamDomains??[];return(0,a.isCredentialSmartCategorized)(t,n)?r[0]:null}},10167:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.applyTeamSpaceContentControlRules=void 0;let a=r(20648),o=r(80896),n=r(93625),i=r(31785),s=r(12653),c=r(27762),l=r(49705);async function u(e,t,r){let{updates:a,deletions:o,changeHistories:i}=r,s=a.length>0,c=function({deletions:e}){return Object.keys(e).reduce((t,r)=>t+e[r].length,0)}(r)>0;(s||c)&&(t.dispatch((0,n.teamSpaceContentControlApplied)(a,o,i)),await e.getInstance().user.persistPersonalData())}async function d(e,t,r,n,d){try{let o=r.getState(),p=(0,l.spacesWithForcedCategorizationEnabledSelector)(o);if(0===p.length)return;let S=(0,s.controlTeamSpacesContent)({spaces:p,...(0,i.teamSpaceContentControlStateSelector)(o)}),g=S.deletions.KWAuthentifiant||[],m=S.updates.filter(a.isCredential).map(e=>e.Id),y=S.hiddenItemIds,f=[...g,...m,...y];await u(t,r,S);let E=p.filter(e=>e.details.shouldDelete);if(!function(e,t,r){let a=e.getUserLogin(),o=(0,c.ukiSelector)(e.getState());r.forEach(e=>{t.teamPlans.spaceDeleted({login:a,uki:o,teamId:Number(e.teamId)})})}(r,n,E),!function(e,t){let{deletions:r,hiddenItemIds:a,updates:o}=t,n={deletedItemIds:Object.keys(r).reduce((e,t)=>[...e,...r[t]],[]),hiddenItemIds:a,updatedItemIds:o.map(e=>e.Id)};e.teamSpaceContentControlDone(n)}(e,S),f.length>0){let{commands:{recalculatePasswordHealth:e}}=d.createClients().passwordHealth;e()}}catch(t){let e=Error(`[Spaces] - runTeamSpaceContentControlJob: ${t}`);(0,o.sendExceptionLog)({error:e})}}t.applyTeamSpaceContentControlRules=d},12653:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.controlTeamSpacesContent=void 0;let a=r(20648),o=r(91783),n=r(48140),i=r(86471),s=r(37653),c=r(3313),l=r(45657);function u(e,t){return{...e,SpaceId:t}}let d=e=>e.info.removeForcedContentEnabled&&e.shouldDelete;t.controlTeamSpacesContent=function(e){let t={deletions:{KWAuthentifiant:[],KWEmail:[],KWGeneratedPassword:[]},updates:[],changeHistories:[],hiddenItemIds:[]};return 0===e.spaces.length?t:e.items.reduce((t,r)=>(function(e,t,r){let p=e.spaces.map(e=>e.details),S=(0,s.pickBestTeamSpaceForForcedCategorization)(p,r,e.credentials);if(!S)return t;let{teamSpace:g}=S,{status:m}=g;switch(m){case"accepted":return function(e,t,r,o){let{updates:n,changeHistories:i}=t,{teamId:s}=r,{deviceName:d,login:p,personalData:S,platformInfo:g}=e,m=u(o,s),y=(0,a.isCredential)(m)?(0,c.getUpdatedItemChangeHistory)({change:(0,l.makeUpdateChange)(m),deviceName:d,personalData:S,userLogin:p,platformInfo:g}):null;return{...t,updates:n.concat(m),changeHistories:y?i.concat(y):i}}(e,t,g,r);case"revoked":return function(e,t,r,s){let{teamSpace:p,domainsMatchResult:S}=t,{hiddenItemIds:g}=s,m=d(p)?function(e,t,r,s){let{domainsMatchResult:d}=t;switch(d){case i.TeamDomainsMatchResult.SomeFieldsMatch:return function(e,t,r){let{deletions:o,changeHistories:n}=t,{deviceName:i,login:s,personalData:u,platformInfo:d}=e,{kwType:p}=r,S=(0,a.isCredential)(r)?(0,c.getUpdatedItemChangeHistory)({change:(0,l.makeRemovalChange)(r),deviceName:i,personalData:u,userLogin:s,platformInfo:d}):null;return{...t,deletions:{...o,[p]:o[p].concat(r.Id)},changeHistories:S?n.concat(S):n}}(e,s,r);case i.TeamDomainsMatchResult.NoFieldMatch:return function(e,t,r){let{updates:o,changeHistories:i}=t,{deviceName:s,login:d,personalData:p,platformInfo:S}=e,g=u(r,n.PERSONAL_SPACE_ID),m=(0,a.isCredential)(g)?(0,c.getUpdatedItemChangeHistory)({change:(0,l.makeUpdateChange)(g),deviceName:s,personalData:p,userLogin:d,platformInfo:S}):null;return{...t,updates:o.concat(g),changeHistories:m?i.concat(m):i}}(e,s,r);default:return(0,o.assertUnreachable)(d)}}(e,t,r,s):s,y=S===i.TeamDomainsMatchResult.SomeFieldsMatch?[...g,r.Id]:g;return{...m,hiddenItemIds:y}}(e,S,r,t);default:return t}})(e,t,r),t)}},31785:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.teamSpaceContentControlStateSelector=void 0;let a=r(29509),o=r(93748),n=r(370),i=r(50830),s=r(67584),c=r(39442),l=r(12602),u=r(90410),d=r(49705),p=e=>({KWAuthentifiant:(0,l.countAllCredentialsSelector)(e),KWEmail:(0,c.countAllEmailsSelector)(e),KWGeneratedPassword:(0,s.countAllGeneratedPasswordsSelector)(e)});t.teamSpaceContentControlStateSelector=e=>({credentials:(0,u.unsafeAllCredentialsSelector)(e),itemCountByType:p(e),items:(0,d.forceCategorizableItemsSelector)(e),personalData:(0,i.personalDataSelector)(e),platformInfo:(0,a.platformInfoSelector)(e),login:(0,o.userLoginSelector)(e),deviceName:(0,n.deviceNameSelector)(e)})},3965:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.setupSubscriptions=void 0;let a=r(10167);t.setupSubscriptions=function(e,t){let{sessionService:r,storeService:o,wsService:n,applicationModulesAccess:i}=t;e._sessionOpened.on(()=>{(0,a.applyTeamSpaceContentControlRules)(e,r,o,n,i)})}},27052:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.config=void 0;let a=r(48434);t.config={commands:{},queries:{getSpace:{selector:a.viewedSpaceSelector},getSpaces:{selector:a.viewedSpacesSelector}},liveQueries:{}}},74453:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.associateTeamSpaceId=void 0;let a=r(37653),o=e=>e.filter(e=>e.info.forcedDomainsEnabled&&e.info.teamDomains.length&&!(0,a.isTeamSpaceQuarantined)(e));t.associateTeamSpaceId=function(e,t,r){if(!(0,a.isItemForceCategorizable)(e)||!t||0===t.length)return e;let n=o(t);if(!n.length)return e;let i=(0,a.pickBestTeamSpaceForForcedCategorization)(n,e,r);return i?{...e,SpaceId:i.teamSpace.teamId}:e}},48140:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.PERSONAL_SPACE_ID=void 0,t.PERSONAL_SPACE_ID=""},20126:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.getDefaultPersonalSpace=t.isSpaceItem=void 0;let a=r(20648),o=r(48140);t.isSpaceItem=e=>"SpaceId"in e&&"string"==typeof e.SpaceId,t.getDefaultPersonalSpace=()=>({associatedEmail:null,billingAdmins:[],color:"",companyName:null,info:{name:"",forcedDomainsEnabled:!1,teamDomains:[]},invitationDate:null,isBillingAdmin:!1,isSSOUser:!1,isTeamAdmin:!1,joinDate:null,letter:"",membersNumber:null,planType:null,revokeDate:null,status:a.SpaceStatus.Accepted,teamAdmins:[],teamId:o.PERSONAL_SPACE_ID,teamName:null,tier:a.SpaceTiers.Free,shouldDelete:!1})},93192:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.isQuarantined=t.isPremiumStatusSpaceQuarantined=void 0,t.isPremiumStatusSpaceQuarantined=e=>!!e?.status&&"accepted"!==e.status.toLowerCase()&&!!e.info&&Array.isArray(e.info.teamDomains)&&e.info.teamDomains.length>0&&!!e.info.removeForcedContentEnabled,t.isQuarantined=e=>e&&(0,t.isPremiumStatusSpaceQuarantined)(e.details)},48434:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.viewedSpaceSelector=t.viewedSpacesSelector=t.activeSpacesDetailsSelector=t.activeSpacesSelector=t.spacesSelector=void 0;let a=r(20126),o=r(11261),n=[];t.spacesSelector=e=>e.userSession?.spaceData?.spaces??n,t.activeSpacesSelector=e=>((0,t.spacesSelector)(e)||[]).filter(e=>e.details&&"accepted"===e.details.status),t.activeSpacesDetailsSelector=e=>(0,t.activeSpacesSelector)(e).map(e=>e.details),t.viewedSpacesSelector=e=>{let r=e.userSession.localSettings.nodePremiumStatus.b2bStatus;return r&&"in_team"===r.statusCode&&!r.currentTeam?.teamInfo.personalSpaceEnabled&&(0,t.activeSpacesDetailsSelector)(e).length?(0,o.listView)([...(0,t.activeSpacesDetailsSelector)(e)]):(0,o.listView)([...(0,t.activeSpacesDetailsSelector)(e),(0,a.getDefaultPersonalSpace)()])},t.viewedSpaceSelector=(e,r)=>(0,t.viewedSpacesSelector)(e).find(e=>e.spaceId===r)},11261:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.listView=t.itemView=void 0,t.itemView=({color:e,letter:t,info:r,teamId:a,isSSOUser:o})=>({spaceId:a,displayName:r.name??"",color:e,letter:t,settings:{enableForcedCategorization:r.forcedDomainsEnabled,spaceForcedDomains:r.teamDomains},isSSOUser:o}),t.listView=e=>e.map(t.itemView)},86200:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.vaultConfig=void 0;let a=r(16829);t.vaultConfig={commands:{deleteVaultModuleItem:{handler:a.deleteVaultModuleItemHandler},deleteVaultModuleItemsBulk:{handler:a.deleteVaultModuleItemsBulkHandler},disableVaultItemProtection:{handler:a.disableVaultProtectionHandler}},queries:{},liveQueries:{}}},16829:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.disableVaultProtectionHandler=t.deleteVaultModuleItemsBulkHandler=t.deleteVaultModuleItemHandler=void 0;let a=r(20648),o=r(83533),n=r(3313),i=r(13768),s=r(48505),c=r(50354),l=r(18049),u=r(51236),d=r(22560),p=r(80896),S=r(67095),g=r(93748),m=r(93625),y=(e,t)=>{let r=null;return(0,n.isChangeHistoryCandidate)(t)&&(r=(0,c.getRemoveChangeHistory)(e,t)),r},f=async({storeService:e,eventLoggerService:t},{id:r,kwType:n})=>{let i=(0,s.findPersonalDataItemToDelete)(e,r,n);if(!i){var c;return!function(e){let t=Error(`[DataManagement] - Vault API: ${e}`);(0,p.sendExceptionLog)({error:t}),d.default.error(t)}(c=a.deleteVaultModuleItemFailureReason.NOT_FOUND),{success:!1,error:{reason:c}}}let u=y(e,i);return(0,l.logDeleteVaultItem)(e,t,i,o.UpdateCredentialOrigin.Manual,null),e.dispatch((0,m.deleteVaultModuleItem)({kwType:i.kwType,id:r,changeHistory:u})),{success:!0}};t.deleteVaultModuleItemHandler=f;let E=async({storeService:e,eventLoggerService:t},{kwType:r,items:n})=>{let i={kwType:r,items:[]},c=[],u=[];for(let{id:t}of n){let o=null,n=(0,s.findPersonalDataItemToDelete)(e,t,r);if(!n){reportError(o={id:t,reason:a.deleteVaultModuleItemFailureReason.NOT_FOUND}),c.push(o);continue}let l=y(e,n);i.items.push({id:t,changeHistory:l}),u.push(n)}for(let r of u)(0,l.logDeleteVaultItem)(e,t,r,o.UpdateCredentialOrigin.Manual,null);return(i.items.length&&e.dispatch((0,m.deleteVaultModuleItemsBulk)(i)),n.length!==i.items.length||c.length)?{success:!1,error:{errors:c}}:{success:!0}};t.deleteVaultModuleItemsBulkHandler=E;let A=async(e,t)=>{let r=e.storeService.getState();if((0,i.credentialSelector)(r,t)){if((0,g.protectPasswordsSettingSelector)(r)){(0,u.updateProtectPasswordsSettingHandler)(e,!1);return}(0,S.disableCredentialProtection)(e,t)}};t.disableVaultProtectionHandler=A},23585:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.bootstrap=void 0;let a=r(68849);t.bootstrap=e=>{e.register(a.config)}},54286:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.computeAndSendCollectionImportActivityLog=t.computeAndSendCSVImportActivityLog=t.computeAndSendDeletedCredentialActivityLog=t.computeAndSendModifiedCredentialActivityLog=t.computeAndSendCreatedCredentialActivityLog=t.shouldSendCreateOrModifiedCredentialActivityLog=t.notifySharersOnUpdate=t.makeNewPersonalDataItemBase=t.makeUpdatedPersonalDataItemBase=void 0;let a=r(42387),o=r(20648),n=r(7795),i=r(12857),s=r(67179),c=r(61681),l=r(29485),u=r(76369),d=r(37653),p=r(93748),S=r(21815);function g(e){let t="MANUAL"===e.updatedItem.origin?{UserModificationDatetime:e.itemUpdateDate}:{};return{LocaleFormat:(0,l.getLocaleFormat)(e.platformInfo,e.existingItem,e.updatedItem),SpaceId:void 0!==e.updatedItem.content.spaceId?e.updatedItem.content.spaceId:e.existingItem?.SpaceId??"",Attachments:e.updatedItem.content.attachments,...t}}async function m(e,t,r){let a=await (0,S.convertItemToDashlaneXml)(e,t);a.success&&r.createClients().sharingItems.commands.updateSharedItemContent({itemContent:a.xml,itemId:t.Id})}function y(e){return async(t,r)=>{let o;let s={domain_url:new i.ParsedURL(r.domainUrl).getRootDomain()??""},c={import_count:r.importCount??0};o=e===n.ActivityLogType.UserImportedCredentials?c:e===n.ActivityLogType.UserImportedCollection?{collection_name:r.collectionName,credential_count:r.itemCount}:s;let l={category:n.ActivityLogCategory.VaultPasswords,log_type:e,properties:o,is_sensitive:e!==n.ActivityLogType.UserImportedCredentials||void 0,date_time:new Date().getTime(),schema_version:"1.0.0",uuid:(0,a.v4)().toUpperCase()};await t.createClients().activityLogs.commands.storeActivityLogs({activityLogs:[l]})}}t.makeUpdatedPersonalDataItemBase=g,t.makeNewPersonalDataItemBase=function(e,t,r=(0,s.getUnixTimestamp)()){return{kwType:t.kwType,Id:(0,c.generateItemUuid)(),CreationDatetime:r,LastBackupTime:0,LastUse:r,...g({platformInfo:e,updatedItem:t,itemUpdateDate:r})}},t.notifySharersOnUpdate=m,t.shouldSendCreateOrModifiedCredentialActivityLog=function(e,t,r){let a=(0,u.currentTeamIdSelector)(e.getState()),n=(0,p.activeSpacesSelector)(e.getState())[0],i=(0,d.isItemToForceCategorize)(t,n);return r!==o.SaveOrigin.IMPORT&&(t.SpaceId===a||i)},t.computeAndSendCreatedCredentialActivityLog=y(n.ActivityLogType.UserCreatedCredential),t.computeAndSendModifiedCredentialActivityLog=y(n.ActivityLogType.UserModifiedCredential),t.computeAndSendDeletedCredentialActivityLog=y(n.ActivityLogType.UserDeletedCredential),t.computeAndSendCSVImportActivityLog=y(n.ActivityLogType.UserImportedCredentials),t.computeAndSendCollectionImportActivityLog=y(n.ActivityLogType.UserImportedCollection)},67003:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.bootstrap=t.setupSubscriptions=void 0;let a=r(29898);Object.defineProperty(t,"setupSubscriptions",{enumerable:!0,get:function(){return a.setupSubscriptions}});var o=r(23585);Object.defineProperty(t,"bootstrap",{enumerable:!0,get:function(){return o.bootstrap}})},67803:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.makeLiveSelectorGetter=void 0;let a=r(49548),o=r(99040),n=r(7299);t.makeLiveSelectorGetter=(e,t,r,i)=>s=>(0,a.createSelector)(e,i,r,t,(e,t,r,a)=>(0,o.viewListResults)(a)((0,n.applyQuery)(r,t,s,e)))},38728:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.filterOutQuarantinedItems=t.itemIsNotQuarantined=void 0;let r=(e,t)=>{let r=t.find(t=>t.details&&t.teamId===e.SpaceId);return r?r.details:null},a=(e,t)=>e.SpaceId===t.teamId;t.itemIsNotQuarantined=(e,t)=>{let o=r(t,e);return!o||!a(t,o)},t.filterOutQuarantinedItems=(e,r)=>0===r.length?e:e.filter(e=>(0,t.itemIsNotQuarantined)(r,e))},7299:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.applyQuery=t.getQuerySelector=void 0;let a=r(27011),o=r(66175);t.getQuerySelector=(e,r,a)=>(o,n)=>{let i=e(o),s=a(o),c=r(o);return(0,t.applyQuery)(c,s,n,i)},t.applyQuery=(e,t,r,n)=>{let i;let{sortToken:s,filterToken:c,limit:l}=r,u=(i=(0,a.filterData)(t,e,c,n),(0,o.sortData)(t,s,i));return{items:l?u.slice(0,l):u,matchingCount:u.length}}},29485:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.getValidState=t.isProposedLocaleLocalized=t.getLocaleFormat=void 0;let a=r(20648),o=r(22560),n=r(19298);function i(e){return!!n.Country[e]&&[n.Country.NO_TYPE,n.Country.UNIVERSAL].every(t=>t!==e)}t.getLocaleFormat=function(e,t,r){if(!(0,a.isObjectLocalized)(r))return n.Country.UNIVERSAL;let o=n.Country[r.content.localeFormat],s=i(o),c=t&&t.LocaleFormat?t.LocaleFormat:n.Country[e.country]||n.Country.US;return o&&s?o:c},t.isProposedLocaleLocalized=i,t.getValidState=function(e,t){return n.geographicStates[e]&&"object"==typeof n.geographicStates[e]&&t in n.geographicStates[e]?t:(o.default.log(`[Data] Given value (${t}) is not a valid state value for country code ${e}`),"")}},29898:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.setupSubscriptions=void 0;let a=r(3965),o=r(65666),n=r(56266);t.setupSubscriptions=function(e,t){(0,a.setupSubscriptions)(e,t),(0,o.setupSubscriptions)(e,t),(0,n.setupSubscriptions)(e,t)}},77164:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.isDataKeyVaultItem=t.PERSONAL_DATA_META_DATA=void 0,t.PERSONAL_DATA_META_DATA=["changeHistories","changesToUpload","generatedPasswords","securityBreaches","securityBreachesMetadata","breachesUpdaterStatus","breachRefreshMetaData","versionedBreaches","secureFileInfo","noteCategories","paypalAccounts","credentialCategories"],t.isDataKeyVaultItem=function(e){return!t.PERSONAL_DATA_META_DATA.includes(e)}},17620:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.getDefaultSpaceId=t.getCurrentItems=t.getDebounceSync=t.WAIT_MS_BEFORE_SYNC=t.nextTick=void 0,t.nextTick=r(75895);let a=r(20648),o=r(24519),n=r(22560),i=r(27698),s=r(35192),c=r(48140),l=r(48434);t.WAIT_MS_BEFORE_SYNC=6e4,t.getDebounceSync=(e,r)=>(0,o.debounce)(a=>{n.Debugger.log("DebounceSync called => informClientsAndSyncPersonalDataChange()"),(0,i.reportDataUpdate)(e),(0,t.nextTick)(()=>{r.getInstance().user.attemptSync(a)})},t.WAIT_MS_BEFORE_SYNC),t.getCurrentItems=(e,t)=>{let r=a.DATAMODELOBJECT_TYPE_TO_CARBON_STORE_KEY[e];return t?.[r]||[]},t.getDefaultSpaceId=e=>{let t=e.getState(),r=(0,l.activeSpacesSelector)(t)[0];return(0,s.isPersonalSpaceEnabledSelector)(t)?c.PERSONAL_SPACE_ID:r.teamId}},31180:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.maybeDataModelDetailView=t.dataModelDetailView=t.dataModelItemView=void 0;let r=e=>({id:e.Id});t.dataModelItemView=e=>({...r(e),hasAttachments:Array.isArray(e.Attachments)&&e.Attachments.length>0,kwType:e.kwType,lastUse:e.LastUse,localeFormat:e.LocaleFormat,spaceId:e.SpaceId});let a=e=>({id:e.Id});t.dataModelDetailView=e=>({...a(e),attachments:e.Attachments||[],kwType:e.kwType,lastUse:e.LastUse,localeFormat:e.LocaleFormat,spaceId:e.SpaceId}),t.maybeDataModelDetailView=e=>t=>t?e(t):void 0},38266:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.config=void 0;let a=r(83784),o=r(29509),n=r(18112);t.config={commands:{cleanRemotelyRemovedProfiles:{handler:n.cleanRemotelyRemovedProfilesHandler}},queries:{getAnonymousComputerId:{selector:a.anonymousComputerIdSelector},getPlatformInfo:{selector:o.platformInfoSelector}},liveQueries:{}}},13776:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.triggerABTestingChanged=void 0;let a=r(25047);t.triggerABTestingChanged=function(e){(0,a.default)().abTestingChanged({version:e.version})}},50565:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.killswitchStateUpdated=void 0;let a=r(73164);t.killswitchStateUpdated=e=>({type:a.KILLSWITCH_STATE_UPDATED,killswitchState:e})},86630:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.killswitchReducer=t.getEmptyKillswitchState=t.DEFAULT_EMPTY_KILLSWITCH_STATE=void 0;let a=r(45991),o=r(73164);function n(){return t.DEFAULT_EMPTY_KILLSWITCH_STATE}t.DEFAULT_EMPTY_KILLSWITCH_STATE=Object.freeze({disableAutofill:!1,disableMLAntiPhishing:!1,disableLoginFlowMigration:!1,brazeContentCardsDisabled:!1,disableAutoSSOLogin:!1,disablePhishingResistance:!1}),t.getEmptyKillswitchState=n,t.killswitchReducer=(e=n(),t)=>t.type===o.KILLSWITCH_STATE_UPDATED?(0,a.shallowEqual)(e,t.killswitchState)?e:{...e,...t.killswitchState}:e},73164:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.KILLSWITCH_STATE_UPDATED=void 0,t.KILLSWITCH_STATE_UPDATED="KILLSWITCH_STATE_UPDATED"},67293:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.blacklistedDeviceKeys=void 0,t.blacklistedDeviceKeys=["remoteFile"]},59730:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.bootstrap=void 0;let a=r(38266);t.bootstrap=e=>{e.register(a.config)}},2972:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.cleanRemotelyRemovedProfilesHandler=void 0;let a=r(62923);async function o({storageService:e,storeService:t,moduleClients:{"carbon-legacy":r}}){try{await (0,a.deviceRemoteDeletion)(t,e,r)}catch(e){throw Error("Failed to perform device remote deletion")}}t.cleanRemotelyRemovedProfilesHandler=o},18112:function(e,t,r){var a=this&&this.__createBinding||(Object.create?function(e,t,r,a){void 0===a&&(a=r);var o=Object.getOwnPropertyDescriptor(t,r);(!o||("get"in o?!t.__esModule:o.writable||o.configurable))&&(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,a,o)}:function(e,t,r,a){void 0===a&&(a=r),e[a]=t[r]}),o=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||a(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),o(r(2972),t)},50083:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.bootstrap=void 0;var a=r(59730);Object.defineProperty(t,"bootstrap",{enumerable:!0,get:function(){return a.bootstrap}})},52780:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.secureDeviceName=void 0,t.secureDeviceName=function(e){return e?e.replace(/https?:\/\//g," "):e}},83784:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.anonymousComputerIdSelector=void 0;let a=r(15535);t.anonymousComputerIdSelector=()=>(0,a.getCommonAppSetting)("anonymousComputerId")},7225:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.EventBusConnectors=void 0;let a=r(12791);t.EventBusConnectors={syncFailure:(0,a.slot)(),syncSuccess:(0,a.slot)(),teamSpaceContentControlDone:(0,a.slot)(),sessionClosed:(0,a.slot)(),familyMemberLeft:(0,a.slot)(),remoteFileChanged:(0,a.slot)(),appInitialized:(0,a.slot)(),coreServicesReady:(0,a.slot)(),_sessionOpened:(0,a.slot)(),carbonSessionOpened:(0,a.slot)()}},28666:function(e,t,r){var a=this&&this.__createBinding||(Object.create?function(e,t,r,a){void 0===a&&(a=r);var o=Object.getOwnPropertyDescriptor(t,r);(!o||("get"in o?!t.__esModule:o.writable||o.configurable))&&(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,a,o)}:function(e,t,r,a){void 0===a&&(a=r),e[a]=t[r]}),o=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||a(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),t.makeEventBusService=void 0;let n=r(12791),i=r(7225);t.makeEventBusService=()=>(0,n.createEventBus)({events:i.EventBusConnectors}),o(r(32277),t)},32277:function(e,t){Object.defineProperty(t,"__esModule",{value:!0})},27012:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.carbonEventHooks=void 0;let a=r(52205);t.carbonEventHooks={iconsUpdates:a.iconsUpdatesHook}},83158:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.defaultCarbonEventStore=void 0,t.defaultCarbonEventStore={iconsUpdates:[]}},98770:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.clearInstance=t.getInstance=t.setInstance=void 0;let a=r(88620),o=r(27012),n=null;t.setInstance=e=>{n=new a.EventStoreConsumer(e,o.carbonEventHooks)},t.getInstance=()=>{if(!n)throw Error("Cannot get EventStoreConsumer instance");return n},t.clearInstance=()=>{n&&n.teardown(),n=null}},37313:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.clearInstance=t.getInstance=t.setInstance=void 0;let r=null;t.setInstance=e=>{r=e},t.getInstance=()=>{if(!r)throw Error("Cannot get EventStore instance");return r},t.clearInstance=()=>{r&&r.teardown(),r=null}},13448:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.config=void 0;let a=r(66416);t.config={commands:{},queries:{getHasFeature:{selectorFactory:async e=>(await (0,a.makeFeatureFlipsSelectors)(e.applicationModulesAccess)).getHasFeatureSelector},getFeatures:{selectorFactory:async e=>(await (0,a.makeFeatureFlipsSelectors)(e.applicationModulesAccess)).featureFlipsSelector}},liveQueries:{}}},75618:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.bootstrap=void 0;let a=r(13448);t.bootstrap=e=>{e.register(a.config)}},56243:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.bootstrap=void 0;var a=r(75618);Object.defineProperty(t,"bootstrap",{enumerable:!0,get:function(){return a.bootstrap}})},66416:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.makeFeatureFlipsSelectors=t.makeGetHasFeatureSelector=t.makeFeatureFlipsSelector=void 0;let a=r(95121),o=r(77323);t.makeFeatureFlipsSelector=e=>async()=>{let{queries:t}=e.createClients().featureFlips,r=await (0,a.firstValueFrom)(t.userFeatureFlips());return(0,o.isSuccess)(r)?r.data:{}},t.makeGetHasFeatureSelector=e=>async(t,r)=>{let{queries:n}=e.createClients().featureFlips,i=await (0,a.firstValueFrom)(n.userFeatureFlips());if((0,o.isSuccess)(i))return i.data[r]},t.makeFeatureFlipsSelectors=e=>({featureFlipsSelector:(0,t.makeFeatureFlipsSelector)(e),getHasFeatureSelector:(0,t.makeGetHasFeatureSelector)(e)})},89149:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.config=void 0;let a=r(46021);t.config={commands:{setGlobalExtensionSettings:{handler:a.setGlobalExtensionSettings},getGlobalExtensionSettings:{handler:a.getGlobalExtensionSettings}},queries:{},liveQueries:{}}},75824:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.setGlobalExtensionSettingsState=t.SET_GLOBAL_EXTENSION_SETTINGS=void 0,t.SET_GLOBAL_EXTENSION_SETTINGS="SET_GLOBAL_EXTENSION_SETTINGS",t.setGlobalExtensionSettingsState=e=>({type:t.SET_GLOBAL_EXTENSION_SETTINGS,extensionSettings:e})},3104:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.globalExtensionSettingsReducer=void 0;var a=r(68325);Object.defineProperty(t,"globalExtensionSettingsReducer",{enumerable:!0,get:function(){return a.globalExtensionSettingsReducer}})},68325:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.globalExtensionSettingsReducer=void 0;let a=r(75824);t.globalExtensionSettingsReducer=(e={},t)=>t.type===a.SET_GLOBAL_EXTENSION_SETTINGS?Object.assign({},e,{extensionSettings:t.extensionSettings}):e},59464:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.bootstrap=void 0;let a=r(89149),o=r(46021),n=r(80896),i=r(75824);t.bootstrap=(e,t)=>{e.register(a.config);let{storeService:r,storageService:s,applicationModulesAccess:c}=t;(0,o.getGlobalExtensionSettings)({storeService:r,storageService:s}).then(e=>{r.dispatch((0,i.setGlobalExtensionSettingsState)(e)),(0,o.setExceptionLogsConsent)(c,e.interactionDataConsent??!0),(0,n.setAllowedToSendExceptionLog)(e.interactionDataConsent??!0)})}},46021:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.setGlobalExtensionSettings=t.getGlobalExtensionSettings=t.setExceptionLogsConsent=void 0;let a=r(12770),o=r(75824),n=r(80896),i="consents",s={interactionDataConsent:"interactionData",personalDataConsent:"personalData"},c={interactionDataConsent:null,personalDataConsent:null};function l(e,t){let{enableExceptionLog:r}=e.createClients().exceptionLogging.commands;r({flag:t})}t.setExceptionLogsConsent=l;let u=(e=null)=>{let t=JSON.parse(e);return!t||"object"!=typeof t||Array.isArray(t)?c:Object.values(s).every(e=>Object.prototype.hasOwnProperty.call(t,e))?{interactionDataConsent:t[s.interactionDataConsent],personalDataConsent:t[s.personalDataConsent]}:c},d=async e=>{let t=e.storageService.getLocalStorage();try{let e=await t.readItem(i);return u(e)}catch{return console.warn("failed parsing user consent values; proceeding as if they haven't been set."),{interactionDataConsent:null,personalDataConsent:null}}};t.getGlobalExtensionSettings=d;let p=async(e,t)=>{let r=e.storageService.getLocalStorage();try{await r.writeItem(i,JSON.stringify({[s.interactionDataConsent]:t.interactionDataConsent,[s.personalDataConsent]:t.personalDataConsent})),e.storeService.dispatch((0,o.setGlobalExtensionSettingsState)(t)),(0,n.setAllowedToSendExceptionLog)(!1!==t.interactionDataConsent),l(e.applicationModulesAccess,!1!==t.interactionDataConsent),(0,a.logToggleAnalyticsEvent)(e)}catch{return{success:!1}}return{success:!0}};t.setGlobalExtensionSettings=p},61819:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.bootstrap=void 0;var a=r(59464);Object.defineProperty(t,"bootstrap",{enumerable:!0,get:function(){return a.bootstrap}})},66336:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.config=void 0;let a=r(2901);t.config={commands:{evaluatePassword:{handler:a.evaluatePassword}},queries:{},liveQueries:{}}},55796:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.load=void 0;let a=r(95020),o=async e=>{let{data:t}=await (0,a.httpGetUsingFetch)(`${e}assets/frequency_lists.json`);return t};t.load=o},2901:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.evaluatePassword=t.evaluatePasswordStrength=t.loadFrequencyLists=void 0;let a=r(51860),o=r(32034),n=r(55796),i=()=>{},s=new Promise(e=>{i=e}),c=async()=>{let e=(0,o.getPublicPath)(),t=await (0,n.load)(e);(0,a.setFrequencyLists)(t),i()};t.loadFrequencyLists=c;let l=async e=>(await s,(0,a.evaluate)(e)),u=async e=>(await l(e)).score;t.evaluatePasswordStrength=u;let d=async(e,t)=>{let{score:r,feedback:a}=await l(t.password);return{score:r,feedback:a}};t.evaluatePassword=d},30103:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.evaluatePasswordStrengthOutOfFive=void 0;let a=r(2901),o=async e=>{if(e)return await (0,a.evaluatePasswordStrength)(e)/25};t.evaluatePasswordStrengthOutOfFive=o},60398:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.bootstrap=void 0;let a=r(66336);t.bootstrap=e=>{e.register(a.config)}},60402:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.bootstrap=void 0;var a=r(60398);Object.defineProperty(t,"bootstrap",{enumerable:!0,get:function(){return a.bootstrap}})},91783:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.assertUnreachable=void 0,t.assertUnreachable=function(e,t="Didn't expect to reach this code."){throw Error(t)}},82779:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.asyncMapLimit=void 0;let a=r(95674);t.asyncMapLimit=(e,t,r,o=e.length)=>{let n=e.length,i=0,s=[],c=0,l=a=>o=>{if(s[a]=o,n===++i)return r(s);c<n-1&&t(e[++c],l(c))},u=Math.max(Math.min(n,o),1);c=u-1;for(let r=0;r<u;r++)t(e[r],l(r)).catch(e=>(0,a.logWarn)({message:e.message}))}},24519:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.debounce=void 0,t.debounce=function(e,t){let r;return function(a,...o){var n=this;clearTimeout(r),a.immediateCall?(r=null,e.apply(n,o)):r=setTimeout(function(){r=null,e.apply(n,o)},t)}}},86590:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.decipherDatabaseRules=void 0;let a=r(34978),o=r(65008),n=async(e,t)=>{let r=await (0,a.decipherDashlaneSecureData)(t,e,"",(0,o.makeGetDerivateKeyWithCacheAndQueue)());return(0,a.deflatedUtf8ToUtf16)(r)};t.decipherDatabaseRules=(e,t)=>n(e,t)},89815:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.sanitizeTransactions=void 0,t.sanitizeTransactions=e=>e.filter(Boolean)},49093:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.areSetsEqual=void 0,t.areSetsEqual=function(e,t){return e===t||e.size===t.size&&Array.from(e).every(e=>t.has(e))}},83867:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.getWindowLocalStorage=void 0,t.getWindowLocalStorage=function(){return self.localStorage||null}},7273:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.inMemoryInterSessionUnsyncedSliceReducer=void 0;var a=r(13077);Object.defineProperty(t,"inMemoryInterSessionUnsyncedSliceReducer",{enumerable:!0,get:function(){return a.inMemoryInterSessionUnsyncedSliceReducer}})},62071:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.resetAllLoginNotification=t.addNewLoginNotification=t.RESET_ALL_LOGIN_NOTIFICATIONS=t.ADD_NEW_LOGIN_NOTIFICATION=void 0,t.ADD_NEW_LOGIN_NOTIFICATION="ADD_NEW_LOGIN_NOTIFICATION",t.RESET_ALL_LOGIN_NOTIFICATIONS="RESET_ALL_LOGIN_NOTIFICATIONS",t.addNewLoginNotification=e=>({type:t.ADD_NEW_LOGIN_NOTIFICATION,notification:e}),t.resetAllLoginNotification=()=>({type:t.RESET_ALL_LOGIN_NOTIFICATIONS})},21294:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});let a=r(62071);function o(){return[]}t.default=(e=o(),t)=>{switch(t.type){case a.ADD_NEW_LOGIN_NOTIFICATION:return[...e,t.notification];case a.RESET_ALL_LOGIN_NOTIFICATIONS:return o();default:return e}}},13077:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.inMemoryInterSessionUnsyncedSliceReducer=void 0;let a=r(20781),o=r(21294);t.inMemoryInterSessionUnsyncedSliceReducer=(0,a.combineReducers)({loginNotification:o.default})},47586:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.TsEventBusCommandQueryBus=void 0;var a=r(66375);Object.defineProperty(t,"TsEventBusCommandQueryBus",{enumerable:!0,get:function(){return a.TsEventBusCommandQueryBus}})},66375:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.TsEventBusCommandQueryBus=void 0;let a=r(12791),o=r(19661),n=r(17229);class i extends o.CommandQueryBus{constructor(e,t,r){super(e),this.bus=r,r||(this.bus=(0,a.createEventBus)({events:t}))}registerCommand(e,t){this.bus[e].on(t)}registerQuery(e,t){this.bus[e].on(t)}registerLiveQuery(e,t){(0,n.connectLazySlot)(this.bus[e],t)}}t.TsEventBusCommandQueryBus=i},56517:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.LocalStorageEventStore=void 0;let a=r(74819),o=r(83158);class n extends a.EventStore{constructor(e){super(),this.localStorageService=e}async store(e){await this.localStorageService.getInstance().storeEventStore(e)}async retrieve(){let e=await this.localStorageService.getInstance().getEventStore();return null===e?o.defaultCarbonEventStore:{iconsUpdates:e.iconsUpdates||o.defaultCarbonEventStore.iconsUpdates}}}t.LocalStorageEventStore=n},88620:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.EventStoreConsumer=void 0;let a=r(42387);t.EventStoreConsumer=class{constructor(e,t){this.eventStore=e,this.hooks=t,this.liveConsumptionSubs={},this.lockIds={},this.startTopic=e=>{this.startLiveConsumption(e),this.consumeTopic(e)},this.lockTopic=e=>{this.stopLiveConsumption(e);let t=(0,a.v4)();return this.lockIds[e]=(this.lockIds[e]||new Set).add(t),t},this.releaseTopic=(e,t)=>{let r=this.lockIds[e];r&&r.delete(t),r&&0!==r.size||this.startTopic(e)},this.teardown=()=>{Object.keys(this.liveConsumptionSubs).forEach(this.stopLiveConsumption)},this.consumeTopic=async e=>{for(let t of(await this.eventStore.getItems(e)))this.handleItem(e,t)},this.startLiveConsumption=e=>{this.liveConsumptionSubs[e]||(this.liveConsumptionSubs[e]=this.eventStore.newItems$(e).subscribe(t=>this.handleItem(e,t)))},this.stopLiveConsumption=e=>{this.liveConsumptionSubs[e]&&(this.liveConsumptionSubs[e].unsubscribe(),delete this.liveConsumptionSubs[e])},this.handleItem=async(e,t)=>{let r=this.hooks[e];r||await this.eventStore.remove(e,t.id),await r(t.event)&&await this.eventStore.remove(e,t.id)}}}},68360:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.DebugConnector=void 0;let a=r(12791);t.DebugConnector={log:(0,a.slot)(),info:(0,a.slot)(),warning:(0,a.slot)(),error:(0,a.slot)()}},65602:function(e,t){Object.defineProperty(t,"__esModule",{value:!0})},5727:function(e,t,r){var a=this&&this.__createBinding||(Object.create?function(e,t,r,a){void 0===a&&(a=r);var o=Object.getOwnPropertyDescriptor(t,r);(!o||("get"in o?!t.__esModule:o.writable||o.configurable))&&(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,a,o)}:function(e,t,r,a){void 0===a&&(a=r),e[a]=t[r]}),o=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||a(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),o(r(65602),t),o(r(68360),t)},72285:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.config=void 0;let a=r(57986),o=r(91018);t.config={commands:{},queries:{getIsBrazeContentDisabled:{selector:a.disableBrazeContentCardsSelector},getIsLoginFlowMigrationDisabled:{selector:a.disableLoginFlowMigrationSelector},getIsAutoSSOLoginDisabled:{selector:a.disableAutoSSOLoginSelector},getKillSwitch:{selector:a.killSwitchSelector}},liveQueries:{liveIsBrazeContentDisabled:{operator:o.disableBrazeContentCardsOperator$},liveIsLoginFlowMigrationDisabled:{operator:o.disableLoginFlowMigrationOperator$},liveIsAutoSSOLoginDisabled:{operator:o.disableAutoSSOLoginOperator$},liveKillSwitch:{operator:o.getKillSwitchOperator$}}}},48611:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.bootstrap=void 0;let a=r(72285);t.bootstrap=e=>{e.register(a.config)}},76282:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.triggerKillswitchCron=void 0;let a=r(91360),o=r(33658),n=null,i="killswitch-alarm";async function s(e){await (0,a.alarmsGet)(i)||((0,o.updateKillswitchState)(e),(0,a.alarmsCreate)(i,{periodInMinutes:60})),a.alarmsOnAlarm.addListener(t=>{t.name===i&&(0,o.updateKillswitchState)(e)})}t.triggerKillswitchCron=function(e){if((0,a.alarmsIsSupported)())s(e);else n||((0,o.updateKillswitchState)(e),n=setInterval(()=>{try{(0,o.updateKillswitchState)(e)}catch{}},36e5))}},58423:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.bootstrap=void 0;var a=r(48611);Object.defineProperty(t,"bootstrap",{enumerable:!0,get:function(){return a.bootstrap}})},33658:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.updateKillswitchState=void 0;let a=r(38578),o=r(39960),n=r(81571),i=r(28323),s=r(50565),c=a.z.object({disableAutofill:a.z.boolean().default(!1),disableMLAntiPhishing:a.z.boolean().default(!1),brazeContentCardsDisabled:a.z.boolean().default(!1),disableLoginFlowMigration:a.z.boolean().default(!1),disableAutoSSOLogin:a.z.boolean().default(!1),disablePhishingResistance:a.z.boolean().default(!1)}),l=async e=>{let t=Object.values(o.KillSwitches),r=await (0,n.getKillSwitches)(e,t);if((0,i.isApiError)(r))throw Error(`[Killswitch] - updateKillswitchState : ${r.message} (${r.code})`);let a=c.safeParse(r);if(!a.success)throw Error("[Killswitch] - updateKillswitchState: unexpected server response shape");e.dispatch((0,s.killswitchStateUpdated)({disableAutofill:a.data.disableAutofill||!1,disableMLAntiPhishing:a.data.disableMLAntiPhishing||!1,brazeContentCardsDisabled:a.data.brazeContentCardsDisabled||!1,disableLoginFlowMigration:a.data.disableLoginFlowMigration||!1,disableAutoSSOLogin:a.data.disableAutoSSOLogin||!1,disablePhishingResistance:a.data.disablePhishingResistance||!1}))};t.updateKillswitchState=l},91018:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.getKillSwitchOperator$=t.disableAutoSSOLoginOperator$=t.disableLoginFlowMigrationOperator$=t.disableBrazeContentCardsOperator$=void 0;let a=r(95121),o=r(15237),n=r(57986);t.disableBrazeContentCardsOperator$=()=>(0,a.pipe)((0,o.map)(n.disableBrazeContentCardsSelector),(0,o.distinctUntilChanged)()),t.disableLoginFlowMigrationOperator$=()=>(0,a.pipe)((0,o.map)(n.disableLoginFlowMigrationSelector),(0,o.distinctUntilChanged)()),t.disableAutoSSOLoginOperator$=()=>(0,a.pipe)((0,o.map)(n.disableAutoSSOLoginSelector),(0,o.distinctUntilChanged)()),t.getKillSwitchOperator$=e=>{let t=(0,n.getKillSwitchSelector)(e);return(0,a.pipe)((0,o.map)(t),(0,o.distinctUntilChanged)())}},57986:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.getKillSwitchSelector=t.killSwitchSelector=t.disableAutoSSOLoginSelector=t.disableLoginFlowMigrationSelector=t.disableBrazeContentCardsSelector=void 0;let a=r(86630),o=e=>e.device.killswitch||a.DEFAULT_EMPTY_KILLSWITCH_STATE;t.disableBrazeContentCardsSelector=e=>o(e).brazeContentCardsDisabled||!1,t.disableLoginFlowMigrationSelector=e=>o(e).disableLoginFlowMigration||!1,t.disableAutoSSOLoginSelector=e=>o(e).disableAutoSSOLogin,t.killSwitchSelector=(e,t)=>o(e)[t],t.getKillSwitchSelector=e=>r=>(0,t.killSwitchSelector)(r,e)},41872:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.setupSubscriptions=void 0;let a=r(76282);t.setupSubscriptions=function(e,t){e.appInitialized.on(()=>{let{storeService:e}=t;(0,a.triggerKillswitchCron)(e)})}},31478:function(e,t,r){var a,o;Object.defineProperty(t,"__esModule",{value:!0}),t.isBackupCryptError=t.BackupCryptError=t.BackupCryptErrorMessages=t.BackupCryptErrorCode=void 0;let n=r(21837);(o=a=t.BackupCryptErrorCode||(t.BackupCryptErrorCode={}))[o.TRANSACTION_CLEAR_CONTENT_EMPTY=0]="TRANSACTION_CLEAR_CONTENT_EMPTY",o[o.EMPTY_CLEAR_FULL_BACKUP_FILE_XML=1]="EMPTY_CLEAR_FULL_BACKUP_FILE_XML",o[o.CLEAR_FULL_BACKUP_FILE_XML_NOT_AN_ARRAY=2]="CLEAR_FULL_BACKUP_FILE_XML_NOT_AN_ARRAY",o[o.EMPTY_FULL_BACKUP_FILE=3]="EMPTY_FULL_BACKUP_FILE",o[o.NULL_FULL_BACKUP_FILE_MAP=4]="NULL_FULL_BACKUP_FILE_MAP",o[o.EMPTY_FULL_BACKUP_FILE_MAP=5]="EMPTY_FULL_BACKUP_FILE_MAP",o[o.EMPTY_CLEAR_FULL_BACKUP_FILE=6]="EMPTY_CLEAR_FULL_BACKUP_FILE",o[o.CLEAR_FULL_BACKUP_FILE_NOT_XML=7]="CLEAR_FULL_BACKUP_FILE_NOT_XML",o[o.FULL_BACKUP_FILE_ITEM_WITHOUT_KWTYPE=8]="FULL_BACKUP_FILE_ITEM_WITHOUT_KWTYPE",o[o.FULL_BACKUP_FILE_ITEM_WITHOUT_ID=9]="FULL_BACKUP_FILE_ITEM_WITHOUT_ID",o[o.TRANSACTION_CONTENT_NOT_XML=10]="TRANSACTION_CONTENT_NOT_XML",t.BackupCryptErrorMessages={[a.TRANSACTION_CLEAR_CONTENT_EMPTY]:"Empty transaction content",[a.EMPTY_CLEAR_FULL_BACKUP_FILE_XML]:"Empty full backup file XML",[a.CLEAR_FULL_BACKUP_FILE_XML_NOT_AN_ARRAY]:"Full backup file XML not resolved as an array",[a.EMPTY_FULL_BACKUP_FILE]:"Empty full backup file",[a.NULL_FULL_BACKUP_FILE_MAP]:"Null full backup file map",[a.EMPTY_FULL_BACKUP_FILE_MAP]:"Empty full backup file map",[a.EMPTY_CLEAR_FULL_BACKUP_FILE]:"Deciphered full backup file content is empty",[a.CLEAR_FULL_BACKUP_FILE_NOT_XML]:"WRONG_PASSWORD",[a.FULL_BACKUP_FILE_ITEM_WITHOUT_KWTYPE]:"Full backup file item without kwType",[a.FULL_BACKUP_FILE_ITEM_WITHOUT_ID]:"Full backup file item without Id",[a.TRANSACTION_CONTENT_NOT_XML]:"WRONG_PASSWORD"},t.BackupCryptError={codes:a,name:"BackupCryptError",messages:t.BackupCryptErrorMessages},t.isBackupCryptError=e=>(0,n.isCarbonError)(e,t.BackupCryptError)},19884:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.decryptFullBackupFile=void 0;let a=r(56886),o=r(31478),n=r(40257),i=r(34978),s=r(21837),c=r(56708),l=r(80896),u=r(63011),d=async(e,t)=>{try{let e=await (0,c.parseDashlaneXml)(t);if(!e)throw new s.CarbonError(o.BackupCryptError,o.BackupCryptErrorCode.EMPTY_CLEAR_FULL_BACKUP_FILE_XML);if(!Array.isArray(e))throw new s.CarbonError(o.BackupCryptError,o.BackupCryptErrorCode.CLEAR_FULL_BACKUP_FILE_XML_NOT_AN_ARRAY);return e}catch(t){throw e(u.announcements.decipherFullBackupParseFailed(t)),t}},p=(e,t,r)=>{if(null==t)return e(u.announcements.decipherFullBackupSkipped()),!1;if(""===t)throw new s.CarbonError(o.BackupCryptError,o.BackupCryptErrorCode.EMPTY_FULL_BACKUP_FILE);if(null===r)throw new s.CarbonError(o.BackupCryptError,o.BackupCryptErrorCode.NULL_FULL_BACKUP_FILE_MAP);if(t&&0===r.size)throw new s.CarbonError(o.BackupCryptError,o.BackupCryptErrorCode.EMPTY_FULL_BACKUP_FILE_MAP);return!0},S=async(e,t,r)=>{try{let t=await e.decrypt(r),a=(0,i.deflatedUtf8ToUtf16)(t);if(!a){let e=new s.CarbonError(o.BackupCryptError,o.BackupCryptErrorCode.EMPTY_CLEAR_FULL_BACKUP_FILE);throw l.sendExceptionLog({error:e}),e}if("string"==typeof a&&!a.trim().startsWith("<"))throw new s.CarbonError(o.BackupCryptError,o.BackupCryptErrorCode.CLEAR_FULL_BACKUP_FILE_NOT_XML);return a}catch(n){let o=(0,a.attemptReadCryptoPayload)(e,r);throw t(u.announcements.decipherFullBackupDecipherFailed(n,o)),n}},g=(e,t,r)=>{let{Id:a,kwType:i}=t,c=r.get(a);if(void 0===c)return e(u.announcements.decipherFullBackupItemSkipped(Error("Transaction not in full backup list skipped"),{itemType:i,itemId:a})),null;let l=t instanceof Object?Object.keys(t):[];if(!i){let t=new s.CarbonError(o.BackupCryptError,o.BackupCryptErrorCode.FULL_BACKUP_FILE_ITEM_WITHOUT_KWTYPE);throw e(u.announcements.decipherFullBackupItemReadFailed(t.addAdditionalInfo({itemId:a,itemKeys:l}),a)),t}return a?(e(u.announcements.decipherFullBackupItemRead(i,a,c)),{type:(0,n.getTransactionTypeFromDataModelType)(i),backupDate:c,action:"BACKUP_EDIT",identifier:a,content:t}):(e(u.announcements.decipherFullBackupItemSkipped(Error("Transaction without id skipped"),{itemType:i})),null)},m=(e,t,r)=>{for(let a in t.keys())!r.has(a)&&e(u.announcements.decipherFullBackupItemSkipped(Error("Missing full backup item content"),{itemId:a}))},y=(e,t,r)=>{let a=t.length,o=[],n=new Set;for(let i=0;i<a;++i){let a=t[i];a.Id&&n.add(a.Id);let s=g(e,a,r);s&&o.push(s)}return m(e,r,n),o};async function f(e,t,r,n){try{if(!p(t,r,n))return[];t(u.announcements.decipherFullBackupStarted());let o=await S(e,t,r),i=await d(t,o),s=(0,a.fixKwType)(i),c=y(t,s,n);return t(u.announcements.decipherFullBackupFinished(c.length)),c}catch(e){if(t(u.announcements.decipherFullBackupFailed(e)),(0,s.isCarbonError)(e,o.BackupCryptError,o.BackupCryptErrorCode.EMPTY_CLEAR_FULL_BACKUP_FILE))return[];throw e}}t.decryptFullBackupFile=f},83648:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.encryptSingleTransaction=t.decrypt=void 0;let a=r(25903),o=r(19884),n=r(1520);Object.defineProperty(t,"encryptSingleTransaction",{enumerable:!0,get:function(){return n.encryptSingleTransaction}});let i=r(5142),s=r(63011),c=e=>(0,a.partition)(e=>"SETTINGS"===e.type,e),l=e=>(0,a.partition)(e=>!!e.content,e),u=e=>e.map(e=>({...e,content:null}));async function d(e,t,r,a,d){if(null===d)throw Error("null transactions");let p=Number(r&&a.size);t(s.announcements.decipherStarted(p));let S=await (0,o.decryptFullBackupFile)(e,t,r,a);t(s.announcements.decipherTransactionsStarted());let[g,m]=c(d),y=await (0,n.decryptSingleTransactions)(e,t,g),[f,E]=l(m),A=(0,i.makeOpenSessionProgressService)();A.init(f.length);let h=await (0,n.decryptSingleTransactions)(e,t,f,A),_=u(E);t(s.announcements.decipherTransactionsFinished());let T=[...S,...y,..._,...h];return t(s.announcements.decipherFinished(T)),T}t.decrypt=d},5142:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.makeOpenSessionProgressService=void 0;let a=r(25047);t.makeOpenSessionProgressService=()=>{let e,t,r,o;let n=(n=!1)=>{let i=(0,a.default)();if(!i)return;let s=t/e*100;(n||Date.now()-o>=500&&s!==r)&&(r=s,o=Date.now(),i.openSessionProgressChanged({statusDescription:"percentage of work done before session opening",statusProgress:r}))};return{init(a){e=a,t=0,r=0,o=Date.now(),n(!0)},incrementJobsDone(){if(void 0===e)throw Error("openSessionProgressService must be initialized before begin used");t++,n()},decrementJobsTodo(){e--}}}},1520:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.encryptSingleTransaction=t.decryptSingleTransactions=t.decryptSingleTransaction=t.parseTransactionContentXml=t.decryptTransactionContent=void 0;let a=r(56886),o=r(31478),n=r(21837),i=r(56708),s=r(80896),c=r(34978),l=r(63011),u=async(e,t,{content:r})=>{try{let t=await e.decrypt(r);return(0,c.deflatedUtf8ToUtf16)(t)}catch(n){let o=(0,a.attemptReadCryptoPayload)(e,r);throw t(l.announcements.decipherTransactionDecipherFailed(n,o)),n}};t.decryptTransactionContent=u;let d=e=>{if(!e){let e=new n.CarbonError(o.BackupCryptError,o.BackupCryptErrorCode.TRANSACTION_CLEAR_CONTENT_EMPTY);throw s.sendExceptionLog({error:e}),e}},p=e=>{if("string"==typeof e&&!e.trim().startsWith("<"))throw new n.CarbonError(o.BackupCryptError,o.BackupCryptErrorCode.TRANSACTION_CONTENT_NOT_XML)},S=async(e,t)=>{try{return d(t),p(t),await (0,i.parseDashlaneXml)(t)}catch(t){throw e(l.announcements.decipherTransactionParseFailed(t)),t}};t.parseTransactionContentXml=S;let g=(e,t)=>Object.assign({},e,{content:t});async function m(e,r,n){try{r(l.announcements.decipherTransactionStarted(n));let o=await (0,t.decryptTransactionContent)(e,r,n),i=await (0,t.parseTransactionContentXml)(r,o),s=(0,a.fixKwType)(i),c=g(n,s);return r(l.announcements.decipherTransactionFinished(n)),c}catch(t){let{type:e}=n;if((0,o.isBackupCryptError)(t)){let{action:r,backupDate:a,identifier:o}=n;t.addAdditionalInfo({itemId:o,transactionType:e,action:r,backupDate:a})}if(r(l.announcements.decipherTransactionFailed(t,n)),"SETTINGS"===e)throw t;return null}}async function y(e,t,r,a){let o=r.map(async r=>{let o=await m(e,t,r);return a&&a.incrementJobsDone(),o});return(await Promise.all(o)).filter(Boolean)}async function f(e,t,r={}){let a=(0,c.utf16ToDeflatedUtf8)(t.content),o=await e.getInstance().encrypt(a,r);return{...t,content:o}}t.decryptSingleTransaction=m,t.decryptSingleTransactions=y,t.encryptSingleTransaction=f},56886:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.fixKwType=t.attemptReadCryptoPayload=void 0;let a=r(29138);t.attemptReadCryptoPayload=(e,t)=>{try{return e.readCryptoPayload(t)}catch(e){}return""},t.fixKwType=function e(t){return Array.isArray(t)?t.map(t=>e(t)):(0,a.default)(t)?Object.keys(t).reduce((r,a)=>{let o=t[a];return"__type__"===a?r.kwType=o:r[a]=e(o),r},{}):t}},11754:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.formatStep=void 0;let a=r(67833),o=r(91783);t.formatStep=e=>{switch(e){case a.SyncLoggerStep.Main:return"[Sync]";case a.SyncLoggerStep.Chronological:return"[Sync|Chrono]";case a.SyncLoggerStep.Latest:return"[Sync|Latest]";case a.SyncLoggerStep.Decipher:return"[Sync|Decipher]";case a.SyncLoggerStep.DecipherFullBackup:return"[Sync|Decipher|FullBackup]";case a.SyncLoggerStep.DecipherTransactions:return"[Sync|Decipher|Transactions]";case a.SyncLoggerStep.Duplicate:return"[Sync|Duplicate]";case a.SyncLoggerStep.Cipher:return"[Sync|Cipher]";case a.SyncLoggerStep.Upload:return"[Sync|Upload]";case a.SyncLoggerStep.Save:return"[Sync|Save]";case a.SyncLoggerStep.TreatProblem:return"[Sync|TreatProblem]";case a.SyncLoggerStep.TreatProblemSummary:return"[Sync|TreatProblem|Summary]";case a.SyncLoggerStep.Sharing:return"[Sync|Sharing]";case a.SyncLoggerStep.TeamAdminData:return"[Sync|TeamAdminData]";default:(0,o.assertUnreachable)(e)}}},48451:function(e,t,r){var a=this&&this.__createBinding||(Object.create?function(e,t,r,a){void 0===a&&(a=r);var o=Object.getOwnPropertyDescriptor(t,r);(!o||("get"in o?!t.__esModule:o.writable||o.configurable))&&(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,a,o)}:function(e,t,r,a){void 0===a&&(a=r),e[a]=t[r]}),o=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||a(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),o(r(23749),t)},63289:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.logSyncVerbose=t.logSyncDebug=t.logSyncInfo=t.logSyncWarn=t.logSyncError=void 0;let a=r(22560),o=(0,a.withTag)("Sync");t.logSyncError=o(a.logError),t.logSyncWarn=o(a.logWarn),t.logSyncInfo=o(a.logInfo),t.logSyncDebug=o(a.logDebug),t.logSyncVerbose=o(a.logVerbose)},23749:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.makeSyncLoggerMonitor=void 0;let a=r(63011),o=r(67833),n=r(75919),i=r(11754),s=r(63289);t.makeSyncLoggerMonitor=()=>{let e=null,t=e=>"object"==typeof e&&e.message||`${e}`,r=(e,t)=>`${(0,i.formatStep)(e)} ${t}`;return(i,{timestamp:c})=>{switch(i.type){case"SyncStarted":{let{syncType:t}=i;e=c,(0,s.logSyncInfo)({message:r(o.SyncLoggerStep.Main,"Start"),details:{step:o.SyncLoggerStep.Main,Type:(0,n.syncTypeForSyncLogger)(t)}})}break;case"ChronologicalSyncStarted":{let{updatesCount:t,deletesCount:a}=i;(0,s.logSyncDebug)({message:r(o.SyncLoggerStep.Chronological,"Start"),details:{step:o.SyncLoggerStep.Chronological,Timestamp:e,Update:t,Delete:a}})}break;case"LatestRequested":{let{lock:t,needsKeys:a}=i;(0,s.logSyncDebug)({message:r(o.SyncLoggerStep.Latest,"Request"),details:{step:o.SyncLoggerStep.Latest,Timestamp:e,Lock:t,SharingKeys:a}})}break;case"LatestSucceeded":{let{updatesCount:t,deletesCount:a,fullBackupSize:n}=i;(0,s.logSyncDebug)({message:r(o.SyncLoggerStep.Latest,"Success"),details:{step:o.SyncLoggerStep.Latest,Timestamp:e,Update:t,Delete:a,FullBackup:n}})}break;case"LatestFailed":{let{error:e}=i;(0,s.logSyncWarn)({message:r(o.SyncLoggerStep.Latest,"Error"),details:{step:o.SyncLoggerStep.Latest,Cause:t(e)}})}break;case"DecipherStarted":{let{fullBackupFileSize:e}=i;(0,s.logSyncVerbose)({message:r(o.SyncLoggerStep.Decipher,"Start"),details:{step:o.SyncLoggerStep.Decipher,Count:e}})}break;case"DecipherFullBackupSkipped":(0,s.logSyncVerbose)({message:r(o.SyncLoggerStep.DecipherFullBackup,"Skip"),details:{step:o.SyncLoggerStep.DecipherFullBackup}});break;case"DecipherFullBackupStarted":(0,s.logSyncVerbose)({message:r(o.SyncLoggerStep.DecipherFullBackup,"Start"),details:{step:o.SyncLoggerStep.DecipherFullBackup}});break;case"DecipherFullBackupItemRead":{let{itemType:e,itemId:t,backupDate:a}=i;(0,s.logSyncDebug)({message:r(o.SyncLoggerStep.DecipherFullBackup,"Transaction"),details:{step:o.SyncLoggerStep.DecipherFullBackup,Type:e,Id:t,Date:a}})}break;case"DecipherFullBackupItemSkipped":{let{error:e,itemType:a,itemId:n}=i;(0,s.logSyncDebug)({message:r(o.SyncLoggerStep.DecipherFullBackup,"TransactionSkipped"),details:{step:o.SyncLoggerStep.DecipherFullBackup,Type:a,Id:n,Cause:t(e)}})}break;case"DecipherFullBackupFinished":{let{itemsCount:e}=i;(0,s.logSyncVerbose)({message:r(o.SyncLoggerStep.DecipherFullBackup,"Done"),details:{step:o.SyncLoggerStep.DecipherFullBackup,Count:e}})}break;case"DecipherFullBackupFailed":{let{error:e}=i;(0,s.logSyncWarn)({message:r(o.SyncLoggerStep.DecipherFullBackup,"Error"),details:{step:o.SyncLoggerStep.DecipherFullBackup,Cause:t(e)}})}break;case"DecipherTransactionsStarted":(0,s.logSyncVerbose)({message:r(o.SyncLoggerStep.DecipherTransactions,"Start"),details:{step:o.SyncLoggerStep.DecipherTransactions}});break;case"DecipherTransactionFinished":{let{action:e,transactionType:t,identifier:a,backupDate:n}=i;(0,s.logSyncDebug)({message:r(o.SyncLoggerStep.DecipherTransactions,"Transaction"),details:{step:o.SyncLoggerStep.DecipherTransactions,Action:e,Type:t,Id:a,Date:n}})}break;case"DecipherTransactionFailed":{let{error:e,transactionType:a,identifier:n,backupDate:c}=i;(0,s.logSyncWarn)({message:r(o.SyncLoggerStep.DecipherTransactions,"Error"),details:{step:o.SyncLoggerStep.DecipherTransactions,Cause:t(e),Type:a,Id:n,Date:c}})}break;case"DecipherTransactionsFinished":(0,s.logSyncVerbose)({message:r(o.SyncLoggerStep.DecipherTransactions,"Done"),details:{step:o.SyncLoggerStep.DecipherTransactions}});break;case"DecipherFinished":{let{updatesCount:e,deletesCount:t}=i;(0,s.logSyncVerbose)({message:r(o.SyncLoggerStep.Decipher,"Done"),details:{step:o.SyncLoggerStep.Decipher,Transactions:e+t}})}break;case"TransactionDuplicated":{let{transactionType:e,identifier:t,backupDate:a}=i;(0,s.logSyncWarn)({message:r(o.SyncLoggerStep.Duplicate,"Transaction"),details:{step:o.SyncLoggerStep.Duplicate,Type:e,Id:t,Date:a}})}break;case"CipherStarted":(0,s.logSyncVerbose)({message:r(o.SyncLoggerStep.Cipher,"Start"),details:{step:o.SyncLoggerStep.Cipher}});break;case"TransactionCiphered":{let{transactionType:e,itemId:t,backupDate:a}=i;(0,s.logSyncDebug)({message:r(o.SyncLoggerStep.Cipher,"Transaction"),details:{step:o.SyncLoggerStep.Cipher,Type:e,Id:t,Date:a}})}break;case"CipherFinished":(0,s.logSyncVerbose)({message:r(o.SyncLoggerStep.Cipher,"Done"),details:{step:o.SyncLoggerStep.Cipher}});break;case"UploadRequested":{let{updatedCount:e,deletedCount:t}=i;(0,s.logSyncDebug)({message:r(o.SyncLoggerStep.Upload,"Request"),details:{step:o.SyncLoggerStep.Upload,Update:e,Delete:t}})}break;case"UploadSucceeded":{let{timestamp:e}=i;(0,s.logSyncDebug)({message:r(o.SyncLoggerStep.Upload,"Success"),details:{step:o.SyncLoggerStep.Upload,Timestamp:e}})}break;case"UploadFailed":{let{error:e}=i;(0,s.logSyncWarn)({message:r(o.SyncLoggerStep.Upload,"Error"),details:{step:o.SyncLoggerStep.Upload,Cause:t(e)}})}break;case"SaveStarted":(0,s.logSyncVerbose)({message:r(o.SyncLoggerStep.Save,"Start"),details:{step:o.SyncLoggerStep.Save}});break;case"SaveFinished":(0,s.logSyncVerbose)({message:r(o.SyncLoggerStep.Save,"Done"),details:{step:o.SyncLoggerStep.Save}});break;case"ChronologicalSyncFinished":{let{summarySize:e}=i;(0,s.logSyncDebug)({message:r(o.SyncLoggerStep.Chronological,"Done"),details:{step:o.SyncLoggerStep.Chronological,Summary:e}})}break;case"TreatProblemStarted":(0,s.logSyncDebug)({message:r(o.SyncLoggerStep.TreatProblem,"Start"),details:{step:o.SyncLoggerStep.TreatProblem}});break;case"TreatProblemSummaryStarted":{let{localItemsCount:e,remoteItemsCount:t}=i;(0,s.logSyncDebug)({message:r(o.SyncLoggerStep.TreatProblemSummary,"Start"),details:{step:o.SyncLoggerStep.TreatProblemSummary,Local:e,Remote:t}})}break;case"TreatProblemSummaryCompared":{let{result:e,cause:t,transactionType:n,identifier:c,localDate:l,remoteDate:u}=i,d=t?{Cause:a.TreatProblemSummaryComparedCause[t]}:{};(0,s.logSyncDebug)({message:r(o.SyncLoggerStep.TreatProblemSummary,"Comparison"),details:{step:o.SyncLoggerStep.TreatProblemSummary,Result:a.TreatProblemSummaryComparedResult[e],...d,Type:n,Id:c,...l?{LocalDate:l}:{},...void 0!==u?{RemoteDate:u}:{}}})}break;case"TreatProblemSummaryFinished":(0,s.logSyncDebug)({message:r(o.SyncLoggerStep.TreatProblemSummary,"Done"),details:{step:o.SyncLoggerStep.TreatProblemSummary}});break;case"TreatProblemDiffComputed":{let{transactionsToDownloadCount:e,transactionsToUploadCount:t}=i;0===e&&0===t?(0,s.logSyncVerbose)({message:r(o.SyncLoggerStep.TreatProblem,"Diff UpToDate"),details:{step:o.SyncLoggerStep.TreatProblem}}):(0,s.logSyncWarn)({message:r(o.SyncLoggerStep.TreatProblem,"Diff"),details:{step:o.SyncLoggerStep.TreatProblem,Download:e,Upload:t}})}break;case"TreatProblemFinished":(0,s.logSyncDebug)({message:r(o.SyncLoggerStep.TreatProblem,"Done"),details:{step:o.SyncLoggerStep.TreatProblem}});break;case"TeamAdminDataSyncStarted":(0,s.logSyncDebug)({message:r(o.SyncLoggerStep.TeamAdminData,"Start"),details:{step:o.SyncLoggerStep.TeamAdminData}});break;case"TeamAdminDataSyncFinished":(0,s.logSyncDebug)({message:r(o.SyncLoggerStep.TeamAdminData,"Done"),details:{step:o.SyncLoggerStep.TeamAdminData}});break;case"SharingSyncStarted":(0,s.logSyncDebug)({message:r(o.SyncLoggerStep.Sharing,"Start"),details:{step:o.SyncLoggerStep.Sharing}});break;case"SharingSyncFinished":(0,s.logSyncDebug)({message:r(o.SyncLoggerStep.Sharing,"Done"),details:{step:o.SyncLoggerStep.Sharing}});break;case"SyncFinished":(0,s.logSyncInfo)({message:r(o.SyncLoggerStep.Main,"Done"),details:{step:o.SyncLoggerStep.Main}});break;case"SyncFailed":{let{error:e}=i;(0,s.logSyncError)({message:r(o.SyncLoggerStep.Main,"Failed"),details:{step:o.SyncLoggerStep.Main,Cause:t(e)}})}}}}},67833:function(e,t){var r;Object.defineProperty(t,"__esModule",{value:!0}),t.SyncLoggerStep=void 0,(r=t.SyncLoggerStep||(t.SyncLoggerStep={}))[r.Main=0]="Main",r[r.Chronological=1]="Chronological",r[r.Latest=2]="Latest",r[r.Decipher=3]="Decipher",r[r.DecipherFullBackup=4]="DecipherFullBackup",r[r.DecipherTransactions=5]="DecipherTransactions",r[r.Duplicate=6]="Duplicate",r[r.Cipher=7]="Cipher",r[r.Upload=8]="Upload",r[r.Save=9]="Save",r[r.TreatProblem=10]="TreatProblem",r[r.TreatProblemSummary=11]="TreatProblemSummary",r[r.Sharing=12]="Sharing",r[r.TeamAdminData=13]="TeamAdminData"},75919:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.syncTypeForSyncLogger=void 0;let a=r(87829),o=r(91783);t.syncTypeForSyncLogger=e=>{switch(e){case a.SyncType.LIGHT_SYNC:return"Light";case a.SyncType.FULL_SYNC:return"Full";case a.SyncType.FIRST_SYNC:return"Initial";default:(0,o.assertUnreachable)(e)}}},63022:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.treatProblemSummaryFinished=t.treatProblemSummaryCompared=t.treatProblemSummaryStarted=t.transactionDuplicated=t.decipherTransactionFinished=t.decipherTransactionFailed=t.decipherTransactionParseFailed=t.decipherTransactionDecipherFailed=t.decipherTransactionStarted=t.decipherFullBackupFinished=t.decipherFullBackupFailed=t.decipherFullBackupItemReadFailed=t.decipherFullBackupItemSkipped=t.decipherFullBackupItemRead=t.decipherFullBackupDecipherFailed=t.decipherFullBackupParseFailed=t.decipherFullBackupStarted=t.decipherFullBackupSkipped=t.cipherFinished=t.transactionCiphered=t.cipherStarted=t.uploadFailed=t.uploadSucceeded=t.uploadRequested=t.syncTypeChanged=t.syncFailed=t.syncFinished=t.decipherTransactionsFinished=t.decipherTransactionsStarted=t.decipherFinished=t.decipherStarted=t.latestFailed=t.latestSucceeded=t.latestRequested=t.teamAdminDataSyncFinished=t.teamAdminDataSyncFailed=t.teamAdminDataSyncStarted=t.sharingSyncFinished=t.sharingSyncFailed=t.sharingSyncInvalidSyncData=t.sharingSyncStarted=t.treatSharingKeysFailed=t.treatProblemFinished=t.treatProblemDiffComputed=t.treatProblemFailed=t.treatProblemStarted=t.chronologicalSyncFinished=t.chronologicalSyncFailed=t.chronologicalSyncStarted=t.syncStarted=void 0,t.saveFinished=t.saveStarted=void 0;let a=r(75035),o=r(24685),n=r(64419),i=r(59992);t.syncStarted=(e,t)=>({type:"SyncStarted",trigger:e,syncType:t}),t.chronologicalSyncStarted=e=>({type:"ChronologicalSyncStarted",updatesCount:(0,i.countEditionUploadChanges)(e?.changesToUpload||[]),deletesCount:(0,i.countDeletionUploadChanges)(e?.changesToUpload||[])}),t.chronologicalSyncFailed=e=>({type:"ChronologicalSyncFailed",error:e}),t.chronologicalSyncFinished=(e,t)=>({type:"ChronologicalSyncFinished",summarySize:(0,a.countSyncSummaryTransactions)(e),fullBackupFileSize:t}),t.treatProblemStarted=()=>({type:"TreatProblemStarted"}),t.treatProblemFailed=e=>({type:"TreatProblemFailed",error:e}),t.treatProblemDiffComputed=(e,t)=>({type:"TreatProblemDiffComputed",transactionsToDownloadCount:e,transactionsToUploadCount:t}),t.treatProblemFinished=()=>({type:"TreatProblemFinished"}),t.treatSharingKeysFailed=e=>({type:"TreatSharingKeysFailed",error:e}),t.sharingSyncStarted=()=>({type:"SharingSyncStarted"}),t.sharingSyncInvalidSyncData=(e,t)=>({type:"SharingSyncInvalidSyncData",itemGroupId:e,errorName:t}),t.sharingSyncFailed=e=>({type:"SharingSyncFailed",error:e}),t.sharingSyncFinished=()=>({type:"SharingSyncFinished"}),t.teamAdminDataSyncStarted=()=>({type:"TeamAdminDataSyncStarted"}),t.teamAdminDataSyncFailed=e=>({type:"TeamAdminDataSyncFailed",error:e}),t.teamAdminDataSyncFinished=()=>({type:"TeamAdminDataSyncFinished"}),t.latestRequested=(e,t)=>({type:"LatestRequested",lock:"nolock"!==e,needsKeys:t}),t.latestSucceeded=e=>({type:"LatestSucceeded",updatesCount:(0,o.countEditionTransactions)(e.transactionList),deletesCount:(0,o.countRemoveTransactions)(e.transactionList),fullBackupSize:(e.fullBackupFileList||[]).length}),t.latestFailed=e=>({type:"LatestFailed",error:e}),t.decipherStarted=e=>({type:"DecipherStarted",fullBackupFileSize:e}),t.decipherFinished=e=>({type:"DecipherFinished",updatesCount:(0,o.countEditionTransactions)(e),deletesCount:(0,o.countRemoveTransactions)(e)}),t.decipherTransactionsStarted=()=>({type:"DecipherTransactionsStarted"}),t.decipherTransactionsFinished=()=>({type:"DecipherTransactionsFinished"}),t.syncFinished=()=>({type:"SyncFinished"}),t.syncFailed=e=>({type:"SyncFailed",error:e}),t.syncTypeChanged=e=>({type:"SyncTypeChanged",syncType:e}),t.uploadRequested=(e,t)=>({type:"UploadRequested",updatedCount:e,deletedCount:t}),t.uploadSucceeded=(e,t,r)=>({type:"UploadSucceeded",updatedCount:e,deletedCount:t,timestamp:r}),t.uploadFailed=e=>({type:"UploadFailed",error:e}),t.cipherStarted=()=>({type:"CipherStarted"}),t.transactionCiphered=(e,t,r)=>({type:"TransactionCiphered",transactionType:e,itemId:t,backupDate:r}),t.cipherFinished=()=>({type:"CipherFinished"}),t.decipherFullBackupSkipped=()=>({type:"DecipherFullBackupSkipped"}),t.decipherFullBackupStarted=()=>({type:"DecipherFullBackupStarted"}),t.decipherFullBackupParseFailed=e=>({type:"DecipherFullBackupParseFailed",error:e}),t.decipherFullBackupDecipherFailed=(e,t)=>({type:"DecipherFullBackupDecipherFailed",error:e,cryptoPayload:t}),t.decipherFullBackupItemRead=(e,t,r)=>({type:"DecipherFullBackupItemRead",itemType:e,itemId:t,backupDate:r}),t.decipherFullBackupItemSkipped=(e,t)=>({type:"DecipherFullBackupItemSkipped",itemType:t?.itemType,itemId:t?.itemId,error:e}),t.decipherFullBackupItemReadFailed=(e,t)=>({type:"DecipherFullBackupItemReadFailed",error:e,itemId:t}),t.decipherFullBackupFailed=e=>({type:"DecipherFullBackupFailed",error:e}),t.decipherFullBackupFinished=e=>({type:"DecipherFullBackupFinished",itemsCount:e}),t.decipherTransactionStarted=({action:e,backupDate:t,identifier:r,time:a,type:o})=>({type:"DecipherTransactionStarted",time:a,action:e,backupDate:t,identifier:r,transactionType:o}),t.decipherTransactionDecipherFailed=(e,t)=>({type:"DecipherTransactionDecipherFailed",error:e,cryptoPayload:t}),t.decipherTransactionParseFailed=e=>({type:"DecipherTransactionParseFailed",error:e}),t.decipherTransactionFailed=(e,{backupDate:t,identifier:r,type:a})=>({type:"DecipherTransactionFailed",error:e,transactionType:a,identifier:r,backupDate:t}),t.decipherTransactionFinished=({action:e,backupDate:t,identifier:r,type:a})=>({type:"DecipherTransactionFinished",action:e,transactionType:a,identifier:r,backupDate:t}),t.transactionDuplicated=(e,t,r)=>({type:"TransactionDuplicated",transactionType:e,identifier:t,backupDate:r}),t.treatProblemSummaryStarted=(e,t)=>({type:"TreatProblemSummaryStarted",localItemsCount:(0,n.countPersonalDataItems)(e),remoteItemsCount:(0,a.countSyncSummaryTransactions)(t)}),t.treatProblemSummaryCompared=(e,t,r,a)=>({type:"TreatProblemSummaryCompared",result:e,transactionType:t,identifier:r,...a?.cause?{cause:a.cause}:{},...a?.localDate?{localDate:a.localDate}:{},...a?.remoteDate?{remoteDate:a.remoteDate}:{}}),t.treatProblemSummaryFinished=()=>({type:"TreatProblemSummaryFinished"}),t.saveStarted=()=>({type:"SaveStarted"}),t.saveFinished=()=>({type:"SaveFinished"})},63011:function(e,t,r){var a=this&&this.__createBinding||(Object.create?function(e,t,r,a){void 0===a&&(a=r);var o=Object.getOwnPropertyDescriptor(t,r);(!o||("get"in o?!t.__esModule:o.writable||o.configurable))&&(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,a,o)}:function(e,t,r,a){void 0===a&&(a=r),e[a]=t[r]}),o=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||a(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),t.announcements=void 0;let n=r(63022);t.announcements=n,o(r(55558),t)},55558:function(e,t){var r,a;Object.defineProperty(t,"__esModule",{value:!0}),t.TreatProblemSummaryComparedCause=t.TreatProblemSummaryComparedResult=void 0,(r=t.TreatProblemSummaryComparedResult||(t.TreatProblemSummaryComparedResult={}))[r.UpToDate=0]="UpToDate",r[r.Upload=1]="Upload",r[r.Download=2]="Download",(a=t.TreatProblemSummaryComparedCause||(t.TreatProblemSummaryComparedCause={}))[a.OutOfDate=0]="OutOfDate",a[a.Missing=1]="Missing"},4002:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.generateLocalDuplicates=void 0;let a=r(25903),o=r(1469),n=r(24445),i=r(61681),s=r(4745),c=r(27498),l=r(33795),u=r(12857),d=(e,t)=>{let r=o.mergingRules[t.type];if(!r||0===r.length||!t.content)return!1;let a=(0,l.fixPersonalDataItemFromExternalSource)(t.content,t.identifier);for(let{property:o,canonize:n}of r){let r=e[o],i=a[o];if("Domain"===o&&"AUTHENTIFIANT"===t.type&&r&&i&&(r=new u.ParsedURL(e.Url).getRootDomain(),i=new u.ParsedURL(a.Url).getRootDomain()),(n?(0,s.canonizeText)(r):r)!==(n?(0,s.canonizeText)(i):i))return!0}return!1};t.generateLocalDuplicates=function(e,t,r){let o=(0,n.filterDataModelObjects)(t,e,["changeHistories"]),s=e=>{let t=(0,c.findTransaction)(e.Id,r);return!t||(0,c.isRemovalTransaction)(t)||!d(e,t)?null:{duplicate:{...(0,a.clone)(e),Id:(0,i.generateItemUuid)()},duplicatedFromId:e.Id}};return o.reduce((e,t)=>{let r=s(t);return r&&e.push(r),e},[])}},1469:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.mergingRules=void 0,t.mergingRules={ADDRESS:[{property:"AddressFull",canonize:!1},{property:"City",canonize:!1},{property:"ZipCode",canonize:!0}],AUTHENTIFIANT:[{property:"Domain",canonize:!1},{property:"Email",canonize:!1},{property:"Login",canonize:!1},{property:"Note",canonize:!1},{property:"OtpSecret",canonize:!1},{property:"OtpUrl",canonize:!1},{property:"Password",canonize:!1},{property:"SubdomainOnly",canonize:!1},{property:"Title",canonize:!1},{property:"TrustedUrl",canonize:!1},{property:"UseFixedUrl",canonize:!1}],BANKSTATEMENT:[{property:"BankAccountIBAN",canonize:!0}],COMPANY:[{property:"Name",canonize:!1},{property:"JobTitle",canonize:!1}],DATA_CHANGE_HISTORY:[{property:"ObjectId",canonize:!0}],DRIVERLICENCE:[{property:"Number",canonize:!0}],EMAIL:[{property:"Email",canonize:!0}],FISCALSTATEMENT:[{property:"FiscalNumber",canonize:!0},{property:"TeledeclarantNumber",canonize:!0}],GENERATED_PASSWORD:[{property:"Domain",canonize:!1},{property:"GeneratedDate",canonize:!1},{property:"Password",canonize:!1}],IDCARD:[{property:"Number",canonize:!0}],IDENTITY:[{property:"FirstName",canonize:!1},{property:"LastName",canonize:!1}],PASSPORT:[{property:"Number",canonize:!0}],PAYMENTMEAN_PAYPAL:[{property:"Login",canonize:!1},{property:"Password",canonize:!1}],PAYMENTMEANS_CREDITCARD:[{property:"Bank",canonize:!0},{property:"CardNumber",canonize:!0},{property:"CardNumberLastDigits",canonize:!0},{property:"ExpireMonth",canonize:!0},{property:"ExpireYear",canonize:!0},{property:"OwnerName",canonize:!0}],PERSONALWEBSITE:[{property:"Website",canonize:!1}],PHONE:[{property:"Number",canonize:!0}],PURCHASE_CATEGORY:[{property:"CategoryName",canonize:!1}],PURCHASEBASKET:[{property:"Id",canonize:!1}],PURCHASEPAIDBASKET:[{property:"AutoTitle",canonize:!1},{property:"Comment",canonize:!1},{property:"DeliveryAddressDescription",canonize:!1},{property:"DeliveryAddressName",canonize:!1},{property:"MerchantDomain",canonize:!0},{property:"PaymentMeanDescription",canonize:!1},{property:"PaymentMeanName",canonize:!1},{property:"PurchaseDate",canonize:!0},{property:"TotalAmount",canonize:!0},{property:"UserTitle",canonize:!1}],SECURENOTE:[{property:"Title",canonize:!1},{property:"Content",canonize:!1}],SOCIALSECURITYSTATEMENT:[{property:"SocialSecurityNumber",canonize:!0}]}},29705:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.mergeChangeHistories=void 0;let a=r(25903);t.mergeChangeHistories=function(e,t){let r=(0,a.eqBy)((0,a.prop)("Id")),o=(0,a.ascend)((0,a.prop)("ModificationDate")),n=(0,a.unionWith)(r,e.ChangeSets,t.ChangeSets);return{...e,ChangeSets:(0,a.sort)(o,n)}}},5894:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.mergeLocalAndRemote=t.getMergeableTransactions=t.supportedTransactionTypesForMerge=t.unMergeableTransaction=void 0;let a=r(25903),o=r(29705),n=r(27498);t.unMergeableTransaction=["DEFAULT_AUTHENTIFIANT","DEFAULT_CONFIDENTIAL","DEFAULT_IDENTITY","DEFAULT_PAYMENTMEANS","DEFAULT_MISC","DEFAULT_REWARDCARD","POINTS","SETTINGS","SECURITYALERTS"],t.supportedTransactionTypesForMerge=["DATA_CHANGE_HISTORY"],t.getMergeableTransactions=function(e,r){let o=(0,a.map)((0,a.prop)("itemId"),r);return e.filter(e=>!t.unMergeableTransaction.includes(e.type)).filter(e=>"BACKUP_REMOVE"!==e.action).filter(e=>o.includes(e.identifier)).filter(e=>t.supportedTransactionTypesForMerge.includes(e.type))},t.mergeLocalAndRemote=function(e,t){let r=[],a=e.changeHistories.map(e=>{let a=(0,n.findTransaction)(e.Id,t),i=o.mergeChangeHistories(e,a.content);return r.push({...a,content:i}),i});return{personalData:{...e,changeHistories:a},remoteTransactions:r}}},64308:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});let a=r(25903),o=r(20648),n=r(22560),i=r(64419),s=r(80896),c=r(5894),l=r(59992),u=r(27498),d=r(40257),p=r(4002),S=r(63011),g=r(80306);t.default=function(e,t,r,m){let{changesToUpload:y,editConflicts:f,transactionsToDownload:E}=function(e,t,r){if(0===t.length)return{changesToUpload:e,transactionsToDownload:t,editConflicts:[]};let o=(0,a.intersection)((0,a.pluck)("identifier",t),(0,a.pluck)("itemId",e));if(0===e.filter(e=>o.includes(e.itemId)).length)return{changesToUpload:e,transactionsToDownload:t,editConflicts:[]};let n=(0,a.reject)(e=>(0,l.isRemovalUploadChange)(e)&&o.includes(e.itemId),e),i=(0,a.reject)(e=>((0,u.isRemovalTransaction)(e)||r.has(e.identifier))&&o.includes(e.identifier),t),s=(0,a.intersection)((0,a.pluck)("identifier",i),(0,a.pluck)("itemId",n));return{changesToUpload:n,transactionsToDownload:i,editConflicts:s}}(t.changesToUpload,m,r);if(0===f.length)return{personalData:{...t,changesToUpload:y},remoteTransactions:[...E]};let A=`[Sync] conflict on local/remote changes, ${f.length} conflicts`;n.default.log(A),(0,s.sendExceptionLog)({error:Error(A),code:o.ExceptionCriticality.WARNING});let{duplicateObjects:h,uploadChangesWithDuplicates:_,usableRemoteTransactions:T}=function(e,t,r,a,o){if(0===o.length)return{uploadChangesWithDuplicates:r,usableRemoteTransactions:a,duplicateObjects:[]};let n=(0,p.generateLocalDuplicates)(o,t,a),i=n.map(e=>e.duplicate),s=i.map(e=>({action:"BACKUP_EDIT",backupDate:0,identifier:e.Id,objectType:"transaction",time:Date.now(),type:(0,d.getTransactionTypeFromDataModelType)(e.kwType),content:e}));s.forEach(({backupDate:t,identifier:r,type:a})=>{e(S.announcements.transactionDuplicated(a,r,t))});let c=n.map(e=>e.duplicatedFromId);return{uploadChangesWithDuplicates:r.filter(e=>!c.includes(e.itemId)).concat(i.map(g.createUploadChangeForItem)),duplicateObjects:i,usableRemoteTransactions:a.filter(e=>!o.includes(e.identifier)||c.includes(e.identifier)).concat(s)}}(e,t,y,E,f),v=(0,i.saveObjects)(t,h),I=c.getMergeableTransactions(T,_);if(0===I.length)return{personalData:{...v,changesToUpload:_},remoteTransactions:[...T]};let D=c.mergeLocalAndRemote(v,I);return{personalData:{...D.personalData,changesToUpload:_},remoteTransactions:[...T,...D.remoteTransactions]}}},79546:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.getSyncEventErrorName=t.getSyncEventExtent=t.createInitialSyncEvent=void 0;let a=r(83533),o=r(20648),n=r(87829),i=r(91783),s=r(21837),c=r(74907),l=r(77644);t.createInitialSyncEvent=(e,r,a)=>({extent:(0,t.getSyncEventExtent)(e),trigger:r,timestamp:a,duration:{sync:0,chronological:0,treat_problem:0,sharing:0}}),t.getSyncEventExtent=e=>{switch(e){case n.SyncType.LIGHT_SYNC:return a.Extent.Light;case n.SyncType.FULL_SYNC:return a.Extent.Full;case n.SyncType.FIRST_SYNC:return a.Extent.Initial;default:(0,i.assertUnreachable)(e)}},t.getSyncEventErrorName=function(e){let t=a.ErrorName.Other;return(0,s.isCarbonError)(e)&&(e.errorType===c.HttpError?t=(({errorCode:e})=>e===c.HttpErrorCode.CLIENT_ERROR||e===c.HttpErrorCode.SERVER_ERROR||e===c.HttpErrorCode.STATUS_CODE)(e)?a.ErrorName.HttpStatus:a.ErrorName.HttpIo:e.errorType===l.WSError&&(t=a.ErrorName.ResponseContent)),e instanceof Error&&e?.message&&void 0!==o.AuthenticationCode[e.message]&&(t=a.ErrorName.Authentication),t}},99882:function(e,t,r){var a=this&&this.__createBinding||(Object.create?function(e,t,r,a){void 0===a&&(a=r);var o=Object.getOwnPropertyDescriptor(t,r);(!o||("get"in o?!t.__esModule:o.writable||o.configurable))&&(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,a,o)}:function(e,t,r,a){void 0===a&&(a=r),e[a]=t[r]}),o=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||a(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),o(r(35740),t)},35740:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.makeEventLoggerSyncMonitor=void 0;let a=r(29141);t.makeEventLoggerSyncMonitor=()=>{let e=(0,a.getEmptyState)();return{monitor:(t,r)=>{e=(0,a.reduceState)(e,t,r)}}}},29141:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.reduceState=t.getEmptyState=void 0;let a=r(79546),o=r(83533),n=(e,t)=>({...e,syncEvent:{...e.syncEvent,...t}}),i=(e,t)=>e>0&&t>0?o.TreatProblem.UploadAndDownload:t>0?o.TreatProblem.Upload:e>0?o.TreatProblem.Download:o.TreatProblem.NotNeeded,s=e=>Date.now()-e,c=(e,{trigger:t,syncType:r},{timestamp:o})=>{let n=(0,a.createInitialSyncEvent)(r,t,Math.floor(o/1e3));return{...e,syncStartTimestamp:o,syncEvent:n}},l=(e,{timestamp:t})=>({...e,chronologicalStartTimestamp:t}),u=(e,{fullBackupFileSize:t})=>n(e,{duration:{...e.syncEvent.duration,chronological:s(e.chronologicalStartTimestamp)},fullBackupSize:t||0}),d=e=>n(e,{duration:{...e.syncEvent.duration,chronological:s(e.chronologicalStartTimestamp)},error:{step:o.ErrorStep.Chronological,name:o.ErrorName.Other}}),p=(e,{timestamp:t})=>({...e,treatProblemStartTimestamp:t}),S=(e,{transactionsToDownloadCount:t,transactionsToUploadCount:r})=>n(e,{treatProblem:i(t,r)}),g=e=>n(e,{duration:{...e.syncEvent.duration,treat_problem:s(e.treatProblemStartTimestamp)}}),m=e=>n(e,{duration:{...e.syncEvent.duration,treat_problem:s(e.treatProblemStartTimestamp)},error:{step:o.ErrorStep.TreatProblem,name:o.ErrorName.Other}}),y=e=>n(e,{error:{step:o.ErrorStep.TreatProblem,name:o.ErrorName.Other}}),f=(e,{timestamp:t})=>({...e,sharingSyncStartTimestamp:t}),E=e=>n(e,{duration:{...e.syncEvent.duration,sharing:s(e.sharingSyncStartTimestamp)}}),A=e=>n(e,{duration:{...e.syncEvent.duration,sharing:s(e.sharingSyncStartTimestamp)},error:{step:o.ErrorStep.Sharing,name:o.ErrorName.Other}}),h=(e,{updatesCount:t,deletesCount:r})=>{let a=e.syncEvent.incomingUpdateCount||0,o=e.syncEvent.incomingDeleteCount||0;return n(e,{incomingUpdateCount:a+t,incomingDeleteCount:o+r})},_=(e,{updatedCount:t,deletedCount:r})=>{let a=e.syncEvent.outgoingUpdateCount||0,o=e.syncEvent.outgoingDeleteCount||0;return n(e,{outgoingUpdateCount:a+t,outgoingDeleteCount:o+r})},T=e=>n(e,{duration:{...e.syncEvent.duration,sync:s(e.syncStartTimestamp)}}),v=(e,{error:t})=>n(e,{duration:{...e.syncEvent.duration,sync:s(e.syncStartTimestamp)},error:{...e.syncEvent.error,name:(0,a.getSyncEventErrorName)(t)}}),I=(e,{syncType:t})=>n(e,{extent:(0,a.getSyncEventExtent)(t)});t.getEmptyState=()=>({syncStartTimestamp:null,chronologicalStartTimestamp:null,treatProblemStartTimestamp:null,sharingSyncStartTimestamp:null,syncEvent:null}),t.reduceState=(e,t,r)=>{switch(t.type){case"SyncStarted":return c(e,t,r);case"ChronologicalSyncStarted":return l(e,r);case"ChronologicalSyncFinished":return u(e,t);case"ChronologicalSyncFailed":return d(e);case"TreatProblemStarted":return p(e,r);case"TreatProblemDiffComputed":return S(e,t);case"TreatProblemFinished":return g(e);case"TreatProblemFailed":return m(e);case"TreatSharingKeysFailed":return y(e);case"SharingSyncStarted":return f(e,r);case"SharingSyncFinished":return E(e);case"SharingSyncFailed":return A(e);case"DecipherFinished":return h(e,t);case"UploadSucceeded":return _(e,t);case"SyncFinished":return T(e);case"SyncFailed":return v(e,t);case"SyncTypeChanged":return I(e,t)}return e}},27498:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.findTransaction=t.isRemovalTransaction=t.isEditionTransaction=t.createNewTransaction=t.getTransactionXml=t.supportedForUploadKwTypeToTransactionTypeMap=t.supportedDataTypesForUpload=void 0;let a=r(25903),o=r(20648),n=r(40257),i=r(22560),s=r(80896),c=r(67179),l=r(34978),u=r(56708),d=r(63011);function p(e){return t.supportedForUploadKwTypeToTransactionTypeMap[e.kwType]?(0,u.getDashlaneXml)(e):(i.default.error(`Unsupported kwType "${e.kwType}" for transformation to XML`),"")}async function S(e,r,a){try{let{itemId:o,kwType:n,content:i}=a,s=t.supportedForUploadKwTypeToTransactionTypeMap[n];if("REMOVE"===a.action){let e={type:s,action:"BACKUP_REMOVE",identifier:o,objectType:"transaction",time:(0,c.getUnixTimestamp)(),backupDate:0,content:""};return Promise.resolve(e)}let u=(0,l.utf16ToDeflatedUtf8)(p(i)),S=await e.encrypt(u),g={type:s,action:"BACKUP_EDIT",identifier:o,objectType:"transaction",time:(0,c.getUnixTimestamp)(),backupDate:0,content:S};return r(d.announcements.transactionCiphered(s,o,0)),g}catch(t){let e=Error(`[Sync] - upload: failed to create transaction. ${t}`);return(0,s.sendExceptionLog)({error:e,code:o.ExceptionCriticality.ERROR}),null}}t.supportedDataTypesForUpload=["KWAddress","KWAuthentifiant","KWBankStatement","KWCollection","KWCompany","KWDataChangeHistory","KWDriverLicence","KWEmail","KWFiscalStatement","KWGeneratedPassword","KWIdentity","KWIDCard","KWPasskey","KWPassport","KWPaymentMean_creditCard","KWPersonalWebsite","KWPhone","KWSecret","KWSecureFileInfo","KWSecureNote","KWSecurityBreach","KWSettingsManagerApp","KWSocialSecurityStatement"],t.supportedForUploadKwTypeToTransactionTypeMap=(0,a.pick)(t.supportedDataTypesForUpload,n.DATAMODEL_TYPE_TO_TRANSACTION_TYPE),t.getTransactionXml=p,t.createNewTransaction=S;let g=(0,a.propEq)("identifier");t.isEditionTransaction=(0,a.propEq)("action","BACKUP_EDIT"),t.isRemovalTransaction=(0,a.propEq)("action","BACKUP_REMOVE"),t.findTransaction=(0,a.curry)((e,t)=>(0,a.find)(g(e),t))},40257:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.TransactionType=t.getTransactionTypeFromDataModelType=t.getDataModelTypeFromTransactionType=t.DATAMODEL_TYPE_TO_TRANSACTION_TYPE=void 0;let a=r(20648);Object.defineProperty(t,"DATAMODEL_TYPE_TO_TRANSACTION_TYPE",{enumerable:!0,get:function(){return a.DATAMODEL_TYPE_TO_TRANSACTION_TYPE}}),Object.defineProperty(t,"getDataModelTypeFromTransactionType",{enumerable:!0,get:function(){return a.getDataModelTypeFromTransactionType}}),Object.defineProperty(t,"getTransactionTypeFromDataModelType",{enumerable:!0,get:function(){return a.getTransactionTypeFromDataModelType}}),Object.defineProperty(t,"TransactionType",{enumerable:!0,get:function(){return a.TransactionType}})},24685:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.countRemoveTransactions=t.countEditionTransactions=void 0;let r=(e,t)=>e.reduce((e,r)=>r.identifier&&r.action===t?e+1:e,0);t.countEditionTransactions=e=>r(e,"BACKUP_EDIT"),t.countRemoveTransactions=e=>r(e,"BACKUP_REMOVE")},33727:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.getMissingIdentifiers=void 0;let a=r(20648),o=r(25903),n=r(63011),i=r(80306);t.getMissingIdentifiers=function(e,t,r){let s=(e,t)=>({missingLocally:[...e.missingLocally,...t.missingLocally],missingRemotely:[...e.missingRemotely,...t.missingRemotely]});e(n.announcements.treatProblemSummaryStarted(t,r));let c=a.transactionTypes.reduce((c,l)=>s(c,function(e,t,r,s){let c=a.TRANSACTION_TYPE_TO_DATAMODEL_TYPE[t];if(!c||!a.DATAMODELOBJECT_TYPE_TO_CARBON_STORE_KEY[c])return{missingLocally:[],missingRemotely:[]};let l=a.DATAMODELOBJECT_TYPE_TO_CARBON_STORE_KEY[c];if(!r[l])return{missingLocally:[],missingRemotely:[]};let u=s.transactions[t]||{},d=new Set(r.changesToUpload.filter(({kwType:e})=>e===c).map(({itemId:e})=>e)),p=r[l].filter(({Id:e})=>!d.has(e)),S=Object.keys(u).filter(e=>!d.has(e)),g=(0,o.difference)(S,(0,o.pluck)("Id",p));g.forEach(r=>{e(n.announcements.treatProblemSummaryCompared(n.TreatProblemSummaryComparedResult.Download,t,r,{cause:n.TreatProblemSummaryComparedCause.Missing,remoteDate:u[r]}))});let m=n.announcements.treatProblemSummaryCompared;return p.reduce((r,{Id:a,LastBackupTime:o})=>{let s=u[a],l=1e3*o;if(!s||s/1e3<o){e(m(n.TreatProblemSummaryComparedResult.Upload,t,a,{cause:s?n.TreatProblemSummaryComparedCause.OutOfDate:n.TreatProblemSummaryComparedCause.Missing,localDate:l,...s?{remoteDate:s}:{}}));let o=(0,i.createUploadChange)({action:"EDIT",kwType:c,itemId:a});return{missingLocally:r.missingLocally,missingRemotely:[...r.missingRemotely,o]}}return s/1e3>o?(e(m(n.TreatProblemSummaryComparedResult.Download,t,a,{cause:n.TreatProblemSummaryComparedCause.OutOfDate,localDate:l,remoteDate:s})),{missingLocally:[...r.missingLocally,a],missingRemotely:r.missingRemotely}):(e(m(n.TreatProblemSummaryComparedResult.UpToDate,t,a,{localDate:l})),r)},{missingLocally:g,missingRemotely:[]})}(e,l,t,r)),{missingLocally:[],missingRemotely:[]});return e(n.announcements.treatProblemSummaryFinished()),c}},59992:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.getUploadChangesWithoutSettings=t.isSettingUploadChange=t.countDeletionUploadChanges=t.countEditionUploadChanges=t.findUploadChange=t.isRemovalUploadChange=t.isEditionUploadChange=void 0;let a=r(25903),o=(0,a.propEq)("itemId");t.isEditionUploadChange=(0,a.propEq)("action","EDIT"),t.isRemovalUploadChange=(0,a.propEq)("action","REMOVE"),t.findUploadChange=(0,a.curry)((e,t)=>(0,a.find)(o(e),t)),t.countEditionUploadChanges=e=>e.filter(e=>(0,t.isEditionUploadChange)(e)).length,t.countDeletionUploadChanges=e=>e.filter(e=>(0,t.isRemovalUploadChange)(e)).length,t.isSettingUploadChange=(0,a.propEq)("kwType","KWSettingsManagerApp"),t.getUploadChangesWithoutSettings=e=>(0,a.reject)(t.isSettingUploadChange,e)},51333:function(e,t){var r;Object.defineProperty(t,"__esModule",{value:!0}),t.UploadChangeStatus=void 0,(r=t.UploadChangeStatus||(t.UploadChangeStatus={})).ReadyForNextSync="ReadyForNextSync",r.ScheduledForSync="ScheduledForSync"},96285:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.markChangeAsReadyForNextSync=t.markChangeAsScheduled=t.filterOutUploadedChanges=void 0;let a=r(51333);t.filterOutUploadedChanges=(e,t)=>e.filter(({itemId:e,status:r})=>!t.includes(e)||r!==a.UploadChangeStatus.ScheduledForSync);let o=e=>t=>({...t,status:e});t.markChangeAsScheduled=o(a.UploadChangeStatus.ScheduledForSync),t.markChangeAsReadyForNextSync=o(a.UploadChangeStatus.ReadyForNextSync)},80306:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.createUploadChangeForDeletion=t.createUploadChangeForItem=t.createUploadChange=void 0;let a=r(51333);t.createUploadChange=({itemId:e,kwType:t,action:r="EDIT",status:o=a.UploadChangeStatus.ReadyForNextSync})=>({itemId:e,kwType:t,action:r,status:o});let o=e=>({itemId:e.Id,kwType:e.kwType});t.createUploadChangeForItem=e=>(0,t.createUploadChange)(o(e)),t.createUploadChangeForDeletion=e=>r=>(0,t.createUploadChange)({itemId:r,kwType:e,action:"REMOVE"})},16137:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.isUploadNeeded=t.upload=t.gatherContentsToUpload=void 0;let a=r(25903),o=r(20648),n=r(59992),i=r(27498),s=r(24685),c=r(63011),l=Object.keys(i.supportedForUploadKwTypeToTransactionTypeMap),u=(0,a.flip)(a.contains)(l),d=(0,a.compose)(a.uniq,(0,a.filter)((0,a.propSatisfies)(u,"kwType")),(0,a.filter)((0,a.propSatisfies)(Boolean,"itemId")),(0,a.defaultTo)([]));function p(e,t){return d(e.changesToUpload).map(r=>{let{action:i,kwType:s,itemId:c}=r,l=o.DATAMODELOBJECT_TYPE_TO_CARBON_STORE_KEY[s];if((0,n.isRemovalUploadChange)(r))return{action:i,kwType:s,itemId:c,content:null};if("KWSettingsManagerApp"===r.kwType&&"SETTINGS_userId"===c)return{action:i,kwType:s,itemId:c,content:t};let u=(0,a.find)((0,a.propEq)("Id",c),e[l]);return u?{action:i,kwType:s,itemId:c,content:u}:null}).filter(a.identity)}t.gatherContentsToUpload=p;let S=async(e,t,r)=>{t(c.announcements.cipherStarted());let a=r.map(r=>(0,i.createNewTransaction)(e,t,r)),o=await Promise.all(a);return t(c.announcements.cipherFinished()),o.filter(Boolean)};async function g(e){let{announce:t,cryptoCenterService:r,personalData:a,personalSettings:o}=e,n=p(a,o),i=await S(r,t,n);if(0===i.length)return{uploadedTransactionsId:[]};try{let r=(0,s.countEditionTransactions)(i),a=(0,s.countRemoveTransactions)(i);t(c.announcements.uploadRequested(r,a));let o=await e.ws.backup.upload({login:e.login,uki:e.uki,lock:e.lock,transactions:i,privateKey:e.privateKey,publicKey:e.publicKey}),n=i.reduce((e,t)=>(t.identifier&&e.push(t.identifier),e),[]);return t(c.announcements.uploadSucceeded(r,a,o.timestamp)),{uploadedTransactionsId:n,lastSyncTimestamp:Number(o.timestamp),summary:o.summary}}catch(e){throw t(c.announcements.uploadFailed(e)),e}}t.upload=g,t.isUploadNeeded=function(e){let t=(0,a.propOr)([],"changesToUpload",e);return 0!==t.length&&d(t).length>0}},75035:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.countSyncSummaryTransactions=void 0,t.countSyncSummaryTransactions=function(e){return e?Object.keys(e.transactions).reduce((t,r)=>t+(Object.keys(e.transactions[r])||[]).length,0):0}},75795:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.getLastSuccessfulSyncTimestamp=t.sync=t.MAX_SYNC_TIMESTAMP=t.MIN_SYNC_TIMESTAMP=void 0;let a=r(25903),o=r(87829),n=r(66132),i=r(16137),s=r(64308),c=r(22560),l=r(65356),u=r(63011),d=r(99520),p=r(59992),S=r(93625),g=r(80896),m=r(21837),y=(e,t)=>{let r=new Set;for(let t of e&&e.items||[])t&&"object"==typeof t&&t.id&&r.add(t.id);for(let e of t.items)e&&"object"==typeof e&&e.itemId&&r.add(e.itemId);return r};async function f(e){let r;let{announce:f,storeService:A}=e;try{let h=A.getState();!function(e){switch(e.syncType){case o.SyncType.FIRST_SYNC:{if(0!==e.lastSyncTimestamp)throw Error("Sync Error: lastSyncTimestamp should be 0 on First Sync");let t=(0,p.getUploadChangesWithoutSettings)(e.personalData?.changesToUpload??[]);if(t?.length)throw Error("Sync Error: should not have changes to upload on First Sync");break}case o.SyncType.LIGHT_SYNC:case o.SyncType.FULL_SYNC:if(null===e.lastSyncTimestamp||e.lastSyncTimestamp<t.MIN_SYNC_TIMESTAMP||e.lastSyncTimestamp>t.MAX_SYNC_TIMESTAMP){let t=Error("Sync Error: non valid lastSyncTimestamp"),r=m.CarbonError.fromAnyError(t).addContextInfo("SYNC","verifySyncArgs").addAdditionalInfo({libError:`lastSyncTimestamp: ${e.lastSyncTimestamp}`});throw(0,g.sendExceptionLog)({error:r}),t}break;default:{let t=Error("Sync Error: unexpected syncType"),r=m.CarbonError.fromAnyError(t).addContextInfo("SYNC","verifySyncArgs").addAdditionalInfo({libError:`syncType: ${e.syncType}`});throw(0,g.sendExceptionLog)({error:r}),t}}}(e);let _=e.personalData||A.getPersonalData(),{isUploadEnabled:T}=A.getSyncStatus();c.Debugger.log(`[Sync] User allowed to Upload: ${T}`),T&&(0,i.isUploadNeeded)(_)&&(c.Debugger.log("[Sync] Found local data to upload"),e.syncType=o.SyncType.FULL_SYNC,f(u.announcements.syncTypeChanged(e.syncType))),A.dispatch((0,S.scheduleChangesForSync)()),r=await (0,n.latest)(e);let v=()=>({...(0,a.dissoc)("lock",r),syncType:e.syncType,isUploadEnabled:r.isUploadEnabled,lastSyncTimestamp:E(e.lastSyncTimestamp,r.lastSyncTimestamp),uploadedTransactions:[],summary:r.summary});if((0,l.changeMPinProgressSelector)(h))return await (0,d.unlock)(e,r.lock),v();if(e.syncType!==o.SyncType.FULL_SYNC||!r.isUploadEnabled)return r.isUploadEnabled&&await (0,d.unlock)(e,r.lock),v();let I=y(r.sharing2,A.getSharingData()),{personalData:D,remoteTransactions:P}=(0,s.default)(f,_,I,r.clearTransactions),O=(0,a.isNil)(e.pushKeysToServer)?null:{publicKey:e.pushKeysToServer.public,privateKey:e.pushKeysToServer.private},C={login:e.login,uki:e.uki,lock:r.lock,ws:e.ws,cryptoCenterService:e.dataEncryptorService.getInstance(),personalData:D,personalSettings:A.getPersonalSettings(),...O,announce:f},b=await (0,i.upload)(C);return 0===b.uploadedTransactionsId.length&&(0,d.unlock)(e,r.lock),A.dispatch((0,S.clearUploadedChanges)(b.uploadedTransactionsId)),{...(0,a.dissoc)("lock",r),clearTransactions:P,syncType:e.syncType,isUploadEnabled:r.isUploadEnabled,uploadedTransactions:b.uploadedTransactionsId,lastSyncTimestamp:E(e.lastSyncTimestamp,b.lastSyncTimestamp),summary:b.summary||r.summary}}catch(t){throw r&&await (0,d.unlock)(e,r.lock),t&&t.message,t}finally{A.dispatch((0,S.unscheduleRemainingChanges)())}}function E(e,t){let r=Number(t);return""===t||(0,a.isNil)(t)||isNaN(r)?e:r}t.MIN_SYNC_TIMESTAMP=0xe8d4a50fff,t.MAX_SYNC_TIMESTAMP=2070753783e3,t.sync=f,t.getLastSuccessfulSyncTimestamp=E},66132:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.buildFullBackupFileMap=t.buildLatestArgs=t.latest=void 0;let a=r(42387),o=r(25903),n=r(20648),i=r(83648),s=r(22560),c=r(87829),l=r(63011),u=r(99520),d=r(21837),p=r(80896);async function S(e){let t;let r=g(e),{announce:a}=e;try{let{lock:o,needsKeys:i}=r;if(a(l.announcements.latestRequested(o,i)),t=await e.ws.backup.latest(r),"message"===t.objectType){if("Incorrect authentification"===t.content)throw Error(n.AuthenticationCode[n.AuthenticationCode.INVALID_UKI]);if("Temporarily disabled"===t.content)throw Error("Sync service unavailable");throw Error(n.AuthenticationCode[n.AuthenticationCode.UNKNOWN_SYNC_ERROR])}if(void 0!==t.objectType)throw Error("unexpected objectType");if(!t.transactionList)throw s.default.log("Backup sync failed"),Error("Backup sync failed");if(t.transactionList.find(e=>!e.backupDate||e.backupDate<0xe8d4a50fff||e.backupDate>2070753783e3))throw Error("wrongly formatted backupDate")}catch(e){throw a(l.announcements.latestFailed(e)),e}a(l.announcements.latestSucceeded(t));let c=m(t.fullBackupFileList);try{return{clearTransactions:await i.decrypt(e.dataEncryptorService.getInstance(),a,t.fullBackupFile,c,t.transactionList),sharing2:t.sharing2,lastSyncTimestamp:t.timestamp,lock:r.lock,keys:t.keys,isUploadEnabled:(0,o.defaultTo)(!1,t.uploadEnabled),summary:t.summary,fullBackupFileSize:c.size}}catch(t){throw(0,u.unlock)(e,r.lock),t}}function g(e){let{lastSyncTimestamp:t,login:r,needsKeys:o,storeService:n,syncType:i,transactionIds:s,uki:l}=e,u=s&&s.length,S={lock:i===c.SyncType.FULL_SYNC||u?(0,a.v4)():"nolock",login:r,needsKeys:o,sharing2:!0,teamAdminGroups:!0,timestamp:t,version:n.getPlatform().info.appVersion,uki:l};switch(s&&(S.transactions=s),i){case c.SyncType.FIRST_SYNC:if(0!==S.timestamp)throw Error("timestamp should be null for FIRST_SYNC");break;case c.SyncType.LIGHT_SYNC:case c.SyncType.FULL_SYNC:if(isNaN(S.timestamp))S.timestamp=0;else if(null===S.timestamp||S.timestamp<0xe8d4a50fff||S.timestamp>2070753783e3){let e=Error("non valid lastSyncTimestamp"),t=d.CarbonError.fromAnyError(e).addContextInfo("SYNC","buildLatestArgs").addAdditionalInfo({libError:`lastSyncTimestamp: ${S.timestamp}`});throw(0,p.sendExceptionLog)({error:t}),e}break;default:{let e=Error("unexpected syncType"),t=d.CarbonError.fromAnyError(e).addContextInfo("SYNC","buildLatestArgs").addAdditionalInfo({libError:`syncType: ${i}`});throw(0,p.sendExceptionLog)({error:t}),e}}return S}function m(e){let t=new Map;return e&&e.forEach(e=>{t.set(e.identifier,e.backupDate)}),t}t.latest=S,t.buildLatestArgs=g,t.buildFullBackupFileMap=m},87829:function(e,t){var r;Object.defineProperty(t,"__esModule",{value:!0}),t.SyncType=void 0,(r=t.SyncType||(t.SyncType={}))[r.FIRST_SYNC=0]="FIRST_SYNC",r[r.LIGHT_SYNC=1]="LIGHT_SYNC",r[r.FULL_SYNC=2]="FULL_SYNC"},99520:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.unlock=void 0;let a=r(22560);async function o(e,t){if(!(t&&"nolock"!==t))return;let{login:r,ws:o,uki:n}=e;try{await o.backup.unlock({login:r,uki:n,lock:t})}catch(e){(0,a.logWarn)({tag:"Sync",message:`Unlock failed: ${e}`})}}t.unlock=o},41683:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.binaryFindLastIndex=t.binaryFindIndex=t.binaryContains=void 0;let a=r(25903);t.binaryContains=(0,a.curry)(function e(t,r){let a=t.length;if(0===a)return!1;let o=Math.floor(a/2),n=t[o];return n===r||(n<r?e(t.slice(o+1,a),r):e(t.slice(0,o),r))}),t.binaryFindIndex=function e(t,r,a){let o=t.length;if(0===o)return -1;let n=a?Math.min(a,o-1):Math.floor(o/2);if(r(t[n])){let a=e(t.slice(0,n),r);return -1===a?n:a}{let a=e(t.slice(n+1,o),r);return -1===a?-1:n+a+1}},t.binaryFindLastIndex=function e(t,r,a){let o=t.length;if(0===o)return -1;let n=a?Math.min(a,o-1):Math.floor(o/2);if(!r(t[n]))return e(t.slice(0,n),r);{let a=e(t.slice(n+1,o),r);return -1===a?n:n+a+1}}},25434:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.makeDataEncryptorService=t.setObfuscatingKey=void 0;let a=r(34978);t.setObfuscatingKey=function(e){return e.setInstance({raw:[214,238,100,106,146,140,114].concat([110,232,72,104,108,100,204]).map(e=>e/2).map(e=>String.fromCharCode(e)).join("")},""),e},t.makeDataEncryptorService=function(e){let t=null;return{setInstance:(r,o,n)=>{t=(0,a.makeCryptoCenterService)(r,o,e,n)},getInstance:()=>{if(!t)throw Error("makeDataEncryptorService: you must call setInstance(password,serverKey) before getting the instance");return t},close:()=>{t=null},hasBeenSet:()=>!!t}}},73082:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.convertDashlaneSecureDataKWC3ToTransportableData=void 0;let a=r(93308);t.convertDashlaneSecureDataKWC3ToTransportableData=e=>{let t=e.salt,r=(0,a.utf8ToBase64Buffer)(e.version),o=e.encryptedData;return(0,a.concatBuffers)(t,r,o)}},93308:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.convertBufferToHex=t.deflateBuffer=t.removeQtCompressionHeader=t.addQtCompressHeader=t.isBase64Encoded=t.getSubDataByteArray=t.concatBuffers=t.ab2str=t.str2ab=t.base64ToBigInteger=t.pemToSpki=t.spkitoPem=t.pkcs8toPem=t.CrlfToLF=t.pemTopkcs8=t.base64BufferToText=t.utf8ToBase64=t.base64ToUtf8=t.utf8ToBase64Buffer=t.base64BufferToUtf8=t.arrayBufferToText=t.uint8ArrayToText=t.utf8ChunkDecode=t.utf8ChunkEncode=t.base64ToBuffer=t.bufferToBase64=t.applyXorOnBuffers=void 0;let a=r(24592),o=r(95051),n=r(3534),i=r(63946),s=r(74265),c=r(21936),l=r(25951),u="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",d=new Uint8Array(256);for(let e=0;e<u.length;e++)d[u.charCodeAt(e)]=e;function p(e,t=1e6){let r=new Uint8Array(e),a=r.length,o=t%3,n=0===o?t:t+(3-o),i=Math.ceil(a/n),s="",c=-1;for(;c++<i;){let e=c*n,t=c===i-1?a:(c+1)*n,o=function(e){let t=e.length,r=[];for(let a=0;a<t;a+=3)r.push(u[e[a]>>2]),r.push(u[(3&e[a])<<4|e[a+1]>>4]),r.push(u[(15&e[a+1])<<2|e[a+2]>>6]),r.push(u[63&e[a+2]]);return r.join("")}(r.slice(e,t));s=s.concat(o)}return a%3==2?s.substring(0,s.length-1)+"=":a%3==1?s.substring(0,s.length-2)+"==":s}function S(e){let t,r,a,o,n,i=.75*e.length,s=e.length,c=0;e.endsWith("=")&&(i--,"="===e[e.length-2]&&i--);let l=new ArrayBuffer(i),u=new Uint8Array(l);for(t=0;t<s;t+=4)r=d[e.charCodeAt(t)],a=d[e.charCodeAt(t+1)],o=d[e.charCodeAt(t+2)],n=d[e.charCodeAt(t+3)],u[c++]=r<<2|a>>4,u[c++]=(15&a)<<4|o>>2,u[c++]=(3&o)<<6|63&n;return l}function g(e,t=1e6){let r=e.length;if(0===r)return"";let a="",o=0,n=Math.min(0+t,r);for(;n<=r;){let i=e.charCodeAt(n-1);if(i>=55296&&i<=56319){if(++n>r)throw Error("Invalid string provided to utf8ChunkEncode");continue}let s=e.slice(o,n),c=l.encode(s);if(a=a.concat(c),n===r)break;n=Math.min((o=n)+t,r)}return a}t.applyXorOnBuffers=function(e,t){if(e.byteLength!==t.byteLength)throw Error("xorBuffer: buffers are not same length");let r=new Uint8Array(e),a=new Uint8Array(t),o=e.byteLength,n=new Uint8Array(o);for(let e=0;e<o;e++)n[e]=r[e]^a[e];return n.buffer},t.bufferToBase64=p,t.base64ToBuffer=S,t.utf8ChunkEncode=g;function m(e,t=1e6){let r=e.length;if(0===r)return"";let a="",o=0,n=Math.min(0+t,r);for(;n<=r;){if(function(e){var t;return e>>6==2||(t=e)>>5==6||t>>4==14||t>>3==30}(e.charCodeAt(n-1))&&n<r&&e.charCodeAt(n)>>6==2){n++;continue}let i=e.slice(o,n),s=l.decode(i);if(a=a.concat(s),n===r)break;n=Math.min((o=n)+t,r)}return a}function y(e){let t=new Uint16Array(e),r=t.length,a="",o=16383;for(let e=0;e<r;e+=o)e+o>r&&(o=r-e),a+=String.fromCharCode.apply(null,t.subarray(e,e+o));return a}function f(e){return y(new Uint8Array(e))}function E(e){let t=new ArrayBuffer(e.length),r=new Uint8Array(t);for(let t=0;t<e.length;++t)r[t]=e.charCodeAt(t);return t}function A(...e){let t=new Uint8Array(e.reduce((e,t)=>e+t.byteLength,0));return e.reduce((e,r)=>(t.set(new Uint8Array(r),e),e+r.byteLength),0),t.buffer}t.utf8ChunkDecode=m,t.uint8ArrayToText=y,t.arrayBufferToText=f,t.base64BufferToUtf8=function(e){let t=p(e);return m(a.decode(t))},t.utf8ToBase64Buffer=function(e){let t=g(e);return S(a.encode(t))},t.base64ToUtf8=function(e){return m(a.decode(e))},t.utf8ToBase64=function(e){let t=g(e);return a.encode(t)},t.base64BufferToText=function(e){let t=p(e);return a.decode(t)},t.pemTopkcs8=function(e){let t=o.privateKeyFromPem(e),r=o.privateKeyToAsn1(t),a=o.wrapRsaPrivateKey(r);return E(s.toDer(a).getBytes())},t.CrlfToLF=e=>e.replace(/(?:\\[r]|[\r\n]+)+/g,"\n"),t.pkcs8toPem=function(e){let r=new n.ByteBuffer(e),a=s.fromDer(r),i=o.privateKeyFromAsn1(a),c=o.privateKeyToPem(i);return(0,t.CrlfToLF)(c)},t.spkitoPem=function(e){let r=new n.ByteBuffer(e),a=s.fromDer(r),i=o.publicKeyFromAsn1(a),c=o.publicKeyToRSAPublicKeyPem(i);return(0,t.CrlfToLF)(c)},t.pemToSpki=function(e){let t=o.publicKeyFromPem(e),r=o.publicKeyToAsn1(t);return E(s.toDer(r).getBytes())},t.base64ToBigInteger=function(e){let t="===".slice((e.length+3)%4),r=(e+t).replace(/\-/g,"+").replace(/_/g,"/"),a=n.decode64(r);return new i.BigInteger(n.bytesToHex(a),16)},t.str2ab=E,t.ab2str=f,t.concatBuffers=A,t.getSubDataByteArray=function(e,t,r){return e.slice(t,r)},t.isBase64Encoded=function(e){return e&&/^([A-Za-z0-9+/]{4})*([A-Za-z0-9+/]{4}|[A-Za-z0-9+/]{3}=|[A-Za-z0-9+/]{2}==)$/.test(e)},t.addQtCompressHeader=function(e){let t;return A(new Uint8Array([(0xff000000&(t=e.byteLength))>>24,(0xff0000&t)>>16,(65280&t)>>8,255&t]).buffer,e)},t.removeQtCompressionHeader=function(e){return e.slice(4)},t.deflateBuffer=function(e){return c.deflate(new Uint8Array(e),{level:7}).buffer},t.convertBufferToHex=function(e){return Array.prototype.map.call(new Uint8Array(e),e=>("00"+e.toString(16)).slice(-2)).join("")}},60355:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.getRandomValues=void 0;let a=r(22640);t.getRandomValues=function(e){return(0,a.getWebCrypto)().getRandomValues(new Uint8Array(e))}},81649:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.jwkToSpki=t.evpBytesToKey=void 0;let a=r(95051),o=r(74265),n=r(59587),i=r(93308);async function s(e){let{derivedKey:t,salt:r,keyLength:a,ivLength:o}=e,s=(0,i.concatBuffers)(t,r.slice(0,8)),c=await (0,n.computeHashSha1)(s),l=await (0,n.computeHashSha1)((0,i.concatBuffers)(c,s)),u=await (0,n.computeHashSha1)((0,i.concatBuffers)(l,s));return Promise.resolve((0,i.concatBuffers)(c,l,u).slice(a,a+o))}t.evpBytesToKey=s,t.jwkToSpki=e=>{let{modulus:t,exponent:r}=e,n=a.setRsaPublicKey((0,i.base64ToBigInteger)(t),(0,i.base64ToBigInteger)(r)),s=a.publicKeyToAsn1(n),c=o.toDer(s).getBytes();return(0,i.str2ab)(c)}},18040:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.getNoDerivationCryptoConfig=void 0;let a=r(92180),o=r(50527);t.getNoDerivationCryptoConfig=function(){return(0,a.parsePayload)(o.CRYPTO_NODERIVATION_HMAC64).cryptoConfig}},22640:function(e,t){function r(){return self.crypto||null}Object.defineProperty(t,"__esModule",{value:!0}),t.getWebCryptoSubtle=t.getWebCrypto=void 0,t.getWebCrypto=r,t.getWebCryptoSubtle=function(){let e=r();return e?e.subtle?e.subtle:e.webkitSubtle?e.webkitSubtle:null:null}},58361:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.generateLocalkeyAndSetupEncryptorService=t.getEncryptionKeyBuffer=void 0;let a=r(18040),o=r(93308),n=r(12971),i=r(49789),s=r(4455);async function c(e,t,r,c){let l=await (0,n.generate64BytesKey)(),u=(0,o.base64BufferToText)(l),d=(0,a.getNoDerivationCryptoConfig)();e.setInstance({raw:u},"",d),t.dispatch((0,i.updateLocalKey)(u)),c===s.PersistData.PERSIST_DATA_YES&&await r.getInstance().user.persistLocalKey(u)}t.getEncryptionKeyBuffer=function(e,t,r){if(r.skipDerivation){if(e.byteLength<64)throw Error(`createEncryptionKey: password should be at least 64 bytes long but is: ${e.byteLength}`);return(0,o.applyXorOnBuffers)(e,t)}return(0,o.concatBuffers)(t,e)},t.generateLocalkeyAndSetupEncryptorService=c},65008:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.makeGetDerivateKeyWithCacheAndQueue=void 0;let a=r(92180),o=r(93308),n=r(47868),i=r(59587);t.makeGetDerivateKeyWithCacheAndQueue=function(){let e=new Map,t=new Map;function r(t){return e.get(t)}function s(r,a){let o=t.get(r);o&&o.forEach(({resolve:e})=>e(a)),t.set(r,[]),e.set(r,a)}function c(r,a,o,i){return new Promise((c,l)=>{let u=t.get(r)||[];u.push({resolve:c,reject:l}),t.set(r,u);let d=e.get(r);if(d){s(r,d);return}1===u.length&&({pbkdf2:n.deriveKeyWithPBKDF2,argon2d:n.deriveKeyWithArgon2d})[i.method](a,o,i).then(e=>{s(r,e)}).catch(a=>{!function(r,a){let o=t.get(r);o&&o.forEach(({reject:e})=>e(a)),t.set(r,[]),e.delete(r)}(r,a)})})}return(e,t,n)=>{var s,l,u,d,p;return s=r,l=c,(function(e,t,r){if((0,a.isNoDerivation)(r))return Promise.resolve((0,o.arrayBufferToText)(e));let n=(0,a.isPbkdf2Derivation)(r)?r.iterations:r.t_cost;return new Promise((a,s)=>{(0,i.computeHashSha256)((0,o.str2ab)(`${(0,o.arrayBufferToText)(e)}_${(0,o.arrayBufferToText)(t)}_${r.method}_${n}`)).then(e=>(0,o.arrayBufferToText)(e)).then(a,s)})})(u=e,d=t,p=n).then(e=>{let t=s(e);return t||l(e,u,d,p)})}}},86324:function(e,t,r){var a,o;Object.defineProperty(t,"__esModule",{value:!0}),t.verify=t.sign=t.decrypt=t.encrypt=t.generateRsaOaepKeyPair=t.DefaultAsymmetricOptions=t.HashAlgorithm=t.RSASA_PKCS1=t.RSA_OAEP=void 0;let n=r(93308);t.RSA_OAEP="RSA-OAEP",t.RSASA_PKCS1="RSASSA-PKCS1-v1_5";let i=new Uint8Array([1,0,1]);(o=a=t.HashAlgorithm||(t.HashAlgorithm={})).SHA_1="SHA-1",o.SHA_256="SHA-256",t.DefaultAsymmetricOptions={hashAlgorithm:a.SHA_256};let s=e=>({name:t.RSASA_PKCS1,hash:{name:e}}),c=e=>({name:t.RSA_OAEP,hash:{name:e}});async function l({privateKey:e,publicKey:t}){return{privateKey:await self.crypto.subtle.exportKey("pkcs8",e),publicKey:await self.crypto.subtle.exportKey("spki",t)}}let u=async(e=a.SHA_256)=>{let r=await self.crypto.subtle.generateKey({name:t.RSA_OAEP,modulusLength:2048,publicExponent:i,hash:{name:e}},!0,["encrypt","decrypt"]),{publicKey:o,privateKey:s}=await l({...r});return function({publicKey:e,privateKey:t}){return{publicKey:(0,n.spkitoPem)(e),privateKey:(0,n.pkcs8toPem)(t)}}({publicKey:o,privateKey:s})};async function d({publicKey:e,data:r,options:a=t.DefaultAsymmetricOptions}){let o=await self.crypto.subtle.importKey("spki",e,c(a.hashAlgorithm),!1,["encrypt"]);return await self.crypto.subtle.encrypt(c(a.hashAlgorithm),o,r)}async function p({privateKey:e,data:r,options:a=t.DefaultAsymmetricOptions}){let o=await self.crypto.subtle.importKey("pkcs8",e,c(a.hashAlgorithm),!1,["decrypt"]);return await self.crypto.subtle.decrypt(c(a.hashAlgorithm),o,r)}async function S({privateKey:e,data:r,options:a=t.DefaultAsymmetricOptions}){let o=await self.crypto.subtle.importKey("pkcs8",e,s(a.hashAlgorithm),!1,["sign"]);return await self.crypto.subtle.sign(s(a.hashAlgorithm),o,r)}async function g({publicKey:e,signature:r,data:a,options:o=t.DefaultAsymmetricOptions}){let n=await self.crypto.subtle.importKey("spki",e,s(o.hashAlgorithm),!1,["verify"]);return await self.crypto.subtle.verify(s(o.hashAlgorithm),n,r,a)}t.generateRsaOaepKeyPair=u,t.encrypt=d,t.decrypt=p,t.sign=S,t.verify=g},35580:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.deriveKeyWithArgon2d=void 0;let a=r(25826),o=r(22560),n=r(80896),i=r(85839),s=async(e,t,r)=>{let a={argon2d:i.ArgonType.Argon2d,argon2i:i.ArgonType.Argon2i},{hash:o}=await (0,i.hash)({pass:new Uint8Array(e),salt:new Uint8Array(t),time:r.t_cost,mem:r.m_cost,hashLen:32,parallelism:r.parallelism,type:a[r.method]});return o},c=async(e,t,r)=>{try{if(null===e||null===t||null===r)throw Error("deriveKeyWithArgon2d parameters are null");if(!a.env.isBrowserEnvironment()&&!a.env.isWorkerEnvironment())throw Error("Environment is not supported");return s(e,t,r)}catch(t){let e=Error(`[Derivation] - deriveKeyWithArgon2d: ${t}`);throw o.Debugger.error(e),(0,n.sendExceptionLog)({error:e}),t}};t.deriveKeyWithArgon2d=c},47868:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.deriveKeyWithArgon2d=t.deriveKeyWithPBKDF2=void 0;var a=r(41103);Object.defineProperty(t,"deriveKeyWithPBKDF2",{enumerable:!0,get:function(){return a.deriveKeyWithPBKDF2}});var o=r(35580);Object.defineProperty(t,"deriveKeyWithArgon2d",{enumerable:!0,get:function(){return o.deriveKeyWithArgon2d}})},41103:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.deriveKeyWithPBKDF2=void 0;let a=r(22640),o=r(2101),n=r(22560),i=r(73386),s=r(80896),c={sha1:"SHA-1",sha256:"SHA-256"},l=async(e,t,r)=>{if(null===e||null===t||null===r)throw Error("deriveKeyWithPBKDF2 parameters are null");let l=(0,i.getPlugins)().pbkdf2Plugin;if(l)return new Promise(a=>{a(l.deriveKey(new Uint8Array(e),new Uint8Array(t),r.iterations,r.hashMethod?c[r.hashMethod]:"SHA-256",32).buffer)});let u=(0,a.getWebCryptoSubtle)();try{let a=await u.importKey("raw",e,"PBKDF2",!1,["deriveKey"]);return await u.deriveKey({name:"PBKDF2",salt:t,iterations:r.iterations,hash:{name:r.hashMethod?c[r.hashMethod]:"SHA-256"}},a,{name:o.AES_CBC,length:256},!0,["encrypt","decrypt"]).then(e=>u.exportKey("raw",e))}catch(t){let e=Error(`[Derivation] - deriveKeyWithPBKDF2: ${t}`);throw n.Debugger.error(e),(0,s.sendExceptionLog)({error:e}),t}};t.deriveKeyWithPBKDF2=l},59587:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.hashAndSplitKey=t.computeHashMD5=t.computeHashSha512=t.computeHashSha256=t.computeHashSha1=void 0;let a=r(33582),o=r(93308);async function n({hashAlgorithm:e,data:t}){return await self.crypto.subtle.digest({name:e},t)}async function i(e){return await n({hashAlgorithm:"SHA-1",data:e})}async function s(e){return await n({hashAlgorithm:"SHA-256",data:e})}async function c(e){return await n({hashAlgorithm:"SHA-512",data:e})}async function l(e){let t=await c(e),r=t.byteLength,a=(0,o.getSubDataByteArray)(new Uint8Array(t),0,r/2),n=(0,o.getSubDataByteArray)(new Uint8Array(t),r/2,r);return{aes:a.buffer,hmac:n.buffer}}t.computeHashSha1=i,t.computeHashSha256=s,t.computeHashSha512=c,t.computeHashMD5=e=>{let t=a.create();return t.update(e),t.digest().toHex()},t.hashAndSplitKey=l},12971:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.verifyHashHmacSHA256=t.signHashHmacSHA256=t.decryptAES256=t.encryptAES256=t.importKeyAES256=t.generate64BytesKey=t.generateAESKey=void 0;let a=r(93308),o="AES-CBC",n={name:"HMAC",hash:{name:"SHA-256"}};async function i(){let e=await self.crypto.subtle.generateKey({name:o,length:256},!0,["encrypt","decrypt"]);return await self.crypto.subtle.exportKey("raw",e)}async function s(){let e=await i(),t=await i();return(0,a.concatBuffers)(e,t)}async function c(e){return await self.crypto.subtle.importKey("raw",e,o,!1,["encrypt","decrypt"])}async function l({key:e,iv:t,clearData:r}){let a=await c(e);return await self.crypto.subtle.encrypt({name:o,iv:t},a,r)}async function u({key:e,iv:t,encryptedData:r}){let a=await c(e);return await self.crypto.subtle.decrypt({name:o,iv:t},a,r)}async function d(e){return await self.crypto.subtle.importKey("raw",e,{name:"HMAC",hash:{name:"SHA-256"}},!0,["sign","verify"])}async function p({key:e,data:t}){let r=await d(e);return await self.crypto.subtle.sign(n,r,t)}async function S({key:e,signature:t,data:r}){let a=await d(e);return await self.crypto.subtle.verify(n,a,t,r)}t.generateAESKey=i,t.generate64BytesKey=s,t.importKeyAES256=c,t.encryptAES256=l,t.decryptAES256=u,t.signHashHmacSHA256=p,t.verifyHashHmacSHA256=S},2101:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.AES_KEY_SIZE=t.AES_CBC=void 0,t.AES_CBC="AES-CBC",t.AES_KEY_SIZE=32},67972:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.makeAsymmetricEncryption=t.makeSymmetricEncryption=t.makeCryptoService=void 0;let a=r(21936),o=r(34978),n=r(20648),i=r(56708),s=r(12971),c=r(68662),l=r(86324),u=r(93308),d=r(81649),p=r(59587),S=r(15916);async function g(e,t){let r=(0,u.base64ToBuffer)(t),a=(0,u.base64ToBuffer)(e),o=await (0,p.hashAndSplitKey)(a),n=(0,c.parseDashlaneKw5SecureData)(new Uint8Array(r)),i=(0,u.concatBuffers)(n.iv,n.secured),l=await (0,s.signHashHmacSHA256)({key:o.hmac,data:i});if((0,u.bufferToBase64)(l)!==(0,u.bufferToBase64)(n.hash))throw Error("Sharing - Data has been tampered with");return(0,s.decryptAES256)({key:o.aes,iv:n.iv,encryptedData:n.secured})}t.makeCryptoService=()=>({symmetricEncryption:(0,t.makeSymmetricEncryption)(),asymmetricEncryption:(0,t.makeAsymmetricEncryption)()}),t.makeSymmetricEncryption=()=>({generateNewAESKey:()=>(0,s.generateAESKey)().then(u.bufferToBase64),encryptAES256:async(e,t)=>{let r=(0,u.base64ToBuffer)(t),a=(0,u.base64ToBuffer)(e),o=await (0,p.hashAndSplitKey)(a),n=(0,c.generateIV)();return(0,s.encryptAES256)({key:o.aes,iv:n,clearData:r}).then(async e=>{let t=(0,u.concatBuffers)(n,e),a=await (0,s.signHashHmacSHA256)({key:o.hmac,data:t}),i=(0,c.makeKWC5DashlaneSecureData)(r,e,n,a),l=(0,c.convertKw5ToTransportableData)(i);return(0,u.bufferToBase64)(l)})},encryptSharingItem:async(e,r)=>{let o=(0,t.makeSymmetricEncryption)(),n=(0,i.getDashlaneXml)(r),s=(0,u.utf8ToBase64)(n),c=(0,u.base64ToBuffer)(s),l=a.deflate(new Uint8Array(c)).buffer,d=(0,u.addQtCompressHeader)(l),p=(0,u.bufferToBase64)(d);return o.encryptAES256(e,p)},decryptAES256:async(e,t)=>{let r=await g(e,t),a="";try{a=(0,u.base64BufferToUtf8)(r)}catch{a=(0,u.bufferToBase64)(r)}return a},decryptSharingItem:async(e,t)=>{let r=await g(e,t);try{let e=new Uint8Array(r),t=(0,u.uint8ArrayToText)(e);return JSON.parse(t)}catch{let e=(0,o.deflatedUtf8ToUtf16)(r),{__type__:t,...a}=await (0,i.parseDashlaneXml)(e),s={...a,kwType:a.kwType||t};if((0,n.isCredential)(s))return(0,S.fixCredentialTypesFromTransaction)(s);if((0,n.isNote)(s))return(0,S.fixNoteTypesFromTransaction)(s);if((0,n.isSecret)(s))return(0,S.fixSecretTypesFromTransaction)(s);return s}},signHmacSHA256:(e,t)=>{let r=(0,u.base64ToBuffer)(t),a=(0,u.base64ToBuffer)(e);return(0,s.signHashHmacSHA256)({key:a,data:r}).then(e=>(0,u.bufferToBase64)(e))},verifyHmacSHA256:(e,t,r)=>{let a=(0,u.base64ToBuffer)(r),o=(0,u.base64ToBuffer)(e),n=(0,u.base64ToBuffer)(t);return(0,s.verifyHashHmacSHA256)({key:o,signature:n,data:a})}}),t.makeAsymmetricEncryption=(e=l.DefaultAsymmetricOptions)=>({generateRsaKeyPair:()=>(0,l.generateRsaOaepKeyPair)(e.hashAlgorithm),encrypt:(t,r)=>{let a=(0,u.base64ToBuffer)(r),o=(0,u.pemToSpki)(t);return(0,l.encrypt)({publicKey:o,data:a,options:e}).then(u.bufferToBase64)},decrypt:(t,r)=>{let a=(0,u.base64ToBuffer)(r),o=(0,u.pemTopkcs8)(t);return(0,l.decrypt)({privateKey:o,data:a,options:e}).then(u.bufferToBase64)},sign:(t,r)=>{let a=(0,u.pemTopkcs8)(t),o=(0,u.base64ToBuffer)(r);return(0,l.sign)({privateKey:a,data:o,options:e}).then(u.bufferToBase64)},verify:(t,r,a)=>{let o=(0,u.pemToSpki)(t),n=(0,u.base64ToBuffer)(a),i=(0,u.base64ToBuffer)(r);return(0,l.verify)({publicKey:o,signature:i,data:n,options:e})},verifyJwk:(t,r,a)=>{let o=(0,d.jwkToSpki)(t),n=(0,u.base64ToBuffer)(r),i=(0,u.base64ToBuffer)(a);return(0,l.verify)({publicKey:o,signature:n,data:i,options:e})}})},70362:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.makeKeyBasedCrypto=t.makeKeyDataEncryptorService=t.DATA_TAMPERED_ERROR=void 0;let a=r(22560),o=r(80896),n=r(93308),i=r(59587),s=r(68662),c=r(12971);t.DATA_TAMPERED_ERROR="KeyBasedCrypto - Data has been tampered with",t.makeKeyDataEncryptorService=function(){let e=null;return{setInstance:r=>{e=(0,t.makeKeyBasedCrypto)(r)},getInstance:()=>{if(!e)throw Error("makeKeyDataEncryptorService: you must call setInstance(password,serverKey) before getting the instance");return e},close:()=>{e=null},hasBeenSet:()=>!!e}},t.makeKeyBasedCrypto=e=>{let r=e.raw&&(0,n.isBase64Encoded)(e.raw)?(0,n.base64ToBuffer)(e.raw):e.raw?(0,n.str2ab)(e.raw):e.buffer;return{isKey:()=>{throw Error("makeKeyBasedCrypto:isKey not implemented")},encrypt:e=>Promise.resolve().then(()=>(0,i.hashAndSplitKey)(r).then(t=>{let r=(0,s.generateIV)();return(0,c.encryptAES256)({key:t.aes,iv:r,clearData:e}).then(a=>{let o=(0,n.concatBuffers)(r,a);return(0,c.signHashHmacSHA256)({key:t.hmac,data:o}).then(t=>{let o=(0,s.makeKWC5DashlaneSecureData)(e,a,r,t),i=(0,s.convertKw5ToTransportableData)(o);return(0,n.bufferToBase64)(i)})})})).catch(e=>(!function(e,t){let r=Error(`${e}: ${t}`);throw(0,o.sendExceptionLog)({error:r}),a.Debugger.log(r),r}("[makeKeyBasedCrypto] - Error while encrypting data.",e),null)),decrypt:e=>Promise.resolve().then(()=>{let a=(0,n.base64ToBuffer)(e);return(0,i.hashAndSplitKey)(r).then(e=>{let r=(0,s.parseDashlaneKw5SecureData)(new Uint8Array(a)),o=(0,n.concatBuffers)(r.iv,r.secured);return(0,c.signHashHmacSHA256)({key:e.hmac,data:o}).then(a=>{if((0,n.bufferToBase64)(a)!==(0,n.bufferToBase64)(r.hash))throw Error(t.DATA_TAMPERED_ERROR);return(0,c.decryptAES256)({key:e.aes,iv:r.iv,encryptedData:r.secured})})})}),prepareCrypto:()=>Promise.resolve(),readCryptoPayload:e=>{let t=(0,n.base64ToBuffer)(e);return(0,s.parseDashlaneKw5SecureData)(new Uint8Array(t)).version}}}},50527:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.CRYPTO_NODERIVATION_HMAC64=void 0,t.CRYPTO_NODERIVATION_HMAC64="$1$noderivation$aes256$cbchmac64$16$"},34978:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.prepareCrypto=t.deflatedUtf8ToUtf16=t.utf16ToDeflatedUtf8=t.inflateUtf16=t.deflateUtf16=t.cipherDashlaneSecureData=t.decipherDashlaneSecureData=t.makeCryptoCenterService=t.PBKDF2_DEFAULT_PAYLOAD=t.ARGON2_DEFAULT_PAYLOAD=void 0;let a=r(21936),o=r(87951),n=r(93308),i=r(81649),s=r(92180);Object.defineProperty(t,"ARGON2_DEFAULT_PAYLOAD",{enumerable:!0,get:function(){return s.ARGON2_DEFAULT_PAYLOAD}}),Object.defineProperty(t,"PBKDF2_DEFAULT_PAYLOAD",{enumerable:!0,get:function(){return s.PBKDF2_DEFAULT_PAYLOAD}});let c=r(12971),l=r(59587),u=r(60355),d=r(73082),p=r(65008),S=r(22560),g=r(49789),m=r(33170);function y(e,t,r){let a=t+r;return(0,s.isCryptoConfigKWC3)(e.derivation)?(0,n.str2ab)(a):(0,n.utf8ToBase64Buffer)(a)}async function f(e,t,r){return"evpByteToKey"===e.cryptoConfig.ciphering.options.ivGeneration.method?A(e.cryptoConfig,t,r):(0,s.isDashlaneSecureDataFlexible)(e)||(0,s.isDashlaneSecureDataKWC5)(e)?e.iv:void 0}t.makeCryptoCenterService=function(e,r,a,o){let i=(0,p.makeGetDerivateKeyWithCacheAndQueue)(),c=e.raw,l=(0,n.str2ab)(r+c);return{isKey:(e,t)=>e+t===r+c,decrypt:(e,a={})=>(0,t.decipherDashlaneSecureData)(e,c,r,i,a),encrypt:(e,n={})=>{let{cryptoConfig:s}=n,l={...n,cryptoConfig:s||o};return(0,t.cipherDashlaneSecureData)(c,r,e,a,i,l)},prepareCrypto:()=>O(a,l,i,o),readCryptoPayload:e=>(0,s.readCryptoPayload)(e)}};let E=async(e,t,r,a,o={})=>{let i,l;let{forceKeyKWC5:u,forceSalt:d}=o,p=(0,n.base64ToBuffer)(e),S=(0,s.parseCipheredData)(new Uint8Array(p)),g=S.cryptoConfig;if(((0,s.isDashlaneSecureDataFlexible)(S)||(0,s.isDashlaneSecureDataKWC3)(S))&&(i=d||S.salt),(0,s.isDashlaneSecureDataKWC5)(S)&&u)l=u;else if((0,s.isNoDerivation)(g.derivation))l=(0,n.str2ab)(t);else{let e=y(g,r,t);l=await a(e,i,g.derivation)}let m=await f(S,i,l),{signatureKey:E,cipheringKey:A}=await h(S.cryptoConfig,l);return await _(S,E,m),await (0,c.decryptAES256)({key:A,iv:m,encryptedData:S.cipheredContent})};t.decipherDashlaneSecureData=E;let A=async(e,t,r)=>{let a={derivedKey:r,salt:t,keyLength:32,ivLength:e.ciphering.options.ivLength};return(0,i.evpBytesToKey)(a)},h=async(e,t)=>{if("skip"===e.signature.method)return{signatureKey:new ArrayBuffer(0),cipheringKey:t};let r="hmac64"===e.signature.method?t:await (0,l.computeHashSha512)(t);if(64!==r.byteLength)throw Error(`[cryptoCenter][prepareKeys] - cryptoKey's length must be 64B but is ${r.byteLength}B`);return{cipheringKey:(0,n.getSubDataByteArray)(new Uint8Array(r),0,r.byteLength/2).buffer,signatureKey:(0,n.getSubDataByteArray)(new Uint8Array(r),r.byteLength/2,r.byteLength).buffer}},_=(e,t,r)=>{if("skip"===e.cryptoConfig.signature.method)return Promise.resolve();let a=(0,n.concatBuffers)(r,e.cipheredContent);return(0,c.signHashHmacSHA256)({key:t,data:a}).then(t=>{if((0,n.bufferToBase64)(t)!==(0,n.bufferToBase64)(e.hash))throw Error("[decipherFlexibleMarker] Data are corrupted: HMAC signature cannot be verified")})},T=e=>{let t=(0,n.removeQtCompressionHeader)(e),r=new a.Inflate({chunkSize:16383});if(r.push(t,o.Z_FINISH),r.err)throw Error(`[Crypto] - postTreatData: unable to uncompress data - ${r.msg} (code ${r.err})`);return r.result},v=async(e,t,r,a,o,i={})=>{let l,u;let{cryptoConfig:d,forceSalt:p,forceIv:S}=i,g=d||(0,s.getCryptoConfig)(a);if((0,s.isNoDerivation)(g.derivation))l=(0,n.str2ab)(e);else{u=p||C(a,g.derivation);let r=y(g,t,e);l=await o(r,u,g.derivation)}let m=S||await I(g,u,l),{signatureKey:f,cipheringKey:E}=await h(g,l),A=await (0,c.encryptAES256)({key:E,iv:m,clearData:r}),_=await D(A,g,f,m);return P(u,m,_,A,g)};async function I(e,t,r){return"evpByteToKey"===e.ciphering.options.ivGeneration.method?A(e,t,r):(0,u.getRandomValues)(e.ciphering.options.ivLength)}t.cipherDashlaneSecureData=v,t.deflateUtf16=e=>a.deflate(e,{level:7}),t.inflateUtf16=e=>{let t=new Uint8Array(e);return a.inflate(t,{to:"string"})},t.utf16ToDeflatedUtf8=(e,t={})=>{let{skipDeflate:r,skipUtf8Encoding:a}=t,o=a?e:(0,n.utf8ChunkEncode)(e),i=(0,n.str2ab)(o);return r?i:(0,n.addQtCompressHeader)((0,n.deflateBuffer)(i))},t.deflatedUtf8ToUtf16=(e,t={})=>{let{skipUtf8Decoding:r,skipInflate:a,unescapeXml:o}=t,i=new Uint8Array(e),s=a?i:T(i),c=(0,n.uint8ArrayToText)(s);if(o&&(c=decodeURI(c)),!r)try{c=(0,n.utf8ChunkDecode)(c)}catch(e){S.Debugger.log("Cannot utf8.decode "+e)}return c};let D=(e,t,r,a)=>{if("skip"===t.signature.method)return Promise.resolve().then(()=>new ArrayBuffer(0));let o=(0,n.concatBuffers)(a,e);return(0,c.signHashHmacSHA256)({key:r,data:o})},P=(e,t,r,a,o)=>{if((0,s.isCryptoConfigKWC3)(o.derivation)){let t=(0,d.convertDashlaneSecureDataKWC3ToTransportableData)({encryptedData:a,salt:e,version:"KWC3"});return(0,n.bufferToBase64)(t)}let i=(0,s.convertDashlaneSecureDataFlexibleToTransportableData)({salt:e,iv:t,hash:r,cipheredContent:a,cryptoConfig:o});return(0,n.bufferToBase64)(i)};async function O(e,t,r,a){let o=a??(0,s.getCryptoConfig)(e),n=o.derivation;if("noderivation"===n.method)return;let i=C(e,o.derivation);await r(t,i,n)}function C(e,t){return(0,s.isCryptoConfigKWC3)(t)?function(e){if(e.getUserSession().cryptoKwc3FixedSalt)return(0,n.base64ToBuffer)(e.getUserSession().cryptoKwc3FixedSalt);let t=(0,u.getRandomValues)(32),r=(0,n.bufferToBase64)(t);return e.dispatch((0,g.updateCryptoKwc3FixedSalt)(r)),t}(e):function(e){if(e.getPersonalSettings().CryptoFixedSalt)return(0,n.base64ToBuffer)(e.getPersonalSettings().CryptoFixedSalt);let t=(0,u.getRandomValues)(16),r={CryptoFixedSalt:(0,n.bufferToBase64)(t)};return e.dispatch((0,m.editPersonalSettings)(r)),t}(e)}t.prepareCrypto=O},68662:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.makeKWC5DashlaneSecureData=t.generateIV=t.parseDashlaneKw5SecureData=t.convertKw5ToTransportableData=void 0;let a=r(60355),o=r(93308);t.convertKw5ToTransportableData=e=>{let t=new ArrayBuffer(32);if("KWC5"!==e.version)throw Error("Version must be KWC5");if(null===e.hash)throw Error("hmacSha2 from DashlaneSecureData is null");if(null===e.iv)throw Error("iv from DashlaneSecureData is null");e.iv&&(t=(0,o.concatBuffers)(e.iv,(0,a.getRandomValues)(16)));let r=(0,o.utf8ToBase64Buffer)(e.version);return(0,o.concatBuffers)(t,r,e.hash,e.secured)},t.parseDashlaneKw5SecureData=e=>{if(e.byteLength<36)throw Error(`Data length should be at least 36 long but was ${e.byteLength}`);let t=0,r=(0,o.getSubDataByteArray)(e,t,16).buffer;t+=32;let a=(0,o.getSubDataByteArray)(e,t,t+4),n=(0,o.uint8ArrayToText)(a);if("KWC5"!==n)throw Error("Version must be KWC5");t+=4;let i=(0,o.getSubDataByteArray)(e,t,t+32).buffer;return t+=32,{iv:r,version:n,hash:i,secured:(0,o.getSubDataByteArray)(e,t,e.byteLength).buffer}},t.generateIV=()=>(0,a.getRandomValues)(16),t.makeKWC5DashlaneSecureData=(e,t,r,a)=>({version:"KWC5",clearData:e,secured:t,iv:r,hash:a})},92180:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.PBKDF2_DEFAULT_PAYLOAD=t.ARGON2_DEFAULT_PAYLOAD=t.KWC3_DEFAULT_PAYLOAD=t.getUserCryptoPayload=t.getCryptoUserPayload=t.getCryptoConfig=t.makeFlexibleMarkerCryptoConfig=t.makeFlexibleMarkerPbkdf2Config=t.makeFlexibleMarkerArgon2dConfig=t.makeKWC3CryptoConfig=t.convertDashlaneSecureDataFlexibleToTransportableData=t.makeFlexibleMarkerPayloadBuffer=t.makeFlexibleMarkerPayloadString=t.makeFlexibleCryptoConfig=t.readCryptoPayload=t.parseCipheredData=t.getFlexibleSecureData=t.getLegacySecureData=t.getLegacyMarker=t.getLegacyCryptoConfig=t.parsePayload=t.getSignatureConfig=t.getCipheringConfiguration=t.getDerivationConfiguration=t.getPbkdf2DerivationConfig=t.getArgon2DerivationConfig=t.extractNextPayloadComponent=t.isDashlaneSecureDataFlexible=t.isDashlaneSecureDataKWC5=t.isDashlaneSecureDataKWC3=t.DashlaneCipherVersion=t.isSupportedAESMode=t.isSupportedDerivationMethod=t.isCryptoConfigKWC3=t.isNoDerivation=t.isArgon2Derivation=t.isPbkdf2Derivation=void 0;let a=r(25903),o=r(49204),n=r(93308);function i(e){return"pbkdf2"===e.method}function s(e){return"noderivation"===e.method||"skip"===e.method}function c(e){return!!["argon2d","pbkdf2","noderivation","skip"].find(t=>t===e)}function l(e){return!!["cbchmac","cbchmac64","cbc","gcm"].find(t=>t===e)}function u(){return{derivation:{method:"pbkdf2",saltLength:32,iterations:10204,hashMethod:"sha1"},signature:{method:"skip"},ciphering:{method:"aes256",options:{mode:"cbc",ivLength:16,ivGeneration:{method:"evpByteToKey"}}}}}function d(){return{method:"argon2d",saltLength:16,t_cost:3,m_cost:32768,parallelism:2}}function p(){return{method:"pbkdf2",saltLength:16,iterations:2e5,hashMethod:"sha256"}}function S(e){return{derivation:"argon2d"===e?d():p(),signature:{method:"hmac"},ciphering:{method:"aes256",options:{mode:"cbchmac",ivLength:16,ivGeneration:{method:"data"}}}}}function g(e){return e.getPersonalSettings().CryptoUserPayload||t.ARGON2_DEFAULT_PAYLOAD}t.isPbkdf2Derivation=i,t.isArgon2Derivation=function(e){return"argon2d"===e.method},t.isNoDerivation=s,t.isCryptoConfigKWC3=function(e){return i(e)&&10204===e.iterations&&"sha1"===e.hashMethod},t.isSupportedDerivationMethod=c,t.isSupportedAESMode=l,t.DashlaneCipherVersion=(0,o.Enum)("KWC3","KWC5"),t.isDashlaneSecureDataKWC3=e=>e.marker===t.DashlaneCipherVersion.KWC3,t.isDashlaneSecureDataKWC5=e=>e.marker===t.DashlaneCipherVersion.KWC5,t.isDashlaneSecureDataFlexible=e=>void 0!==e.iv,t.extractNextPayloadComponent=e=>{if(null===e)return"";let t=e;return t.startsWith("$")&&(t=t.substring(1,e.length)),t.substring(0,t.indexOf("$"))},t.getArgon2DerivationConfig=e=>{let r=0,a={};if(a.saltLength=Number((0,t.extractNextPayloadComponent)(e.substring(r,e.length))),r+=a.saltLength.toString().length+1,a.t_cost=Number((0,t.extractNextPayloadComponent)(e.substring(r,e.length))),r+=a.t_cost.toString().length+1,a.m_cost=Number((0,t.extractNextPayloadComponent)(e.substring(r,e.length))),r+=a.m_cost.toString().length+1,a.parallelism=Number((0,t.extractNextPayloadComponent)(e.substring(r,e.length))),r+=a.parallelism.toString().length+1,isNaN(a.saltLength)||0===a.saltLength||isNaN(a.t_cost)||0===a.t_cost||isNaN(a.m_cost)||0===a.m_cost||isNaN(a.parallelism)||0===a.parallelism)throw Error("Wrong parameters in payload");return a},t.getPbkdf2DerivationConfig=e=>{let r=0,a={};if(a.saltLength=Number((0,t.extractNextPayloadComponent)(e.substring(r,e.length))),r+=a.saltLength.toString().length+1,a.iterations=Number((0,t.extractNextPayloadComponent)(e.substring(r,e.length))),r+=a.iterations.toString().length+1,a.hashMethod=String((0,t.extractNextPayloadComponent)(e.substring(r,e.length))),r+=a.hashMethod.length+1,isNaN(a.saltLength)||isNaN(a.iterations))throw Error("Wrong parameters in payload");return a},t.getDerivationConfiguration=e=>{let r=0,a={},o=String((0,t.extractNextPayloadComponent)(e.substring(r,e.length)));if(!c(o))throw Error("Derivation method not supported");if(a.method=o,"noderivation"===o||"skip"===o)return a;if(r+=a.method.length+1,"argon2d"===a.method){let o=(0,t.getArgon2DerivationConfig)(e.substring(r,e.length));a={...a,...o}}if("pbkdf2"===a.method){let o=(0,t.getPbkdf2DerivationConfig)(e.substring(r,e.length));a={...a,...o}}return a},t.getCipheringConfiguration=e=>{let r={options:{}},a=0;if(r.method=String((0,t.extractNextPayloadComponent)(e.substring(a,e.length))),a+=r.method.length+1,"aes256"===r.method){let o=String((0,t.extractNextPayloadComponent)(e.substring(a,e.length)));if(!l(o))throw Error("[getCipheringConfiguration]: unsupported AES mode");if(r.options.mode=o,a+=r.options.mode.length+1,r.options.ivLength=Number((0,t.extractNextPayloadComponent)(e.substring(a,e.length))),isNaN(r.options.ivLength)||0===r.options.ivLength)throw Error("[getCipheringConfiguration]: Wrong parameters in payload")}else throw Error(`[getCipheringConfiguration]: Wrong ciphering method expected "aes256" but get ${r.method}`);return r},t.getSignatureConfig=e=>{let t={method:"skip"};return"cbchmac"===e&&(t.method="hmac"),"cbchmac64"===e&&(t.method="hmac64"),t},t.parsePayload=e=>{if(null===e)throw Error("parsePayload: No payload to parse");if(e.startsWith("$")){let r=0,o=Number((0,t.extractNextPayloadComponent)(e.substring(r,e.length)));if(1!==o)throw Error(`parsePayload: version should be 1 but is ${o}`);r+=o.toString().length+1;let n=(0,t.getDerivationConfiguration)(e.substring(r,e.length)),i=(0,a.reduce)((e,t)=>e+(`${t}`.length+1));r=i(r,(0,a.values)(n));let s=(0,t.getCipheringConfiguration)(e.substring(r,e.length));return r+=String(s.method).length+1,r=i(r,(0,a.values)(s.options)),{cryptoConfig:{derivation:n,signature:(0,t.getSignatureConfig)(s.options.mode),ciphering:{method:s.method,options:{...s.options,ivGeneration:{method:"data"}}}},payloadLength:r+1}}throw Error("parsePayload: Unable to parse payload")},t.getLegacyCryptoConfig=e=>{if("KWC3"===e)return{derivation:{method:"pbkdf2",saltLength:32,iterations:10204,hashMethod:"sha1"},signature:{method:"skip"},ciphering:{method:"aes256",options:{mode:"cbc",ivLength:16,ivGeneration:{method:"evpByteToKey"}}}};if("KWC5"===e)return{derivation:{method:"skip"},signature:{method:"hmac"},ciphering:{method:"aes256",options:{mode:"cbchmac",ivLength:16,ivGeneration:{method:"data"}}}};throw Error("Wrong marker")},t.getLegacyMarker=e=>{let r=(0,n.getSubDataByteArray)(e,32,36),a=(0,n.uint8ArrayToText)(r);return a===t.DashlaneCipherVersion.KWC3||a===t.DashlaneCipherVersion.KWC5?a:null},t.getLegacySecureData=(e,r)=>{if(e===t.DashlaneCipherVersion.KWC3)return{marker:e,salt:(0,n.getSubDataByteArray)(r,0,32).buffer,cipheredContent:(0,n.getSubDataByteArray)(r,36,r.byteLength).buffer,cryptoConfig:(0,t.getLegacyCryptoConfig)(e)};if(e===t.DashlaneCipherVersion.KWC5)return{marker:e,iv:(0,n.getSubDataByteArray)(r,0,16).buffer,hash:(0,n.getSubDataByteArray)(r,36,68).buffer,cipheredContent:(0,n.getSubDataByteArray)(r,68,r.byteLength).buffer,cryptoConfig:(0,t.getLegacyCryptoConfig)(e)};throw Error("Wrong marker")},t.getFlexibleSecureData=e=>{let r=(0,n.uint8ArrayToText)(e),{cryptoConfig:a,payloadLength:o}=(0,t.parsePayload)(r),i=o,c=s(a.derivation)?0:a.derivation.saltLength,l=a.ciphering.options.ivLength,u=(0,n.getSubDataByteArray)(e,i,i+c).buffer;i+=c;let d=(0,n.getSubDataByteArray)(e,i,i+l).buffer;i+=l;let p=(0,n.getSubDataByteArray)(e,i,i+32).buffer;return i+=32,{salt:u,iv:d,hash:p,cipheredContent:(0,n.getSubDataByteArray)(e,i,e.length).buffer,cryptoConfig:a}},t.parseCipheredData=e=>{let r=(0,t.getLegacyMarker)(e);if(r)return(0,t.getLegacySecureData)(r,e);if("$"===(0,n.uint8ArrayToText)((0,n.getSubDataByteArray)(e,0,1)))return(0,t.getFlexibleSecureData)(e);throw Error("Unable to parse ciphered data")},t.readCryptoPayload=e=>{let r=new Uint8Array((0,n.base64ToBuffer)(e)),a=(0,t.getLegacyMarker)(r);if(a)return a;let o=(0,n.uint8ArrayToText)(r),{payloadLength:i}=(0,t.parsePayload)(o);return o.substr(0,i)},t.makeFlexibleCryptoConfig=e=>e.cryptoConfig,t.makeFlexibleMarkerPayloadString=e=>{let t="$1",r=(0,a.reduce)((e,t)=>"string"==typeof t||"number"==typeof t?e+`$${String(t)}`:e);return t=r(t,(0,a.values)(e.derivation)),t=r(t,[e.ciphering.method]),r(t,(0,a.values)((0,a.omit)(["ivGeneration"],e.ciphering.options)))+"$"},t.makeFlexibleMarkerPayloadBuffer=e=>{let r=(0,t.makeFlexibleMarkerPayloadString)(e);return(0,n.str2ab)(r)},t.convertDashlaneSecureDataFlexibleToTransportableData=e=>{let{cipheredContent:r,cryptoConfig:a,hash:o,iv:i,salt:c}=e,l=(0,t.makeFlexibleMarkerPayloadBuffer)(a);return s(a.derivation)?(0,n.concatBuffers)(l,i,o,r):(0,n.concatBuffers)(l,c,i,o,r)},t.makeKWC3CryptoConfig=u,t.makeFlexibleMarkerArgon2dConfig=d,t.makeFlexibleMarkerPbkdf2Config=p,t.makeFlexibleMarkerCryptoConfig=S,t.getCryptoConfig=function(e){let r=g(e);return(0,a.isNil)(r)?S("argon2d"):"KWC3"===r?u():(0,t.parsePayload)(r).cryptoConfig},t.getCryptoUserPayload=g,t.getUserCryptoPayload=e=>"pbkdf2_kwc3"===e?{CryptoUserPayload:t.KWC3_DEFAULT_PAYLOAD}:{CryptoUserPayload:(0,a.compose)(n.base64BufferToUtf8,t.makeFlexibleMarkerPayloadBuffer,S)("argon2"===e?"argon2d":"pbkdf2")},t.KWC3_DEFAULT_PAYLOAD="KWC3",t.ARGON2_DEFAULT_PAYLOAD="$1$argon2d$16$3$32768$2$aes256$cbchmac$16$",t.PBKDF2_DEFAULT_PAYLOAD="$1$pbkdf2$16$200000$sha256$aes256$cbchmac$16$"},14654:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.makeCanonicalRequest=void 0;let a=r(25903);t.makeCanonicalRequest=e=>{let t=e=>e.toLowerCase(),r=o(e.headers),n=e.headersToSign?a.pick(a.map(t,a.values(e.headersToSign)),a.mapObjIndexed(t,r)):r,i=s(e.uri),c=l(e.query),p=u(n),S=d(n);return{canonicalRequest:[e.method,i,c,p,S,e.hashedPayload].join("\n"),signedHeaders:S}};let o=e=>a.pipe(a.toPairs,a.map(([e,t])=>[e.toLowerCase(),t]),p)(e),n=e=>e.split("/").map(e=>i(e)).join("/"),i=e=>e.replace(/[^A-Za-z0-9_.~\-]/g,e=>"%"+e.charCodeAt(0).toString(16).toUpperCase()),s=e=>n(e),c=(e,t)=>{let r=i(e),o=Array.isArray(t)?t:[t];return a.pipe(a.map(e=>i(e)),a.map(e=>[r,e]),a.sortBy(a.reduce(a.concat,"")))(o)},l=e=>a.pipe(e=>a.toPairs(e),a.sortBy(e=>e[0]),a.map(([e,t])=>c(e,t)),a.unnest,a.map(([e,t])=>`${e}=${t}`),a.join("&"))(e),u=e=>{let t=(e,t)=>e.toLowerCase()+":"+t.trim().replace(/\s+/g," ")+"\n";return a.pipe(e=>a.toPairs(e),a.sortBy(e=>e[0].toLowerCase()),a.map(([e,r])=>t(e,r)),a.join(""))(e)},d=e=>a.pipe(a.keys,a.map(e=>e.toLowerCase()),a.sortBy(a.identity),a.join(";"))(e),p=e=>{let t={};for(let r=0;r<e.length;++r)t[e[r][0]]=e[r][1];return t}},83061:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.getApiCredentials=void 0;let a=r(29509),o=r(91783),n=r(31740);t.getApiCredentials=function(e,t){if(t.authenticationType===n.ApiAuthType.None)return{type:t.authenticationType};let r={appKeys:(0,a.appKeysSelector)(e)};switch(t.authenticationType){case n.ApiAuthType.App:return{type:n.ApiAuthType.App,...r};case n.ApiAuthType.UserDevice:return{type:n.ApiAuthType.UserDevice,...r,login:t.login,deviceKeys:(0,a.deviceKeysSelector)(e)};case n.ApiAuthType.Session:return{type:n.ApiAuthType.Session,...r,login:t.login,sessionKeys:(0,a.sessionKeysSelector)(e),deviceId:(0,a.getDeviceAccessKeySelector)(e,t.login)};case n.ApiAuthType.TeamDevice:return{type:n.ApiAuthType.TeamDevice,...r,teamUuid:t.teamUuid,deviceKeys:(0,a.deviceKeysSelector)(e)};default:(0,o.assertUnreachable)(t.authenticationType)}}},64206:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.prepareApiEndpoint=void 0;let a=r(31740),o=r(17541);t.prepareApiEndpoint=function(e){let{authenticationType:t,endpoint:r,group:n,method:i,version:s,accept:c,responseType:l}=e,u=`/${a.ApiVersion[s]}/${n}/${r}`;return(0,o.getMakeApiRequest)(u,t,i,l??"json",c)}},34166:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.makeSafeDeviceName=t.makeSafeLanguage=t.makeSafeCountry=void 0,t.makeSafeCountry=function(e){return!e||e.length<2||e.length>5?"ZZ":e},t.makeSafeLanguage=function(e){return!e||e.length<2||e.length>5?"und":e},t.makeSafeDeviceName=function(e){return e||"Device"}},88549:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.getCode=void 0;let a=r(31740);t.getCode=(e,t)=>{let r=t.indexOf(e);return r<0?a.UnknownError:t[r]}},87233:function(e,t,r){var a=this&&this.__createBinding||(Object.create?function(e,t,r,a){void 0===a&&(a=r);var o=Object.getOwnPropertyDescriptor(t,r);(!o||("get"in o?!t.__esModule:o.writable||o.configurable))&&(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,a,o)}:function(e,t,r,a){void 0===a&&(a=r),e[a]=t[r]}),o=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||a(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),o(r(34166),t),o(r(5283),t),o(r(88549),t)},5283:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.isExtraDeviceTokenValid=t.isEmailTokenValid=void 0,t.isEmailTokenValid=function(e){return/^\d{6}$/.test(e)},t.isExtraDeviceTokenValid=function(e){return/^[A-Za-z0-9+/]{64}$/.test(e)}},28323:function(e,t,r){var a=this&&this.__createBinding||(Object.create?function(e,t,r,a){void 0===a&&(a=r);var o=Object.getOwnPropertyDescriptor(t,r);(!o||("get"in o?!t.__esModule:o.writable||o.configurable))&&(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,a,o)}:function(e,t,r,a){void 0===a&&(a=r),e[a]=t[r]}),o=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||a(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),t.UnknownError=t.isApiErrorOfType=t.isApiError=void 0;var n=r(31740);Object.defineProperty(t,"isApiError",{enumerable:!0,get:function(){return n.isApiError}}),Object.defineProperty(t,"isApiErrorOfType",{enumerable:!0,get:function(){return n.isApiErrorOfType}}),Object.defineProperty(t,"UnknownError",{enumerable:!0,get:function(){return n.UnknownError}}),o(r(67070),t),o(r(87233),t)},17541:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.getApiClientAgentHeader=t.validateStatus=t.makeApiResponse=t.getMethodParams=t.getAuthParams=t.getMakeApiRequest=void 0;let a=r(67179),o=r(91783),n=r(65559),i=r(74907),s=r(29509),c=r(31740),l=r(67506),u=r(83061),d=r(3314),p=r(86454);function S(e,{login:t,teamUuid:r}){switch(e){case c.ApiAuthType.App:case c.ApiAuthType.None:return{authenticationType:e};case c.ApiAuthType.UserDevice:case c.ApiAuthType.Session:return{authenticationType:e,login:t};case c.ApiAuthType.TeamDevice:return{authenticationType:e,teamUuid:r};default:(0,o.assertUnreachable)(e)}}function g(e,t){switch(e){case c.ApiRequestMethod.GET:return{method:e};case c.ApiRequestMethod.POST:return{method:e,payload:t};default:(0,o.assertUnreachable)(e)}}function m(e){var t;let r=function({errors:e}){return Array.isArray(e)&&e.length>0?e[0]:null}(e);return r||{code:"success",data:(t=e).data?null:t,...t.data}}async function y(e,t,r,n,i){if(r.type===c.ApiAuthType.None)return{};let u=(0,s.dashlaneServerDeltaTimestampSelector)(e.getState())||0,d=Math.round((0,a.getUnixTimestamp)()-u),p=function(e){switch(e.method){case c.ApiRequestMethod.GET:return"";case c.ApiRequestMethod.POST:return JSON.stringify(e.payload);default:(0,o.assertUnreachable)(e)}}(i),{method:S}=i;return{Authorization:await (0,l.signRequest)({request:{pathname:t,method:S,rawBody:p,headers:n},timestamp:d,credentials:r})}}function f(e){return JSON.stringify({platform:e.platformName||"unknown",version:e.appVersion||"unknown",osversion:e.osVersion||"unknown",language:e.lang||"unknown"})}t.getMakeApiRequest=function(e,r,a,s,l){return async(E,A)=>{let h={login:"",teamUuid:"",payload:{},...A||{}},_=g(a,h.payload),T=S(r,{login:h.login,teamUuid:h.teamUuid}),v=(0,u.getApiCredentials)(E.getState(),T),I={Accept:l??"application/json","Content-Type":"application/json; charset=UTF-8","dashlane-client-agent":f((0,n.getPlatformInfo)())},D={...I,Host:new URL(d.config.DASHLANE_API_HOST_WITH_SCHEME).hostname},P=await y(E,e,v,D,_),O={...I,...P,...(0,p.getCloudflareHeaders)()},C=`${d.config.DASHLANE_API_HOST_WITH_SCHEME}${e}`,{data:b}=await function(e,r,a,n){let s={headers:a,validateStatus:t.validateStatus,responseType:n};switch(e.method){case c.ApiRequestMethod.GET:return(0,i.get)(r,s);case c.ApiRequestMethod.POST:return(0,i.post)(r,e.payload,s);default:(0,o.assertUnreachable)(e)}}(_,C,O,s);return m(b)}},t.getAuthParams=S,t.getMethodParams=g,t.makeApiResponse=m,t.validateStatus=e=>e>=100&&e<=500,t.getApiClientAgentHeader=f},1413:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.getAndEvaluateForUser=void 0;let a=r(31740),o=r(64206),n={group:a.ApiEndpointGroups.abtesting,version:a.ApiVersion.v1,method:a.ApiRequestMethod.POST,authenticationType:a.ApiAuthType.UserDevice,endpoint:"GetAndEvaluateForUser"},i=(0,o.prepareApiEndpoint)(n);async function s(e,t,r){return i(e,{login:t,payload:r})}t.getAndEvaluateForUser=s},86969:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.deactivateAccountRecoveryKey=void 0;let a=r(31740),o=r(64206),n={group:a.ApiEndpointGroups.accountRecovery,version:a.ApiVersion.v1,method:a.ApiRequestMethod.POST,authenticationType:a.ApiAuthType.UserDevice,endpoint:"Deactivate"},i=(0,o.prepareApiEndpoint)(n);t.deactivateAccountRecoveryKey=function(e,t,r){return i(e,{login:t,payload:r})}},96332:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.accountInfo=void 0;let a=r(64206),o=r(31740),n={group:o.ApiEndpointGroups.account,version:o.ApiVersion.v1,method:o.ApiRequestMethod.POST,authenticationType:o.ApiAuthType.UserDevice,endpoint:"AccountInfo"},i=(0,a.prepareApiEndpoint)(n);async function s(e,t){return i(e,{login:t,payload:{}})}t.accountInfo=s},72901:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.createUserWithSSO=void 0;let a=r(64206),o=r(31740),n={authenticationType:o.ApiAuthType.App,endpoint:"CreateUserWithSSO",group:o.ApiEndpointGroups.account,method:o.ApiRequestMethod.POST,version:o.ApiVersion.v1},i=(0,a.prepareApiEndpoint)(n);async function s(e,t){return i(e,{payload:t})}t.createUserWithSSO=s},11481:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.createUser=void 0;let a=r(64206),o=r(31740),n={group:o.ApiEndpointGroups.account,version:o.ApiVersion.v1,method:o.ApiRequestMethod.POST,authenticationType:o.ApiAuthType.App,endpoint:"CreateUser"},i=(0,a.prepareApiEndpoint)(n);async function s(e,t){return i(e,{payload:t})}t.createUser=s},35467:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.getPremiumStatus=void 0;let a=r(64206),o=r(31740),n={group:o.ApiEndpointGroups.premium,version:o.ApiVersion.v1,method:o.ApiRequestMethod.POST,authenticationType:o.ApiAuthType.UserDevice,endpoint:"GetPremiumStatus"},i=(0,a.prepareApiEndpoint)(n);t.getPremiumStatus=function(e,t){return i(e,{login:t,payload:{}})}},2345:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.getSubscriptionInformation=void 0;let a=r(64206),o=r(31740),n={group:o.ApiEndpointGroups.premium,version:o.ApiVersion.v1,method:o.ApiRequestMethod.POST,authenticationType:o.ApiAuthType.UserDevice,endpoint:"GetSubscriptionInfo"},i=(0,a.prepareApiEndpoint)(n);t.getSubscriptionInformation=function(e,t){return i(e,{login:t,payload:{}})}},84984:function(e,t,r){var a;Object.defineProperty(t,"__esModule",{value:!0}),t.requestAccountCreation=t.AccountExistsStatus=void 0;let o=r(64206),n=r(31740);(a=t.AccountExistsStatus||(t.AccountExistsStatus={})).AccountExists="yes",a.AccountDoesntExist="no",a.AccountDoesntExistInvalid="no_invalid",a.AccountDoesntExistUnlikely="no_unlikely";let i={group:n.ApiEndpointGroups.account,version:n.ApiVersion.v1,method:n.ApiRequestMethod.POST,authenticationType:n.ApiAuthType.App,endpoint:"RequestAccountCreation"},s=(0,o.prepareApiEndpoint)(i);t.requestAccountCreation=function(e,t){return s(e,{payload:t})}},30086:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.updateContactInfo=void 0;let a=r(64206),o=r(31740),n={group:o.ApiEndpointGroups.account,version:o.ApiVersion.v1,method:o.ApiRequestMethod.POST,authenticationType:o.ApiAuthType.UserDevice,endpoint:"UpdateContactInfo"},i=(0,a.prepareApiEndpoint)(n);async function s(e,t,r){return i(e,{login:t,payload:r})}t.updateContactInfo=s},28733:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.ExistingSecureRemembermeSession=t.MismatchedSessionSecurity=t.SessionNotFound=t.AuthenticatorNotAvailableOnDevice=t.AuthenticationTypeNotSupported=t.AuthenticatorNotRegistered=t.AssertionRejected=t.AttestationRejected=t.ChallengeVerificationFailed=t.ChallengeExpired=t.ChallengeNotFound=t.InvalidAuthentication=t.TwofaEmailTokenNotEnabled=t.UserHasNoActiveAuthenticator=t.FailedToContactAuthenticatorDevice=t.VerificationMethodDisabled=t.VerificationFailed=t.TeamGenericError=t.SSOBlocked=t.UserNotFound=t.U2fBadRequest=t.InvalidOTPBlocked=t.InvalidOTPAlreadyUsed=t.DeviceNotFound=t.DeviceDeactivated=void 0,t.DeviceDeactivated="device_deactivated",t.DeviceNotFound="device_not_found",t.InvalidOTPAlreadyUsed="invalid_otp_already_used",t.InvalidOTPBlocked="invalid_otp_blocked",t.U2fBadRequest="u2f_bad_request",t.UserNotFound="user_not_found",t.SSOBlocked="SSO_BLOCKED",t.TeamGenericError="TEAM_GENERIC_ERROR",t.VerificationFailed="verification_failed",t.VerificationMethodDisabled="verification_method_disabled",t.FailedToContactAuthenticatorDevice="FAILED_TO_CONTACT_AUTHENTICATOR_DEVICE",t.UserHasNoActiveAuthenticator="USER_HAS_NO_ACTIVE_AUTHENTICATOR",t.TwofaEmailTokenNotEnabled="TWOFA_EMAIL_TOKEN_NOT_ENABLED",t.InvalidAuthentication="invalid_authentication",t.ChallengeNotFound="CHALLENGE_NOT_FOUND",t.ChallengeExpired="CHALLENGE_EXPIRED",t.ChallengeVerificationFailed="CHALLENGE_VERIFICATION_FAILED",t.AttestationRejected="ATTESTATION_REJECTED",t.AssertionRejected="ASSERTION_REJECTED",t.AuthenticatorNotRegistered="AUTHENTICATOR_NOT_REGISTERED",t.AuthenticationTypeNotSupported="AUTHENTICATION_TYPE_NOT_SUPPORTED",t.AuthenticatorNotAvailableOnDevice="AUTHENTICATOR_NOT_AVAILABLE_ON_DEVICE",t.SessionNotFound="SESSION_NOT_FOUND",t.MismatchedSessionSecurity="MISMATCHED_SESSION_SECURITY",t.ExistingSecureRemembermeSession="EXISTING_SECURE_REMEMBERME_SESSION"},5883:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.completeDeviceRegistrationWithAuthTicket=void 0;let a=r(31740),o=r(64206),n={group:a.ApiEndpointGroups.authentication,version:a.ApiVersion.v1,method:a.ApiRequestMethod.POST,authenticationType:a.ApiAuthType.App,endpoint:"CompleteDeviceRegistrationWithAuthTicket"},i=(0,o.prepareApiEndpoint)(n);async function s(e,t){return i(e,{payload:t})}t.completeDeviceRegistrationWithAuthTicket=s},39206:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.completeExtraDeviceRegistrationWithToken=void 0;let a=r(31740),o=r(64206),n={group:a.ApiEndpointGroups.authentication,version:a.ApiVersion.v1,method:a.ApiRequestMethod.POST,authenticationType:a.ApiAuthType.App,endpoint:"CompleteExtraDeviceRegistrationWithToken"},i=(0,o.prepareApiEndpoint)(n);async function s(e,t){return i(e,{payload:t})}t.completeExtraDeviceRegistrationWithToken=s},75668:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.completeLoginWithAuthTicket=void 0;let a=r(31740),o=r(64206),n={authenticationType:a.ApiAuthType.App,endpoint:"CompleteLoginWithAuthTicket",group:a.ApiEndpointGroups.authentication,method:a.ApiRequestMethod.POST,version:a.ApiVersion.v1},i=(0,o.prepareApiEndpoint)(n);async function s(e,t){return i(e,{payload:t})}t.completeLoginWithAuthTicket=s},45435:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.completeRememberMeOpenSession=void 0;let a=r(31740),o=r(64206),n={group:a.ApiEndpointGroups.authentication,version:a.ApiVersion.v1,method:a.ApiRequestMethod.POST,authenticationType:a.ApiAuthType.Session,endpoint:"CompleteRememberMeOpenSession"},i=(0,o.prepareApiEndpoint)(n);async function s(e,t,r){return i(e,{login:t,payload:r})}t.completeRememberMeOpenSession=s},23559:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.completeRememberMeRegistration=void 0;let a=r(31740),o=r(64206),n={group:a.ApiEndpointGroups.authentication,version:a.ApiVersion.v1,method:a.ApiRequestMethod.POST,authenticationType:a.ApiAuthType.UserDevice,endpoint:"CompleteRememberMeRegistration"},i=(0,o.prepareApiEndpoint)(n);async function s(e,t,r){return i(e,{login:t,payload:r})}t.completeRememberMeRegistration=s},10028:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.completeTotpActivation=void 0;let a=r(31740),o=r(64206),n={authenticationType:a.ApiAuthType.UserDevice,endpoint:"CompleteTOTPActivation",group:a.ApiEndpointGroups.authentication,method:a.ApiRequestMethod.POST,version:a.ApiVersion.v1},i=(0,o.prepareApiEndpoint)(n);async function s(e,t,r){return i(e,{login:t,payload:r})}t.completeTotpActivation=s},61552:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.completeWebAuthnAuthenticatorRegistration=void 0;let a=r(31740),o=r(64206),n={group:a.ApiEndpointGroups.authentication,version:a.ApiVersion.v1,method:a.ApiRequestMethod.POST,authenticationType:a.ApiAuthType.UserDevice,endpoint:"CompleteWebAuthnAuthenticatorRegistration"},i=(0,o.prepareApiEndpoint)(n);async function s(e,t,r){return i(e,{login:t,payload:r})}t.completeWebAuthnAuthenticatorRegistration=s},19609:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.deactivateRememberMe=void 0;let a=r(31740),o=r(64206),n={group:a.ApiEndpointGroups.authentication,version:a.ApiVersion.v1,method:a.ApiRequestMethod.POST,authenticationType:a.ApiAuthType.UserDevice,endpoint:"DeactivateRememberMe"},i=(0,o.prepareApiEndpoint)(n);async function s(e,t,r){return i(e,{login:t,payload:r})}t.deactivateRememberMe=s},99511:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.deactivateTotpVerification=void 0;let a=r(31740),o=r(64206),n={authenticationType:a.ApiAuthType.UserDevice,endpoint:"DeactivateTOTP",group:a.ApiEndpointGroups.authentication,method:a.ApiRequestMethod.POST,version:a.ApiVersion.v1},i=(0,o.prepareApiEndpoint)(n);async function s(e,t,r){return i(e,{login:t,payload:r})}t.deactivateTotpVerification=s},81716:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.deactivateWebAuthnAuthenticator=void 0;let a=r(31740),o=r(64206),n={group:a.ApiEndpointGroups.authentication,version:a.ApiVersion.v1,method:a.ApiRequestMethod.POST,authenticationType:a.ApiAuthType.UserDevice,endpoint:"DeactivateWebAuthnAuthenticator"},i=(0,o.prepareApiEndpoint)(n);async function s(e,t,r){return i(e,{login:t,payload:r})}t.deactivateWebAuthnAuthenticator=s},50057:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.getAuthenticationMethodsForDevice=void 0;let a=r(31740),o=r(64206),n={group:a.ApiEndpointGroups.authentication,version:a.ApiVersion.v1,method:a.ApiRequestMethod.POST,authenticationType:a.ApiAuthType.App,endpoint:"GetAuthenticationMethodsForDevice"},i=(0,o.prepareApiEndpoint)(n);async function s(e,t){return i(e,{payload:t})}t.getAuthenticationMethodsForDevice=s},55923:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.getAuthenticationMethodsForLogin=void 0;let a=r(31740),o=r(64206),n={group:a.ApiEndpointGroups.authentication,version:a.ApiVersion.v1,method:a.ApiRequestMethod.POST,authenticationType:a.ApiAuthType.App,endpoint:"GetAuthenticationMethodsForLogin"},i=(0,o.prepareApiEndpoint)(n);async function s(e,t){return i(e,{payload:t})}t.getAuthenticationMethodsForLogin=s},87279:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.getAuthenticationTokenForCardUpdate=void 0;let a=r(64206),o=r(31740),n={group:o.ApiEndpointGroups.authentication,version:o.ApiVersion.v1,method:o.ApiRequestMethod.POST,authenticationType:o.ApiAuthType.UserDevice,endpoint:"CreateTokenExtAuth"},i=(0,a.prepareApiEndpoint)(n);t.getAuthenticationTokenForCardUpdate=function(e,t){return i(e,{login:t,payload:{}})}},58207:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.getAvailableWebAuthnAuthenticators=void 0;let a=r(31740),o=r(64206),n={group:a.ApiEndpointGroups.authentication,version:a.ApiVersion.v1,method:a.ApiRequestMethod.POST,authenticationType:a.ApiAuthType.Session,endpoint:"GetAvailableWebAuthnAuthenticators"},i=(0,o.prepareApiEndpoint)(n);async function s(e,t){return i(e,{login:t,payload:{}})}t.getAvailableWebAuthnAuthenticators=s},89878:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.getMasterPasswordCipheringKey=void 0;let a=r(64206),o=r(31740),n={group:o.ApiEndpointGroups.authentication,version:o.ApiVersion.v1,method:o.ApiRequestMethod.POST,authenticationType:o.ApiAuthType.Session,endpoint:"GetMasterPasswordCipheringKey"},i=(0,a.prepareApiEndpoint)(n);async function s(e,t){return i(e,{login:t,payload:{}})}t.getMasterPasswordCipheringKey=s},77023:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.getTokens=void 0;let a=r(64206),o=r(31740),n={group:o.ApiEndpointGroups.authentication,version:o.ApiVersion.v1,method:o.ApiRequestMethod.GET,authenticationType:o.ApiAuthType.App,endpoint:"GetTokens"},i=(0,a.prepareApiEndpoint)(n);async function s(e){return i(e)}t.getTokens=s},54376:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.getTwoFactorAuthenticationStatus=void 0;let a=r(64206),o=r(31740),n={group:o.ApiEndpointGroups.authentication,version:o.ApiVersion.v1,method:o.ApiRequestMethod.POST,authenticationType:o.ApiAuthType.UserDevice,endpoint:"Get2FAStatus"},i=(0,a.prepareApiEndpoint)(n);t.getTwoFactorAuthenticationStatus=function(e,t){return i(e,{login:t,payload:{}})}},98728:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.getU2FDevices=void 0;let a=r(31740),o=r(64206),n={authenticationType:a.ApiAuthType.UserDevice,endpoint:"GetU2FDevices",group:a.ApiEndpointGroups.authentication,method:a.ApiRequestMethod.POST,version:a.ApiVersion.v1},i=(0,o.prepareApiEndpoint)(n);async function s(e,t){return i(e,{login:t,payload:{}})}t.getU2FDevices=s},16522:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.getUnauthorizedProfiles=void 0;let a=r(31740),o=r(64206),n={group:a.ApiEndpointGroups.authentication,version:a.ApiVersion.v1,method:a.ApiRequestMethod.POST,authenticationType:a.ApiAuthType.App,endpoint:"GetUnauthorizedProfiles"},i=(0,o.prepareApiEndpoint)(n);async function s(e,t){return i(e,{payload:t})}t.getUnauthorizedProfiles=s},24416:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.getUserSSOInfo=void 0;let a=r(31740),o=r(64206),n={group:a.ApiEndpointGroups.authentication,version:a.ApiVersion.v1,method:a.ApiRequestMethod.POST,authenticationType:a.ApiAuthType.TeamDevice,endpoint:"GetUserSSOInfo"},i=(0,o.prepareApiEndpoint)(n);async function s(e,t){let{login:r,teamUuid:a,userServiceProviderKey:o}=t;return i(e,{login:r,teamUuid:a,payload:{login:r,userServiceProviderKey:o}})}t.getUserSSOInfo=s},31841:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.getWebAuthnAuthenticators=void 0;let a=r(31740),o=r(64206),n={group:a.ApiEndpointGroups.authentication,version:a.ApiVersion.v1,method:a.ApiRequestMethod.POST,authenticationType:a.ApiAuthType.UserDevice,endpoint:"GetWebAuthnAuthenticators"},i=(0,o.prepareApiEndpoint)(n);async function s(e,t){return i(e,{login:t,payload:{}})}t.getWebAuthnAuthenticators=s},28233:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.initRememberMasterPassword=void 0;let a=r(64206),o=r(31740),n={group:o.ApiEndpointGroups.authentication,version:o.ApiVersion.v1,method:o.ApiRequestMethod.POST,authenticationType:o.ApiAuthType.UserDevice,endpoint:"InitRememberMasterPassword"},i=(0,a.prepareApiEndpoint)(n);async function s(e,t,r){return i(e,{login:t,payload:r})}t.initRememberMasterPassword=s},46788:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.performDashlaneAuthenticatorVerification=t.verificationTimeoutError=void 0;let a=r(84935),o=r(31740),n=r(64206);t.verificationTimeoutError={code:a.VerificationTimeout,message:"The authentication request has timed out",type:a.BusinessError};let i={authenticationType:o.ApiAuthType.App,endpoint:"PerformDashlaneAuthenticatorVerification",group:o.ApiEndpointGroups.authentication,method:o.ApiRequestMethod.POST,version:o.ApiVersion.v1},s=(0,n.prepareApiEndpoint)(i);async function c(e,t){return s(e,{payload:t})}t.performDashlaneAuthenticatorVerification=c},37201:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.performDuoPushVerification=void 0;let a=r(31740),o=r(64206),n={authenticationType:a.ApiAuthType.App,endpoint:"PerformDuoPushVerification",group:a.ApiEndpointGroups.authentication,method:a.ApiRequestMethod.POST,version:a.ApiVersion.v1},i=(0,o.prepareApiEndpoint)(n);async function s(e,t){return i(e,{payload:t})}t.performDuoPushVerification=s},56188:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.performEmailTokenVerification=void 0;let a=r(31740),o=r(64206),n={authenticationType:a.ApiAuthType.App,endpoint:"PerformEmailTokenVerification",group:a.ApiEndpointGroups.authentication,method:a.ApiRequestMethod.POST,version:a.ApiVersion.v1},i=(0,o.prepareApiEndpoint)(n);async function s(e,t){return i(e,{payload:t})}t.performEmailTokenVerification=s},52052:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.performSsoVerification=void 0;let a=r(31740),o=r(64206),n={authenticationType:a.ApiAuthType.App,endpoint:"PerformSsoVerification",group:a.ApiEndpointGroups.authentication,method:a.ApiRequestMethod.POST,version:a.ApiVersion.v1},i=(0,o.prepareApiEndpoint)(n);async function s(e,t){return i(e,{payload:t})}t.performSsoVerification=s},16472:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.performTotpVerification=void 0;let a=r(31740),o=r(64206),n={authenticationType:a.ApiAuthType.App,endpoint:"PerformTotpVerification",group:a.ApiEndpointGroups.authentication,method:a.ApiRequestMethod.POST,version:a.ApiVersion.v1},i=(0,o.prepareApiEndpoint)(n);async function s(e,t){return i(e,{payload:t})}t.performTotpVerification=s},78952:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.performU2FVerification=void 0;let a=r(31740),o=r(64206),n={authenticationType:a.ApiAuthType.App,endpoint:"PerformU2FVerification",group:a.ApiEndpointGroups.authentication,method:a.ApiRequestMethod.POST,version:a.ApiVersion.v1},i=(0,o.prepareApiEndpoint)(n);async function s(e,t){return i(e,{payload:t})}t.performU2FVerification=s},1890:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.requestExtraDeviceRegistration=void 0;let a=r(31740),o=r(64206),n={group:a.ApiEndpointGroups.authentication,version:a.ApiVersion.v1,method:a.ApiRequestMethod.POST,authenticationType:a.ApiAuthType.UserDevice,endpoint:"RequestExtraDeviceRegistration"},i=(0,o.prepareApiEndpoint)(n);async function s(e,t){return i(e,{login:t,payload:{tokenType:"shortLived"}})}t.requestExtraDeviceRegistration=s},1733:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.requestTOTPActivation=void 0;let a=r(31740),o=r(64206),n={authenticationType:a.ApiAuthType.UserDevice,endpoint:"RequestTOTPActivation",group:a.ApiEndpointGroups.authentication,method:a.ApiRequestMethod.POST,version:a.ApiVersion.v1},i=(0,o.prepareApiEndpoint)(n);async function s(e,t,r){return i(e,{login:t,payload:r})}t.requestTOTPActivation=s},32628:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.removeU2FAuthenticator=void 0;let a=r(64206),o=r(31740),n={group:o.ApiEndpointGroups.authentication,version:o.ApiVersion.v1,method:o.ApiRequestMethod.POST,authenticationType:o.ApiAuthType.UserDevice,endpoint:"DeactivateU2FDevice"},i=(0,a.prepareApiEndpoint)(n);async function s(e,t,r){return i(e,{login:t,payload:r})}t.removeU2FAuthenticator=s},63556:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.requestWebauthnOpenSession=void 0;let a=r(31740),o=r(64206),n={group:a.ApiEndpointGroups.authentication,version:a.ApiVersion.v1,method:a.ApiRequestMethod.POST,authenticationType:a.ApiAuthType.Session,endpoint:"RequestWebauthnOpenSession"},i=(0,o.prepareApiEndpoint)(n);async function s(e,t){return i(e,{login:t,payload:{}})}t.requestWebauthnOpenSession=s},39419:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.requestWebauthnRegistration=void 0;let a=r(31740),o=r(64206),n={group:a.ApiEndpointGroups.authentication,version:a.ApiVersion.v1,method:a.ApiRequestMethod.POST,authenticationType:a.ApiAuthType.UserDevice,endpoint:"RequestWebauthnRegistration"},i=(0,o.prepareApiEndpoint)(n);async function s(e,t){return i(e,{login:t,payload:{}})}t.requestWebauthnRegistration=s},90464:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.addPrivateBreach=void 0;let a=r(31740),o=r(64206),n={group:a.ApiEndpointGroups.dataleakQA,version:a.ApiVersion.v1,method:a.ApiRequestMethod.POST,authenticationType:a.ApiAuthType.App,endpoint:"AddTestLeak"},i=(0,o.prepareApiEndpoint)(n);async function s(e,t){return i(e,{payload:{...t}})}t.addPrivateBreach=s},60249:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.createOrUpdateDarkWebBreach=void 0;let a=r(31740),o=r(64206),n={group:a.ApiEndpointGroups.dataleakQA,version:a.ApiVersion.v1,method:a.ApiRequestMethod.POST,authenticationType:a.ApiAuthType.App,endpoint:"SetTestDataBreach"},i=(0,o.prepareApiEndpoint)(n);async function s(e,t){return i(e,{payload:{...t}})}t.createOrUpdateDarkWebBreach=s},2409:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.createPublicBreach=void 0;let a=r(31740),o=r(64206),n={group:a.ApiEndpointGroups.breachesQA,version:a.ApiVersion.v1,method:a.ApiRequestMethod.POST,authenticationType:a.ApiAuthType.App,endpoint:"CreateTestBreach"},i=(0,o.prepareApiEndpoint)(n);async function s(e,t){return i(e,{payload:t})}t.createPublicBreach=s},48142:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.getDarkWebInsightReport=void 0;let a=r(31740),o=r(64206),n={group:a.ApiEndpointGroups.teams,version:a.ApiVersion.v1,method:a.ApiRequestMethod.POST,authenticationType:a.ApiAuthType.UserDevice,endpoint:"GetDarkWebInsightsReportDetails"},i=(0,o.prepareApiEndpoint)(n);async function s(e,t,r){return i(e,{login:t,payload:r})}t.getDarkWebInsightReport=s},51413:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.getDarkWebInsightsSummaryRequest=void 0;let a=r(31740),o=r(64206),n={group:a.ApiEndpointGroups.teams,version:a.ApiVersion.v1,method:a.ApiRequestMethod.POST,authenticationType:a.ApiAuthType.UserDevice,endpoint:"GetDarkWebInsightsSummary"},i=(0,o.prepareApiEndpoint)(n);async function s(e,t){return i(e,{login:t,payload:{}})}t.getDarkWebInsightsSummaryRequest=s},4684:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.deactivateDevices=t.CLIENT_STILL_OVERFLOWING=t.PAIRING_GROUPS_NOT_FOUND=t.CLIENT_DEVICES_NOT_FOUND=void 0;let a=r(31740),o=r(64206);t.CLIENT_DEVICES_NOT_FOUND="CLIENT_DEVICES_NOT_FOUND",t.PAIRING_GROUPS_NOT_FOUND="PAIRING_GROUPS_NOT_FOUND",t.CLIENT_STILL_OVERFLOWING="CLIENT_STILL_OVERFLOWING";let n={group:a.ApiEndpointGroups.devices,version:a.ApiVersion.v1,method:a.ApiRequestMethod.POST,authenticationType:a.ApiAuthType.UserDevice,endpoint:"DeactivateDevices"},i=(0,o.prepareApiEndpoint)(n);async function s(e,t,r){return i(e,{login:t,payload:r})}t.deactivateDevices=s},96348:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.listDevices=void 0;let a=r(31740),o=r(64206),n={group:a.ApiEndpointGroups.devices,version:a.ApiVersion.v1,method:a.ApiRequestMethod.POST,authenticationType:a.ApiAuthType.UserDevice,endpoint:"ListDevices"},i=(0,o.prepareApiEndpoint)(n);async function s(e,t){return i(e,{login:t,payload:{}})}t.listDevices=s},84935:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.InvalidTeamDeviceLogin=t.BasicConfigNotFound=t.DeactivatedTeamDevice=t.DeviceKeyNotFound=t.DeviceAccountMappingAlreadyExists=t.B2bSsoUserNotFound=t.NoFreeSlot=t.NotProposedNeitherAccepted=t.InvalidSsoToken=t.InvalidUser=t.DomainNotValidForTeam=t.TotpActiveOrNotSeeded=t.ConfigurationNotFound=t.TeamDeviceEncryptedConfigNotFound=t.InvalidTOTPStatus=t.VerificationMethodInvalid=t.InvalidAuthTicket=t.WrongPublicKey=t.VerificationTimeout=t.VerificationRequiresRequest=t.VerificationFailedTooManyTimes=t.UpdateOfVerificationMethodNotSupported=t.UnexpectedError=t.UnchangedPrivateKey=t.TwofaSettingSameAsCurrent=t.TwofaServerKeyProvidedIncorrectly=t.TwofaServerKeyNotProvided=t.TeamDoesNotExist=t.TemporaryDisabled=t.NoMpEncryptionKey=t.NotAdmin=t.NoSharingKeys=t.NothingToUpdate=t.NoExternalToken=t.MissingSettingsTransaction=t.InvalidSessionAccessKey=t.InvalidKey=t.InsufficientTier=t.ExternalTokenSignatureNotAvailableForPartner=t.Current2faSettingCannotBeChangedAtUpload=t.ConflictingUpload=t.AccountBlockedContactSupport=t.ServerError=t.RateLimitError=t.InvalidRequestError=t.InjectedError=t.BusinessError=void 0,t.BusinessError="business_error",t.InjectedError="injected_error",t.InvalidRequestError="invalid_request_error",t.RateLimitError="rate_limit_error",t.ServerError="server_error",t.AccountBlockedContactSupport="account_blocked_contact_support",t.ConflictingUpload="conflicting_upload",t.Current2faSettingCannotBeChangedAtUpload="current_2fa_setting_cannot_be_changed_at_upload",t.ExternalTokenSignatureNotAvailableForPartner="external_token_signature_not_available_for_partner",t.InsufficientTier="INSUFFICIENT_TIER",t.InvalidKey="invalid_key",t.InvalidSessionAccessKey="invalid_session_access_key",t.MissingSettingsTransaction="MISSING_SETTINGS_TRANSACTION",t.NoExternalToken="no_external_token",t.NothingToUpdate="NOTHING_TO_UPDATE",t.NoSharingKeys="NO_SHARING_KEYS",t.NotAdmin="NOT_ADMIN",t.NoMpEncryptionKey="no_mp_encryption_key",t.TemporaryDisabled="temporary_disabled",t.TeamDoesNotExist="TEAM_DOES_NOT_EXIST",t.TwofaServerKeyNotProvided="2fa_server_key_not_provided",t.TwofaServerKeyProvidedIncorrectly="2fa_server_key_provided_incorrectly",t.TwofaSettingSameAsCurrent="2fa_setting_same_as_current",t.UnchangedPrivateKey="UNCHANGED_PRIVATE_KEY",t.UnexpectedError="unexpected_error",t.UpdateOfVerificationMethodNotSupported="UPDATE_OF_VERIFICATION_METHOD_NOT_SUPPORTED",t.VerificationFailedTooManyTimes="verification_failed_too_many_times",t.VerificationRequiresRequest="verification_requires_request",t.VerificationTimeout="verification_timeout",t.WrongPublicKey="WRONG_PUBLIC_KEY",t.InvalidAuthTicket="invalid_auth_ticket",t.VerificationMethodInvalid="verification_method_invalid",t.InvalidTOTPStatus="invalid_totp_status",t.TeamDeviceEncryptedConfigNotFound="TEAM_DEVICE_CONFIGURATION_NOT_FOUND",t.ConfigurationNotFound="TEAM_DEVICE_CONFIGURATION_NOT_FOUND",t.TotpActiveOrNotSeeded="totp_active_or_not_seeded",t.DomainNotValidForTeam="DOMAIN_NOT_VALID_FOR_TEAM",t.InvalidUser="invalid_user",t.InvalidSsoToken="invalid_sso_token",t.NotProposedNeitherAccepted="not_proposed_neither_accepted",t.NoFreeSlot="no_free_slot",t.B2bSsoUserNotFound="B2B_SSO_USER_NOT_FOUND",t.DeviceAccountMappingAlreadyExists="DEVICE_ACCOUNT_MAPPING_ALREADY_EXISTS",t.DeviceKeyNotFound="DEVICE_KEY_NOT_FOUND",t.DeactivatedTeamDevice="DEACTIVATED_TEAM_DEVICE",t.BasicConfigNotFound="BASIC_CONFIGURATION_NOT_FOUND",t.InvalidTeamDeviceLogin="INVALID_TEAM_DEVICE_LOGIN"},4172:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.getFeatureFlip=void 0;let a=r(64206),o=r(31740),n={group:o.ApiEndpointGroups.features,version:o.ApiVersion.v1,method:o.ApiRequestMethod.POST,authenticationType:o.ApiAuthType.UserDevice,endpoint:"GetAndEvaluateForUser"},i=(0,a.prepareApiEndpoint)(n);t.getFeatureFlip=function(e,t,r){return i(e,{login:t,payload:{features:[r]}})}},43008:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.isGetFilesMetaSuccess=t.getFilesMeta=t.endpoint=void 0;let a=r(64206),o=r(31740);t.endpoint="GetFileMetaV2";let n={group:o.ApiEndpointGroups.file,version:o.ApiVersion.v1,method:o.ApiRequestMethod.POST,authenticationType:o.ApiAuthType.UserDevice,endpoint:t.endpoint},i=(0,a.prepareApiEndpoint)(n);t.getFilesMeta=(e,t,r)=>i(e,{login:t,payload:r}),t.isGetFilesMetaSuccess=e=>"success"===e.code},67070:function(e,t,r){var a=this&&this.__createBinding||(Object.create?function(e,t,r,a){void 0===a&&(a=r);var o=Object.getOwnPropertyDescriptor(t,r);(!o||("get"in o?!t.__esModule:o.writable||o.configurable))&&(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,a,o)}:function(e,t,r,a){void 0===a&&(a=r),e[a]=t[r]}),o=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||a(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),o(r(84935),t),o(r(84984),t),o(r(11481),t),o(r(30086),t),o(r(72901),t),o(r(4684),t),o(r(96348),t),o(r(28733),t),o(r(5883),t),o(r(39206),t),o(r(75668),t),o(r(45435),t),o(r(23559),t),o(r(61552),t),o(r(99511),t),o(r(19609),t),o(r(81716),t),o(r(55923),t),o(r(50057),t),o(r(58207),t),o(r(89878),t),o(r(77023),t),o(r(54376),t),o(r(98728),t),o(r(31841),t),o(r(16522),t),o(r(28233),t),o(r(37201),t),o(r(56188),t),o(r(52052),t),o(r(16472),t),o(r(78952),t),o(r(46788),t),o(r(1890),t),o(r(32628),t),o(r(1733),t),o(r(39419),t),o(r(63556),t),o(r(18254),t),o(r(57229),t),o(r(19274),t),o(r(4359),t),o(r(13433),t),o(r(70172),t),o(r(25482),t),o(r(47551),t),o(r(91709),t),o(r(1549),t),o(r(96304),t),o(r(75457),t),o(r(46579),t),o(r(84749),t),o(r(73872),t),o(r(79267),t),o(r(51962),t),o(r(64639),t),o(r(85874),t),o(r(34215),t),o(r(95264),t),o(r(12177),t),o(r(48765),t),o(r(17210),t)},81571:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.getKillSwitches=void 0;let a=r(64206),o=r(31740),n={group:o.ApiEndpointGroups.killswitch,version:o.ApiVersion.v1,method:o.ApiRequestMethod.POST,authenticationType:o.ApiAuthType.App,endpoint:"GetKillSwitches"},i=(0,a.prepareApiEndpoint)(n);async function s(e,t){return i(e,{payload:{requestedKillswitches:t}})}t.getKillSwitches=s},12177:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.requestPairing=void 0;let a=r(64206),o=r(31740),n={group:o.ApiEndpointGroups.pairing,version:o.ApiVersion.v1,method:o.ApiRequestMethod.POST,authenticationType:o.ApiAuthType.UserDevice,endpoint:"RequestPairing"},i=(0,a.prepareApiEndpoint)(n);async function s(e,t){return i(e,{login:t,payload:{}})}t.requestPairing=s},12709:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.listInvoices=void 0;let a=r(64206),o=r(31740),n={group:o.ApiEndpointGroups.payments,version:o.ApiVersion.v1,method:o.ApiRequestMethod.POST,authenticationType:o.ApiAuthType.UserDevice,endpoint:"ListInvoices"},i=(0,a.prepareApiEndpoint)(n);async function s(e,t){return i(e,{login:t,payload:{}})}t.listInvoices=s},48765:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.getHashes=void 0;let a=r(64206),o=r(31740),n={group:o.ApiEndpointGroups.pwleak,version:o.ApiVersion.v1,method:o.ApiRequestMethod.POST,authenticationType:o.ApiAuthType.App,endpoint:"GetHashes"},i=(0,a.prepareApiEndpoint)(n);async function s(e,t){return i(e,{payload:t})}t.getHashes=s},18254:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.confirmMasterPasswordChangeDone=void 0;let a=r(31740),o=r(64206),n={authenticationType:a.ApiAuthType.UserDevice,endpoint:"ConfirmMasterPasswordChangeDone",group:a.ApiEndpointGroups.sync,method:a.ApiRequestMethod.POST,version:a.ApiVersion.v1},i=(0,o.prepareApiEndpoint)(n);async function s(e,t,r){return i(e,{login:t,payload:r})}t.confirmMasterPasswordChangeDone=s},57229:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.getDataForMasterPasswordChange=void 0;let a=r(31740),o=r(64206),n={authenticationType:a.ApiAuthType.UserDevice,endpoint:"GetDataForMasterPasswordChange",group:a.ApiEndpointGroups.sync,method:a.ApiRequestMethod.POST,version:a.ApiVersion.v1},i=(0,o.prepareApiEndpoint)(n);async function s(e,t,r){return i(e,{login:t,payload:r})}t.getDataForMasterPasswordChange=s},19274:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.getLatestContent=void 0;let a=r(31740),o=r(64206),n={group:a.ApiEndpointGroups.sync,version:a.ApiVersion.v1,method:a.ApiRequestMethod.POST,authenticationType:a.ApiAuthType.UserDevice,endpoint:"GetLatestContent"},i=(0,o.prepareApiEndpoint)(n);async function s(e,t,r){return i(e,{login:t,payload:r})}t.getLatestContent=s},44370:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.uploadDataForCryptoChange=void 0;let a=r(64206),o=r(31740),n={authenticationType:o.ApiAuthType.UserDevice,endpoint:"UploadDataForCryptoUpdate",group:o.ApiEndpointGroups.sync,method:o.ApiRequestMethod.POST,version:o.ApiVersion.v1},i=(0,a.prepareApiEndpoint)(n);async function s(e,t,r){return await i(e,{login:t,payload:r})}t.uploadDataForCryptoChange=s},4359:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.uploadDataForMasterPasswordChange=void 0;let a=r(31740),o=r(64206),n={authenticationType:a.ApiAuthType.UserDevice,endpoint:"UploadDataForMasterPasswordChange",group:a.ApiEndpointGroups.sync,method:a.ApiRequestMethod.POST,version:a.ApiVersion.v1},i=(0,o.prepareApiEndpoint)(n);async function s(e,t,r){return i(e,{login:t,payload:r})}t.uploadDataForMasterPasswordChange=s},13433:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.lastADSyncDate=t.lastADSyncDateErrors=void 0;let a=r(64206),o=r(31740);t.lastADSyncDateErrors=["NOT_ADMIN","INSUFFICIENT_TIER"];let n={group:o.ApiEndpointGroups.teams,version:o.ApiVersion.v1,method:o.ApiRequestMethod.POST,authenticationType:o.ApiAuthType.UserDevice,endpoint:"LastADSyncDate"},i=(0,a.prepareApiEndpoint)(n);t.lastADSyncDate=function(e,t){return i(e,{login:t,payload:{}})}},39786:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.computePlanPricingRequest=void 0;let a=r(31740),o=r(64206),n={group:a.ApiEndpointGroups.teams,version:a.ApiVersion.v1,method:a.ApiRequestMethod.POST,authenticationType:a.ApiAuthType.UserDevice,endpoint:"ComputePlanPricing"},i=(0,o.prepareApiEndpoint)(n);async function s(e,t,r){return await i(e,{login:t,payload:{seats:r}})}t.computePlanPricingRequest=s},96304:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.listTeamDevicesErrors=t.getTeamDeviceErrors=t.createTeamDeviceAccountErrors=t.deactivateTeamDeviceErrors=t.registerTeamDeviceErrors=void 0;let a=r(84935),o=r(31740);t.registerTeamDeviceErrors=[a.NotAdmin,o.UnknownError],t.deactivateTeamDeviceErrors=[a.NotAdmin,o.UnknownError,a.DeviceKeyNotFound,a.DeactivatedTeamDevice],t.createTeamDeviceAccountErrors=[a.NotAdmin,a.DeviceAccountMappingAlreadyExists,a.InvalidTeamDeviceLogin],t.getTeamDeviceErrors=[a.NotAdmin,o.UnknownError],t.listTeamDevicesErrors=[a.NotAdmin,o.UnknownError]},75457:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.createTeamDeviceAccount=void 0;let a=r(64206),o=r(31740),n={group:o.ApiEndpointGroups.teams,version:o.ApiVersion.v1,method:o.ApiRequestMethod.POST,authenticationType:o.ApiAuthType.UserDevice,endpoint:"CreateTeamDeviceAccount"},i=(0,a.prepareApiEndpoint)(n);t.createTeamDeviceAccount=(e,t,r)=>i(e,{login:t,payload:r})},84749:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.deactivateTeamDevice=void 0;let a=r(64206),o=r(31740),n={group:o.ApiEndpointGroups.teams,version:o.ApiVersion.v1,method:o.ApiRequestMethod.POST,authenticationType:o.ApiAuthType.UserDevice,endpoint:"DeactivateTeamDevice"},i=(0,a.prepareApiEndpoint)(n);t.deactivateTeamDevice=function(e,t,r){return i(e,{login:t,payload:r})}},73872:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.getTeamDevice=void 0;let a=r(64206),o=r(31740),n={group:o.ApiEndpointGroups.teams,version:o.ApiVersion.v1,method:o.ApiRequestMethod.POST,authenticationType:o.ApiAuthType.UserDevice,endpoint:"GetTeamDevice"},i=(0,a.prepareApiEndpoint)(n);async function s(e,t,r){return await i(e,{login:t,payload:r})}t.getTeamDevice=s},79267:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.listTeamDevices=void 0;let a=r(64206),o=r(31740),n={group:o.ApiEndpointGroups.teams,version:o.ApiVersion.v1,method:o.ApiRequestMethod.POST,authenticationType:o.ApiAuthType.UserDevice,endpoint:"ListTeamDevices"},i=(0,a.prepareApiEndpoint)(n),s=async(e,t)=>await i(e,{login:t,payload:{}});t.listTeamDevices=s},46579:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.registerTeamDevice=void 0;let a=r(64206),o=r(31740),n={group:o.ApiEndpointGroups.teams,version:o.ApiVersion.v1,method:o.ApiRequestMethod.POST,authenticationType:o.ApiAuthType.UserDevice,endpoint:"RegisterTeamDevice"},i=(0,a.prepareApiEndpoint)(n);t.registerTeamDevice=function(e,t,r){return i(e,{login:t,payload:r})}},70172:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.completeDomainRegistrationErrors=t.completeDomainRegistration=void 0;let a=r(64206),o=r(31740),n={group:o.ApiEndpointGroups.teams,version:o.ApiVersion.v1,method:o.ApiRequestMethod.POST,authenticationType:o.ApiAuthType.UserDevice,endpoint:"CompleteDomainsRegistration"},i=(0,a.prepareApiEndpoint)(n);async function s(e,t){return i(e,{login:t,payload:{}})}t.completeDomainRegistration=s,t.completeDomainRegistrationErrors=["NOT_ADMIN"]},25482:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.deactivateDomain=t.deactivateDomainErrors=void 0;let a=r(64206),o=r(31740);t.deactivateDomainErrors=["NOT_ADMIN","DOMAIN_NOT_FOUND","DOMAIN_NOT_VALID_FOR_TEAM","DOMAIN_CANNOT_BE_DEACTIVATED","DOMAIN_DELETION_FAILED"];let n={group:o.ApiEndpointGroups.teams,version:o.ApiVersion.v1,method:o.ApiRequestMethod.POST,authenticationType:o.ApiAuthType.UserDevice,endpoint:"DeactivateDomain"},i=(0,a.prepareApiEndpoint)(n);async function s(e,t,r){return i(e,{login:t,payload:r})}t.deactivateDomain=s},47551:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.listDomains=t.listDomainErrors=void 0;let a=r(64206),o=r(31740);t.listDomainErrors=["NOT_ADMIN"];let n={group:o.ApiEndpointGroups.teams,version:o.ApiVersion.v1,method:o.ApiRequestMethod.POST,authenticationType:o.ApiAuthType.UserDevice,endpoint:"ListDomains"},i=(0,a.prepareApiEndpoint)(n);async function s(e,t){return i(e,{login:t,payload:{}})}t.listDomains=s},91709:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.requestDomainRegistration=t.requestDomainRegistrationErrors=void 0;let a=r(64206),o=r(31740);t.requestDomainRegistrationErrors=["TEAM_DOES_NOT_EXIST","DOMAIN_ALREADY_EXISTS","NOT_ADMIN","INVALID_PUBLIC_DOMAIN","DOMAIN_NOT_VALID_FOR_TEAM","DOMAIN_CANNOT_CONTAIN_UPPERCASE_LETTERS"];let n={group:o.ApiEndpointGroups.teams,version:o.ApiVersion.v1,method:o.ApiRequestMethod.POST,authenticationType:o.ApiAuthType.UserDevice,endpoint:"RequestDomainRegistration"},i=(0,a.prepareApiEndpoint)(n);t.requestDomainRegistration=function(e,t,r){return i(e,{login:t,payload:r})}},30426:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.changeInviteLinkTeamKey=void 0;let a=r(64206),o=r(31740),n={group:o.ApiEndpointGroups.teams,version:o.ApiVersion.v1,method:o.ApiRequestMethod.POST,authenticationType:o.ApiAuthType.UserDevice,endpoint:"ChangeTeamKey"},i=(0,a.prepareApiEndpoint)(n);t.changeInviteLinkTeamKey=(e,t)=>i(e,{login:t,payload:{}})},34445:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.getInviteLinkErrors=void 0;let a=r(20648);t.getInviteLinkErrors=[a.InviteLinkResponseErrorCode.NotAdmin,a.InviteLinkResponseErrorCode.InviteLinkNotFound,a.InviteLinkResponseErrorCode.TeamKeyNotFound,a.InviteLinkResponseErrorCode.UserInviteLinkNotFound]},5174:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.createInviteLink=void 0;let a=r(64206),o=r(31740),n={group:o.ApiEndpointGroups.teams,version:o.ApiVersion.v1,method:o.ApiRequestMethod.POST,authenticationType:o.ApiAuthType.UserDevice,endpoint:"CreateTeamSignUpPage"},i=(0,a.prepareApiEndpoint)(n);t.createInviteLink=(e,t,r)=>i(e,{login:t,payload:r})},84391:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.getInviteLinkForAdmin=void 0;let a=r(64206),o=r(31740),n={group:o.ApiEndpointGroups.teams,version:o.ApiVersion.v1,method:o.ApiRequestMethod.POST,authenticationType:o.ApiAuthType.UserDevice,endpoint:"GetTeamSignUpPageForAdmin"},i=(0,a.prepareApiEndpoint)(n);t.getInviteLinkForAdmin=(e,t)=>i(e,{login:t,payload:{}})},33173:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.getInviteLink=void 0;let a=r(64206),o=r(31740),n={group:o.ApiEndpointGroups.teams,version:o.ApiVersion.v1,method:o.ApiRequestMethod.POST,authenticationType:o.ApiAuthType.App,endpoint:"GetTeamSignUpPage"},i=(0,a.prepareApiEndpoint)(n);t.getInviteLink=(e,t)=>i(e,{payload:t})},34215:function(e,t,r){var a=this&&this.__createBinding||(Object.create?function(e,t,r,a){void 0===a&&(a=r);var o=Object.getOwnPropertyDescriptor(t,r);(!o||("get"in o?!t.__esModule:o.writable||o.configurable))&&(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,a,o)}:function(e,t,r,a){void 0===a&&(a=r),e[a]=t[r]}),o=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||a(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),o(r(34445),t),o(r(30426),t),o(r(5174),t),o(r(33173),t),o(r(84391),t),o(r(83234),t),o(r(65534),t)},65534:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.requestInviteLinkToken=void 0;let a=r(64206),o=r(31740),n={group:o.ApiEndpointGroups.teams,version:o.ApiVersion.v1,method:o.ApiRequestMethod.POST,authenticationType:o.ApiAuthType.App,endpoint:"RequestTeamInviteToken"},i=(0,a.prepareApiEndpoint)(n);t.requestInviteLinkToken=(e,t)=>i(e,{payload:t})},83234:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.toggleInviteLink=void 0;let a=r(64206),o=r(31740),n={group:o.ApiEndpointGroups.teams,version:o.ApiVersion.v1,method:o.ApiRequestMethod.POST,authenticationType:o.ApiAuthType.UserDevice,endpoint:"ToggleTeamSignUpPage"},i=(0,a.prepareApiEndpoint)(n);t.toggleInviteLink=(e,t,r)=>i(e,{login:t,payload:r})},61767:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.getRecoveryCodesAsTeamCaptain=t.GetRecoveryCodesAsTeamCaptainInternalErrorCode=t.GetRecoveryCodesAsTeamCaptainNotAdminErrorCode=void 0;let a=r(64206),o=r(31740);t.GetRecoveryCodesAsTeamCaptainNotAdminErrorCode="not_billing_admin",t.GetRecoveryCodesAsTeamCaptainInternalErrorCode="internal_error";let n={group:o.ApiEndpointGroups.teams,version:o.ApiVersion.v1,method:o.ApiRequestMethod.POST,authenticationType:o.ApiAuthType.UserDevice,endpoint:"GetRecoveryCodesAsTeamCaptain"},i=(0,a.prepareApiEndpoint)(n);t.getRecoveryCodesAsTeamCaptain=function(e,t,r){return i(e,{login:t,payload:r})}},22839:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.getTeamMembers=void 0;let a=r(64206),o=r(31740),n={group:o.ApiEndpointGroups.teams,version:o.ApiVersion.v1,method:o.ApiRequestMethod.POST,authenticationType:o.ApiAuthType.UserDevice,endpoint:"GetTeamMembers"},i=(0,a.prepareApiEndpoint)(n);t.getTeamMembers=function(e,t,r){return i(e,{login:t,payload:r})}},51962:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.updateTeamDeviceEncryptedConfigErrors=t.getTeamDeviceEncryptedConfigErrors=void 0;let a=r(84935),o=r(31740);t.getTeamDeviceEncryptedConfigErrors=[a.TeamDeviceEncryptedConfigNotFound,a.NotAdmin],t.updateTeamDeviceEncryptedConfigErrors=[a.NotAdmin,o.UnknownError,a.DeviceAccountMappingAlreadyExists,a.DeviceKeyNotFound]},64639:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.getTeamDeviceEncryptedConfig=void 0;let a=r(64206),o=r(31740),n={group:o.ApiEndpointGroups.teams,version:o.ApiVersion.v1,method:o.ApiRequestMethod.POST,authenticationType:o.ApiAuthType.UserDevice,endpoint:"GetTeamDeviceEncryptedConfiguration"},i=(0,a.prepareApiEndpoint)(n);t.getTeamDeviceEncryptedConfig=(e,t,r)=>i(e,{login:t,payload:r})},85874:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.updateTeamDeviceEncryptedConfig=void 0;let a=r(64206),o=r(31740),n={group:o.ApiEndpointGroups.teams,version:o.ApiVersion.v1,method:o.ApiRequestMethod.POST,authenticationType:o.ApiAuthType.UserDevice,endpoint:"UpdateTeamDeviceEncryptedConfiguration"},i=(0,a.prepareApiEndpoint)(n);t.updateTeamDeviceEncryptedConfig=(e,t,r)=>i(e,{login:t,payload:r})},1549:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.teamStatus=void 0;let a=r(64206),o=r(31740),n={group:o.ApiEndpointGroups.teams,version:o.ApiVersion.v1,method:o.ApiRequestMethod.POST,authenticationType:o.ApiAuthType.UserDevice,endpoint:"TeamStatus"},i=(0,a.prepareApiEndpoint)(n);t.teamStatus=function(e,t){return i(e,{login:t,payload:{}})}},95264:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.getRemoteTime=void 0;let a=r(64206),o=r(31740),n={group:o.ApiEndpointGroups.time,version:o.ApiVersion.v1,method:o.ApiRequestMethod.POST,authenticationType:o.ApiAuthType.None,endpoint:"GetRemoteTime"},i=(0,a.prepareApiEndpoint)(n);async function s(e){return i(e,{payload:{}})}t.getRemoteTime=s},17210:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.generateCredential=t.GetVpnCredentialBusinessErrors=void 0;let a=r(64206),o=r(31740);t.GetVpnCredentialBusinessErrors={USER_DOESNT_HAVE_VPN_CAPABILITY:"USER_DOESNT_HAVE_VPN_CAPABILITY",USER_ALREADY_HAS_AN_ACCOUNT:"USER_ALREADY_HAS_AN_ACCOUNT",USER_ALREADY_HAS_AN_ACCOUNT_FOR_PROVIDER:"USER_ALREADY_HAS_AN_ACCOUNT_FOR_PROVIDER",USER_ALREADY_HAVE_ACTIVE_VPN_SUBSCRIPTION:"USER_ALREADY_HAVE_ACTIVE_VPN_SUBSCRIPTION"};let n={group:o.ApiEndpointGroups.vpn,version:o.ApiVersion.v1,method:o.ApiRequestMethod.POST,authenticationType:o.ApiAuthType.UserDevice,endpoint:"GetCredentials"},i=(0,a.prepareApiEndpoint)(n),s=async(e,t,r)=>await i(e,{login:t,payload:r});t.generateCredential=s},67506:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.signRequest=t.allowedUnsignedHeaders=t.allowedUnsignedProxyHeaders=t.allowedUnsignedClientHeaders=t.signatureAlgorithm=void 0;let a=r(25903),o=r(59587),n=r(93308),i=r(12971),s=r(67179),c=r(31740),l=r(14654),u=r(91783);t.signatureAlgorithm="DL1-HMAC-SHA256",t.allowedUnsignedClientHeaders=["origin","content-length","content-encoding","authorization","user-agent","accept-encoding"],t.allowedUnsignedProxyHeaders=["x-forwarded-for","x-forwarded-proto","x-forwarded-port","x-amzn-trace-id"],t.allowedUnsignedHeaders=[...t.allowedUnsignedClientHeaders,...t.allowedUnsignedProxyHeaders];let d=async e=>{let{request:r,credentials:d,headersToSign:p,timestamp:S=(0,s.getUnixTimestamp)()}=e,{method:g,pathname:m,headers:y,query:f={},rawBody:E}=r,A=e=>Promise.resolve(e),h=(0,a.compose)(n.str2ab,n.utf8ChunkEncode),_=(0,a.composeP)((0,a.compose)(A,n.convertBufferToHex),o.computeHashSha256,(0,a.compose)(A,h)),T=await _(E),{canonicalRequest:v,signedHeaders:I}=(0,l.makeCanonicalRequest)({method:g,uri:m,headers:y,query:f,hashedPayload:T,headersToSign:p}),D=await _(v),P=[t.signatureAlgorithm,S,D].join("\n"),O=function(e){let{appKeys:t}=e;switch(e.type){case c.ApiAuthType.App:return t.secretKey;case c.ApiAuthType.UserDevice:{let{deviceKeys:r}=e;return`${t.secretKey}
${r.secretKey}`}case c.ApiAuthType.Session:{let{sessionKeys:r}=e;return`${t.secretKey}
${r.secretKey}`}case c.ApiAuthType.TeamDevice:{let{deviceKeys:r}=e;return`${t.secretKey}
${r.secretKey}`}default:(0,u.assertUnreachable)(e)}}(d),C=h(P),b=await (0,i.signHashHmacSHA256)({key:(0,n.str2ab)(O),data:C}),R=(0,n.convertBufferToHex)(b);return t.signatureAlgorithm+" "+[...function(e){let{appKeys:t}=e,r=["AppAccessKey="+t.accessKey];switch(e.type){case c.ApiAuthType.App:return r;case c.ApiAuthType.UserDevice:{let{login:t,deviceKeys:a}=e;return[`Login=${t}`,...r,`DeviceAccessKey=${a.accessKey}`]}case c.ApiAuthType.Session:{let{deviceId:t,login:a,sessionKeys:o}=e;return[`Login=${a}`,...r,`SessionAccessKey=${o.accessKey}`,`DeviceAccessKey=${t}`]}case c.ApiAuthType.TeamDevice:{let{teamUuid:t,deviceKeys:a}=e;return[`TeamUuid=${t}`,...r,`DeviceAccessKey=${a.accessKey}`]}default:(0,u.assertUnreachable)(e)}}(d),`Timestamp=${S}`,`SignedHeaders=${I}`,`Signature=${R}`].join(",")};t.signRequest=d},31740:function(e,t){var r,a;Object.defineProperty(t,"__esModule",{value:!0}),t.isApiErrorOfType=t.isApiError=t.UnknownError=t.ApiEndpointGroups=t.ApiVersion=t.ApiRequestMethod=t.ApiAuthType=void 0,t.ApiAuthType={App:"App",UserDevice:"UserDevice",None:"None",Session:"Session",TeamDevice:"TeamDevice"},t.ApiRequestMethod={GET:"GET",POST:"POST"},(r=t.ApiVersion||(t.ApiVersion={}))[r.v1=0]="v1",(a=t.ApiEndpointGroups||(t.ApiEndpointGroups={})).abtesting="abtesting",a.account="account",a.accountRecovery="accountrecovery",a.authentication="authentication",a.breachesQA="breaches-qa",a.dataleak="dataleak",a.dataleakQA="dataleak-qa",a.darkwebinsights="darkwebinsights",a.devices="devices",a.familyplan="familyplan",a.features="features",a.file="file",a.killswitch="killswitch",a.pairing="pairing",a.premium="premium",a.pwleak="pwleak",a.sync="sync",a.teams="teams",a.time="time",a.payments="payments",a.vpn="vpn",t.UnknownError="UNKNOWN_ERROR",t.isApiError=function(e){return"object"==typeof e&&"success"!==e.code},t.isApiErrorOfType=function(e,t){return"object"==typeof t&&t.type===e}},64698:function(e,t){var r,a;Object.defineProperty(t,"__esModule",{value:!0}),t.UnknownError=t.UnknownErrorMessages=t.UnknownErrorCode=void 0,(a=r=t.UnknownErrorCode||(t.UnknownErrorCode={}))[a.UNKNOWN_ERROR=0]="UNKNOWN_ERROR",t.UnknownErrorMessages={[r.UNKNOWN_ERROR]:"Unknown error"},t.UnknownError={codes:r,name:"UnknownError",messages:t.UnknownErrorMessages}},21837:function(e,t,r){var a=this&&this.__createBinding||(Object.create?function(e,t,r,a){void 0===a&&(a=r);var o=Object.getOwnPropertyDescriptor(t,r);(!o||("get"in o?!t.__esModule:o.writable||o.configurable))&&(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,a,o)}:function(e,t,r,a){void 0===a&&(a=r),e[a]=t[r]}),o=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||a(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),t.isCarbonError=t.CarbonError=void 0;let n=r(64698);class i extends Error{constructor(e,t){super(e.messages[t]),this.errorType=e,this.errorCode=t,this.additionalInfo={},Object.setPrototypeOf(this,i.prototype),this.name="CarbonError",Error.captureStackTrace&&Error.captureStackTrace(this,i)}errorTypeName(){return this.errorType.name}stringErrorCode(){let{errorType:{codes:e,name:t},errorCode:r}=this;return`${t}#${e[r]}`}addAdditionalInfo(e){return this.additionalInfo={...this.additionalInfo,...e},this}getAdditionalInfo(){return this.additionalInfo}addContextInfo(e,t){let{errorCode:r,errorType:a}=this;return this.message=`[${e}] - ${t}: ${a.messages[r]}`,this}toString(){return`CarbonError: ${this.message} (code ${this.stringErrorCode()})`}static fromAnyError(e,t,r){if(s(e))return e;let a=new i(t||n.UnknownError,void 0===r?n.UnknownErrorCode.UNKNOWN_ERROR:r);return s(a,n.UnknownError,n.UnknownErrorCode.UNKNOWN_ERROR)&&(a.message=e.message||`${e}`),e.stack&&(a.stack=e.stack),a}}function s(e,t,r){return e instanceof Error&&"CarbonError"===e.name&&(void 0===t||t===e.errorType)&&(void 0===r||r===e.errorCode)}t.CarbonError=i,t.isCarbonError=s,o(r(79144),t)},79144:function(e,t){Object.defineProperty(t,"__esModule",{value:!0})},86454:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.getCloudflareHeaders=t.setCloudflareHeaders=t.resetCloudflareHeaders=void 0;let r={};t.resetCloudflareHeaders=function(){r={}},t.setCloudflareHeaders=(e,t)=>{if(Object.isFrozen(r))throw Error("Trying to set Cloudflare headers after initialization");e&&t&&Object.freeze(r={"CF-Access-Client-Id":e,"CF-Access-Client-Secret":t})},t.getCloudflareHeaders=()=>Object.isFrozen(r)?r:{}},6110:function(e,t,r){var a,o;Object.defineProperty(t,"__esModule",{value:!0}),t.isHttpError=t.HttpError=t.HttpErrorMessages=t.HttpErrorCode=void 0;let n=r(21837);(o=a=t.HttpErrorCode||(t.HttpErrorCode={}))[o.CLIENT_ERROR=0]="CLIENT_ERROR",o[o.SERVER_ERROR=1]="SERVER_ERROR",o[o.STATUS_CODE=2]="STATUS_CODE",o[o.CONNECTION_ABORTED=3]="CONNECTION_ABORTED",o[o.CONNECTION_TIMED_OUT=4]="CONNECTION_TIMED_OUT",o[o.NETWORK_ERROR=5]="NETWORK_ERROR",o[o.NO_RESPONSE=6]="NO_RESPONSE",o[o.SETUP_FAILED=7]="SETUP_FAILED",t.HttpErrorMessages={[a.CLIENT_ERROR]:"Http response with client error status",[a.SERVER_ERROR]:"Http response with server error status",[a.STATUS_CODE]:"Http response with non-succesful status",[a.CONNECTION_ABORTED]:"Connection aborted",[a.CONNECTION_TIMED_OUT]:"Connection timed out",[a.NETWORK_ERROR]:"Network error",[a.NO_RESPONSE]:"No response to Http request",[a.SETUP_FAILED]:"Failed to setup Http request"},t.HttpError={codes:a,name:"HttpError",messages:t.HttpErrorMessages},t.isHttpError=(e,r)=>(0,n.isCarbonError)(e,t.HttpError,r)},7752:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.get=void 0;let a=r(95020);t.get=function(e,t={}){return(0,a.httpGetUsingFetch)(e,t)}},95020:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.httpGetUsingFetch=void 0;let a=r(56994);async function o(e,t={}){let r=(0,a.setTimeoutAbort)();try{let o={credentials:"omit",signal:r},n=t.headers?{...o,headers:t.headers}:o,i=await fetch(e,n);if((t.validateStatus&&!t.validateStatus(i.status))??!i.ok){let t=new a.FetchError(`HTTP ${i.status} - ${e}`);throw t.response=i,t}let s=await (0,a.getResponseBody)(i,t.responseType);return{headers:i.headers,data:s,status:i.status,statusText:i.statusText}}catch(e){throw console.error("[background/carbon] Failed to send GET HTTP request",e),(0,a.getCarbonHttpError)(e,r)}}t.httpGetUsingFetch=o},56994:function(e,t,r){var a;Object.defineProperty(t,"__esModule",{value:!0}),t.getCarbonHttpError=t.FetchError=t.setTimeoutAbort=t.getResponseBody=t.HttpStatusCode=void 0;let o=r(91783),n=r(21837),i=r(6110);async function s(e,t="json"){switch(t){case"json":return e.json();case"text":return e.text();case"arraybuffer":return e.arrayBuffer();default:(0,o.assertUnreachable)(t)}}(a=t.HttpStatusCode||(t.HttpStatusCode={}))[a.GATEWAY_TIMEOUT=504]="GATEWAY_TIMEOUT",t.getResponseBody=s,t.setTimeoutAbort=function(e=6e4){let t=new AbortController;return setTimeout(()=>t.abort(),e),t.signal};class c extends Error{constructor(e){super(e),this.response=void 0}}t.FetchError=c,t.getCarbonHttpError=(e,t)=>{let r=null;if(e instanceof c&&e.response){let{response:t}=e,{status:a}=t;(r=a>=400&&a<500?new n.CarbonError(i.HttpError,i.HttpErrorCode.CLIENT_ERROR):a>=500?new n.CarbonError(i.HttpError,i.HttpErrorCode.SERVER_ERROR):new n.CarbonError(i.HttpError,i.HttpErrorCode.STATUS_CODE)).addAdditionalInfo({response:t})}else r="AbortError"===e.name&&t.aborted?new n.CarbonError(i.HttpError,i.HttpErrorCode.CONNECTION_TIMED_OUT):"AbortError"===e.name?new n.CarbonError(i.HttpError,i.HttpErrorCode.CONNECTION_ABORTED):self?.navigator?.onLine?new n.CarbonError(i.HttpError,i.HttpErrorCode.SETUP_FAILED):new n.CarbonError(i.HttpError,i.HttpErrorCode.NETWORK_ERROR);return r.addAdditionalInfo({libError:e.message}),r}},74907:function(e,t,r){var a=this&&this.__createBinding||(Object.create?function(e,t,r,a){void 0===a&&(a=r);var o=Object.getOwnPropertyDescriptor(t,r);(!o||("get"in o?!t.__esModule:o.writable||o.configurable))&&(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,a,o)}:function(e,t,r,a){void 0===a&&(a=r),e[a]=t[r]}),o=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||a(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),t.post=t.get=void 0;var n=r(7752);Object.defineProperty(t,"get",{enumerable:!0,get:function(){return n.get}});var i=r(14931);Object.defineProperty(t,"post",{enumerable:!0,get:function(){return i.post}}),o(r(6110),t)},14931:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.post=void 0;let a=r(13191);t.post=function(e,t,r={}){return(0,a.httpPostUsingFetch)(e,t,r)}},13191:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.httpPostUsingFetch=void 0;let a=r(56994);async function o(e,t,r={}){let n=(0,a.setTimeoutAbort)();try{let o=r.headers||{},i=function(e,t="application/json"){let r=t.trim().toLowerCase();if(r.startsWith("application/json"))return JSON.stringify(e);if(r.startsWith("application/x-www-form-urlencoded"))return new URLSearchParams("string"==typeof e?e:Object.keys(e).reduce((t,r)=>{let a=e[r];return void 0===a||("string"==typeof a?t[r]=a:t[r]=JSON.stringify(a)),t},{}));if(r.startsWith("multipart/form-data")){let t=new FormData;for(let[r,a]of Object.entries(e))t.append(r,a);return t}if((r.startsWith("text/plain")||r.startsWith("application/x-jsonlines"))&&"string"==typeof e)return e;throw Error("Unsupported Content-Type for HTTP POST")}(t,o["Content-Type"]),s=await fetch(e,{method:"POST",headers:o,body:i,credentials:"omit",signal:n});if((r.validateStatus&&!r.validateStatus(s.status))??!s.ok){let t=new a.FetchError(`HTTP ${s.status} - ${e}`);throw t.response=s,t}let c=await (0,a.getResponseBody)(s,r.responseType);return{headers:s.headers,data:c,status:s.status,statusText:s.statusText}}catch(e){throw console.error("[background/carbon] Failed to send POST HTTP request",e),(0,a.getCarbonHttpError)(e,n)}}t.httpPostUsingFetch=o},69204:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.getBatch=void 0;let a=r(80930),o=r(41683);t.getBatch=function(e,t,r){let n="zero"===t.startCursor.type?0:(0,o.binaryFindIndex)(r,r=>(0,a.isAfterTokenStart)(e,t,!1,r));if(-1===n)return[];let i=r.slice(n),s="infinite"===t.endCursor.type?i.length:(0,o.binaryFindIndex)(i,r=>(0,a.isAfterTokenEnd)(e,t,!1,r),t.initialBatchSize),c=-1===s?i.length:s;return i.slice(0,c)}},22300:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.getBatch=t.generatePrevToken=t.generateNextToken=t.generateFirstToken=void 0;var a=r(3668);Object.defineProperty(t,"generateFirstToken",{enumerable:!0,get:function(){return a.generateFirstToken}}),Object.defineProperty(t,"generateNextToken",{enumerable:!0,get:function(){return a.generateNextToken}}),Object.defineProperty(t,"generatePrevToken",{enumerable:!0,get:function(){return a.generatePrevToken}});var o=r(69204);Object.defineProperty(t,"getBatch",{enumerable:!0,get:function(){return o.getBatch}})},80930:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.isBeforeTokenStart=t.isAfterTokenEnd=t.isBeforeTokenEnd=t.isAfterTokenStart=void 0;let a=r(25903),o=r(27011);function n(e,t){return e>t}function i(e,t){return e<t}let s=e=>"ascend"===e?i:n,c=e=>"ascend"===e?n:i;function l(e,t){return(0,a.compose)(o.normalizeStringMapper,e[t])}let u=(0,a.curry)(function(e,t,{0:r,1:a}){let{direction:n,field:i}=r,s=l(e,i);return c(n)(s(t),(0,o.normalizeStringMapper)(a))}),d=(0,a.curry)(function(e,t,{0:r,1:a}){let{direction:o,field:n}=r,i=l(e,n);return s(o)(i(t),a)}),p=(0,a.curry)(function(e,t,{0:r,1:a}){let{field:o}=r;return l(e,o)(t)===a});function S(e){return void 0!==e&&[!0,!1].includes(e)}let g=(e,t)=>r=>r.reduce((r,a)=>S(r)?r:!!e(a)||!!t(a)&&void 0,void 0),m=(e,t)=>(r,o,n,i)=>{let{sortCriteria:s,uniqField:c}=o.sortToken,l="start"===t?o.startCursor:o.endCursor;if("zero"===l.type)return"after"===e;if("infinite"===l.type)return"before"===e;let m=p(r,i),y=g("before"===e?d(r,i):u(r,i),m),f=y((0,a.zip)(s,l.sortValues));if(S(f))return f;let E=y([{0:{direction:"ascend",field:c},1:l.uniqValue}]);return S(E)?E:!n};t.isAfterTokenStart=m("after","start"),t.isBeforeTokenEnd=m("before","end"),t.isAfterTokenEnd=m("after","end"),t.isBeforeTokenStart=m("before","start")},92594:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.sameBatch=void 0;let a=r(25903);t.sameBatch=function(e,t){return e.length===t.length&&e.every((e,r)=>(0,a.equals)(t[r],e))}},3668:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.generateFirstToken=t.generatePrevToken=t.generateNextToken=t.zeroCursor=t.infiniteCursor=void 0;let a=r(25903),o=r(27011),n=r(41683),i=r(80930);function s(e,t,r){return r.sortCriteria.map(r=>{let{field:n}=r;return(0,a.compose)(o.normalizeStringMapper,e[n])(t)})}function c(e,r,a,o,n){let i=n.length,c=o+a-1;if(c>=i-1)return t.infiniteCursor;let l=n[c];return{type:"positional",sortValues:s(e,l,r),uniqValue:String(e[r.uniqField](l))}}t.infiniteCursor={type:"infinite"},t.zeroCursor={type:"zero"},t.generateNextToken=function(e,r,a){if("infinite"===r.endCursor.type)return;let o=function(e,r,a){let{initialBatchSize:o,endCursor:s,sortToken:l}=r;if("infinite"===s.type)throw Error("Cannot generate cursor after infinite end cursor.");let u=(0,n.binaryFindIndex)(a,t=>(0,i.isAfterTokenEnd)(e,r,!1,t));return -1===u?t.infiniteCursor:c(e,l,o,u,a)}(e,r,a);return{...r,startCursor:r.endCursor,endCursor:o}},t.generatePrevToken=function(e,r,a){if("zero"===r.startCursor.type)return;let o=function(e,r,a){let{initialBatchSize:o,startCursor:c,sortToken:l}=r;if("zero"===c.type)throw Error("Cannot generate cursor before zero start cursor.");let u=(0,n.binaryFindLastIndex)(a,t=>(0,i.isBeforeTokenStart)(e,r,!0,t));return -1===u?t.zeroCursor:function(e,r,a,o,n){let i=o-a+1;if(i<0)return t.zeroCursor;let c=n[i];return{type:"positional",sortValues:s(e,c,r),uniqValue:String(e[r.uniqField](c))}}(e,l,o,u,a)}(e,r,a);return{...r,startCursor:o,endCursor:r.startCursor}},t.generateFirstToken=function(e,r,a,o){let{sortToken:n,filterToken:i}=r,s=c(e,n,a,0,o);return{sortToken:n,filterToken:i,initialBatchSize:a,startCursor:t.zeroCursor,endCursor:s}}},73386:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.getPlugins=t.setPlugins=void 0;let r={};t.setPlugins=function(e){r=e},t.getPlugins=function(){return r}},58682:function(e,t,r){var a=this&&this.__createBinding||(Object.create?function(e,t,r,a){void 0===a&&(a=r);var o=Object.getOwnPropertyDescriptor(t,r);(!o||("get"in o?!t.__esModule:o.writable||o.configurable))&&(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,a,o)}:function(e,t,r,a){void 0===a&&(a=r),e[a]=t[r]}),o=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||a(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),o(r(43278),t),o(r(81253),t)},81253:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.setupProbe=void 0;let a=r(25903),o=r(22560),n=(e,t)=>r=>{try{e(r,t)}catch(e){(0,o.logWarn)({message:`Monitor raised an error on announcement ${r.type}`,tag:"Probe",details:{error:e}})}},i=()=>({timestamp:Date.now()}),s=(e,t)=>r=>(0,a.forEach)(n(r,t),e);t.setupProbe=(...e)=>(...t)=>{let r=i();(0,a.forEach)(s(t,r),e)}},43278:function(e,t){Object.defineProperty(t,"__esModule",{value:!0})},68322:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.filterData=void 0;let a=r(25903),o=r(73812),n=r(91783);t.filterData=function(e,t,r,i){return r.filterCriteria.reduce((r,i)=>{let s=function(e,t,r){let{value:i}=r,s=(0,o.normalizeStringMapper)(i),c=t=>(0,a.compose)(o.normalizeStringMapper,e[t]);switch(r.type){case"equals":return e=>c(r.field)(e)===s;case"differs":return e=>c(r.field)(e)!==s;case"matches":return e=>t(s,e);case"in":return e=>{let t=c(r.field)(e);return s.indexOf(t)>-1};case"contains":return e=>{let t=c(r.field)(e);if(!Array.isArray(t))throw Error("[Query] - filter: expected an array");return t.includes(s)};default:(0,n.assertUnreachable)(r)}}(e,t,i);return r.filter(s)},i)}},27011:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.normalizeStringMapper=t.queryData=t.sortData=t.filterData=t.stringifyToken=t.parseToken=t.optimizeBatchSelector=t.createOptimizedSortTokenSelector=t.createOptimizedFilterTokenSelector=void 0;var a=r(97178);Object.defineProperty(t,"createOptimizedFilterTokenSelector",{enumerable:!0,get:function(){return a.createOptimizedFilterTokenSelector}}),Object.defineProperty(t,"createOptimizedSortTokenSelector",{enumerable:!0,get:function(){return a.createOptimizedSortTokenSelector}}),Object.defineProperty(t,"optimizeBatchSelector",{enumerable:!0,get:function(){return a.optimizeBatchSelector}});var o=r(93088);Object.defineProperty(t,"parseToken",{enumerable:!0,get:function(){return o.parseToken}}),Object.defineProperty(t,"stringifyToken",{enumerable:!0,get:function(){return o.stringifyToken}});var n=r(68322);Object.defineProperty(t,"filterData",{enumerable:!0,get:function(){return n.filterData}});var i=r(66175);Object.defineProperty(t,"sortData",{enumerable:!0,get:function(){return i.sortData}});var s=r(36250);Object.defineProperty(t,"queryData",{enumerable:!0,get:function(){return s.queryData}});var c=r(73812);Object.defineProperty(t,"normalizeStringMapper",{enumerable:!0,get:function(){return c.normalizeStringMapper}})},73812:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.normalizeStringMapper=void 0;let a=r(25903),o=r(82573),n=(0,a.compose)(o.normalizeString,a.toLower);t.normalizeStringMapper=e=>"string"==typeof e?n(e):Array.isArray(e)?e.map(t.normalizeStringMapper):e},36250:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.queryData=void 0;let a=r(68322),o=r(66175);t.queryData=function(e,t,r,n,i){let s=(0,a.filterData)(e,t,n,i);return(0,o.sortData)(e,r,s)}},97178:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.optimizeBatchSelector=t.createOptimizedFilterTokenSelector=t.createOptimizedSortTokenSelector=void 0;let a=r(25903),o=r(49548);t.createOptimizedSortTokenSelector=(0,o.createSelectorCreator)(o.defaultMemoize,(e,t)=>e.uniqField===t.uniqField&&e.sortCriteria.length===t.sortCriteria.length&&e.sortCriteria.every((e,r)=>Object.keys(e).every(a=>e[a]===t.sortCriteria[r][a]))),t.createOptimizedFilterTokenSelector=(0,o.createSelectorCreator)(o.defaultMemoize,(e,t)=>e.filterCriteria.length===t.filterCriteria.length&&e.filterCriteria.every((e,r)=>Object.keys(e).every(a=>e[a]===t.filterCriteria[r][a])));let n=(0,o.createSelectorCreator)(o.defaultMemoize,(e,t)=>e.length===t.length&&e.every((e,r)=>t[r]===e));t.optimizeBatchSelector=e=>n(e,a.identity)},66175:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.sortData=void 0;let a=r(73812),o=r(25903);t.sortData=function(e,t,r){let n=(0,o.compose)(String,e[t.uniqField]),i=[...t.sortCriteria.map(t=>(function(e,t){let{direction:r}=t,n=function(e,t){let{field:r}=t;return(0,o.compose)(a.normalizeStringMapper,e[r])}(e,t);return("ascend"===r?o.ascend:o.descend)(n)})(e,t)),(0,o.ascend)(n)];return(0,o.sortWith)(i)(r)}},93088:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.stringifyToken=t.parseToken=void 0;let a=r(93308),o=r(24592);t.parseToken=function(e){let t=o.decode(e);return JSON.parse((0,a.utf8ChunkDecode)(t))},t.stringifyToken=function(e){if(void 0===e)return"";let t=JSON.stringify(e),r=(0,a.utf8ChunkEncode)(t);return o.encode(r)}},82116:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.makeAutoLoginService=t.loadMPFromStorageToStore=t.shouldTrigger=t.createMasterPasswordCipheringKey=t.AUTOLOGIN_EXPIRATION_DATE=void 0;let a=r(25826),o=r(12971),n=r(93308),i=r(49789),s=r(67179),c=r(80896),l=r(22560),u=r(29509),d=r(28323),p=r(93748),S=r(10039),g=r(23555),m=r(83867);t.AUTOLOGIN_EXPIRATION_DATE=1209600,t.createMasterPasswordCipheringKey=()=>(0,o.generateAESKey)();let y=()=>{let e=(0,m.getWindowLocalStorage)();return a.env.isBrowserEnvironment()&&e?parseInt(e["QA.EXTENSION-1474.expirationTimeSeconds"],10):void 0},f=()=>{try{let e=y();if(Number.isSafeInteger(e)&&e<t.AUTOLOGIN_EXPIRATION_DATE)return e}catch(e){(0,l.logError)(e)}return t.AUTOLOGIN_EXPIRATION_DATE},E=async e=>{try{let{storeService:r,localStorageService:a,sessionClient:o}=e;if(!r.isAuthenticated())throw Error(S.RememberMeErrorCode.USER_NOT_AUTHENTICATED);let c=r.getState(),l=await (0,u.getDeviceKeysFromSession)(o),m=(0,u.sessionKeysSelector)(c),y=(0,p.userLoginSelector)(c);if(!l)throw Error(S.RememberMeErrorCode.EMPTY_DEVICE_KEYS);if((0,S.areSessionKeysValid)(m))return;let E=await (0,t.createMasterPasswordCipheringKey)(),A=(0,n.bufferToBase64)(E),h=await (0,d.initRememberMasterPassword)(r,y,{rememberMasterPasswordCipheringKey:A});if((0,d.isApiError)(h))throw Error(h.code);let _=(0,s.getUnixTimestamp)()+f(),T={accessKey:h.sessionAccessKey,secretKey:h.sessionSecretKey,expirationTimeSeconds:_};r.dispatch((0,i.loadSessionKeys)(T)),await a.getInstance().storeAuthenticationKeys(T),e.autoLoginEncryptorService.setInstance({raw:null,buffer:E},"");let v=(0,p.masterPasswordSelector)(c);await a.getInstance().storeMasterPassword(v),await (0,S.persistLocalAccountRememberMeType)(r,"autologin"),r.dispatch((0,g.setRememberMeTypeAction)("autologin"))}catch(t){let e=Error(`[Autologin] - initialize: ${t}`);(0,c.sendExceptionLog)({error:e}),(0,l.logError)(e)}},A=async(e,t,r,a,o)=>{try{if(t.setInstance(o),e.isAuthenticated()||!await (0,S.hasSessionKeysInStorage)(t))return!1;await (0,S.loadSessionKeysToStore)(e,r,t,a);let n=(0,u.sessionKeysSelector)(e.getState());if(!(0,S.areSessionKeysValid)(n))return(0,S.cleanRememberMeStorageData)(e,r,a),!1;return t.getInstance().doesMasterPasswordExist()}catch(e){if(e.message!==S.RememberMeErrorCode.EMPTY_SESSION_KEYS){let t=Error(`[Autologin] - shouldTrigger: ${e}`);(0,c.sendExceptionLog)({error:t}),(0,l.logError)(e)}return!1}};t.shouldTrigger=A;let h=async(e,t,r,a,o,n)=>{let s=await (0,d.getMasterPasswordCipheringKey)(t,n);if((0,d.isApiError)(s))throw"invalid_request_error"===s.type&&"unknown_session_key"===s.code&&(0,S.cleanRememberMeStorageData)(t,e,o),Error(s.message);r.setInstance({raw:s.rememberMasterPasswordCipheringKey},"");let c=await a.getInstance().getMasterPassword();t.dispatch((0,i.updateMasterPassword)(c))};t.loadMPFromStorageToStore=h;let _=async(e,r)=>{try{let{sessionClient:a,storageService:o,storeService:n,autoLoginEncryptorService:i,localStorageService:s}=e;if(!await (0,t.shouldTrigger)(n,s,o,a,r))return;await (0,t.loadMPFromStorageToStore)(o,n,i,s,a,r)}catch(t){let e=Error(`[Autologin] - processAutoLogin: ${t}`);(0,c.sendExceptionLog)({error:e}),(0,l.logError)(e)}};t.makeAutoLoginService=e=>({initialize:()=>E(e),process:t=>_(e,t),shouldTrigger:r=>(0,t.shouldTrigger)(e.storeService,e.localStorageService,e.storageService,e.sessionClient,r)})},16696:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.makeWebAuthnAuthenticationService=t.shouldTrigger=void 0;let a=r(93308),o=r(22560),n=r(12971),i=r(29509),s=r(28323),c=r(93748),l=r(49789),u=r(80896),d=r(18040),p=r(10039),S=r(23555),g=async(e,t)=>{try{let{storeService:r,localStorageService:o,webAuthnAuthenticationEncryptorService:i}=e,u=r.getState(),g=(0,c.userLoginSelector)(u),m=await (0,n.generate64BytesKey)(),y=(0,a.bufferToBase64)(m),f=atob(y),E=await (0,s.completeRememberMeRegistration)(r,g,{masterPasswordEncryptionKey:y,authenticator:t});if((0,s.isApiError)(E))throw Error(E.code);let A={accessKey:E.sessionAccessKey,secretKey:E.sessionSecretKey,expirationTimeSeconds:E.sessionExpirationDateUnix};r.dispatch((0,l.loadSessionKeys)(A)),await o.getInstance().storeAuthenticationKeys(A);let h=(0,d.getNoDerivationCryptoConfig)();i.setInstance({raw:f},"",h);let _=(0,c.masterPasswordSelector)(u);return await o.getInstance().storeWebAuthnMasterPassword(_),await (0,p.persistLocalAccountRememberMeType)(r,"webauthn"),r.dispatch((0,S.setRememberMeTypeAction)("webauthn")),!0}catch(t){let e=Error(`[WebAuthnAuthentication] - initialize: ${t}`);return(0,u.sendExceptionLog)({error:e}),(0,o.logError)(e),!1}},m=async(e,t,r,a,n)=>{try{if(r.setInstance(n),(0,c.isAuthenticatedSelector)(e.getState())||!await (0,p.hasSessionKeysInStorage)(r))return!1;await (0,p.loadSessionKeysToStore)(e,t,r,a);let o=(0,i.sessionKeysSelector)(e.getState());if(!(0,p.areSessionKeysValid)(o))return!1;return r.getInstance().doesMasterPasswordExist()}catch(e){if(e.message!==p.RememberMeErrorCode.EMPTY_SESSION_KEYS){let t=Error(`[WebAuthnAuthentication] - shouldTrigger: ${e}`);(0,u.sendExceptionLog)({error:t}),(0,o.logError)(t)}return!1}};t.shouldTrigger=m;let y=async(e,t,r)=>{try{let{storeService:a,webAuthnAuthenticationEncryptorService:o,localStorageService:n}=e,i=await (0,s.completeRememberMeOpenSession)(a,t,{authenticator:r});if((0,s.isApiError)(i))throw Error(i.message);let c=(0,d.getNoDerivationCryptoConfig)(),u=i.masterPasswordEncryptionKey,p=atob(u);o.setInstance({raw:p},"",c);let S=await n.getInstance().getWebAuthnMasterPassword();a.dispatch((0,l.updateMasterPassword)(S))}catch(t){let e=Error(`[WebAuthnAuthentication] - processWebAuthnAuthentication: ${t}`);(0,u.sendExceptionLog)({error:e}),(0,o.logError)(e)}},f=async(e,t)=>{let{storeService:r,localStorageService:a,sessionClient:o}=e,n=await (0,i.getDeviceAccessKeysFromSession)(o,t);if(!n)return!1;let c=await (0,s.deactivateRememberMe)(r,t,{deviceAccessKey:n});return!(0,s.isApiError)(c)&&(await a.getInstance().cleanAuthenticationKey(),await (0,p.persistLocalAccountRememberMeType)(r,"disabled"),r.dispatch((0,S.setRememberMeTypeAction)("disabled")),!0)};t.makeWebAuthnAuthenticationService=e=>({initialize:t=>g(e,t),process:(t,r)=>y(e,t,r),shouldTrigger:r=>(0,t.shouldTrigger)(e.storeService,e.storageService,e.localStorageService,e.sessionClient,r),deactivate:t=>f(e,t)})},10039:function(e,t,r){var a,o;Object.defineProperty(t,"__esModule",{value:!0}),t.areSessionKeysValid=t.loadSessionKeysToStore=t.hasSessionKeysInStorage=t.shouldAskMasterPassword=t.cleanRememberMeStorageData=t.getLocalAccountRememberMeType=t.persistLocalAccountRememberMeType=t.RememberMeErrorCode=void 0;let n=r(15535),i=r(6833),s=r(4455),c=r(70362),l=r(49789),u=r(67179),d=r(93748),p=r(28323),S=r(29509),g=r(21837),m=r(80896),y=r(22560);(o=a=t.RememberMeErrorCode||(t.RememberMeErrorCode={})).USER_NOT_AUTHENTICATED="USER_NOT_AUTHENTICATED",o.EMPTY_DEVICE_KEYS="EMPTY_DEVICE_KEYS",o.EMPTY_SESSION_KEYS="EMPTY_SESSION_KEYS";let f=async(e,t)=>{let{login:r,persistData:a}=e.getAccountInfo();a===s.PersistData.PERSIST_DATA_YES&&await (0,n.storeUserPublicSetting)(r,"rememberMeType",t)};t.persistLocalAccountRememberMeType=f,t.getLocalAccountRememberMeType=e=>(0,n.getUserPublicSetting)(e,"rememberMeType");let E=async(e,t,r)=>{let a=await (0,S.getDeviceAccessKeysFromSession)(t,r);a&&await (0,p.deactivateRememberMe)(e,r,{deviceAccessKey:a})},A=async(e,r,a)=>{let o=(0,d.userLoginSelector)(e.getState()),n=[(0,i.removeData)(r,o,"authenticationKeys"),(0,i.removeData)(r,o,"registry"),(0,t.persistLocalAccountRememberMeType)(e,"disabled")];if("disabled"!==(0,S.rememberMeTypeSelector)(e.getState())){let t=new Promise(t=>{E(e,a,o).then(t).catch(e=>{let r=g.CarbonError.fromAnyError(e).addContextInfo("RememberMe","cleanRememberMeStorageData");(0,y.logError)({message:"Error when deactivating remember me server side"}),(0,m.sendExceptionLog)({error:r}),t()})});n.push(t)}await Promise.allSettled(n)};t.cleanRememberMeStorageData=A,t.shouldAskMasterPassword=e=>{if(!["autologin","webauthn"].includes((0,t.getLocalAccountRememberMeType)(e)))return!1;let r=(0,n.getUserPublicSetting)(e,"lastMasterPasswordOpenSessionTimestamp")||void 0;if(r)return Date.now()-r>12096e5};let h=async e=>await e.getInstance().doesAuthenticationKeysExist();t.hasSessionKeysInStorage=h;let _=async(e,r,o,n)=>{try{if(!(0,t.hasSessionKeysInStorage)(o))throw Error(a.EMPTY_SESSION_KEYS);let r=await o.getInstance().getAuthenticationKeys();e.dispatch((0,l.loadSessionKeys)(r))}catch(a){throw a.message.indexOf(c.DATA_TAMPERED_ERROR)>-1&&(0,t.cleanRememberMeStorageData)(e,r,n),a}};t.loadSessionKeysToStore=_,t.areSessionKeysValid=e=>e?.expirationTimeSeconds>(0,u.getUnixTimestamp)()},56319:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.restoreLastAuthenticatedUser=void 0;let a=r(22560),o=r(72287),n=r(80896),i=r(483),s=r(51683),c=r(4544),l=r(57986);async function u(e,t){try{let{applicationModulesAccess:r,storeService:a}=e,n=t.find(e=>e.isLastSuccessfulLogin);if(!n||n.hasLoginOtp)return;let u=a.getState();if(u.userSession.ssoSettings.ssoUser)return;let d=n.login,p=u.authentication.localUsers;if(void 0!==p[d]&&p[d].ssoActivatedUser){(0,l.disableAutoSSOLoginSelector)(u)||(e.storeService.dispatch((0,c.updateLoginStepInfoLogin)(d)),"sso"===n.rememberMeType&&r.createClients().authenticationFlow.commands.initiateAutologinWithSSO({login:d??""}));return}if("webauthn"===n.rememberMeType){!function({storeService:e}){try{document.featurePolicy.features().includes("publickey-credentials-get")&&e.dispatch((0,i.reactivationStatusUpdated)(s.ReactivationStatus.WEBAUTHN))}catch(t){e.dispatch((0,i.reactivationStatusUpdated)(s.ReactivationStatus.CLASSIC))}}(e);return}let S="autologin"===n.rememberMeType&&await e.autoLoginService.shouldTrigger(d),g=(0,o.makeLoginController)(e);if(!S){g.openSession(d);return}await e.autoLoginService.process(d);let m=e.storeService.getUserSession().masterPassword;if(!m)return;await g.openSessionWithMasterPassword(d,m,{triggeredByRememberMeType:"autologin",loginType:"Autologin"})}catch(r){let e=`[index] - restoreLastAuthenticatedUser: ${r}`,t=Error(e);(0,a.logError)({message:e,details:{error:t}}),(0,n.sendExceptionLog)({error:t})}}t.restoreLastAuthenticatedUser=u},7429:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.makeLocalStorageService=void 0;let a=r(6833);t.makeLocalStorageService=e=>{let t=null;return{setInstance:r=>{t=(0,a.makeUserLocalDataService)(e,r)},getInstance:()=>{if(!t)throw Error("makeLocalStorageService: You must call setInstance(login: string) before getting the instance");return t}}}},6833:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.makeUserLocalDataService=t.deleteAllLocalUserData=t.isDataStored=t.removeData=t.getStorageDebugKey=t.getStorageKey=t.STORAGE_VERSION=t.StoredUserDataTypeEnum=void 0;let a=r(20648),o=r(22560),n=r(48169),i=r(93308),s=r(93748),c=r(70607),l=r(34978),u=r(74047),d=r(57112),p=r(24592);t.StoredUserDataTypeEnum=["abTests","authentication","authenticationKeys","eventStore","health","healthWasComputed","icons","localDataBackupLastLoginSuccessful","localDataBackupTmp","localKey","localSettings","notificationsStatus","personalData","personalSettings","recoveryData","recoveryLocalKey","recoverySessionCredential","registry","remoteFileContent","remoteFileMeta","sharingData","teamAdminData","userActivity","vaultReport","analyticsIds"],t.STORAGE_VERSION="v1",t.getStorageKey=(e,r,a=t.STORAGE_VERSION)=>`${e}.${r}.${a}`,t.getStorageDebugKey=(e,r,a=t.STORAGE_VERSION)=>(0,t.getStorageKey)(e,r,a)+".clear";let S=(e,t)=>`${e}.${t}`,g=(e,t)=>S(e,t)+".clear",m=async(e,t,r)=>{let a=await e.getLocalStorage().readItem(r);if("string"!=typeof a||0===a.length)throw Error(`value ${t} undefined`);return a},y=async(e,t,r,n)=>{let s=await m(t,r,n),c=await e.getInstance().decrypt(s),u=(0,l.deflatedUtf8ToUtf16)(c,{skipUtf8Decoding:!0});if(0===u.length)throw Error(a.AuthenticationCode[a.AuthenticationCode.WRONG_PASSWORD]);let d=p.decode(u);try{let e=(0,i.utf8ChunkDecode)(d);return JSON.parse(e)}catch(e){return o.default.log(e),d}},f=async(e,t,r,a)=>{let o=await m(t,r,a),n=await e.getInstance().decrypt(o);return JSON.parse((0,l.inflateUtf16)(n))},E=async(e,r,a,n)=>{let i=r.getLocalStorage(),s=(0,t.getStorageKey)(a,n);if(await i.itemExists(s))return f(e,r,n,s);let c=S(a,n);if(await i.itemExists(c))return y(e,r,n,c);let l=Error("value "+n+" undefined");throw o.default.error(l),l},A=async(e,r,a,i,s)=>{try{let o=e.getLocalStorage(),c=(0,t.getStorageKey)(r,i);if(await o.writeItem(c,a),(0,n.isInternalTestUser)(r)&&s){let a=(0,t.getStorageDebugKey)(r,i);await e.getLocalStorage().writeItem(a,s)}}catch(t){let e=Error(`[storeData] failed for dataType: ${i} with error: ${t}`);throw o.default.error(e),e}},h=async(e,t,r,a,o)=>{let n=JSON.stringify(a),i=(0,l.deflateUtf16)(n),s=await e.getInstance().encrypt(i);await A(t,r,s,o,a)},_=async(e,r,a)=>{let o=(0,t.getStorageKey)(r,a),i=S(r,a),s=(0,t.getStorageDebugKey)(r,a),c=g(r,a),l=e.getLocalStorage(),u=[l.removeItem(o),l.removeItem(i),...(0,n.isInternalTestUser)(r)?[l.removeItem(s),l.removeItem(c)]:[]];await Promise.all(u)};t.removeData=_;let T=async(e,r,a)=>{let o=e.getLocalStorage(),n=(0,t.getStorageKey)(r,a);if(await o.itemExists(n))return!0;let i=S(r,a);return await o.itemExists(i)};async function v(e,t){await e.commands.mitigationDeleteGrapheneUserData({login:t})}async function I(e,r,o){let n=o.trim();await Promise.all([...t.StoredUserDataTypeEnum,...a.FileNamesList].map(async r=>{await (0,t.removeData)(e,n,r)})),await v(r,o)}t.isDataStored=T,t.deleteAllLocalUserData=I,t.makeUserLocalDataService=(e,r)=>{let n=()=>{let{storeService:t,masterPasswordEncryptorService:r,localDataEncryptorService:a}=e;return(0,s.isLocalKeyActivatedSelector)(t.getState())?a:r};return{storePersonalData:t=>h(n(),e.storageService,r,t,"personalData"),getPersonalData:()=>(o.default.log("Load Personal Data"),E(n(),e.storageService,r,"personalData")),doesPersonalDataExist:()=>(o.default.log("Check Personal Data existence"),(0,t.isDataStored)(e.storageService,r,"personalData")),storeLocalSettings:t=>h(n(),e.storageService,r,t,"localSettings"),getLocalSettings:()=>(o.default.log("Load Local Settings"),E(n(),e.storageService,r,"localSettings")),storePersonalSettings:t=>h(n(),e.storageService,r,t,"personalSettings"),getPersonalSettings:()=>(o.default.log("Load Personal Settings"),E(n(),e.storageService,r,"personalSettings")),storeNotificationsStatus:t=>h(n(),e.storageService,r,t,"notificationsStatus"),doesNotificationStatusExist:()=>(o.default.log("Check Notification Status existence"),(0,t.isDataStored)(e.storageService,r,"notificationsStatus")),getNotificationStatus:()=>(o.default.log("Load Notifications Status"),E(n(),e.storageService,r,"notificationsStatus")),storeSharingData:t=>h(n(),e.storageService,r,t,"sharingData"),getSharingData:()=>(o.default.log("Load Sharing Data"),E(n(),e.storageService,r,"sharingData")),storeTeamAdminData:t=>h(n(),e.storageService,r,t,"teamAdminData"),getTeamAdminData:()=>(o.default.log("Load Team Admin Data"),E(n(),e.storageService,r,"teamAdminData")),storeAuthenticationKeys:t=>h(e.authorizationKeysEncryptorService,e.storageService,r,t,"authenticationKeys"),getAuthenticationKeys:()=>(o.default.log("Load Authentication Keys"),E(e.authorizationKeysEncryptorService,e.storageService,r,"authenticationKeys").then(e=>e)),doesAuthenticationKeysExist:()=>(o.default.log("Check Authentication Keys existence"),(0,t.isDataStored)(e.storageService,r,"authenticationKeys")),cleanAuthenticationKey:()=>(0,t.removeData)(e.storageService,r,"authenticationKeys"),storeAuthenticationData:t=>h(n(),e.storageService,r,t,"authentication"),getAuthenticationData:()=>E(n(),e.storageService,r,"authentication"),hasAuthenticationData:()=>(0,t.isDataStored)(e.storageService,r,"authentication"),doesMasterPasswordExist:()=>(o.default.log("Check Master Password Keys existence"),(0,t.isDataStored)(e.storageService,r,"registry")),clearMasterPassword:async()=>{let a=e.storageService;await (0,t.removeData)(a,r,"registry")},getMasterPassword:()=>(o.default.log("Load Master Password via Auto login"),E(e.autoLoginEncryptorService,e.storageService,r,"registry")),storeMasterPassword:t=>(o.default.log("Store Master Password via Auto login"),h(e.autoLoginEncryptorService,e.storageService,r,t,"registry")),getWebAuthnMasterPassword:()=>(o.default.log("Load Master Password via WebAuthn login"),E(e.webAuthnAuthenticationEncryptorService,e.storageService,r,"registry")),storeWebAuthnMasterPassword:t=>(o.default.log("Store Master Password via WebAuthn login"),h(e.webAuthnAuthenticationEncryptorService,e.storageService,r,t,"registry")),getLocalKey:()=>E(e.masterPasswordEncryptorService,e.storageService,r,"localKey"),doesLocalKeyExist:()=>(0,t.isDataStored)(e.storageService,r,"localKey"),storeLocalKey:t=>h(e.masterPasswordEncryptorService,e.storageService,r,t,"localKey"),doesLocalDataExist:()=>Promise.all(["localSettings","personalData","personalSettings"].map(a=>(0,t.isDataStored)(e.storageService,r,a))).then(e=>e.every(e=>e)),storeUserABTests:t=>h(n(),e.storageService,r,t,"abTests"),getUserABTests:()=>(o.default.log("Load User AB Tests"),E(n(),e.storageService,r,"abTests")),storeIcons:async t=>{let a=(0,c.iconsToStorage)(t);return h(n(),e.storageService,r,a,"icons")},getIcons:async()=>{if(!await (0,t.isDataStored)(e.storageService,r,"icons"))return null;let a=await E(n(),e.storageService,r,"icons");return(0,c.iconsFromStorage)(a)},doesUserActivityExist:()=>(0,t.isDataStored)(e.storageService,r,"userActivity"),storeUserActivity:()=>h(n(),e.storageService,r,{},"userActivity"),getUserActivity:()=>E(n(),e.storageService,r,"userActivity"),doesVaultReportExist:()=>(0,t.isDataStored)(e.storageService,r,"vaultReport"),storeVaultReport:t=>h(n(),e.storageService,r,t,"vaultReport"),getVaultReport:()=>E(n(),e.storageService,r,"vaultReport"),storeEventStore:t=>h(n(),e.storageService,r,t,"eventStore"),getEventStore:async()=>await (0,t.isDataStored)(e.storageService,r,"eventStore")?E(n(),e.storageService,r,"eventStore"):null,storeRecoveryLocalKey:async t=>A(e.storageService,r,t,"recoveryLocalKey"),getRecoveryLocalKey:async()=>{let a=(0,t.getStorageKey)(r,"recoveryLocalKey");return await m(e.storageService,"recoveryLocalKey",a)},storeRecoverySessionCredential:t=>h(n(),e.storageService,r,t,"recoverySessionCredential"),getRecoverySessionCredential:async()=>E(n(),e.storageService,r,"recoverySessionCredential"),doesRecoverySessionCredentialExist:async()=>(0,t.isDataStored)(e.storageService,r,"recoverySessionCredential"),cleanRecoverySetupData:async()=>{let a=e.storageService;return await (0,t.removeData)(a,r,"recoverySessionCredential"),await (0,t.removeData)(a,r,"recoveryLocalKey")},doesRecoveryLocalKeyExist:async()=>(0,t.isDataStored)(e.storageService,r,"recoveryLocalKey"),cleanRecoveryData:async()=>{let a=e.storageService;return await (0,t.removeData)(a,r,"recoveryData")},storeRecoveryData:async t=>{let a=e.storageService;return await A(a,r,t,"recoveryData")},getRecoveryData:async()=>{let a=(0,t.getStorageKey)(r,"recoveryData");return await m(e.storageService,"recoveryData",a)},doesRecoveryDataExist:()=>(0,t.isDataStored)(e.storageService,r,"recoveryData"),storeAnalyticsIds:t=>h(n(),e.storageService,r,t,"analyticsIds"),getAnalyticsIds:()=>((0,o.log)({message:"Load Analytics IDs"}),E(n(),e.storageService,r,"analyticsIds")),doesAnalyticsIdsExist:()=>((0,o.log)({message:"Check Analytics IDs existence"}),(0,t.isDataStored)(e.storageService,r,"analyticsIds")),storeRemoteFileContent:(t,a)=>h(n(),e.storageService,r,a,t),storeRemoteFileMeta:t=>h(n(),e.storageService,r,t,"remoteFileMeta"),getRemoteFileMeta:async()=>{let{storageService:a}=e,o=await E(n(),a,r,"remoteFileMeta");return(0,u.isFileRevisionMapper)(o)?o:(await (0,t.removeData)(a,r,"remoteFileMeta"),(0,d.defaultRemoteFileState)().fileMetaData)},getRemoteFileContent:t=>E(n(),e.storageService,r,t),cleanAllRemoteFiles:async()=>{let o=e.storageService;for(let e of(await (0,t.removeData)(o,r,"remoteFileMeta"),a.FileNamesList))await (0,t.removeData)(o,r,e)},cleanSingleFileStorage:async a=>{let o=e.storageService;await (0,t.removeData)(o,r,a);let i=await E(n(),e.storageService,r,"remoteFileMeta");return delete i?.files[a],h(n(),e.storageService,r,i,"remoteFileMeta")},isRemoteFileMetaDataExist:()=>(0,t.isDataStored)(e.storageService,r,"remoteFileMeta"),isRemoteFileContentExist:a=>(0,t.isDataStored)(e.storageService,r,a)}}},2068:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.makeStorageService=t.CarbonLocalStorage=void 0;let a=r(22560);t.CarbonLocalStorage=class{constructor(e){this._storage=e}itemExists(e){return this._storage.itemExists(e)}readItem(e){return this._storage.readItem(e)}async writeItem(e,t){let r=await this.backupItem(e);try{await this._storage.writeItem(e,t),r&&await r.clean()}catch(e){a.Debugger.error("CarbonLocalStorage:writeItem error:",e),r?(a.Debugger.error("CarbonLocalStorage couldn't save data, reverting to backup version"),await r.restoreAndClean()):a.Debugger.error("CarbonLocalStorage couldn't save data and no backup version to restore")}}removeItem(e){return this._storage.removeItem(e)}async getSuitableBackupKey(e){let t=t=>e+"."+t,r=1;for(;await this._storage.itemExists(t(r));)r++;return t(r)}async backupItem(e){if(!await this._storage.itemExists(e))return null;let t=await this.getSuitableBackupKey(e),r=await this._storage.readItem(e);await this._storage.writeItem(t,r);let a=this._storage;async function o(){return await a.removeItem(t)}async function n(){let r=await a.readItem(t);return await a.writeItem(e,r),await o()}return{clean:o,restoreAndClean:n}}},t.makeStorageService=()=>{let e=null;return{setInstance:t=>{e=t},getLocalStorage:()=>{if(!e)throw Error("makeStorageService: You must call setInstance(instance: AsyncStorage) before getting the instance");return e}}}},82573:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.normalizeString=void 0,t.normalizeString=e=>e.normalize("NFD").replace(/[\u0300-\u036f]/g,"").toLowerCase()},86889:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.getStyxApiCredentials=void 0;let a=r(31740),o=r(53127);t.getStyxApiCredentials=function(e,t){if(t.authenticationType!==a.ApiAuthType.App)return{type:a.ApiAuthType.None};let r={appKeys:(0,o.styxKeysSelector)(e)};return{type:a.ApiAuthType.App,...r}}},81290:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.getApiClientAgentHeader=t.getMakeStyxApiRequest=t.getEventsPayload=void 0;let a=r(29509),o=r(17541),n=r(31740),i=r(67179),s=r(3314),c=r(74907),l=r(91783),u=r(86889),d=r(48169),p=r(67506),S=r(20648);async function g(e,t,r,o,s,c){if(r.type===n.ApiAuthType.None)return{};let l=(0,a.dashlaneServerDeltaTimestampSelector)(e.getState())||0,u=Math.round((0,i.getUnixTimestamp)()-l);return{Authorization:await (0,p.signRequest)({request:{pathname:t,method:"POST",rawBody:c,headers:o},timestamp:u,credentials:r,headersToSign:s})}}function m(e){return JSON.stringify({platform:e.platformName,version:e.appVersion})}t.getEventsPayload=function(e){return e.map(e=>JSON.stringify(e)).join("\n")},t.getMakeStyxApiRequest=function(e,t,r){return async(p,y)=>{let f={login:"",teamUuid:"",payload:"",...y||{}},E=(0,o.getMethodParams)(r,f.payload),A=(0,o.getAuthParams)(t,{login:f.login,teamUuid:f.teamUuid}),h="POST"===E.method?E.payload:"",_=(0,a.dashlaneServerDeltaTimestampSelector)(p.getState())||0,T=Math.round((0,i.getUnixTimestamp)()-_),v=(0,u.getStyxApiCredentials)(p.getState(),A),I=(0,a.platformInfoSelector)(p.getState()),D={"Content-Type":"application/x-jsonlines","X-TIMESTAMP":T.toString()},P={"dashlane-client-agent":m(I)};(function(e){let t=e.getAccountInfo().login,r=t&&(0,d.isInternalTestUser)(t),{buildType:a}=e.getPlatformInfo(),o=a===S.ApplicationBuildType.DEV||a===S.ApplicationBuildType.QA;return r||o})(p)&&(D["X-DL-TEST"]="true");let O=Object.keys(P),C=await g(p,e,v,{...P,...D},O,h),b={...P,...C,...D},R=s.config.DASHLANE_STYX_HOST_WITH_SCHEME,N=`${R}${e}`,{data:w}=await function(e,t,r){let a={headers:r,validateStatus:o.validateStatus};switch(e.method){case n.ApiRequestMethod.GET:return(0,c.get)(t,a);case n.ApiRequestMethod.POST:return(0,c.post)(t,e.payload,a);default:(0,l.assertUnreachable)(e)}}(E,N,b);return w}},t.getApiClientAgentHeader=m},77116:function(e,t,r){var a;Object.defineProperty(t,"__esModule",{value:!0}),t.SendTokenStatus=t.makeWSAuthentication=void 0;let o=r(50783),n="authentication";t.makeWSAuthentication=()=>({registerUki:e=>{var t;return t=e,(0,o._makeRequest)(n,7,"registeruki",t,{responseType:"text"}).then(e=>{if(function(e){if("string"!=typeof e){let t=JSON.stringify(e);throw Error(`unsupported_response - ${t}`)}}(e),"ERROR"===e)throw Error("Error: Failed to register the UKI");return e})},validity:e=>{var t;return t=e,(0,o._makeRequest)(n,7,"validity",t,{responseType:"text"})}}),(a=t.SendTokenStatus||(t.SendTokenStatus={}))[a.ERROR=0]="ERROR",a[a.SUCCESS=1]="SUCCESS",a[a.OTP_NEEDED=2]="OTP_NEEDED",a[a.UNKNOWN_USER=3]="UNKNOWN_USER"},681:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.makeWSBackup=void 0;let a=r(50783),o="backup";t.makeWSBackup=()=>({latest:e=>n(e),upload:e=>i(e),unlock:e=>s(e),erase:e=>c(e)});let n=e=>(0,a._makeRequest)(o,12,"latest",Object.assign({},e,{sharingTimestamp:0})),i=e=>(0,a._makeRequest)(o,12,"upload",e),s=e=>(0,a._makeRequest)(o,12,"unlock",e),c=e=>(0,a._makeRequest)(o,12,"erase",e)},83687:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.makeWSBreaches=void 0;let a=r(50783);t.makeWSBreaches=()=>({get:e=>(0,a._makeRequest)("breaches",1,"get",e)})},45588:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.makeWSContactInfo=void 0;let a=r(50783);t.makeWSContactInfo=()=>({getContactInfo:e=>{var t;return t=e,(0,a._makeRequest)("contactinfos",1,"get",{login:t.login,uki:t.uki})}})},36194:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.makeWSCountry=void 0;let a=r(50783);t.makeWSCountry=()=>({getCurrentCountry:(e={})=>{var t;return t=e,(0,a._makeRequest)("country",1,"get",t).then(e=>e.content)}})},31699:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.makeWSDataLeaks=void 0;let a=r(36598),o=r(21837),n=r(77644),i=r(3314),s=r(86454),c="dataleak";function l(e){return d(c,1,"status",e)}function u(e){return d(c,1,"leaks",e)}async function d(e,t,r,c){let l=`${i.config.DASHLANE_WS_HOST_WITH_SCHEME}/${t}/${e}/${r}`,u={headers:{...(0,s.getCloudflareHeaders)()}},{data:d}=await (0,a.postDataToUrl)(l,c,u);return function(e,t){if(429===t.code||t.error&&-32600===t.error.code)throw new o.CarbonError(n.WSError,n.WSErrorCode.THROTTLED).addAdditionalInfo({webService:e});return t}(l,d)}t.makeWSDataLeaks=()=>({status:l,leaks:u})},89609:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.makeWSDevices=void 0;let a=r(50783),o="devices";t.makeWSDevices=()=>({list:e=>n(e),deactivate:e=>i(e),changeName:e=>s(e)});let n=e=>(0,a._makeRequest)(o,1,"list",{login:e.login,uki:e.uki}).then(e=>e.content),i=e=>(0,a._makeRequest)(o,1,"deactivate",{login:e.login,uki:e.uki,deviceId:e.deviceId}),s=e=>(0,a._makeRequest)(o,1,"changename",{login:e.login,uki:e.uki,deviceId:e.deviceId,updatedName:e.updatedDeviceName})},77644:function(e,t){var r,a;Object.defineProperty(t,"__esModule",{value:!0}),t.WSError=t.WSErrorMessages=t.WSErrorCode=void 0,(a=r=t.WSErrorCode||(t.WSErrorCode={}))[a.THROTTLED=0]="THROTTLED",a[a.REQUEST_FAILED=1]="REQUEST_FAILED",t.WSErrorMessages={[r.THROTTLED]:"THROTTLED",[r.REQUEST_FAILED]:"WebService responded with error code in payload"},t.WSError={codes:r,name:"WSError",messages:t.WSErrorMessages}},57468:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.makeWSIconCrawler=void 0;let a=r(50783);t.makeWSIconCrawler=()=>({getIcons:o});let o=async e=>(0,a._makeRequest)("iconcrawler",2,"getIcons",{domainsInfo:e})},77765:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.NewCardToken=void 0;let a=r(50783);t.NewCardToken=function(e,t){return(0,a._makeRequest)(t.name,t.version,"getNewCardToken",{login:e.login,uki:e.uki,teamId:e.teamId??null})}},2004:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.makeWSPremium=void 0;let a=r(50783),o="premium";t.makeWSPremium=()=>({status:e=>{var t;return t=e,(0,a._makeRequest)(o,3,"status",{login:t.login,uki:t.uki,billingInformation:t.billingInformation,spaces:t.spaces,autoRenewal:t.autoRenewal,familyInformation:t.familyInformation,previousPlan:t.previousPlan,needsAutoRenewalFailed:t.needsAutoRenewalFailed,teamInformation:!1,capabilities:!0}).then(e=>{if(!e.success)throw Error("failed fetching premium status");return e.hasOwnProperty("billingInformation")&&(e.billingInformation=function(e){if(e)return{cardExpirationYear:Number(e.card_exp_year),cardExpirationMonth:Number(e.card_exp_month),cardLast4Digits:Number(e.card_last4),cardType:e.card_type}}(e.billingInformation)),e})},setAutoRenewal:e=>{var t;return t=e,(0,a._makeRequest)(o,3,"setAutoRenewal",{login:t.login,uki:t.uki,enabled:t.enabled})},updateCardToken:e=>{var t;return t=e,(0,a._makeRequest)(o,3,"updateCardToken",{login:t.login,uki:t.uki,tokenId:t.tokenId,stripeAccount:t.stripeAccount})},getABTestingVersionDetails:e=>{var t;return t=e,(0,a._makeRequest)(o,3,"getABTestingVersionDetails",t)},getSubscriptionCode:e=>(function({login:e,uki:t}){return(0,a._makeRequest)(o,3,"getSubscriptionCode",{login:e,uki:t})})(e)})},15027:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.makeWSQA=void 0;let a=r(50783);t.makeWSQA=()=>({tokens:e=>{var t;return t=e,(0,a._makeRequest)("qa",1,"tokens",t)}})},21997:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.makeWSRecovery=void 0;let a=r(50783),o="recovery";async function n(e){return(0,a._makeRequest)(o,1,"getSetupRequisites",e)}async function i(e){return(0,a._makeRequest)(o,1,"setRecoveryClientKeys",e)}async function s(e){return(0,a._makeRequest)(o,1,"request",e)}async function c(e){let{content:t}=await (0,a._makeRequest)(o,1,"getPendingRequests",e);return t}async function l(e){return(0,a._makeRequest)(o,1,"accept",e)}async function u(e){return(0,a._makeRequest)(o,1,"refuse",e)}async function d(e){return(0,a._makeRequest)(o,1,"cancel",e)}t.makeWSRecovery=()=>({getSetupRequisites:e=>n(e),setRecoveryClientKeys:e=>i(e),request:e=>s(e),getPendingRequests:e=>c(e),acceptRequest:e=>l(e),refuseRequest:e=>u(e),cancelRequest:e=>d(e)})},15557:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.makeWSSecureFile=void 0;let a=r(50783),o="securefile";function n(e){return(0,a._makeRequest)(o,1,"delete",e)}function i(e){return(0,a._makeRequest)(o,1,"getUploadLink",e)}function s(e){return(0,a._makeRequest)(o,1,"commit",e)}t.makeWSSecureFile=()=>({getUploadLink:i,commit:s,delete:n})},17927:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.setTeamSettings=t.getTeamSettings=t.makeWSSettings=void 0;let a=r(50783),o="teamPlans";function n(e){return(0,a._makeRequest)(o,1,"status",e)}function i(e){return(0,a._makeRequest)(o,1,"editSettings",e)}t.makeWSSettings=()=>({getTeamSettings:e=>n(e),setTeamSettings:e=>i(e)}),t.getTeamSettings=n,t.setTeamSettings=i},99382:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.makeSharingWS=t.get=void 0;let a=r(50783);function o(e,t,r){let o={login:e,uki:t,action:JSON.stringify(r)};return(0,a._makeRequest)("sharing",2,"get",o).then(({content:e})=>e)}t.get=o,t.makeSharingWS=()=>({get:(e,t,r)=>o(e,t,r)})},33360:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.makeItemGroupWS=void 0;let a=r(50783);function o(e,t,r){let o={login:e,uki:t,action:JSON.stringify(r)};return(0,a._makeRequest)("sharing",2,"performItemGroupAction",o).then(e=>{let t=e.content,r=t.itemGroupErrors;if(r&&r.length>0)throw Error(r[0].message);let{itemGroups:a,items:o}=t;return{itemGroups:a,items:o}})}t.makeItemGroupWS=()=>({createSpecialItemGroup:(e,t,r)=>o(e,t,r).then(({itemGroups:e})=>e&&e[0]),createItemGroup:o,deleteGroup:(e,t,r)=>o(e,t,r),addItems:(e,t,r)=>o(e,t,r),updateItem:(e,t,r)=>o(e,t,r),removeItems:(e,t,r)=>o(e,t,r),acceptItemGroup:o,refuseItemGroup:o,inviteItemGroupMembers:o,revokeItemGroupMembers:o,updateItemGroupMembers:o})},89735:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.makeUserGroupWS=void 0;let a=r(50783);function o(e,t,r){let o={login:e,uki:t,action:JSON.stringify(r)};return(0,a._makeRequest)("userGroup",1,"performUserGroupAction",o).then(e=>{let{itemGroups:t,items:r,userGroupErrors:a,userGroups:o}=e.content;if(a&&a.length>0)throw Error(a[0].message);return{itemGroups:t,items:r,userGroups:o}})}t.makeUserGroupWS=()=>({create:(e,t,r)=>o(e,t,r),delete:(e,t,r)=>o(e,t,r),rename:(e,t,r)=>o(e,t,r),invite:(e,t,r)=>o(e,t,r),revoke:(e,t,r)=>o(e,t,r),update:(e,t,r)=>o(e,t,r),accept:(e,t,r)=>o(e,t,r),refuse:(e,t,r)=>o(e,t,r)})},34814:function(e,t,r){var a,o;Object.defineProperty(t,"__esModule",{value:!0}),t.CheckChangePasswordStatus=t.makeWSStrongAuth=void 0;let n=r(50783),i=r(22560);t.makeWSStrongAuth=()=>({checkChangeMasterPassword:e=>(function({login:e,otp:t,deviceId:r}){return(0,n._makeRequest)("strongauth",3,"getServerKey",{login:e,otp:t,deviceID:r,isMxAware:!0}).then(e=>{if(i.default.log("checkChangeMasterPassword: "+(e?JSON.stringify(e):"response null")),!e||!e.message)throw Error("Unknown response from server");if(void 0===a[e.message])throw Error(`unknown_message - ${JSON.stringify(e)}`);return{status:a[e.message],content:e.content}})})(e)}),(o=a=t.CheckChangePasswordStatus||(t.CheckChangePasswordStatus={}))[o.Unauthorized=0]="Unauthorized",o[o.OK=1]="OK"},6222:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.makeWSTeamPlans=void 0;let a=r(50783),o="teamPlans";t.makeWSTeamPlans=()=>({findUserGroups:e=>{var t;return t=e,(0,a._makeRequest)(o,1,"findUserGroups",t)},proposeMembers:e=>{var t;return t=e,(0,a._makeRequest)(o,1,"proposeMembers",t)},acceptTeam:e=>{var t;return t=e,(0,a._makeRequest)(o,1,"acceptTeam",t)},addTeamAdmin:e=>{var t;return t=e,(0,a._makeRequest)(o,1,"addTeamCaptain",t)},removeTeamAdmin:e=>{var t;return t=e,(0,a._makeRequest)(o,1,"removeTeamCaptain",t)},registerFreeTrial:e=>{var t;return t=e,(0,a._makeRequest)(o,1,"registerFreeTrial",t)},confirmFreeTrial:e=>{var t;return t=e,(0,a._makeRequest)(o,1,"confirmFreeTrial",t)},getDirectorySyncRequest:e=>{var t;return t=e,(0,a._makeRequest)(o,1,"getDirectorySyncRequest",t)},updateDirectorySyncRequestStatus:e=>{var t;return t=e,(0,a._makeRequest)(o,1,"updateDirectorySyncRequestStatus",t)},spaceDeleted:e=>{var t;return t=e,(0,a._makeRequest)(o,1,"spaceDeleted",t)}})},49170:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.create=t.makeWSUserActivity=void 0;let a=r(50783);async function o(e){return await (0,a._makeRequest)("useractivity",2,"create",e)}t.makeWSUserActivity=()=>({create:o}),t.create=o},64298:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.makeWSUserAlias=void 0;let a=r(50783);t.makeWSUserAlias=()=>({findUsersByAliases:e=>{var t;return t=e,(0,a._makeRequest)("userAlias",1,"findUsers",{login:t.login,uki:t.uki,aliases:t.aliases}).then(e=>e.content)}})},5552:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.isWSResponseSuccess=void 0,t.isWSResponseSuccess=function(e){return 200===e.code}},52417:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.makeWSService=void 0;let a=r(77116),o=r(45588),n=r(36194),i=r(31699),s=r(89609),c=r(2004),l=r(21997),u=r(34814),d=r(6222),p=r(64298),S=r(17927),g=r(33360),m=r(15027),y=r(99382),f=r(681),E=r(83687),A=r(89735),h=r(49170),_=r(57468),T=r(15557);t.makeWSService=()=>({authentication:(0,a.makeWSAuthentication)(),backup:(0,f.makeWSBackup)(),breaches:(0,E.makeWSBreaches)(),contactInfo:(0,o.makeWSContactInfo)(),country:(0,n.makeWSCountry)(),dataleaks:(0,i.makeWSDataLeaks)(),devices:(0,s.makeWSDevices)(),iconCrawler:(0,_.makeWSIconCrawler)(),itemGroup:(0,g.makeItemGroupWS)(),premium:(0,c.makeWSPremium)(),recovery:(0,l.makeWSRecovery)(),settings:(0,S.makeWSSettings)(),strongAuth:(0,u.makeWSStrongAuth)(),teamPlans:(0,d.makeWSTeamPlans)(),userAlias:(0,p.makeWSUserAlias)(),sharing:(0,y.makeSharingWS)(),userGroup:(0,A.makeUserGroupWS)(),qa:(0,m.makeWSQA)(),userActivity:(0,h.makeWSUserActivity)(),secureFile:(0,T.makeWSSecureFile)()})},50783:function(e,t,r){var a;Object.defineProperty(t,"__esModule",{value:!0}),t._makeRequest=t.WsError=void 0;let o=r(36598),n=r(21837),i=r(86454),s=r(77644),c=r(3314);(a=t.WsError||(t.WsError={}))[a.THROTTLED=-999]="THROTTLED",t._makeRequest=function(e,t,r,a,l){let u=`${c.config.DASHLANE_WS_HOST_WITH_SCHEME}/${t}/${e}/${r}`,d={...l,headers:{...(0,i.getCloudflareHeaders)()}};return(0,o.postDataToUrl)(u,a,d).then(e=>(function(e,t){if("string"==typeof t)return t;if(429===t.code||t.error&&-32600===t.error.code)throw new n.CarbonError(s.WSError,s.WSErrorCode.THROTTLED).addAdditionalInfo({webService:e});if("code"in t&&200!==t.code||"success"in t&&!t.success||"error"in t&&t.error)throw new n.CarbonError(s.WSError,s.WSErrorCode.REQUEST_FAILED).addAdditionalInfo({webService:e,message:t.message,webServiceSubMessage:t.content?.message||t.content?.error||t.content,code:t.code});return t})(u,"string"==typeof e?e:e.data))}},12387:function(e,t){var r,a;Object.defineProperty(t,"__esModule",{value:!0}),t.KWXMLError=t.KWXMLErrorMessages=t.KWXMLErrorCode=void 0,(a=r=t.KWXMLErrorCode||(t.KWXMLErrorCode={}))[a.PARSING_FAILED=0]="PARSING_FAILED",t.KWXMLErrorMessages={[r.PARSING_FAILED]:"Failed to parse Dashlane XML"},t.KWXMLError={codes:r,name:"KWXMLError",messages:t.KWXMLErrorMessages}},56708:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.findAllKWXMLElementsOfType=t.removeNamespace=t.getDashlaneXml=t.parseDashlaneXml=void 0;let a=r(25903),o=r(92546),n=r(21837),i=r(12387),s=r(29138),c=r(79937),l=r(15916);async function u(e){try{return await new Promise((t,r)=>{(0,o.parseXml)((e,a)=>e?r(e):t(a),e,{fixType:!1})})}catch(e){throw new n.CarbonError(i.KWXMLError,i.KWXMLErrorCode.PARSING_FAILED).addAdditionalInfo({libError:`${e}`})}}function d(e){var t;let r={KWAuthentifiant:l.fixCredentialTypesFromStore,KWSecureNote:l.fixNoteTypesFromStore,KWSecret:l.fixSecretTypesFromStore,KWSecurityBreach:l.fixBreachTypesFromStore,KWSettingsManagerApp:c.fixPersonalSettingTypes.fromStore},o=(0,a.compose)((0,a.reject)(a.isNil),(0,a.omit)((0,a.defaultTo)([],{KWAuthentifiant:["domainIcon"],KWSettingsManagerApp:["kwType","LastBackupTime","Id"]}[e.kwType])))((t={kwType:"__type__"},function e(r){return(0,s.default)(r)?Object.keys(r).reduce((o,n)=>{let i=t[n]||n,c=r[n];return Array.isArray(c)?o[i]=c.map((0,a.unary)(e)):(0,s.default)(c)?o[i]=e(c):o[i]=c,o},{}):r}(e)));return r[e.kwType]&&(o=r[e.kwType](o)),o}function p(e){if(!e.includes(":"))return e;{let t=e.indexOf(":");return e.substring(t+1,e.length)}}t.parseDashlaneXml=u,t.getDashlaneXml=function(e){let t=Array.isArray(e)?(0,a.map)(d,e):d(e);return(0,o.toXml)(t,{pretty:!1,allowEmpty:!0})},t.removeNamespace=p,t.findAllKWXMLElementsOfType=function e(t,r,a=[]){if(p(t.__type__)===r&&a.push(t),t.__children__&&t.__children__.length>0)for(let n=0;n<t.__children__.length;n++){let i=t.__children__[n];(0,o.isKWXMLElement)(i)&&e(i,r,a)}return a}},59889:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.config=void 0;let a=r(52211),o=r(37068),n=r(1312),i=r(76991),s=r(17872),c=r(412);t.config={commands:{abortDeviceLimitFlow:{handler:c.abortDeviceLimitFlow},loginViaSSO:{handler:a.loginViaSSO},unlinkPreviousDevice:{handler:n.unlinkPreviousDevice},unlinkMultipleDevices:{handler:i.unlinkMultipleDevices}},queries:{getLoginDeviceLimitFlow:{selector:o.viewedLoginDeviceLimitFlowSelector}},liveQueries:{liveLoginDeviceLimitFlow:{operator:s.loginDeviceLimitFlowView$}}}},38366:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.unlinkMultipleDevicesErrorReached=t.multipleDevicesLimitStillReached=t.oneDeviceLimitStillReached=t.sessionOpenedAfterDeviceLimitRemoval=t.refreshDeviceLimitStatusFailed=t.deviceLimitRemoved=t.deviceLimitStatusUpdated=t.unlinkingSucceeded=t.unlinkingFailed=t.unlinkingMultipleDevicesRequested=t.unlinkPreviousDeviceRequested=t.multipleDevicesLimitReached=t.oneDeviceLimitReached=t.UNLINK_MULTIPLE_DEVICES_ERROR=t.UNLINKING_SUCCEEDED=t.UNLINKING_FAILED=t.UNLINK_MULTIPLE_DEVICES_REQUESTED=t.UNLINK_PREVIOUS_DEVICE_REQUESTED=t.SESSION_OPENED_AFTER_DEVICE_LIMIT_REMOVAL=t.REFRESH_DEVICE_LIMIT_STATUS_FAILED=t.MULTIPLE_DEVICES_LIMIT_STILL_REACHED=t.MULTIPLE_DEVICES_LIMIT_REACHED=t.ONE_DEVICE_LIMIT_STILL_REACHED=t.ONE_DEVICE_LIMIT_REACHED=t.DEVICE_LIMIT_STATUS_UPDATED=t.DEVICE_LIMIT_REMOVED=void 0,t.DEVICE_LIMIT_REMOVED="DEVICE_LIMIT_REMOVED",t.DEVICE_LIMIT_STATUS_UPDATED="DEVICE_LIMIT_STATUS_UPDATED",t.ONE_DEVICE_LIMIT_REACHED="ONE_DEVICE_LIMIT_REACHED",t.ONE_DEVICE_LIMIT_STILL_REACHED="ONE_DEVICE_LIMIT_STILL_REACHED",t.MULTIPLE_DEVICES_LIMIT_REACHED="MULTIPLE_DEVICES_LIMIT_REACHED",t.MULTIPLE_DEVICES_LIMIT_STILL_REACHED="MULTIPLE_DEVICES_LIMIT_STILL_REACHED",t.REFRESH_DEVICE_LIMIT_STATUS_FAILED="REFRESH_DEVICE_LIMIT_STATUS_FAILED",t.SESSION_OPENED_AFTER_DEVICE_LIMIT_REMOVAL="SESSION_OPENED_AFTER_DEVICE_LIMIT_REMOVAL",t.UNLINK_PREVIOUS_DEVICE_REQUESTED="UNLINK_PREVIOUS_DEVICE_REQUESTED",t.UNLINK_MULTIPLE_DEVICES_REQUESTED="UNLINK_MULTIPLE_DEVICES_REQUESTED",t.UNLINKING_FAILED="UNLINKING_FAILED",t.UNLINKING_SUCCEEDED="UNLINKING_SUCCEEDED",t.UNLINK_MULTIPLE_DEVICES_ERROR="UNLINK_MULTIPLE_DEVICES_ERROR",t.oneDeviceLimitReached=e=>({type:t.ONE_DEVICE_LIMIT_REACHED,deviceLimitStatus:e.deviceLimitStatus,login:e.login,subscriptionCode:e.subscriptionCode}),t.multipleDevicesLimitReached=e=>({type:t.MULTIPLE_DEVICES_LIMIT_REACHED,deviceLimitStatus:e.deviceLimitStatus,login:e.login,subscriptionCode:e.subscriptionCode}),t.unlinkPreviousDeviceRequested=()=>({type:t.UNLINK_PREVIOUS_DEVICE_REQUESTED}),t.unlinkingMultipleDevicesRequested=()=>({type:t.UNLINK_MULTIPLE_DEVICES_REQUESTED}),t.unlinkingFailed=()=>({type:t.UNLINKING_FAILED}),t.unlinkingSucceeded=()=>({type:t.UNLINKING_SUCCEEDED}),t.deviceLimitStatusUpdated=()=>({type:t.DEVICE_LIMIT_STATUS_UPDATED}),t.deviceLimitRemoved=()=>({type:t.DEVICE_LIMIT_REMOVED}),t.refreshDeviceLimitStatusFailed=()=>({type:t.REFRESH_DEVICE_LIMIT_STATUS_FAILED}),t.sessionOpenedAfterDeviceLimitRemoval=()=>({type:t.SESSION_OPENED_AFTER_DEVICE_LIMIT_REMOVAL}),t.oneDeviceLimitStillReached=e=>({type:t.ONE_DEVICE_LIMIT_STILL_REACHED,updatedDeviceLimitStatus:e.updatedDeviceLimitStatus}),t.multipleDevicesLimitStillReached=e=>({type:t.MULTIPLE_DEVICES_LIMIT_STILL_REACHED,updatedDeviceLimitStatus:e.updatedDeviceLimitStatus}),t.unlinkMultipleDevicesErrorReached=e=>({type:t.UNLINK_MULTIPLE_DEVICES_ERROR,retryPayload:e.retryPayload})},91042:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.getEmptyLoginDeviceLimitFlowState=void 0;let a=r(38366),o=r(47939),n=r(91783),i=r(20648),s=(e,t)=>t.type===a.ONE_DEVICE_LIMIT_REACHED?(0,o.atOneDeviceLimitReachedStage)({login:t.login,subscriptionCode:t.subscriptionCode,deviceLimitStatus:t.deviceLimitStatus}):t.type===a.MULTIPLE_DEVICES_LIMIT_REACHED?(0,o.atMultipleDevicesLimitReachedStage)({login:t.login,subscriptionCode:t.subscriptionCode,deviceLimitStatus:t.deviceLimitStatus}):e,c=(e,t)=>{switch(t.type){case a.UNLINK_PREVIOUS_DEVICE_REQUESTED:return(0,o.atUnlinkingAndOpeningSessionStage)(e);case a.DEVICE_LIMIT_STATUS_UPDATED:return(0,o.atRefreshingDeviceLimitStatusStage)(e)}return e},l=(e,t)=>{switch(t.type){case a.UNLINK_MULTIPLE_DEVICES_REQUESTED:return(0,o.atUnlinkingAndOpeningSessionStage)(e);case a.DEVICE_LIMIT_STATUS_UPDATED:return(0,o.atRefreshingDeviceLimitStatusStage)(e)}return e},u=(e,t)=>{switch(t.type){case a.UNLINK_MULTIPLE_DEVICES_ERROR:return(0,o.atUnlinkMultipleDevicesErrorStage)({...e,retryPayload:t.retryPayload});case a.UNLINK_MULTIPLE_DEVICES_REQUESTED:return(0,o.atUnlinkingAndOpeningSessionStage)(e);case a.UNLINKING_SUCCEEDED:return(0,o.atDeviceLimitDoneStage)(e)}return e},d=e=>{let{deviceLimitStatus:t}=e;switch(t._tag){case"limitedToOneDevice":return(0,o.atOneDeviceLimitReachedStage)({...e,deviceLimitStatus:t});case"limitedToMultipleDevices":return(0,o.atMultipleDevicesLimitReachedStage)({...e,deviceLimitStatus:t});default:(0,n.assertUnreachable)(t)}},p=(e,t)=>{switch(t.type){case a.ONE_DEVICE_LIMIT_STILL_REACHED:return(0,o.atOneDeviceLimitReachedStage)({...e,deviceLimitStatus:t.updatedDeviceLimitStatus});case a.MULTIPLE_DEVICES_LIMIT_STILL_REACHED:return(0,o.atMultipleDevicesLimitReachedStage)({...e,deviceLimitStatus:t.updatedDeviceLimitStatus});case a.REFRESH_DEVICE_LIMIT_STATUS_FAILED:return d(e);case a.DEVICE_LIMIT_REMOVED:return(0,o.atOpeningSessionAfterDeviceLimitRemovalStage)(e)}return e},S=(e,t)=>{switch(t.type){case a.UNLINKING_SUCCEEDED:return(0,o.atDeviceLimitDoneStage)(e);case a.UNLINKING_FAILED:return d(e);case a.UNLINK_MULTIPLE_DEVICES_ERROR:return(0,o.atUnlinkMultipleDevicesErrorStage)({...e,retryPayload:t.retryPayload})}return e};function g(){return{flow:null}}t.default=(e=g(),t)=>{if(null===e.flow)return{flow:s(null,t)};switch(e.flow.name){case i.LoginDeviceLimitFlowStage.OneDeviceLimitReached:return{flow:c(e.flow,t)};case i.LoginDeviceLimitFlowStage.UnlinkingMultipleDevicesError:return{flow:u(e.flow,t)};case i.LoginDeviceLimitFlowStage.MultipleDevicesLimitReached:return{flow:l(e.flow,t)};case i.LoginDeviceLimitFlowStage.RefreshingDeviceLimitStatus:return{flow:p(e.flow,t)};case i.LoginDeviceLimitFlowStage.UnlinkingAndOpeningSession:return{flow:S(e.flow,t)};case i.LoginDeviceLimitFlowStage.OpeningSessionAfterDeviceLimitRemoval:case i.LoginDeviceLimitFlowStage.DeviceLimitDone:return e;default:return(0,n.assertUnreachable)(e.flow)}},t.getEmptyLoginDeviceLimitFlowState=g},412:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.abortDeviceLimitFlow=void 0;let a=r(20648),o=r(96131),n=r(80896);async function i(e){let{sessionService:t}=e;try{return await t.getInstance().user.closeSession(),{success:!0}}catch(t){let e=(0,o.augmentDeviceLimitError)(t,"abortDeviceLimitFlow");return(0,n.sendExceptionLog)({error:e}),{success:!1,error:{code:a.AbortDeviceLimitFlowError.UnexpectedError}}}}t.abortDeviceLimitFlow=i},35191:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.getPairingGroupDevices=t.findMyPairingGroup=t.isDevicePartOfPairingGroup=t.isDesktopPlatform=void 0;let a=r(20648);t.isDesktopPlatform=e=>e===a.Platform.DesktopLegacyWindows||e===a.Platform.DesktopLegacyMacOS||e===a.Platform.DesktopUWP,t.isDevicePartOfPairingGroup=(e,t)=>t.devices.includes(e.deviceId),t.findMyPairingGroup=(e,t)=>e.find(e=>e.pairingGroupUUID===t),t.getPairingGroupDevices=(e,t)=>t.filter(({deviceId:t})=>e.devices.includes(t))},32466:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.makeDeviceInfoService=void 0;let a=r(25903),o=r(28323),n=r(20648),i={[n.Platform.Android]:"server_android",[n.Platform.CarbonTests]:"server_carbon_tests",[n.Platform.CarbonUnknown]:"server_carbon_unknown",[n.Platform.DesktopLegacyMacOS]:"server_macosx",[n.Platform.DesktopLegacyWindows]:"server_win",[n.Platform.DesktopUWP]:"desktop_win",[n.Platform.IPad]:"server_ipad",[n.Platform.IPhone]:"server_iphone",[n.Platform.IPod]:"server_ipod",[n.Platform.StandaloneExtension]:"server_standalone",[n.Platform.TeamAdminConsole]:"server_tac",[n.Platform.WebApp]:"server_leeloo",[n.Platform.WebAppDev]:"server_leeloo_dev"},s=(0,a.invertObj)(i),c=e=>s[e],l=e=>({deviceId:e.deviceId,deviceName:e.deviceName,devicePlatform:c(e.devicePlatform),lastActivityDate:e.lastActivityDateUnix,isBucketOwner:e.isBucketOwner,temporary:e.temporary}),u=e=>({pairingGroupUUID:e.pairingGroupUUID,devices:e.devices,isBucketOwner:e.isBucketOwner}),d=async(e,t)=>{let r=await o.listDevices(e,t);if(o.isApiError(r))throw Error(`Failed to get devices: ${r.message}`);return{devices:r.devices.map(l),pairingGroups:r.pairingGroups.map(u)}};t.makeDeviceInfoService=e=>({getDevicesInfo:t=>d(e,t)})},62459:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.toPlatformView=void 0;let a=r(20648),o={[a.Platform.Android]:a.PlatformView.Android,[a.Platform.CarbonTests]:a.PlatformView.Other,[a.Platform.CarbonUnknown]:a.PlatformView.Other,[a.Platform.DesktopLegacyMacOS]:a.PlatformView.DesktopMacOS,[a.Platform.DesktopLegacyWindows]:a.PlatformView.DesktopWindows,[a.Platform.DesktopUWP]:a.PlatformView.DesktopWindows,[a.Platform.IPad]:a.PlatformView.IPad,[a.Platform.IPhone]:a.PlatformView.IPhone,[a.Platform.IPod]:a.PlatformView.IPod,[a.Platform.StandaloneExtension]:a.PlatformView.StandaloneExtension,[a.Platform.TeamAdminConsole]:a.PlatformView.TeamAdminConsole,[a.Platform.WebApp]:a.PlatformView.WebApp,[a.Platform.WebAppDev]:a.PlatformView.WebApp};t.toPlatformView=e=>o[e]},56770:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.DeviceLimitCapabilityEventBus=void 0,t.DeviceLimitCapabilityEventBus=class{constructor(e,t){this.services=e,this.connector=t}register(e){let t=[];return Object.keys(e).forEach(r=>{let{handler:a}=e[r],o=this.connector[r].on(()=>a(this.services));t.push(o)}),()=>{t.forEach(e=>e())}}}},34789:function(e,t,r){let a;Object.defineProperty(t,"__esModule",{value:!0}),t.getDeviceLimitFlowEventsManager=t.DeviceLimitFlowEventsManager=void 0;let o=r(42387),n=r(17872),i=r(15237);class s{constructor(e){this.registrations=[],e.getState$().pipe((0,n.loginDeviceLimitFlow$)(),(0,i.pairwise)()).subscribe(this.onTransition.bind(this))}addEventListener(e,t){let r=(0,o.v4)();return this.registrations.push({id:r,event:e,listener:t}),r}removeTransitionEventListener(e){this.registrations=this.registrations.filter(t=>t.id!==e)}onTransition([e,t]){this.registrations.forEach(({event:r,listener:a})=>{("exit"===r.type&&r.from===e?.name||"entry"===r.type&&r.to===t?.name)&&a(r)})}}t.DeviceLimitFlowEventsManager=s,t.getDeviceLimitFlowEventsManager=e=>(a||(a=new s(e)),a)},47939:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.atUnlinkMultipleDevicesErrorStage=t.atDeviceLimitDoneStage=t.atRefreshingDeviceLimitStatusStage=t.atOpeningSessionAfterDeviceLimitRemovalStage=t.atUnlinkingAndOpeningSessionStage=t.atMultipleDevicesLimitReachedStage=t.atOneDeviceLimitReachedStage=void 0;let a=r(20648);t.atOneDeviceLimitReachedStage=e=>({...e,name:a.LoginDeviceLimitFlowStage.OneDeviceLimitReached}),t.atMultipleDevicesLimitReachedStage=e=>({...e,name:a.LoginDeviceLimitFlowStage.MultipleDevicesLimitReached}),t.atUnlinkingAndOpeningSessionStage=e=>({...e,name:a.LoginDeviceLimitFlowStage.UnlinkingAndOpeningSession}),t.atOpeningSessionAfterDeviceLimitRemovalStage=e=>({...e,name:a.LoginDeviceLimitFlowStage.OpeningSessionAfterDeviceLimitRemoval}),t.atRefreshingDeviceLimitStatusStage=e=>({...e,name:a.LoginDeviceLimitFlowStage.RefreshingDeviceLimitStatus}),t.atDeviceLimitDoneStage=e=>({...e,name:a.LoginDeviceLimitFlowStage.DeviceLimitDone}),t.atUnlinkMultipleDevicesErrorStage=e=>({...e,deviceLimitStatus:e.deviceLimitStatus,name:a.LoginDeviceLimitFlowStage.UnlinkingMultipleDevicesError})},17872:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.loginDeviceLimitFlowView$=t.loginDeviceLimitFlow$=void 0;let a=r(95121),o=r(15237),n=r(37068);t.loginDeviceLimitFlow$=()=>(0,a.pipe)((0,o.map)(n.loginDeviceLimitFlowSelector),(0,o.distinctUntilChanged)((e,t)=>e?.name===t?.name)),t.loginDeviceLimitFlowView$=()=>(0,a.pipe)((0,o.map)(n.viewedLoginDeviceLimitFlowSelector),(0,o.distinctUntilChanged)((e,t)=>e?.name===t?.name))},37068:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.viewedLoginDeviceLimitFlowSelector=t.loginDeviceLimitFlowSelector=void 0;let a=r(79660);t.loginDeviceLimitFlowSelector=e=>e.userSession.loginDeviceLimitFlow.flow,t.viewedLoginDeviceLimitFlowSelector=e=>{let r=(0,t.loginDeviceLimitFlowSelector)(e);return r?(0,a.toLoginDeviceLimitFlowView)(r):null}},79660:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.toLoginDeviceLimitFlowView=t.toMultipleDevicesLimitErrorStageView=t.toMultipleDevicesLimitReachedStageView=void 0;let a=r(20648),o=r(99626),n=r(4968),i=r(91783),s=e=>({name:a.LoginDeviceLimitFlowStage.OneDeviceLimitReached,login:e.login,previousDevice:(0,o.toPreviousDeviceInfo)(e.deviceLimitStatus.bucketOwner),subscriptionCode:e.subscriptionCode});t.toMultipleDevicesLimitReachedStageView=e=>({name:a.LoginDeviceLimitFlowStage.MultipleDevicesLimitReached,login:e.login,devicesToDeactivate:e.deviceLimitStatus.devices.map(n.toDeviceToDeactivateInfoView),subscriptionCode:e.subscriptionCode}),t.toMultipleDevicesLimitErrorStageView=e=>({name:a.LoginDeviceLimitFlowStage.UnlinkingMultipleDevicesError,login:e.login,retryPayload:e.retryPayload,subscriptionCode:e.subscriptionCode});let c=(e,t)=>({name:e,login:t});t.toLoginDeviceLimitFlowView=e=>{switch(e.name){case a.LoginDeviceLimitFlowStage.OneDeviceLimitReached:return s(e);case a.LoginDeviceLimitFlowStage.MultipleDevicesLimitReached:return(0,t.toMultipleDevicesLimitReachedStageView)(e);case a.LoginDeviceLimitFlowStage.UnlinkingAndOpeningSession:case a.LoginDeviceLimitFlowStage.DeviceLimitDone:case a.LoginDeviceLimitFlowStage.RefreshingDeviceLimitStatus:case a.LoginDeviceLimitFlowStage.OpeningSessionAfterDeviceLimitRemoval:return c(e.name,e.login);case a.LoginDeviceLimitFlowStage.UnlinkingMultipleDevicesError:return(0,t.toMultipleDevicesLimitErrorStageView)(e);default:return(0,i.assertUnreachable)(e)}}},66560:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.startDeviceLimitFlow=t.getDeviceLimitStatus=t.attemptGetDeviceLimitStatus=void 0;let a=r(93748),o=r(25392),n=r(64516),i=r(28639),s=r(32466),c=r(97815),l=r(38366),u=r(27762),d=r(59565),p=r(21837),S=r(74907),g=r(29509),m=()=>new Promise(e=>setTimeout(()=>e((0,c.noDeviceLimit)()),3e3)),y=e=>{if(!(0,p.isCarbonError)(e,S.HttpError,S.HttpErrorCode.NETWORK_ERROR)&&!(0,p.isCarbonError)(e,S.HttpError,S.HttpErrorCode.CONNECTION_ABORTED)&&!(0,p.isCarbonError)(e,S.HttpError,S.HttpErrorCode.CONNECTION_TIMED_OUT))throw e;return(0,c.noDeviceLimit)()},f=async e=>{try{return await Promise.race([(0,t.getDeviceLimitStatus)(e),m()])}catch(e){return y(e)}};t.attemptGetDeviceLimitStatus=f;let E=async e=>{let{storeService:t,moduleClients:r}=e,l=t.getState();if((0,d.isSSOUserSelector)(l))return(0,c.noDeviceLimit)();let p=(0,o.pairingIdSelector)(l),S=(0,a.premiumStatusSelector)(l),m=(0,a.userLoginSelector)(l),y=(0,s.makeDeviceInfoService)(t),f=await y.getDevicesInfo(m),E=await (0,g.getDeviceAccessKeysFromSession)(r.session,m),A=(0,u.deviceKeysSelector)(t.getState()),h=(0,n.isOneDeviceLimitApplicable)(p,f,E,S);if("limitedToOneDevice"===h._tag)return(0,c.limitedToOneDevice)(h.bucketOwner);let _=(0,i.isMultipleDevicesLimitApplicable)(f,S,A);return"limitedToMultipleDevices"===_._tag?(0,c.limitedToMultipleDevices)(_.devices):(0,c.noDeviceLimit)()};t.getDeviceLimitStatus=E;let A=async(e,t)=>{let{sessionService:r,storeService:o}=e,n=o.getState(),i=(0,a.userLoginSelector)(n),s=r.getInstance().user,c=await s.fetchSubscriptionCode();if("limitedToOneDevice"===t._tag){let e=(0,l.oneDeviceLimitReached)({deviceLimitStatus:t,subscriptionCode:c,login:i});o.dispatch(e)}else if("limitedToMultipleDevices"===t._tag){let e=(0,l.multipleDevicesLimitReached)({deviceLimitStatus:t,subscriptionCode:c,login:i});o.dispatch(e)}};t.startDeviceLimitFlow=A},97815:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.noDeviceLimit=t.limitedToMultipleDevices=t.limitedToOneDevice=void 0,t.limitedToOneDevice=e=>({_tag:"limitedToOneDevice",bucketOwner:e}),t.limitedToMultipleDevices=e=>({_tag:"limitedToMultipleDevices",devices:e}),t.noDeviceLimit=()=>({_tag:"noDeviceLimit"})},79455:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.refreshDeviceLimitStatus=void 0;let a=r(80896),o=r(72287),n=r(96131),i=r(38366),s=r(66560),c=async e=>{let{sessionService:t,storeService:r}=e;try{await (0,o.sessionDidOpen)(e),r.dispatch((0,i.sessionOpenedAfterDeviceLimitRemoval)())}catch(o){(0,n.notifyDeviceLimitError)(e,o);let r=(0,n.augmentDeviceLimitError)(o,"openSessionAfterDeviceLimitRemoval");(0,a.sendExceptionLog)({error:r}),t.close()}},l=async e=>{let{sessionService:t,storeService:r}=e;try{let a=t.getInstance().user;await a.refreshSessionData();let o=await (0,s.getDeviceLimitStatus)(e);if("noDeviceLimit"===o._tag)r.dispatch((0,i.deviceLimitRemoved)()),await c(e);else if("limitedToOneDevice"===o._tag){let e=(0,i.oneDeviceLimitStillReached)({updatedDeviceLimitStatus:o});r.dispatch(e)}else if("limitedToMultipleDevices"===o._tag){let e=(0,i.multipleDevicesLimitStillReached)({updatedDeviceLimitStatus:o});r.dispatch(e)}}catch(t){r.dispatch((0,i.refreshDeviceLimitStatusFailed)());let e=(0,n.augmentDeviceLimitError)(t,"refreshDeviceLimitStatus");(0,a.sendExceptionLog)({error:e})}};t.refreshDeviceLimitStatus=l},96131:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.augmentDeviceLimitError=t.notifyDeviceLimitError=void 0;let a=r(20648),o=r(62071),n=e=>"object"==typeof e&&e instanceof Error,i=e=>n(e)?e.message:"No valid error reported";async function s(e,t){let{storeService:r}=e,n=(0,o.addNewLoginNotification)({type:a.LoginNotificationType.UNKNOWN_ERROR,message:i(t)});r.dispatch(n)}t.notifyDeviceLimitError=s,t.augmentDeviceLimitError=function(e,t){let r=Error(`[DeviceLimit] - ${t}: ${i(e)}`);return n(e)&&(r.stack=e.stack),r}},28639:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.isMultipleDevicesLimitApplicable=void 0;let a=r(61792),o=({pairingGroups:e,devices:t})=>{let r=t.filter(t=>!e.find(e=>e.devices.includes(t.deviceId))&&t,[]);return{pairingGroups:e,nonPairedDevices:r}},n=(e,t)=>t.lastActivityDate-e.lastActivityDate,i=({pairingGroups:e,devices:t,nonPairedDevices:r,deviceKeys:a})=>{let o=[...t].sort(n),i=[];for(let r of e){let e;e=r.devices.includes(a?.accessKey)?{...t.find(e=>e.deviceId===a?.accessKey),isCurrentDevice:!0}:o.find(e=>r.devices.includes(e.deviceId)),i.push({...e,deviceId:r.pairingGroupUUID,isPairingGroup:!0})}return[...i,...r.map(e=>e.deviceId===a?.accessKey?{...e,isCurrentDevice:!0}:e)].sort(n)};t.isMultipleDevicesLimitApplicable=(e,t,r)=>{if(1>=(t?.capabilities?.devicesLimit?.info?.limit||0))return(0,a.notLimitedToMultipleDevices)();let{nonPairedDevices:n,pairingGroups:s}=o(e);if(t.capabilities.devicesLimit.info.limit<n.length+s.length){let t=i({devices:e.devices,nonPairedDevices:n,pairingGroups:s,deviceKeys:r});return(0,a.limitedToMultipleDevices)(t)}return(0,a.notLimitedToMultipleDevices)()}},61792:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.limitedToMultipleDevices=t.notLimitedToMultipleDevices=void 0,t.notLimitedToMultipleDevices=()=>({_tag:"notLimitedToMultipleDevices"}),t.limitedToMultipleDevices=e=>({_tag:"limitedToMultipleDevices",devices:e})},4968:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.toDeviceToDeactivateInfoView=void 0;let a=r(20648),o=r(62459);t.toDeviceToDeactivateInfoView=e=>({...e,platform:e.devicePlatform?(0,o.toPlatformView)(e.devicePlatform):a.PlatformView.Other})},64516:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.getMonoBucketOwner=t.isOneDeviceLimitApplicable=void 0;let a=r(25903),o=r(35191),n=r(12010);function i(e){let{devices:t,pairingGroups:r}=e,n=null,i=t.find(e=>e.isBucketOwner)??null;if(!i&&(n=r.find(e=>e.isBucketOwner)??null)){let e=(0,o.getPairingGroupDevices)(n,t);e.sort((e,t)=>e.lastActivityDate-t.lastActivityDate);let r=(0,a.partition)(e=>!!(e.devicePlatform&&(0,o.isDesktopPlatform)(e.devicePlatform)),e);i=(0,a.unnest)(r)[0]||null}return{bucketOwner:i,bucketOwnerPairingGroup:n}}t.isOneDeviceLimitApplicable=function(e,t,r,a){let{bucketOwner:s,bucketOwnerPairingGroup:c}=i(t),{pairingGroups:l}=t;if(a?.capabilities?.devicesLimit?.info?.limit!==1)return(0,n.notLimitedToOneDevice)();let u=!!c&&!!e&&c.pairingGroupUUID===e,d=(0,o.findMyPairingGroup)(l,e??""),p=!!s&&!!d&&(0,o.isDevicePartOfPairingGroup)(s,d);return!s||s.deviceId===r||u||p?(0,n.notLimitedToOneDevice)():(0,n.limitedToOneDevice)(s)},t.getMonoBucketOwner=i},12010:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.notLimitedToOneDevice=t.limitedToOneDevice=void 0,t.limitedToOneDevice=e=>({_tag:"limitedToOneDevice",bucketOwner:e}),t.notLimitedToOneDevice=()=>({_tag:"notLimitedToOneDevice"})},99626:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.toPreviousDeviceInfo=void 0;let a=r(20648),o=r(62459);t.toPreviousDeviceInfo=({deviceName:e,devicePlatform:t,lastActivityDate:r})=>({name:e??"",platform:t?(0,o.toPlatformView)(t):a.PlatformView.Other,lastActive:r})},65824:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.setupDeviceLimitEventBus=void 0;let a=r(79455),o=r(38366),n=r(20648),i={deviceLimitCapabilityUpdated:{handler:e=>{let t=(0,o.deviceLimitStatusUpdated)();e.storeService.dispatch(t),(0,a.refreshDeviceLimitStatus)(e)}}},s={type:"entry",to:n.LoginDeviceLimitFlowStage.OneDeviceLimitReached},c={type:"exit",from:n.LoginDeviceLimitFlowStage.OneDeviceLimitReached},l={type:"entry",to:n.LoginDeviceLimitFlowStage.MultipleDevicesLimitReached},u={type:"exit",from:n.LoginDeviceLimitFlowStage.MultipleDevicesLimitReached};t.setupDeviceLimitEventBus=(e,t)=>{let r;let a=()=>r=e.register(i),o=()=>r();t.addEventListener(s,a),t.addEventListener(c,o),t.addEventListener(l,a),t.addEventListener(u,o)}},76991:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.unlinkMultipleDevices=void 0;let a=r(20648),o=r(93748),n=r(28323),i=r(28639),s=r(72287),c=r(62071),l=r(32466),u=r(38366),d=r(96131),p=r(80896),S=r(27762),g=async(e,t,r)=>{let{storeService:a}=e,o=e=>{let t=(0,u.unlinkMultipleDevicesErrorReached)({retryPayload:r});return a.dispatch(t),{success:!1,error:{code:e.code}}};try{let e=await (0,n.deactivateDevices)(a,t,r);if((0,n.isApiError)(e)&&e.code!==n.CLIENT_DEVICES_NOT_FOUND&&e.code!==n.PAIRING_GROUPS_NOT_FOUND)return o(e)}catch(e){return o(e)}},m=async(e,t)=>{let{storeService:r}=e,n=r.getState(),s=(0,o.premiumStatusSelector)(n),d=(0,l.makeDeviceInfoService)(r),p=await d.getDevicesInfo(t),g=(0,S.deviceKeysSelector)(r.getState()),m=(0,i.isMultipleDevicesLimitApplicable)(p,s,g);if("limitedToMultipleDevices"===m._tag){r.dispatch((0,u.deviceLimitStatusUpdated)());let e=(0,c.addNewLoginNotification)({type:a.LoginNotificationType.UNKNOWN_ERROR,message:`${a.USER_STILL_OVERFLOWING}`});r.dispatch(e);let t=(0,u.multipleDevicesLimitStillReached)({updatedDeviceLimitStatus:{_tag:"limitedToMultipleDevices",devices:m.devices}});return r.dispatch(t),{success:!1,error:{code:a.USER_STILL_OVERFLOWING}}}return!1},y=async(e,t)=>{let{storeService:r,sessionService:n}=e,i=r.getState(),c=(0,o.userLoginSelector)(i);r.dispatch((0,u.unlinkingMultipleDevicesRequested)());let l=await g(e,c,t);if(l)return l;let S=await m(e,c);if(S)return S;try{return await (0,s.sessionDidOpen)(e),r.dispatch((0,u.unlinkingSucceeded)()),{success:!0}}catch(t){return n.close(!1),(0,d.notifyDeviceLimitError)(e,t),r.dispatch((0,u.unlinkingFailed)()),(0,p.sendExceptionLog)({error:(0,d.augmentDeviceLimitError)(t,"unlinkMultipleDevices")}),{success:!1,error:{code:a.UNEXPECTED_ERROR}}}};t.unlinkMultipleDevices=y},1312:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.unlinkPreviousDevice=void 0;let a=r(72287),o=r(38366),n=r(96131),i=r(80896),s=r(20648);async function c(e){let{storeService:t}=e;try{return t.dispatch((0,o.unlinkPreviousDeviceRequested)()),await (0,a.sessionDidOpen)(e),t.dispatch((0,o.unlinkingSucceeded)()),{success:!0}}catch(a){t.dispatch((0,o.unlinkingFailed)()),(0,n.notifyDeviceLimitError)(e,a);let r=(0,n.augmentDeviceLimitError)(a,"unlinkPreviousDevice");return(0,i.sendExceptionLog)({error:r}),{success:!1,error:{code:s.UnlinkPreviousDeviceError.UnexpectedError}}}}t.unlinkPreviousDevice=c},72287:function(e,t,r){var a,o;Object.defineProperty(t,"__esModule",{value:!0}),t.DifferentLoginAuthorized=t.sessionDidOpen=t.openSessionWithMasterPassword=t.updateSessionUponLoginAction=t.makeLoginController=void 0;let n=r(83533),i=r(20648),s=r(27698),c=r(45407),l=r(49087),u=r(73547),d=r(27698),p=r(49789),S=r(31935),g=r(30029),m=r(15535),y=r(4455),f=r(6956),E=r(30350),A=r(36598),h=r(18040),_=r(58361),T=r(52780),v=r(29509),I=r(65356),D=r(15876),P=r(92846),O=r(32501),C=r(6833),b=r(22089),R=r(97806),N=r(93748),w=r(59565),L=r(7108),U=r(4790),M=r(10039),F=r(76380),k=r(66965),K=r(25392),B=r(66560),G=r(15346),j=r(4544),V=r(28323),W=r(23555),H=r(71802),x=r(95121),Y=r(77323),q=r(72620),$=r(97880);async function Q(e,t){await c.askServerToSendToken(e,t),d.triggerOpenSessionTokenSent({isResendAction:!0,login:t})}async function z(e,t,r){let{storeService:o,sessionService:s,wsService:c,storageService:l,moduleClients:u}=e;t=(0,A.normalizeEmail)(t);try{let p=r&&r.password;await Z(e,t,p,{authorizeDifferentLogin:a.AUTHORIZED});let g=await s.getInstance().user.accountExistsLocally(),m=await eg(o,l,u["carbon-legacy"],c,g),f=(0,H.accountAuthenticationTypeSelector)(o.getState());if("invisibleMasterPassword"===f)return d.triggerOpenSessionMasterPasswordLess(),i.LoginResultEnum.MasterPasswordLess;switch(m){case i.AuthenticationCode.SSO_LOGIN_BYPASS:return(0,b.sendAskSSOAuthenticationEventLog)(e,n.VerificationMode.None),d.triggerOpenSessionSsoRedirectionToIdpRequired((0,G.triggerServiceProviderUrlRedirect)(o.getState(),t),(0,w.ssoProviderInfoSelector)(o.getState()).isNitroProvider),i.LoginResultEnum.SSOLogin;case i.AuthenticationCode.ASK_MASTER_PASSWORD:if(!g)throw Error("checkLogin should never return ASK_MASTER_PASSWORD for remote accounts");if(p)return er(e,t,p);return(0,b.sendAskAuthenticationEventLog)(e,n.VerificationMode.None),o.dispatch((0,j.updateLoginStepInfoStep)(i.LoginStep.Password)),d.triggerAskMasterPassword(t),i.LoginResultEnum.MasterPasswordMissing;case i.AuthenticationCode.ASK_OTP:return(0,b.sendAskAuthenticationEventLog)(e,n.VerificationMode.Otp2),o.dispatch((0,j.updateLoginStepInfoStep)(i.LoginStep.OTP2)),d.triggerOpenSessionOTPSent({hasU2F:!1}),i.LoginResultEnum.OTPMissing;case i.AuthenticationCode.ASK_OTP_FOR_NEW_DEVICE:let{otpType:E}=o.getAccountInfo();return(0,b.sendAskAuthenticationEventLog)(e,E===S.OtpType.OTP_NEW_DEVICE?n.VerificationMode.Otp1:n.VerificationMode.Otp2),o.dispatch((0,j.updateLoginStepInfoStep)(i.LoginStep.OTP1)),d.triggerOpenSessionOTPForNewDeviceRequired(),i.LoginResultEnum.OTPMissing;case i.AuthenticationCode.ASK_TOKEN:if(g=await s.getInstance().user.accountExistsLocally())throw Error("Unexpected local account presence during email token step");return await u.authenticationFlow.commands.requestEmailTokenVerification({login:t}),(0,b.sendAskAuthenticationEventLog)(e,n.VerificationMode.EmailToken),o.dispatch((0,j.updateLoginStepInfoStep)(i.LoginStep.OTPToken)),d.triggerOpenSessionTokenSent({isResendAction:!1,login:t}),i.LoginResultEnum.TokenMissing;case i.AuthenticationCode.USE_LOCAL_UKI:if((0,v.ukiSelector)(o.getState()))return ec(e,y.PersistData.PERSIST_DATA_YES);throw Error(i.AuthenticationCode[i.AuthenticationCode.UNKNOWN_UKI]);case i.AuthenticationCode.ASK_DASHLANE_AUTHENTICATOR:if(g=await s.getInstance().user.accountExistsLocally())throw Error("Unexpected local account presence during dashlane authenticator step");return(0,b.sendAskAuthenticationEventLog)(e,n.VerificationMode.AuthenticatorApp),o.dispatch((0,j.updateLoginStepInfoStep)(i.LoginStep.DashlaneAuthenticator)),d.triggerOpenSessionDashlaneAuthenticator(),i.LoginResultEnum.DashlaneAuthenticatorApprovalMissing;default:throw Error(i.AuthenticationCode[i.AuthenticationCode.UNKNOWN_ERROR])}}catch(e){if(d.getAuthenticationCodeFromError(e)===i.AuthenticationCode.USER_DOESNT_EXIST&&(0,$.validateLoginForAccountCreation)(t)){let e;try{e=await (0,V.requestAccountCreation)(o,{login:t})}catch{}if(void 0!==e&&!(0,V.isApiError)(e)&&e.ssoServiceProviderUrl){let e=Error(i.AuthenticationCode[i.AuthenticationCode.USER_DOESNT_EXIST_SSO]);d.triggerOpenSessionFailed(e);return}}throw d.triggerOpenSessionFailed(e),e}}async function X(e,t,r,a,o){try{let{storeService:n,sessionService:s}=e;if(t=(0,A.normalizeEmail)(t),await Z(e,t,r),await s.getInstance().user.accountExistsLocally())throw Error(i.AuthenticationCode[i.AuthenticationCode.DASHLANE_AUTHENTICATOR_ASKED_FOR_LOCAL_SESSION]);let l=await c.registerDeviceWithDashlaneAuthenticator(n,a,o);if(l===i.AuthenticationCode.DASHLANE_AUTHENTICATOR_LOGIN_CANCELLED)return(0,b.sendDashlaneAuthenticatorErrorLog)(e),i.LoginResultEnum.DashlaneAuthenticatorApprovalCancelled;if(l!==i.AuthenticationCode.ASK_MASTER_PASSWORD)throw Error("unexpected status from verifyDashlaneAuthenticatorPush");if(r)return er(e,t,r,{isDataPersisted:a,loginType:"MasterPassword"});return d.triggerAskMasterPassword(t),i.LoginResultEnum.MasterPasswordMissing}catch(t){eS(t)&&(0,b.sendDashlaneAuthenticatorErrorLog)(e),d.triggerOpenSessionFailed(t)}}async function J(e,t,r,a,o,n){try{let{storeService:s,sessionService:l}=e;if(t=(0,A.normalizeEmail)(t),await Z(e,t,r),await function(e){if(!e)throw Error(i.AuthenticationCode[i.AuthenticationCode.EMPTY_TOKEN]);if(!ey.test(e))throw Error(i.AuthenticationCode[i.AuthenticationCode.TOKEN_NOT_VALID])}(a),await l.getInstance().user.accountExistsLocally())throw Error(i.AuthenticationCode[i.AuthenticationCode.TOKEN_PROVIDED_FOR_LOCAL_SESSION]);if(await c.registerDeviceWithToken(s,o,(0,y.makeEmailToken)(a),!1,t,n)!==i.AuthenticationCode.ASK_MASTER_PASSWORD)throw Error("unexpected status from verifyOtpOrToken");if(r)return er(e,t,r,{isDataPersisted:o,loginType:"MasterPassword"});return d.triggerAskMasterPassword(t),i.LoginResultEnum.MasterPasswordMissing}catch(t){throw ep(t)&&(0,b.sendEmailTokenErrorLog)(e),d.triggerOpenSessionFailed(t),t}}async function Z(e,t,r,o){let{storeService:n,sessionService:s,moduleClients:{session:c}}=e,l=await (0,x.firstValueFrom)(c.queries.selectedOpenedSession());if(!(0,Y.isSuccess)(l))throw Error(i.AuthenticationCode[i.AuthenticationCode.UNKNOWN_ERROR]);if(l.data)throw Error(i.AuthenticationCode[i.AuthenticationCode.SESSION_ALREADY_OPENED]);if(""===t)throw Error(i.AuthenticationCode[i.AuthenticationCode.EMPTY_LOGIN]);if(!(0,A.isValidLogin)(t))throw Error(i.AuthenticationCode[i.AuthenticationCode.INVALID_LOGIN]);if(n.dispatch((0,j.updateLoginStepInfoLogin)(t)),""===r)throw Error(i.AuthenticationCode[i.AuthenticationCode.EMPTY_MASTER_PASSWORD]);let u=a.FORBIDDEN;if(o&&void 0!==o.authorizeDifferentLogin&&(u=o.authorizeDifferentLogin),n.getUserLogin()&&n.getUserLogin()!==t&&(n.isAuthenticated()&&await s.close(),u===a.FORBIDDEN))throw Error(i.AuthenticationCode[i.AuthenticationCode.DIFFERENT_LOGIN_PROVIDED_WITH_TOKEN_OR_OTP]);n.hasSessionId()&&n.getUserLogin()===t&&r&&n.dispatch((0,p.updateMasterPassword)(r));let d=o&&o.serverKey;if(d&&n.dispatch((0,p.updateServerKey)(d)),n.getUserLogin()!==t||void 0===r){let e=(0,w.ssoSettingsSelector)(n.getState());await s.close(!1),s.setInstance(t,r),e.ssoToken&&n.dispatch((0,F.storeSSOSettings)(e))}}async function ee(e,t,r,a,o,n){let{storageService:s,storeService:c,sessionService:g,moduleClients:{"carbon-legacy":m}}=e;try{if(t=(0,A.normalizeEmail)(t),await Z(e,t,r),await em(a),!await g.getInstance().user.accountExistsLocally())return et(e,t,r,a,o,void 0,n);if(c.dispatch((0,p.updateisUsingBackupCode)(n)),c.getAccountInfo().otpType!==S.OtpType.OTP_LOGIN)throw Error(i.AuthenticationCode[i.AuthenticationCode.OTP_PROVIDED_FOR_LOCAL_NON_OTP_SESSION]);let f=await (0,l.convertTokenToAuthTicket)(c,(0,y.makeOTP)(a));if(!1===f.success){let{error:{code:e,message:t}}=f;if(e===i.AuthenticationCode.BUSINESS_ERROR)throw Error(t);throw Error(i.AuthenticationCode[e])}let E=f.authTicket;if(await u.completeLogin(c,s,m,E,n??!1)!==i.AuthenticationCode.ASK_MASTER_PASSWORD)throw Error("unexpected status from verifyOtpOrToken");if(r)return er(e,t,r,{isDataPersisted:o});return d.triggerAskMasterPassword(t),i.LoginResultEnum.MasterPasswordMissing}catch(t){if(ed(t)){let e=await (0,P.getLocalAccounts)(c,s);d.sendLocalAccounts(e)}throw ep(t)&&(0,b.sendOTPErrorLog)(e,n),d.triggerOpenSessionFailed(t),t}}async function et(e,t,r,a,o,n,s){try{let{storeService:l,sessionService:u}=e,p=(0,A.normalizeEmail)(t);if(await Z(e,p,r),await em(a),await u.getInstance().user.accountExistsLocally())throw Error("Unexpected local account presence during OTP1 step");if(await c.registerDeviceWithToken(l,o,(0,y.makeOTP)(a),s??!1,t,n)!==i.AuthenticationCode.ASK_MASTER_PASSWORD)throw Error("unexpected status from device registration");if(r)return er(e,p,r,{isDataPersisted:o});return d.triggerAskMasterPassword(p),i.LoginResultEnum.MasterPasswordMissing}catch(t){throw ep(t)&&(0,b.sendOTPForNewDeviceErrorLog)(e,s),d.triggerOpenSessionFailed(t),t}}async function er(e,t,r,o,n){let s=o?.loginType??"MasterPassword";try{let{storeService:l,sessionService:d,masterPasswordEncryptorService:S,localDataEncryptorService:m,remoteDataEncryptorService:f,localStorageService:E,storageService:_,moduleClients:{"carbon-legacy":T}}=e;if(["PasswordlessAccountCreation","PasswordlessARK","DeviceToDevice"].includes(s))l.dispatch((0,g.storeAccountAuthenticationType)("invisibleMasterPassword"));else{let e;let r=l.getState(),a=(0,v.getDeviceAccessKeySelector)(r,t);try{let r=await (0,V.getAuthenticationMethodsForLogin)(l,{login:t,deviceAccessKey:a,methods:y.localSupportedAuthenticationMethod});if((0,V.isApiError)(r))return await u.handleGetAuthenticationMethodsForLoginError(_,T,r,t);e=r.accountType}catch(t){e="masterPassword"}l.dispatch((0,g.storeAccountAuthenticationType)(e))}let I=o&&o.isDataPersisted;n?.(`isDataPersisted? ${I}`),void 0===I&&(I=l.getAccountInfo().persistData);let D=o&&o.serverKey;n?.(`serverKey null, undefined, or empty? ${!D}`);let P=!!(o&&o.rememberMasterPassword);n?.(`rememberMasterPassword? ${P}`);let O=!!o?.shouldRememberMeForSSO;t=(0,A.normalizeEmail)(t),n?.("updateSessionUponLoginAction START"),await Z(e,t,r,{authorizeDifferentLogin:a.AUTHORIZED,serverKey:D}),n?.("updateSessionUponLoginAction SUCCESS");let C=await d.getInstance().user.accountExistsLocally();if(n?.(`accountExistLocally? ${C}`),C){let t=E.getInstance(),r=await t.doesLocalKeyExist();if(n?.(`doesLocalKeyExist? ${r}`),r)try{let e=await t.getLocalKey();e.length<64&&(n?.("localKeyMigrationRequired? "+"true"),l.dispatch((0,p.updateIsLocalKeyMigrationRequired)(!0))),n?.("set localDataEncryptorService START");let r=(0,h.getNoDerivationCryptoConfig)();m.setInstance({raw:e},"",r),n?.("set localDataEncryptorService SUCCESS"),n?.("updateLocalKey START"),l.dispatch((0,p.updateLocalKey)(e)),n?.("updateLocalKey SUCCESS")}catch(t){throw(0,b.sendMasterPasswordLoginErrorLog)(e,!1),Error(i.AuthenticationCode[i.AuthenticationCode.WRONG_PASSWORD])}n?.("loadLocalData START"),await u.loadLocalData(d,l,S),n?.("loadLocalData SUCCESS")}else{let e=l.getState(),t=(0,N.isRemoteKeyActivatedSelector)(e)&&f?f:S;n?.("validateMasterPassword START"),await c.validateMasterPassword(l,t),n?.("validateMasterPassword SUCCESS")}if(n?.("rememberMasterPasswordUpdated START"),o?.rememberMasterPassword&&l.dispatch((0,p.rememberMasterPasswordUpdated)(P)),n?.("rememberMasterPasswordUpdated SUCCESS"),O)l.dispatch((0,p.shouldRememberMeForSSOUpdated)(O));else{let t=await (0,x.firstValueFrom)(e.moduleClients.authenticationFlow.queries.getSsoUserSettings());(0,Y.isSuccess)(t)&&!t.data.rememberMeForSSOPreference&&await (0,q.disableAutologin)(e)}if(u.cacheIsSso(l.getAccountInfo().login,"SSO"===s),l.dispatch((0,F.storeSSOSettings)({ssoUser:"SSO"===s})),!C)return n?.("initInitialSession START"),"SSO"===s&&(0,b.sendLoginSuccessEventLog)({services:e,isInitial:!0,loginType:o?.loginType}),await ec(e,I,o);return n?.("initLocalSession START"),(0,b.sendLoginSuccessEventLog)({services:e,isInitial:!1,loginType:s}),await el(e,o)}catch(t){throw t.message&&t.message===i.AuthenticationCode[i.AuthenticationCode.WRONG_PASSWORD]&&(0,b.sendMasterPasswordLoginErrorLog)(e,!0),d.triggerOpenSessionFailed(t),t}}t.makeLoginController=e=>({openSession:(t,r)=>z(e,t,r),openSessionWithToken:(t,r,a,o,n)=>J(e,t,r,a,o,n),openSessionWithDashlaneAuthenticator:(t,r,a,o)=>X(e,t,r,a,o),cancelDashlaneAuthenticatorRegistration:()=>(c.cancelRegistrationWithDashlaneAuthenticator(),Promise.resolve()),openSessionWithOTP:(t,r,a,o,n)=>ee(e,t,r,a,o,n),openSessionWithOTPForNewDevice:(t,r,a,o,n,i)=>et(e,t,r,a,o,n,i),openSessionWithMasterPassword:(t,r,a)=>er(e,t,r,a),openSessionResendToken:t=>Q(e.moduleClients.authenticationFlow,t),loadAccountCreationInfos:(t,r,a,o,n,i)=>ef(e,t,r,a,o,n,i)}),t.updateSessionUponLoginAction=Z,t.openSessionWithMasterPassword=er;let ea=async(e,t,r)=>{let a=(0,U.hasTACAccessInCurrentSpace)(e);if(i.possibleAdminPermissions.includes(r)&&!a)throw e.isAuthenticated()&&await t.close(),Error(i.AuthenticationCode[i.AuthenticationCode.USER_UNAUTHORIZED])},eo=async(e,t)=>{let r=e.getState(),a=(0,K.pairingIdSelector)(r);d.triggerSessionOpened(e,t,a)},en=(e,t)=>{let{login:r,persistData:a,sessionStartTime:o}=e.getAccountInfo();a===y.PersistData.PERSIST_DATA_YES&&((0,m.storeUserPublicSetting)(r,"lastSuccessfulLoginTime",o),(t?.triggeredByRememberMeType===void 0||t?.triggeredByRememberMeType==="disabled")&&(0,m.storeUserPublicSetting)(r,"lastMasterPasswordOpenSessionTimestamp",o))},ei=async e=>{await e.accountExistsLocally()?await e.attemptSync(n.Trigger.Login):await e.sync(n.Trigger.InitialLogin)},es=async e=>{let{sessionService:t,storeService:r}=e,a=t.getInstance().user,o=r.getState(),n=(0,L.recoveryInProgressSelector)(o);if(void 0!==(0,w.ssoMigrationInfoSelector)(o).migration||n)return!0;let s=!await a.accountExistsLocally(),c=(0,I.changeMPinProgressSelector)(o);if(s||c){try{await ei(a)}catch(e){throw Error(i.AuthenticationCode[i.AuthenticationCode.UNKNOWN_SYNC_ERROR])}return!0}return!1};async function ec(e,t,r){let{localDataEncryptorService:a,sessionService:o,storageService:n,storeService:s,moduleClients:c}=e,{login:l,otpType:d}=s.getAccountInfo();await (0,C.deleteAllLocalUserData)(n,c["carbon-legacy"],l),await (0,_.generateLocalkeyAndSetupEncryptorService)(a,s,o,t),t===y.PersistData.PERSIST_DATA_YES&&(u.cacheOtpStatus(s.getAccountInfo().login,d),await (0,k.persistLocalUsersAuthenticationData)(n,s));let p=o.getInstance().user;await p.refreshSessionData(),r?.requiredPermissions&&await ea(s,o,r.requiredPermissions);let S=await (0,B.getDeviceLimitStatus)(e);return"noDeviceLimit"!==S._tag?(await (0,B.startDeviceLimitFlow)(e,S),i.LoginResultEnum.DeviceLimitFlow):eu(e,r)}async function el(e,t){let{sessionService:r,storeService:a,localDataEncryptorService:o}=e,n=r.getInstance().user,s=a.getState();(0,N.isLocalKeyMigrationRequiredSelector)(s)&&(await (0,_.generateLocalkeyAndSetupEncryptorService)(o,a,r,y.PersistData.PERSIST_DATA_YES),await n.persistAllData()),await n.refreshSessionData(),t?.requiredPermissions&&await ea(a,r,t.requiredPermissions);let c=await (0,B.attemptGetDeviceLimitStatus)(e);return"noDeviceLimit"!==c._tag?(await (0,B.startDeviceLimitFlow)(e,c),i.LoginResultEnum.DeviceLimitFlow):eu(e,t)}async function eu(e,t){try{let{autoLoginService:r,eventBusService:a,sessionService:o,storeService:n,storageService:c,wsService:l}=e,u=o.getInstance().user,d=n.getState(),S=(0,N.userLoginSelector)(d);n.dispatch((0,g.confirmUserAuthentication)()),en(n,t);let m=await es(e);if(await (0,f.getAndTriggerRefreshAccountInfo)(n,o,l),eo(n,c),!1===m)try{await ei(u)}catch(e){throw Error(i.AuthenticationCode[i.AuthenticationCode.UNKNOWN_SYNC_ERROR])}let y=await (0,P.getLocalAccounts)(n,c);(0,s.sendLocalAccounts)(y);let E="webauthn"!==(0,M.getLocalAccountRememberMeType)(S);n.getUserSession().rememberMasterPassword&&E&&r.initialize(),n.getUserSession().shouldRememberMeForSSO&&E&&(await (0,M.persistLocalAccountRememberMeType)(n,"sso"),n.dispatch((0,W.setRememberMeTypeAction)("sso"))),a.carbonSessionOpened({login:S}),t?.triggeredByRememberMeType!=="autologin"&&n.dispatch((0,p.updateLastMasterPasswordCheck)());let A=(0,N.nodePremiumStatusSelector)(d);return A&&A.b2bStatus?.statusCode==="in_team"&&u.startPeriodic2FAInfoRefresh(),await (0,O.refreshTwoFactorAuthenticationInfoService)(n,l),n.dispatch((0,p.updateSessionDidOpen)(!0)),i.LoginResultEnum.LoggedIn}catch(r){let{storeService:t}=e;throw t.dispatch((0,g.userAuthenticationFailed)()),t.dispatch((0,p.updateSessionDidOpen)(!1)),r}}t.sessionDidOpen=eu;let ed=e=>e&&"object"==typeof e&&e.message===i.AuthenticationCode[i.AuthenticationCode.DEVICE_NOT_REGISTERED],ep=e=>e?.message&&R.TokenOrOTPErrorCode.includes(e.message),eS=e=>e?.message&&R.DashlaneAuthenticatorErrorCode.includes(e.message),eg=async(e,t,r,a,o)=>{if(o)try{return await u.checkLogin(e,t,r)}catch(e){if(!ed(e))throw e}let n=(0,v.ukiSelector)(e.getState());return n?c.checkLoginWithUki(e,a,n):c.requestDeviceRegistration(e)};function em(e){if(!e||0===e.length)throw Error(i.AuthenticationCode[i.AuthenticationCode.EMPTY_OTP])}let ey=/^[0-9]{6}$/;async function ef(e,t,r,a,o,n,i){let s=(0,T.secureDeviceName)(a);await Z(e,t,r),e.storeService.dispatch((0,D.deviceRegistered)((0,D.makeDeviceRegistrationKeys)(o.accessKey,o.secretKey),i,t)),e.storeService.dispatch((0,E.registerDeviceName)(s)),e.storeService.dispatch((0,E.registerLastSync)(n))}(o=a=t.DifferentLoginAuthorized||(t.DifferentLoginAuthorized={}))[o.AUTHORIZED=0]="AUTHORIZED",o[o.FORBIDDEN=1]="FORBIDDEN"},52211:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.loginViaSSO=void 0;let a=r(81453),o=r(20648),n=r(95174),i=r(40891),s=r(62071),c=r(36598),l=r(72287),u=r(52780),d=r(18040),p=r(58361),S=r(93308),g=r(34978),m=r(28323),y=r(30029),f=r(49789),E=r(45407),A=r(4455),h=r(93748),_=r(59565),T=r(23640),v=r(75668),I=r(15346),D=r(30021),P=r(49087),O=r(31935),C=r(76380),b=r(22089),R=r(20530),N=r(80896),w=r(22560),L=r(29509),U=r(71802),M=r(77323);async function F(e,t){let{sessionService:r,storeService:i}=e,{ssoServiceProviderKey:l,exist:d,ssoToken:p,consents:S,currentAuths:g=o.SsoMigrationServerMethod.SSO,expectedAuths:m=o.SsoMigrationServerMethod.SSO,inStore:y,anonymousUserId:f}=t;try{let E=(0,c.normalizeEmail)(t.login),A=e.storeService.getUserLogin();if(A&&E!==A){let e=Error("SSO Login flow with previous login attempt data is prohibited!");throw e._type=o.LoginViaSsoCode.SSO_LOGIN_CORRUPT,e}let h=(0,u.secureDeviceName)(t.deviceName),_={...t,login:E,deviceName:h};if((!l||!E)&&!y)return i.dispatch((0,s.addNewLoginNotification)({type:o.LoginNotificationType.SSO_SETUP_ERROR})),(0,I.makeReturnErrorObject)(o.LoginViaSsoCode.EMPTY_LOGIN);if(!d)return await (0,n.createSSOAccount)(e,{ssoServiceProviderKey:l,login:E,deviceName:h,ssoToken:p,consents:S,anonymousUserId:f});if(!(0,I.isSupportedTransitionFlow)(g,m))return i.dispatch((0,s.addNewLoginNotification)({type:o.LoginNotificationType.SSO_SETUP_ERROR})),(0,I.makeReturnErrorObject)(o.LoginViaSsoCode.UNSUPPORTED_TRANSITION);if(g===o.SsoMigrationServerMethod.MP&&m===o.SsoMigrationServerMethod.SSO)return await k(e,_);if(g===o.SsoMigrationServerMethod.SSO&&m===o.SsoMigrationServerMethod.MP){let e={ssoUser:!0,migration:a.AuthenticationFlowContracts.SSOMigrationType.SSO_TO_MP};i.dispatch((0,C.storeSSOSettings)(e)),_.requiredPermissions=null}if(r.setInstance(E,void 0),!await r.getInstance().user.accountExistsLocally())return await B(e,_);return await K(e,_)}catch(t){return function({services:e,error:t}){return(0,N.sendExceptionLog)({error:t}),w.default.log(t.message,t),(0,b.sendSsoLoginErrorLog)(e),e.storeService.dispatch((0,s.addNewLoginNotification)({type:t._type===o.LoginViaSsoCode.SSO_LOGIN_CORRUPT?o.LoginNotificationType.SSO_LOGIN_CORRUPT:o.LoginNotificationType.UNKNOWN_ERROR,message:t.message})),(0,I.makeReturnErrorObject)("_type"in t&&t._type||o.LoginViaSsoCode.UNKNOWN_ERROR,t.message)}({services:e,error:t})}}t.loginViaSSO=F;let k=async(e,t)=>{let{moduleClients:r,storeService:n}=e,{ssoServiceProviderKey:i,ssoToken:c}=t,{login:u}=t,{isAuthenticated:d,otpType:p}=n.getAccountInfo(),S=(0,U.accountAuthenticationTypeSelector)(n.getState());if(t.inStore){let e=(0,_.ssoSettingsSelector)(n.getState());if(i=e.ssoServiceProviderKey,c=e.ssoToken,!i||!c)return n.dispatch((0,s.addNewLoginNotification)({type:o.LoginNotificationType.SSO_SETUP_ERROR})),(0,I.makeReturnErrorObject)(o.LoginViaSsoCode.SSO_VERIFICATION_FAILED)}if(!d){let t={ssoUser:!0,serviceProviderUrl:"",ssoServiceProviderKey:i,ssoToken:c,migration:a.AuthenticationFlowContracts.SSOMigrationType.MP_TO_SSO};return n.dispatch((0,C.storeSSOSettings)(t)),(0,l.makeLoginController)(e).openSession(u),n.dispatch((0,s.addNewLoginNotification)({type:o.LoginNotificationType.RELOGIN_NEEDED})),(0,I.makeReturnErrorObject)(o.LoginViaSsoCode.INNACTIVE_SESSION)}if(p===O.OtpType.NO_OTP){let{success:e}=await (0,P.convertTokenToAuthTicket)(n,(0,T.makeSsoToken)(c));if(!e)return n.dispatch((0,s.addNewLoginNotification)({type:o.LoginNotificationType.SSO_SETUP_ERROR})),(0,I.makeReturnErrorObject)(o.LoginViaSsoCode.SSO_VERIFICATION_FAILED)}let g={newPassword:i,flow:o.ChangeMPFlowPath.MP_TO_SSO};"masterPassword"!==S&&n.dispatch((0,y.storeAccountAuthenticationType)("masterPassword"));let m=await (0,D.changeMasterPassword)(e,g);return!1===m.success?(n.dispatch((0,s.addNewLoginNotification)({type:o.LoginNotificationType.UNKNOWN_ERROR,message:m.error.code})),m):(await (0,R.markNotificationAsUnseen)(e,o.NotificationName.MpToSsoMigrationDoneDialog),"masterPassword"!==S&&await r.accountManagement.commands.changeAccountType({newAccountType:"masterPassword"}).then(e=>{if((0,M.isFailure)(e))throw Error("Error while changing account type to masterPassword")}).catch(e=>{n.dispatch((0,y.storeAccountAuthenticationType)(S)),(0,N.sendExceptionLog)({error:e}),w.default.error(e)}),(0,I.successResponse)())},K=async(e,{login:t,ssoServiceProviderKey:r,ssoToken:a,requiredPermissions:n,shouldRememberMeForSSO:i})=>{let c;let{storeService:u}=e,y=await (0,L.getDeviceAccessKeySelector)(u.getState(),t);if(!y)throw Error(o.AuthenticationCode[o.AuthenticationCode.DEVICE_NOT_REGISTERED]);let E=await (0,P.convertTokenToAuthTicket)(u,(0,T.makeSsoToken)(a));if(!1===E.success){let{error:{message:e}}=E;return u.dispatch((0,s.addNewLoginNotification)({type:o.LoginNotificationType.SSO_SETUP_ERROR})),(0,I.makeReturnErrorObject)(o.LoginViaSsoCode.SSO_VERIFICATION_FAILED,e)}let h=E.authTicket,_=await (0,v.completeLoginWithAuthTicket)(u,{login:t,deviceAccessKey:y,authTicket:h});if((0,m.isApiError)(_))return(0,I.formatAPIError)(_);let{masterPasswordEncryptorService:D,remoteDataEncryptorService:O}=e,{ssoServerKey:C,remoteKeys:b}=_,R=(0,S.base64ToBuffer)(C),N=b.filter(e=>"sso"===e.type)[0];try{let e=(0,S.base64ToBuffer)(r),t=(0,p.getEncryptionKeyBuffer)(e,R,{skipDerivation:!0});c=(0,S.arrayBufferToText)(t);let a=(0,d.getNoDerivationCryptoConfig)();D.setInstance({raw:c},"",a);let o=await D.getInstance().decrypt(N.key),n=(0,g.deflatedUtf8ToUtf16)(o,{skipUtf8Decoding:!0,skipInflate:!0});O.setInstance({raw:n},"",a),u.dispatch((0,f.updateRemoteKey)(n))}catch(e){return{success:!1,error:{code:o.LoginViaSsoCode.WRONG_PASSWORD}}}let w=A.PersistData.PERSIST_DATA_YES;return await (0,l.openSessionWithMasterPassword)(e,t,c,{isDataPersisted:w,serverKey:"",requiredPermissions:n,loginType:"SSO",shouldRememberMeForSSO:i}),(0,I.successResponse)()},B=async(e,t)=>{let{storeService:r,masterPasswordEncryptorService:a,remoteDataEncryptorService:o}=e,{deviceName:n,ssoToken:s,login:c,ssoServiceProviderKey:u,requiredPermissions:d,shouldRememberMeForSSO:p}=t;r.dispatch((0,i.updateLocalUserInfo)(c,{ssoActivatedUser:!0}));let S=A.PersistData.PERSIST_DATA_YES;await (0,E.registerDeviceWithToken)(r,S,(0,T.makeSsoToken)(s),!1,c,n,{masterPasswordEncryptorService:a,remoteDataEncryptorService:o,ssoServiceProviderKey:u});let g=e.storeService.getState(),m=(0,h.masterPasswordSelector)(g);return await (0,l.openSessionWithMasterPassword)(e,c,m,{isDataPersisted:S,serverKey:"",requiredPermissions:d,loginType:"SSO",shouldRememberMeForSSO:p}),(0,I.successResponse)()}},15346:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.triggerServiceProviderUrlRedirect=t.successResponse=t.makeReturnErrorObject=t.formatAPIError=t.isSupportedTransitionFlow=void 0;let a=r(20648),o=r(28323),n=r(42196),i=r(59565);t.isSupportedTransitionFlow=(e,t)=>e===a.SsoMigrationServerMethod.SSO?t===a.SsoMigrationServerMethod.SSO||t===a.SsoMigrationServerMethod.MP:e===a.SsoMigrationServerMethod.MP&&t===a.SsoMigrationServerMethod.SSO,t.formatAPIError=e=>{switch(e.code){case o.B2bSsoUserNotFound:case o.InvalidSsoToken:case o.DeviceNotFound:case o.InvalidAuthTicket:return(0,t.makeReturnErrorObject)(a.LoginViaSsoCode.SSO_VERIFICATION_FAILED,e.message);default:return(0,t.makeReturnErrorObject)(a.LoginViaSsoCode.UNKNOWN_ERROR,e.message)}},t.makeReturnErrorObject=(e,t)=>({success:!1,error:{code:e,message:t}}),t.successResponse=(e=a.LoginViaSsoCode.SUCCESS)=>({success:!0,code:e}),t.triggerServiceProviderUrlRedirect=function(e,t){let r=(0,i.serviceProviderUrlSelector)(e),a=`${r}?username=${t}`;return(0,n.emitServiceProviderUrl)(a),a}},30229:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.bootstrap=void 0;let a=r(59889),o=r(65824),n=r(56770),i=r(34789);t.bootstrap=(e,t,r)=>{if(e.register(a.config),r.connectors.deviceLimit){let e=new n.DeviceLimitCapabilityEventBus(t,r.connectors.deviceLimit),a=(0,i.getDeviceLimitFlowEventsManager)(t.storeService);(0,o.setupDeviceLimitEventBus)(e,a)}}},22089:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.sendMasterPasswordLoginErrorLog=t.sendSsoLoginErrorLog=t.sendBiometricLoginErrorLog=t.sendDashlaneAuthenticatorErrorLog=t.sendOTPErrorLog=t.sendOTPForNewDeviceErrorLog=t.sendEmailTokenErrorLog=t.sendLoginSuccessEventLog=t.sendAskSSOAuthenticationEventLog=t.sendAskBiometricAuthenticationEventLog=t.sendAskAuthenticationEventLog=void 0;let a=r(83533),o=r(91783),n=r(12770),i=r(31935),s=(e,t,r)=>{switch(e){case i.OtpType.NO_OTP:if(!t)return a.VerificationMode.None;if(r)return a.VerificationMode.AuthenticatorApp;return a.VerificationMode.EmailToken;case i.OtpType.OTP_NEW_DEVICE:return a.VerificationMode.Otp1;case i.OtpType.OTP_LOGIN:return a.VerificationMode.Otp2;default:return a.VerificationMode.None}},c=async(e,t,r)=>{await (0,n.logEvent)(t,{event:new a.UserAskAuthenticationEvent({mode:e,reason:a.Reason.Login,verificationMode:r})})};t.sendAskAuthenticationEventLog=c.bind(null,a.Mode.MasterPassword),t.sendAskBiometricAuthenticationEventLog=c.bind(null,a.Mode.Biometric),t.sendAskSSOAuthenticationEventLog=c.bind(null,a.Mode.Sso);let l=async(e,t)=>{let{otpType:r}=e.storeService.getAccountInfo(),{isUsingBackupCode:o,isUsingDashlaneAuthenticator:i}=e.storeService.getUserSession(),c=s(r,t,i);await (0,n.logEvent)(e,{event:new a.UserLoginEvent({mode:a.Mode.MasterPassword,status:a.Status.Success,isFirstLogin:t,isBackupCode:o,verificationMode:c})})},u=async(e,t)=>{let{otpType:r}=e.storeService.getAccountInfo(),{isUsingBackupCode:o,isUsingDashlaneAuthenticator:i}=e.storeService.getUserSession(),c=s(r,t,i);await (0,n.logEvent)(e,{event:new a.UserLoginEvent({mode:a.Mode.DeviceTransfer,status:a.Status.Success,isFirstLogin:t,isBackupCode:o,verificationMode:c})})},d=async(e,t)=>{await (0,n.logEvent)(e,{event:new a.UserLoginEvent({mode:a.Mode.Sso,status:a.Status.Success,isFirstLogin:t,isBackupCode:!1,verificationMode:a.VerificationMode.None})})},p=async e=>{await (0,n.logEvent)(e,{event:new a.UserLoginEvent({mode:a.Mode.Biometric,status:a.Status.Success,isFirstLogin:!1,isBackupCode:!1,verificationMode:a.VerificationMode.None})})},S=async({services:e,isInitial:t,loginType:r})=>{switch(r){case"SSO":await d(e,t);break;case"Biometric":await p(e);break;case"MasterPassword":await l(e,t);break;case"DeviceToDevice":await u(e,t);break;case"Autologin":case"MasterPasswordARK":case"PasswordlessARK":case"PasswordlessAccountCreation":return;default:(0,o.assertUnreachable)(r)}};t.sendLoginSuccessEventLog=S;let g=async e=>{await (0,n.logEvent)(e,{event:new a.UserLoginEvent({mode:a.Mode.MasterPassword,status:a.Status.ErrorWrongOtp,isFirstLogin:!0,isBackupCode:!1,verificationMode:a.VerificationMode.EmailToken})})};t.sendEmailTokenErrorLog=g;let m=async(e,t)=>{let{otpType:r}=e.storeService.getAccountInfo();await (0,n.logEvent)(e,{event:new a.UserLoginEvent({mode:a.Mode.MasterPassword,status:a.Status.ErrorWrongOtp,isFirstLogin:!0,isBackupCode:t,verificationMode:r===i.OtpType.OTP_LOGIN?a.VerificationMode.Otp2:a.VerificationMode.Otp1})})};t.sendOTPForNewDeviceErrorLog=m;let y=async(e,t)=>{await (0,n.logEvent)(e,{event:new a.UserLoginEvent({mode:a.Mode.MasterPassword,status:a.Status.ErrorWrongOtp,isFirstLogin:!1,isBackupCode:t,verificationMode:a.VerificationMode.Otp2})})};t.sendOTPErrorLog=y;let f=async e=>{await (0,n.logEvent)(e,{event:new a.UserLoginEvent({mode:a.Mode.MasterPassword,status:a.Status.ErrorWrongOtp,isFirstLogin:!0,isBackupCode:!1,verificationMode:a.VerificationMode.AuthenticatorApp})})};t.sendDashlaneAuthenticatorErrorLog=f;let E=async e=>{await (0,n.logEvent)(e,{event:new a.UserLoginEvent({mode:a.Mode.Biometric,status:a.Status.ErrorUnknown,isFirstLogin:!1,isBackupCode:!1,verificationMode:a.VerificationMode.None})})};t.sendBiometricLoginErrorLog=E;let A=async e=>{await (0,n.logEvent)(e,{event:new a.UserLoginEvent({mode:a.Mode.Sso,status:a.Status.ErrorInvalidSso,isBackupCode:!1,verificationMode:a.VerificationMode.None})})};t.sendSsoLoginErrorLog=A;let h=async(e,t)=>{let{otpType:r}=e.storeService.getAccountInfo(),{isUsingBackupCode:o,isUsingDashlaneAuthenticator:i}=e.storeService.getUserSession(),c=s(r,t,i);await (0,n.logEvent)(e,{event:new a.UserLoginEvent({mode:a.Mode.MasterPassword,status:a.Status.ErrorWrongPassword,isFirstLogin:t,isBackupCode:o,verificationMode:c})})};t.sendMasterPasswordLoginErrorLog=h},8845:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.addLoginNotification=void 0;let a=r(62071);async function o(e,t){let{storeService:r}=e;r.dispatch((0,a.addNewLoginNotification)(t))}t.addLoginNotification=o},73566:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.bootstrap=void 0;var a=r(30229);Object.defineProperty(t,"bootstrap",{enumerable:!0,get:function(){return a.bootstrap}})},18629:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.setupSubscriptions=void 0;let a=r(27698),o=r(62923),n=r(27762),i=r(483),s=r(56319),c=r(28009),l=r(29509);t.setupSubscriptions=function(e,t){let{storageService:r,storeService:u,moduleClients:{"carbon-legacy":d}}=t;e.appInitialized.on(async e=>{let p=(0,l.localAccountsInitializedSelector)(u.getState());if(e.initMode===c.InitMode.FirstInit){await (0,o.deviceRemoteDeletion)(u,r,d);let e=await (0,n.getLocalAccounts)(u,r);await (0,s.restoreLastAuthenticatedUser)(t,e),(0,a.sendLocalAccounts)(e),t.storeService.dispatch((0,i.localAccountsListUpdated)(e))}else if(!p){let e=await (0,n.getLocalAccounts)(u,r);(0,a.sendLocalAccounts)(e),t.storeService.dispatch((0,i.localAccountsListUpdated)(e))}})}},97806:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.DashlaneAuthenticatorErrorCode=t.TokenOrOTPErrorCode=void 0;let a=r(20648);t.TokenOrOTPErrorCode=[a.AuthenticationCode.TOKEN_EXPIRED,a.AuthenticationCode.TOKEN_NOT_VALID,a.AuthenticationCode.TOKEN_TOO_MANY_ATTEMPTS,a.AuthenticationCode.EMPTY_TOKEN,a.AuthenticationCode.OTP_ALREADY_USED,a.AuthenticationCode.OTP_NOT_VALID,a.AuthenticationCode.OTP_TOO_MANY_ATTEMPTS,a.AuthenticationCode.EMPTY_OTP,a.AuthenticationCode.BACKUP_CODE_NOT_VALID],t.DashlaneAuthenticatorErrorCode=[a.AuthenticationCode.DASHLANE_AUTHENTICATOR_LOGIN_CANCELLED,a.AuthenticationCode.DASHLANE_AUTHENTICATOR_PUSH_NOTIFICATION_DENIED,a.AuthenticationCode.FAILED_TO_CONTACT_AUTHENTICATOR_DEVICE]},80538:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.config=void 0;let a=r(45903),o=r(28020),n=r(60742),i=r(8845);t.config={commands:{addLoginNotification:{handler:i.addLoginNotification},clearAllStoredLoginNotification:{handler:o.clearAllStoredLoginNotification}},queries:{getLoginNotifications:{selector:a.loginNotificationListSelector}},liveQueries:{liveLoginNotifications:{operator:n.loginNotificationList$}}}},31424:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.bootstrap=void 0;let a=r(80538);t.bootstrap=e=>{e.register(a.config)}},94505:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.bootstrap=void 0;var a=r(31424);Object.defineProperty(t,"bootstrap",{enumerable:!0,get:function(){return a.bootstrap}})},60742:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.loginNotificationList$=void 0;let a=r(95121),o=r(15237),n=r(45903);t.loginNotificationList$=()=>(0,a.pipe)((0,o.map)(n.loginNotificationListSelector),(0,o.distinctUntilChanged)())},45903:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.loginNotificationListSelector=void 0,t.loginNotificationListSelector=e=>e.inMemoryInterSessionUnsynced.loginNotification},28020:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.clearAllStoredLoginNotification=void 0;let a=r(62071),o=async e=>(e.storeService.dispatch((0,a.resetAllLoginNotification)()),{success:!0});t.clearAllStoredLoginNotification=o},96898:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.config=void 0;let a=r(86586),o=r(63418),n=r(931),i=r(53342);t.config={commands:{updateLoginStepInfo:{handler:n.updateLoginStepInfoHandler},resetLoginStepInfo:{handler:i.resetLoginStepInfoHandler}},queries:{getLoginStepInfo:{selector:a.loginStepInfoSelector}},liveQueries:{liveLoginStepInfo:{operator:o.liveLoginStepInfo$}}}},4544:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.resetLoginStepInfo=t.updateLoginStepInfoStep=t.updateLoginStepInfoLogin=t.RESET_LOGIN_STEP_INFO=t.UPDATE_LOGIN_STEP_INFO_STEP=t.UPDATE_LOGIN_STEP_INFO_LOGIN=void 0,t.UPDATE_LOGIN_STEP_INFO_LOGIN="UPDATE_LOGIN_STEP_INFO_LOGIN",t.UPDATE_LOGIN_STEP_INFO_STEP="UPDATE_LOGIN_STEP_INFO_STEP",t.RESET_LOGIN_STEP_INFO="RESET_LOGIN_STEP_INFO",t.updateLoginStepInfoLogin=e=>({type:t.UPDATE_LOGIN_STEP_INFO_LOGIN,login:e}),t.updateLoginStepInfoStep=e=>({type:t.UPDATE_LOGIN_STEP_INFO_STEP,step:e}),t.resetLoginStepInfo=()=>({type:t.RESET_LOGIN_STEP_INFO})},86586:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.loginStepInfoSelector=void 0,t.loginStepInfoSelector=e=>{let t=e.userSession.localSettings.loginStepInfo;return t?.step?t:null}},57226:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.bootstrap=void 0;let a=r(96898);t.bootstrap=e=>{e.register(a.config)}},53342:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.resetLoginStepInfoHandler=void 0;let a=r(4544);t.resetLoginStepInfoHandler=e=>(e.storeService.dispatch((0,a.resetLoginStepInfo)()),e.sessionService.getInstance().user.persistLocalSettings(),Promise.resolve())},931:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.updateLoginStepInfoHandler=void 0;let a=r(4544);t.updateLoginStepInfoHandler=(e,t)=>(void 0!==t.login&&e.storeService.dispatch((0,a.updateLoginStepInfoLogin)(t.login)),void 0!==t.step&&e.storeService.dispatch((0,a.updateLoginStepInfoStep)(t.step)),e.sessionService.getInstance().user.persistLocalSettings(),Promise.resolve())},38421:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.bootstrap=void 0;var a=r(57226);Object.defineProperty(t,"bootstrap",{enumerable:!0,get:function(){return a.bootstrap}})},63418:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.liveLoginStepInfo$=void 0;let a=r(95121),o=r(15237),n=r(86586);t.liveLoginStepInfo$=()=>(0,a.pipe)((0,o.map)(n.loginStepInfoSelector),(0,o.distinctUntilChanged)())},98238:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.Debugger=void 0;let a=r(95674),o=r(77550),n=e=>e.reduce((e,t)=>{let r=Object.keys(e).length;return{...e,[r]:t}},{}),i=([e,...t])=>{let r="",a=[];return"string"==typeof e?r=e:a=[e],{message:r,details:n(a=[...a,...t])}},s=function(){let e=e=>(...t)=>{let r={...i(t),level:e};(0,a.log)(r)},t=e(o.LogLevel.Debug),r=e(o.LogLevel.Info);return{log:t,info:r,warn:e(o.LogLevel.Warn),error:e(o.LogLevel.Error)}}();t.Debugger=s,t.default=s},95674:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.redirectConsoleLogs=t.logVerbose=t.logDebug=t.logInfo=t.logWarn=t.logError=t.log=void 0;let a=r(25903),o=r(3314),n=r(96828),i=r(77550),s=r(31328),c=r(91783),l=r(71491),u=null,d=e=>{switch(e){case i.LogLevel.Error:return console.error;case i.LogLevel.Warn:return console.warn;case i.LogLevel.Info:return console.info;case i.LogLevel.Verbose:return console.log;case i.LogLevel.Debug:return console.debug;default:return(0,c.assertUnreachable)(e)}},p=e=>t=>{let{level:r=i.LogLevel.Error}=t,a=d(r),o=e(t);a.call(this,o)},S=(0,s.formatLogEntry)(s.formatLogEntryDetail),g=(e,t)=>r=>a=>t(a[e])&&r(a),m=g("tag",(e=[])=>{let t=o.config.LOG_TAGS||[],r="string"==typeof t?[t]:[...t],a="string"==typeof e?[e]:[...e];return!r.length||r.some(e=>a.includes(e))}),y=g("level",e=>e>=o.config.LOG_LEVEL),f=(0,a.pipe)(e=>t=>(u||p(e))(t),y,m)(S);f({message:"~~~ Logs activated ~~~",level:i.LogLevel.Info,tag:[l.LOGS_LOG_TAG,l.DEBUGGER_LOG_TAG]}),t.log=f,t.logError=(0,n.withErrorLevel)(f),t.logWarn=(0,n.withWarnLevel)(f),t.logInfo=(0,n.withInfoLevel)(f),t.logDebug=(0,n.withDebugLevel)(f),t.logVerbose=(0,n.withVerboseLevel)(f),t.redirectConsoleLogs=e=>(u=e,()=>{u=null})},96828:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.withVerboseLevel=t.withDebugLevel=t.withInfoLevel=t.withWarnLevel=t.withErrorLevel=t.withTag=t.withLevel=void 0;let a=r(77550),o=(e,t)=>r=>a=>r({[e]:t,...a});t.withLevel=e=>o("level",e),t.withTag=e=>o("tag",e),t.withErrorLevel=(0,t.withLevel)(a.LogLevel.Error),t.withWarnLevel=(0,t.withLevel)(a.LogLevel.Warn),t.withInfoLevel=(0,t.withLevel)(a.LogLevel.Info),t.withDebugLevel=(0,t.withLevel)(a.LogLevel.Debug),t.withVerboseLevel=(0,t.withLevel)(a.LogLevel.Verbose)},31328:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.formatLogEntryDetail=t.formatLogEntry=void 0;let a=r(21837),o=r(77550);function n(e){let{stack:t}=e,r=`${e}`;t&&"string"==typeof t&&t.substr(0,t.indexOf("\n"))===r&&(r="");let a=r?`
${t}`:t;return`${r}${a}`}let i={[o.LogLevel.Error]:"(e)",[o.LogLevel.Warn]:"(w)",[o.LogLevel.Info]:"(i)",[o.LogLevel.Debug]:"(d)",[o.LogLevel.Verbose]:"(v)"};t.formatLogEntry=e=>t=>{let{details:r={},level:a=o.LogLevel.Debug,message:n,tag:s=[]}=t,c=function(e){let t=Array.isArray(e)?e:[e];return t.length?` [${t.join("|")}]`:""}(s),l=i[a],u=!!n,d=u?` ${n}`:"",p=Object.keys(r).reduce((t,a)=>!Number.isInteger(parseInt(a,10))&&u?`${t} ${a}:${e(r[a])}`:`${t} ${e(r[a])}`,"");return`${l}${c}${d}${p}`},t.formatLogEntryDetail=e=>(0,a.isCarbonError)(e)?function(e){let t=JSON.stringify(e.getAdditionalInfo()),r=t?`
${t}`:"";return`${n(e)}${r}`}(e):e instanceof Error?n(e):"object"==typeof e?JSON.stringify(e):String(e)},22560:function(e,t,r){var a=this&&this.__createBinding||(Object.create?function(e,t,r,a){void 0===a&&(a=r);var o=Object.getOwnPropertyDescriptor(t,r);(!o||("get"in o?!t.__esModule:o.writable||o.configurable))&&(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,a,o)}:function(e,t,r,a){void 0===a&&(a=r),e[a]=t[r]}),o=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||a(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),t.withWarnLevel=t.withVerboseLevel=t.withTag=t.withLevel=t.withInfoLevel=t.withErrorLevel=t.withDebugLevel=t.Silent=t.LogLevel=t.redirectConsoleLogs=t.logWarn=t.logVerbose=t.logInfo=t.logError=t.logDebug=t.log=void 0;let n=r(98238);t.default=n.Debugger;var i=r(95674);Object.defineProperty(t,"log",{enumerable:!0,get:function(){return i.log}}),Object.defineProperty(t,"logDebug",{enumerable:!0,get:function(){return i.logDebug}}),Object.defineProperty(t,"logError",{enumerable:!0,get:function(){return i.logError}}),Object.defineProperty(t,"logInfo",{enumerable:!0,get:function(){return i.logInfo}}),Object.defineProperty(t,"logVerbose",{enumerable:!0,get:function(){return i.logVerbose}}),Object.defineProperty(t,"logWarn",{enumerable:!0,get:function(){return i.logWarn}}),Object.defineProperty(t,"redirectConsoleLogs",{enumerable:!0,get:function(){return i.redirectConsoleLogs}}),o(r(98238),t);var s=r(77550);Object.defineProperty(t,"LogLevel",{enumerable:!0,get:function(){return s.LogLevel}}),Object.defineProperty(t,"Silent",{enumerable:!0,get:function(){return s.Silent}});var c=r(96828);Object.defineProperty(t,"withDebugLevel",{enumerable:!0,get:function(){return c.withDebugLevel}}),Object.defineProperty(t,"withErrorLevel",{enumerable:!0,get:function(){return c.withErrorLevel}}),Object.defineProperty(t,"withInfoLevel",{enumerable:!0,get:function(){return c.withInfoLevel}}),Object.defineProperty(t,"withLevel",{enumerable:!0,get:function(){return c.withLevel}}),Object.defineProperty(t,"withTag",{enumerable:!0,get:function(){return c.withTag}}),Object.defineProperty(t,"withVerboseLevel",{enumerable:!0,get:function(){return c.withVerboseLevel}}),Object.defineProperty(t,"withWarnLevel",{enumerable:!0,get:function(){return c.withWarnLevel}})},77550:function(e,t){var r;Object.defineProperty(t,"__esModule",{value:!0}),t.Silent=t.LogLevel=void 0,(r=t.LogLevel||(t.LogLevel={}))[r.Verbose=0]="Verbose",r[r.Debug=10]="Debug",r[r.Info=20]="Info",r[r.Warn=30]="Warn",r[r.Error=40]="Error",t.Silent=100},52619:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.config=void 0;let a=r(12770);t.config={commands:{logEvent:{handler:a.logEvent},logPageView:{handler:a.logPageView}},queries:{},liveQueries:{}}},38867:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.updateEventLoggerVirtualStoreState=t.UPDATE_EVENT_LOGGER_STATE=t.createEventLoggerVirtualStore=t.CREATE_EVENT_LOGGER_VIRTUAL_STORE=void 0,t.CREATE_EVENT_LOGGER_VIRTUAL_STORE="CREATE_EVENT_LOGGER_VIRTUAL_STORE",t.createEventLoggerVirtualStore=({storeName:e,initialState:r})=>({type:t.CREATE_EVENT_LOGGER_VIRTUAL_STORE,storeName:e,initialState:r}),t.UPDATE_EVENT_LOGGER_STATE="UPDATE_EVENT_LOGGER_STATE",t.updateEventLoggerVirtualStoreState=({storeName:e,updater:r})=>({type:t.UPDATE_EVENT_LOGGER_STATE,storeName:e,updater:r})},63168:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.bootstrap=void 0;let a=r(52619);t.bootstrap=(e,t)=>{e.register(a.config),t.eventLoggerService.initRepository()}},2894:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.decryptEvents=t.encryptEvents=void 0;let a=r(25434),o=r(50527),n=r(92180),i=r(34978);async function s({storeService:e,encryptionKey:t,data:r}){let i=(0,a.makeDataEncryptorService)(e),{cryptoConfig:s}=(0,n.parsePayload)(o.CRYPTO_NODERIVATION_HMAC64);i.setInstance({raw:t},"",s);let c=await i.getInstance().encrypt(r);return i.close(),c}async function c({storeService:e,encryptedData:t,encryptionKey:r}){let o=(0,a.makeDataEncryptorService)(e);o.setInstance({raw:r},"");let n=await o.getInstance().decrypt(t);return o.close(),n}async function l(e,t,r){let a=JSON.stringify(t),o=(0,i.deflateUtf16)(a);return await s({storeService:e,encryptionKey:r,data:o})}async function u(e,t,r){let a=await c({storeService:e,encryptedData:t,encryptionKey:r});return JSON.parse((0,i.inflateUtf16)(a))}t.encryptEvents=l,t.decryptEvents=u},19894:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.chunkArray=t.getOsContext=t.getOsVersion=t.getOsType=t.getBrowserContext=t.getAppContext=t.applicationBuildTypeToHermesBuildType=t.platformStringToAppPlatform=t.createLogger=void 0;let a=r(83533),o=r(20648),n=r(25826),i=r(3314),s=r(91783);t.createLogger=e=>{let{eventLoggerService:t}=e,r=t.getRepository("createLogger");return{logger:r.createLogger(),logRepository:r}},t.platformStringToAppPlatform=e=>{switch(e){case"server_standalone":case"server_carbon_unknown":case"server_carbon_tests":return a.Platform.Saex;case"server_leeloo_dev":case"server_leeloo":case"server_tac":return a.Platform.Web;default:(0,s.assertUnreachable)(e,`Hermes Web SDK: Unsupported platform "${e}" detected. This platform is not supported by the Hermes Web SDK or Styx API.`)}},t.applicationBuildTypeToHermesBuildType=e=>{switch(e){case o.ApplicationBuildType.DEV:return a.BuildType.Dev;case o.ApplicationBuildType.QA:return a.BuildType.Qa;case o.ApplicationBuildType.NIGHTLY:return a.BuildType.Nightly;default:return a.BuildType.Production}};let c=(e,t)=>t?e+"-mv"+t:e;t.getAppContext=e=>{let r=e.getPlatformInfo(),{buildType:a}=r;return{platform:(0,t.platformStringToAppPlatform)(r.platformName),version:c(r.appVersion,i.config.MANIFEST_VERSION),build_type:(0,t.applicationBuildTypeToHermesBuildType)(a)}},t.getBrowserContext=()=>{let e=n.browser.getBrowserName();return{name:e,version:n.browser.getBrowserVersion(),user_agent:n.navigator.getNavigator().userAgent}},t.getOsType=e=>{let t=a.OsType.Other,r=e.os.toLowerCase().replace(/[ -/]+/g,"_");return Object.values(a.OsType).map(e=>e.toString()).includes(r)&&(t=r),t},t.getOsVersion=e=>{let t="Mac OS"===e.os?e.osVersion.replace("OS_X_","").replace(/_/g,"."):e.osVersion,r=/([0-9]{1,3}(?:\.[0-9]{0,4}){0,2})/.exec(t);return r&&r.length>=2?r[1]:"0"},t.getOsContext=e=>{let r=e.getPlatformInfo();return{type:(0,t.getOsType)(r),version:(0,t.getOsVersion)(r),locale:r.lang}},t.chunkArray=function e(t,r){return t.length<=r?[t]:[t.slice(0,r),...e(t.slice(r),r)]}},28693:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.makeEventLoggerService=t.bootstrap=void 0;let a=r(83533),o=r(3314),n=r(19894),i=r(15535),s=r(2073),c=r(98024),l=r(46021),u=r(66087);var d=r(63168);Object.defineProperty(t,"bootstrap",{enumerable:!0,get:function(){return d.bootstrap}}),t.makeEventLoggerService=e=>{let t=null,r=r=>{if(!t)throw Error(`makeEventLoggerService: You must call initRepository() before getting the repository instance, eventName: ${r}`);let a=e.storeService.getUserSession();return(a.analyticsIds?.userAnalyticsId||a.analyticsIds?.deviceAnalyticsId)&&t.setTrackingInfo(a.analyticsIds.userAnalyticsId,a.analyticsIds.deviceAnalyticsId),t};return{initRepository:()=>{let r=e.storeService,s=(0,n.getAppContext)(r),c=(0,n.getOsContext)(r),l=(0,n.getBrowserContext)(),d=(0,i.getCommonAppSetting)("installationId"),p=new u.EventLoggerStoreFactory(r);t=new a.LogRepository(s,c,l,d,void 0,!1,p);let S=r.getUserSession();(S.analyticsIds?.userAnalyticsId||S.analyticsIds?.deviceAnalyticsId)&&t.setTrackingInfo(S.analyticsIds.userAnalyticsId,S.analyticsIds.deviceAnalyticsId),3===o.config.MANIFEST_VERSION&&t.setServiceWorkerStartTime(new Date().toISOString())},getRepository:r,logEvent:async a=>{let{interactionDataConsent:o}=await (0,l.getGlobalExtensionSettings)(e);if(!1!==o)return r(a.name).createLogger().logEvent(a),(0,c.storeEventsInQueue)(e,t)},logSync:async a=>{let{interactionDataConsent:o}=await (0,l.getGlobalExtensionSettings)(e);if(!1!==o)return r(a.name).createLogger().logEvent(a),(0,c.storeEventsInQueue)(e,t)},flushEventQueue:()=>(0,s.sendEventQueueToStyx)(e)}}},70891:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.immediatelySendEvents=t.queueEvents=t.queueLogRepositoryEvents=void 0;let a=r(20648),o=r(2073),n=r(98024);async function i(e,t){let{buildType:r}=e.storeService.getPlatformInfo();return r===a.ApplicationBuildType.QA?c(e,t):s(e,t)}async function s(e,t){let r=t.logStorage.containsPriorityEvent();try{if(await (0,n.storeEventsInQueue)(e,t),r)return await (0,o.sendEventQueueToStyx)(e);return{success:!0,result:a.StyxApiResult.NoBatchesSent}}catch(e){return{success:!1,result:a.StyxApiResult.NoBatchesSent}}}async function c(e,t){try{return await (0,o.immediatelySendEventsToStyx)(e,t)}catch(e){return{success:!1,result:a.StyxApiResult.NoBatchesSent}}}t.queueLogRepositoryEvents=i,t.queueEvents=s,t.immediatelySendEvents=c},98699:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.eventLoggerReducer=void 0;let a=r(38867);function o(){return{}}t.eventLoggerReducer=(e=o(),t)=>{switch(t.type){case a.CREATE_EVENT_LOGGER_VIRTUAL_STORE:return{[t.storeName]:t.initialState};case a.UPDATE_EVENT_LOGGER_STATE:return{[t.storeName]:t.updater(e[t.storeName])};default:return e}}},53127:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.styxKeysSelector=void 0,t.styxKeysSelector=e=>e.userSession.sdkAuthentication.styxKeys},2073:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.immediatelySendEventsToStyx=t.sendEventQueueToStyx=void 0;let a=r(20648),o=r(15535),n=r(31740),i=r(81290),s=r(2894),c=r(19894),l=r(98024),u=!1;async function d(e){if(!0===u)return{success:!0,result:a.StyxApiResult.NoBatchesSent};u=!0;let{storageService:t,storeService:r}=e,n=t.getLocalStorage(),i=(0,o.getCommonAppSetting)("eventLoggerQueueKey");if(!await n.itemExists(l.EVENT_QUEUE_STORAGE_KEY))return u=!1,{success:!0,result:a.StyxApiResult.NoBatchesSent};let c=await n.readItem(l.EVENT_QUEUE_STORAGE_KEY);if(!c)return u=!1,{success:!0,result:a.StyxApiResult.NoBatchesSent};if("string"!=typeof c)throw Error("value of EventLogger.eventQueue is expected to be a string");let d=await (0,s.decryptEvents)(r,c,i),p=d.filter(e=>"anonymous"===e.category),g=d.filter(e=>"user"===e.category),m=await S(r,p,"/v1/event/anonymous"),y=await S(r,g,"/v1/event/user"),f=await n.readItem(l.EVENT_QUEUE_STORAGE_KEY);if("string"!=typeof f)throw Error("value of EventLogger.eventQueue is expected to be a string");let E=(await (0,s.decryptEvents)(r,f,i)).filter(({id:e})=>!(m.includes(e)||y.includes(e))),A=await (0,s.encryptEvents)(r,E,i);await n.writeItem(l.EVENT_QUEUE_STORAGE_KEY,A);let h=m.length>0||y.length>0,_=0===A.length,T=a.StyxApiResult.NoBatchesSent;return _?T=a.StyxApiResult.AllBatchesSent:h&&(T=a.StyxApiResult.SomeBatchesSent),u=!1,{success:!0,result:T}}async function p(e,t){let{storeService:r}=e,o=t.logStorage.copy();t.logStorage.removeEvents(o.map(e=>e.id));let n=o.filter(e=>"anonymous"===e.category),i=o.filter(e=>"user"===e.category),s=await S(r,n,"/v1/event/anonymous"),c=await S(r,i,"/v1/event/user"),l=s.length>0||c.length>0,u=s.length+c.length===o.length,d=a.StyxApiResult.NoBatchesSent;return u?d=a.StyxApiResult.AllBatchesSent:l&&(d=a.StyxApiResult.SomeBatchesSent),{success:!0,result:d}}async function S(e,t,r){let a=[];if(!t||0===t.length)return a;let o=(0,i.getMakeStyxApiRequest)(r,n.ApiAuthType.App,n.ApiRequestMethod.POST),s=(0,c.chunkArray)(t,450);try{for(let t of s)if((await o(e,{payload:(0,i.getEventsPayload)(t)})).success)a=a.concat(t.map(({id:e})=>e));else break}catch{}return a}t.sendEventQueueToStyx=d,t.immediatelySendEventsToStyx=p},12770:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.logToggleAnalyticsEvent=t.logPageView=t.logEvent=void 0;let a=r(83533),o=r(20648),n=r(46021),i=r(19894),s=r(70891),c=r(98024);async function l(e,t){let{interactionDataConsent:r}=await (0,n.getGlobalExtensionSettings)(e);if(!1===r)return{result:o.StyxApiResult.NoBatchesSent,success:!1};let{logger:a,logRepository:c}=(0,i.createLogger)(e);return a.logEvent(t.event),(0,s.queueLogRepositoryEvents)(e,c)}async function u(e,t){let{interactionDataConsent:r}=await (0,n.getGlobalExtensionSettings)(e);if(!1===r)return{result:o.StyxApiResult.NoBatchesSent,success:!1};let{logger:a,logRepository:c}=(0,i.createLogger)(e);return a.logView(t.pageView,t.browseComponent),(0,s.queueLogRepositoryEvents)(e,c)}async function d(e){let{interactionDataConsent:t}=await (0,n.getGlobalExtensionSettings)(e),{logger:r,logRepository:o}=(0,i.createLogger)(e),l=!1!==t;if(l||(0,c.clearEventQueue)(e,o),r.logEvent(new a.UserToggleAnalyticsEvent({isAnalyticsEnabled:l})),!t)try{return(0,s.immediatelySendEvents)(e,o)}catch{}return(0,s.queueLogRepositoryEvents)(e,o)}t.logEvent=l,t.logPageView=u,t.logToggleAnalyticsEvent=d},98024:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.clearEventQueue=t.storeEventsInQueue=t.EVENT_QUEUE_STORAGE_KEY=void 0;let a=r(15535),o=r(2894);async function n(e,r){let{storageService:n,storeService:i}=e,s=n.getLocalStorage(),c=(0,a.getCommonAppSetting)("eventLoggerQueueKey"),l=r.logStorage.copy(),u=[],d=[];if(await s.itemExists(t.EVENT_QUEUE_STORAGE_KEY)){let e=await s.readItem(t.EVENT_QUEUE_STORAGE_KEY);if("string"!=typeof e)throw Error("value of EventLogger.eventQueue is expected to be a string");e&&(u=await (0,o.decryptEvents)(i,e,c))}(u=u.concat(l)).map(e=>d.filter(t=>t.id===e.id).length>0?null:d.push(e));let p=await (0,o.encryptEvents)(i,d,c);await s.writeItem(t.EVENT_QUEUE_STORAGE_KEY,p);let S=l.map(e=>e.id);r.logStorage.removeEvents(S)}async function i(e,r){let{storageService:n,storeService:i}=e,s=n.getLocalStorage(),c=(0,a.getCommonAppSetting)("eventLoggerQueueKey"),l=await (0,o.encryptEvents)(i,[],c);await s.writeItem(t.EVENT_QUEUE_STORAGE_KEY,l);let u=r.logStorage.copy().map(e=>e.id);r.logStorage.removeEvents(u)}t.EVENT_QUEUE_STORAGE_KEY="EventLogger.eventQueue",t.storeEventsInQueue=n,t.clearEventQueue=i},66087:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.EventLoggerStoreFactory=void 0;let a=r(38867);t.EventLoggerStoreFactory=class{constructor(e){this.storeService=e}createStore(e,t){let{storeService:r}=this;return r.dispatch((0,a.createEventLoggerVirtualStore)({storeName:e,initialState:t.initialState})),this.makeStore(e)}getStore(e){if(!this.hasStore(e))throw Error(`Store ${e} was not found`);return this.makeStore(e)}hasStore(e){let{storeService:t}=this;return e in t.getState().device.eventLogger}makeStore(e){let{storeService:t}=this;return{getState:()=>t.getState().device.eventLogger[e],updateState:r=>t.dispatch((0,a.updateEventLoggerVirtualStoreState)({storeName:e,updater:r}))}}}},23364:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.config=void 0;let a=r(67234);t.config={commands:{logException:{handler:a.logException}},liveQueries:{},queries:{}}},54105:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.bootstrap=void 0;let a=r(23364);t.bootstrap=e=>{e.register(a.config)}},80896:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.sendTypedExceptionLog=t.sendExceptionLog=t.setAllowedToSendExceptionLog=t.bootstrap=void 0;let a=r(89714),o=r(42096),n=r(22560);var i=r(54105);Object.defineProperty(t,"bootstrap",{enumerable:!0,get:function(){return i.bootstrap}});let s=!0;async function c(e){if(!s){console.log("[background/carbon] Not allowed to send exception logs");return}try{let t=(0,o.default)("carbonException",e);console.log("[background/carbon] Sending exception",t),await (0,a.default)(t)}catch(e){console.log("[background/carbon] Failed sending exception",e)}}async function l(e,t){if(s)try{await (0,a.default)((0,o.default)(e,t))}catch(e){n.Debugger.error(`[Exception] - sendTypedExceptionLog: ${e.message||e}`)}}t.setAllowedToSendExceptionLog=e=>s=e,t.sendExceptionLog=c,t.sendTypedExceptionLog=l},42096:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.anonymousSessionId=void 0;let a=r(42387),o=r(20648),n=r(65559),i=r(21837),s=r(3314);function c(e){let r=function(e){var t;let r=s.config.CODE_NAME,a=s.config.MANIFEST_VERSION;return JSON.stringify({...e,type:(t=(0,n.getPlatformInfo)()).platformName,version:t.appVersion,osVersion:t.osVersion,browser:t.browser,browserVersion:t.browserVersion,os:t.os,codeName:r,manifestVersion:a})}({...e.additionalInfo,legacy:!!e.legacy,line:e.line,sessionId:t.anonymousSessionId,errorCount:1});return{action:"logOnline",code:e.code===o.ExceptionCriticality.WARNING?o.ExceptionCriticality.WARNING:o.ExceptionCriticality.ERROR,message:e.message||"",exceptionType:e.type,functionName:e.funcName,file:e.fileName,stack:e.precisions,additionalInfo:r,featureFlips:[],initialUseCaseModule:e.initialUseCaseModule??"carbon",initialUseCaseName:e.initialUseCaseName,initialUseCaseStacktrace:JSON.stringify(e.useCaseStacktrace)}}t.anonymousSessionId=(0,a.v4)(),t.default=function(e,t){return function(e,t){if(t.error){let r=t.error.precisions&&"string"==typeof t.error.precisions?`${t.error.message}
${t.error.precisions}`:t.error.message,a=(0,i.isCarbonError)(t.error)?t.error.getAdditionalInfo():{};return c({type:e,message:r,code:t.code||t.error.errorLevel,precisions:t.error.stack,additionalInfo:a,initialUseCaseModule:"carbon",initialUseCaseName:""})}return c(Object.assign({type:e},t))}(e,t)}},89714:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.EXCEPTION_LOG_ENDPOINT=void 0;let a=r(36598),o=r(65559);t.EXCEPTION_LOG_ENDPOINT="https://api.dashlane.com/v1/monitoring/ReportClientException",t.default=function(e){return function(e,t,r){let a=e.message||e.functionName||e.file||"UNKNOWN_EXCEPTION";return(n[a]=n[a]||0,n[a]++,n[a]>10)?Promise.resolve():r()}(e,10,()=>{let r=(0,o.getPlatformInfo)();return(0,a.postDataToUrl)(t.EXCEPTION_LOG_ENDPOINT,e,{headers:{"Content-Type":"application/json","dashlane-client-agent":JSON.stringify({platform:r.platformName,version:r.appVersion})}}).then(()=>{}).catch(e=>{console.error("[background/carbon] Failed to send exception log",e)})})};let n={}},67234:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.logException=void 0;let a=r(80896);async function o(e,t){return await (0,a.sendTypedExceptionLog)(t.exceptionType,t.log),{success:!0}}t.logException=o},71491:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.EXCEPTION_LOG_TAG=t.DEBUGGER_LOG_TAG=t.LOGS_LOG_TAG=void 0,t.LOGS_LOG_TAG="Logs",t.DEBUGGER_LOG_TAG="Debugger",t.EXCEPTION_LOG_TAG="Exception"},97881:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.config=void 0;let a=r(38362),o=r(90712),n=r(20530),i=r(42585),s=r(13344);t.config={commands:{markNotificationAsInteracted:{handler:a.markNotificationAsInteracted},markNotificationAsSeen:{handler:o.markNotificationAsSeen},markNotificationAsUnseen:{handler:n.markNotificationAsUnseen}},queries:{getNotificationStatus:{selector:s.notificationsStatusSelector}},liveQueries:{liveNotificationStatus:{operator:i.notificationsStatus$}}}},84767:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.bootstrap=void 0;let a=r(97881);t.bootstrap=e=>{e.register(a.config)}},74137:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.bootstrap=void 0;var a=r(84767);Object.defineProperty(t,"bootstrap",{enumerable:!0,get:function(){return a.bootstrap}})},38362:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.markNotificationAsInteracted=void 0;let a=r(50666),o=r(13344),n=async(e,t)=>{let{storeService:r,localStorageService:n}=e;r.dispatch((0,a.markAsInteracted)(t));let i=(0,o.notificationsStatusSelector)(r.getState());n.getInstance().storeNotificationsStatus(i)};t.markNotificationAsInteracted=n},90712:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.markNotificationAsSeen=void 0;let a=r(50666),o=r(13344),n=async(e,t)=>{let{storeService:r,localStorageService:n}=e;r.dispatch((0,a.markAsSeen)(t));let i=(0,o.notificationsStatusSelector)(r.getState());n.getInstance().storeNotificationsStatus(i)};t.markNotificationAsSeen=n},20530:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.markNotificationAsUnseen=void 0;let a=r(50666),o=r(13344),n=async(e,t)=>{let{storeService:r,localStorageService:n}=e;r.dispatch((0,a.markAsUnseen)(t));let i=(0,o.notificationsStatusSelector)(r.getState());n.getInstance().storeNotificationsStatus(i)};t.markNotificationAsUnseen=n},20447:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.config=void 0;let a=r(28447),o=r(52355),n=r(71476);t.config={commands:{generatePassword:{handler:a.generatePasswordHandler},generateAndSavePassword:{handler:a.generateAndSavePasswordHandler},savePasswordGenerationSettings:{handler:o.savePasswordGenerationSettingsHandler}},queries:{getPasswordGenerationSettings:{selector:n.passwordGenerationSettingsSelector}},liveQueries:{}}},33411:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.bootstrap=void 0;let a=r(20447);t.bootstrap=e=>{e.register(a.config)}},28447:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.generateAndSavePasswordHandler=t.generatePasswordHandler=void 0;let a=r(2901),o=r(22560),n=r(80896),i=r(6956);async function s(e,t){try{let r=(0,i.makeSessionController)(e).generatePassword(t.settings),o=await (0,a.evaluatePasswordStrength)(r);return{success:!0,password:r,strength:o}}catch(e){return(0,o.logError)(e),(0,n.sendExceptionLog)({error:e}),{success:!1}}}async function c(e,t){try{let r=(0,i.makeSessionController)(e).generateAndSavePassword(t.url),o=await (0,a.evaluatePasswordStrength)(r);return{success:!0,password:r,strength:o}}catch(e){return(0,o.logError)(e),(0,n.sendExceptionLog)({error:e}),{success:!1}}}t.generatePasswordHandler=s,t.generateAndSavePasswordHandler=c},52355:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.savePasswordGenerationSettingsHandler=void 0;let a=r(83533),o=r(22560),n=r(80896),i=r(19767),s=r(80990),c=r(17620);async function l(e,t){try{var r;let o={GeneratorDefaultSize:(r=(0,i.fixIncoherentSettings)(t)).length,GeneratorDefaultAvoidAmbiguousChars:r.avoidAmbiguous,GeneratorDefaultDigits:r.digits,GeneratorDefaultLetters:r.letters,GeneratorDefaultSymbols:r.symbols};(0,s.updatePersonalSettings)(e.storeService,e.sessionService,o),(0,c.getDebounceSync)(e.storeService,e.sessionService)({immediateCall:!0},a.Trigger.SettingsChange)}catch(e){(0,o.logError)(e),(0,n.sendExceptionLog)({error:e})}}t.savePasswordGenerationSettingsHandler=l},71476:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.passwordGenerationSettingsSelector=void 0;let a=r(93748),o=r(19767);t.passwordGenerationSettingsSelector=function(e){let t=(0,a.personalSettingsSelector)(e);return(0,o.getDefaultPasswordGenerationSettings)(t)}},87134:function(e,t){async function r(e,t){let{password:r}=t,{applicationModulesAccess:a}=e,{commands:{temporaryCheckMasterPassword:o}}=a.createClients().masterPasswordSecurity;await o({password:r})}Object.defineProperty(t,"__esModule",{value:!0}),t.checkPasswordLeaked=void 0,t.checkPasswordLeaked=r},70104:function(e,t){async function r(e,t){let{password:r}=t,{applicationModulesAccess:a}=e,{commands:{temporaryCheckMasterPasswordWeak:o}}=a.createClients().masterPasswordSecurity;await o({password:r})}Object.defineProperty(t,"__esModule",{value:!0}),t.checkPasswordWeak=void 0,t.checkPasswordWeak=r},34807:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.shouldTriggerMasterPasswordWeakCheck=t.shouldTriggerMasterPasswordLeakCheck=void 0;let a=r(93748);async function o(e){return!!(0,a.isAuthenticatedSelector)(e)}t.shouldTriggerMasterPasswordLeakCheck=function(e){return(0,a.isAuthenticatedSelector)(e)},t.shouldTriggerMasterPasswordWeakCheck=o},74617:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.setupSubscriptions=void 0;let a=r(49606);t.setupSubscriptions=function(e,t){e._sessionOpened.on(()=>{(0,a.triggerMasterPasswordLeakCheck)(t)})}},49606:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.triggerMasterPasswordLeakCheck=void 0;let a=r(87134),o=r(93748),n=r(59565),i=r(34807),s=r(70104);async function c(e){let t=e.storeService.getState();if((0,n.isSSOUserSelector)(t))return;let r=(0,o.masterPasswordSelector)(t);await (0,a.checkPasswordLeaked)(e,{password:r}),await (0,i.shouldTriggerMasterPasswordWeakCheck)(t)&&await (0,s.checkPasswordWeak)(e,{password:r})}t.triggerMasterPasswordLeakCheck=c},8177:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.config=void 0;let a=r(38121),o=r(59253),n=r(92756);t.config={commands:{cancelAutoRenew:{handler:o.cancelAutoRenew},fetchInvoiceList:{handler:n.fetchInvoiceList}},queries:{getInvoicesCount:{selector:a.allInvoicesLengthSelector},getInvoiceList:{selector:a.viewedQueriedInvoicesSelector},getInvoiceListYears:{selector:a.invoiceListYearsSelector}},liveQueries:{}}},41167:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.bootstrap=void 0;let a=r(8177);t.bootstrap=e=>{e.register(a.config)}},59253:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.cancelAutoRenew=void 0;let a=r(80896);async function o(e){let{sessionService:t,storeService:r}=e;if(!r.isAuthenticated())return{success:!1};try{return await t.getInstance().payment.cancelPremiumSubscription(),{success:!0}}catch(r){let e=`[SessionController] - cancelPremiumSubscription: ${r}`,t=Error(e);return(0,a.sendExceptionLog)({error:t}),{success:!1,error:{code:e}}}}t.cancelAutoRenew=o},92756:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.fetchInvoiceList=void 0;let a=r(28323),o=r(12709),n=r(68220);async function i(e){let{storeService:t}=e,r=t.getUserLogin();if(!t.isAuthenticated())return{success:!1};try{let e=await (0,o.listInvoices)(t,r);if((0,a.isApiError)(e))return{success:!1};return t.dispatch((0,n.receivedInvoiceList)(e.invoices)),{success:!0}}catch(e){return{success:!1}}}t.fetchInvoiceList=i},64132:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.bootstrap=void 0;var a=r(41167);Object.defineProperty(t,"bootstrap",{enumerable:!0,get:function(){return a.bootstrap}})},28919:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.getInvoiceMappers=void 0;let a=r(60974),o=e=>"advanced"===e.planFeature?"ADVANCED":"essentials"===e.planFeature?"ESSENTIALS":["family_created","family_renewed"].includes(e.eventType)?"FAMILY":"sync"===e.planFeature?"PREMIUM":"OTHER",n=e=>(0,a.fromUnixTime)(e.startDate).getFullYear().toString();t.getInvoiceMappers=()=>({amountPaid:e=>e.amountPaid,invoiceId:e=>e.invoiceId,planName:e=>o(e),startDate:e=>e.startDate,startYear:e=>n(e)})},37831:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.config=void 0;let a=r(70394),o=r(76857),n=r(48634),i=r(82186);t.config={commands:{unlockProtectedItems:{handler:a.unlockProtectedItems},disableCredentialProtection:{handler:n.disableCredentialProtectionHandler}},queries:{vaultLockDate:{selector:o.vaultLockDateSelector}},liveQueries:{liveVaultLockDate:{operator:i.vaultLockDate$}}}},70394:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.unlockProtectedItems=void 0;let a=r(20648),o=r(49087);async function n(e,t){let{storeService:r,masterPasswordEncryptorService:n}=e;return await (0,o.validateMasterPassword)(r,n,t)?{status:a.UnlockProtectedItemsStatus.SUCCESS}:{status:a.UnlockProtectedItemsStatus.ERROR,error:{code:a.unlockProtectedItemsWrongPasswordError}}}t.unlockProtectedItems=n},9299:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.bootstrap=void 0;let a=r(37831);t.bootstrap=e=>{e.register(a.config)}},48634:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.disableCredentialProtectionHandler=void 0;let a=r(20648),o=r(67095);async function n(e,{credentialId:t}){let{storeService:r,sessionService:n,eventLoggerService:i,applicationModulesAccess:s}=e;try{return await (0,o.disableCredentialProtection)({storeService:r,sessionService:n,eventLoggerService:i,applicationModulesAccess:s},t),{status:a.DisableCredentialProtectionStatus.SUCCESS}}catch(e){return{status:a.DisableCredentialProtectionStatus.ERROR}}}t.disableCredentialProtectionHandler=n},67095:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.disableCredentialProtection=void 0;let a=r(13768),o=r(11369),n=({update:{autoprotected:e}})=>({AutoProtected:e});async function i({storeService:e,sessionService:t,eventLoggerService:r,applicationModulesAccess:i},s){let c=e.getState();if(!(0,a.credentialSelector)(c,s))throw Error("Credential does not exist, cant update");(0,o.updateCredential)({storeService:e,sessionService:t,eventLoggerService:r,applicationModulesAccess:i},{id:s,update:{autoprotected:!1}},n)}t.disableCredentialProtection=i},22409:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.bootstrap=void 0;var a=r(9299);Object.defineProperty(t,"bootstrap",{enumerable:!0,get:function(){return a.bootstrap}})},82186:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.vaultLockDate$=void 0;let a=r(95121),o=r(76857),n=r(15237);t.vaultLockDate$=()=>(0,a.pipe)((0,n.map)(o.vaultLockDateSelector))},76857:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.vaultLockDateSelector=t.gracePeriodSelector=void 0;let a=r(59565),o=r(93748);t.gracePeriodSelector=e=>/^kw_test_auto_fmpc_.*/.test((0,o.userLoginSelector)(e))?5e3:3e5,t.vaultLockDateSelector=e=>(0,a.isSSOUserSelector)(e)?null:(0,o.lastMasterPasswordCheckSelector)(e)+(0,t.gracePeriodSelector)(e)},23733:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.config=void 0;let a=r(37736),o=r(91848),n=r(33345),i=r(93748),s=r(29575);t.config={commands:{activateAccountRecovery:{handler:o.activateAccountRecovery},setupMasterPasswordForRecovery:{handler:n.setupMasterPasswordForRecovery},deactivateAccountRecovery:{handler:o.deactivateAccountRecovery},registerDeviceForRecovery:{handler:n.registerDeviceForRecovery},startAccountRecovery:{handler:n.startAccountRecovery},sendRecoveryRequest:{handler:n.sendRecoveryRequest},cancelRecoveryRequest:{handler:n.cancelRecoveryRequest},checkRecoveryRequestStatus:{handler:n.checkRecoveryRequestStatus},recoverUserData:{handler:n.recoverUserData},checkDoesLocalRecoveryKeyExist:{handler:n.checkDoesLocalRecoveryKeyExist},isRecoveryRequestPending:{handler:o.isRecoveryRequestPending}},queries:{getRecoveryOptInSetting:{selector:i.accountRecoveryOptInSelector},getAccountRecoveryRequestCount:{selector:a.accountRecoveryRequestsCountSelector}},liveQueries:{liveAccountRecoveryRequestCount:{operator:s.accountRecoveryRequestsCount$}}}},12589:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.makeRecoveryController=void 0;let a=r(67972),o=r(22560),n=r(80896),i=r(12610),s=r(72331);function c(e,t,r){return(0,n.sendExceptionLog)({error:t}),o.Debugger.log(e,t),{error:{message:t.message,action:r}}}t.makeRecoveryController=(e,t)=>({getMasterPasswordResetDemandList:r=>(function(e,t,r,a){let o=a.teamId;return t.recovery.getPendingRequests({login:r.login,uki:r.uki,teamId:o}).then(t=>{let a=Object.assign({},e.getTeamAdminData()),n=t.filter(e=>e.login!==r.login);return a.teams[o]&&(a.teams[o].notifications={accountRecoveryRequests:n},(0,s.updateTeamAdminData)(e,a)),{demands:n}}).catch(e=>({demands:[],error:c("Master Password Reset: Error while getPendingRequests",e,a).error}))})(e,t,(0,i.getCurrentUserInfo)(e),r),acceptMasterPasswordResetDemand:r=>(function(e,t,r){let o=(0,a.makeAsymmetricEncryption)();return o.decrypt(t.privateKey,r.recoveryKey).then(e=>o.encrypt(r.userPublicKey,e)).then(a=>e.recovery.acceptRequest({login:t.login,uki:t.uki,sourceLogin:r.login,payload:a})).then(()=>({})).catch(e=>c("Master Password Reset: Error while acceptRequest",e,r))})(t,(0,i.getCurrentUserInfo)(e),r),declineMasterPasswordResetDemand:r=>{var a,o,n;return a=t,o=(0,i.getCurrentUserInfo)(e),n=r,a.recovery.refuseRequest({login:o.login,uki:o.uki,sourceLogin:n.login}).then(()=>({})).catch(e=>c("Master Password Reset: Error while refuseRequest",e,n))}})},20989:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.bootstrap=void 0;let a=r(23733);t.bootstrap=e=>{e.register(a.config)}},75125:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.bootstrap=void 0;var a=r(20989);Object.defineProperty(t,"bootstrap",{enumerable:!0,get:function(){return a.bootstrap}})},29575:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.accountRecoveryRequestsCount$=void 0;let a=r(95121),o=r(15237),n=r(37736);t.accountRecoveryRequestsCount$=function(){return(0,a.pipe)((0,o.map)(e=>(0,n.accountRecoveryRequestsCountSelector)(e)),(0,o.distinctUntilChanged)())}},37736:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.accountRecoveryRequestsCountSelector=t.selectTeamAdminData=t.recoveryHashFromPremiumStatusSelector=t.recoveryHashFromPersonalSettingsSelector=t.shouldShowFeatureActivationModalSelector=void 0;let a=r(35192),o=r(59565),n=r(93748),i=r(4790),s=r(49548);t.shouldShowFeatureActivationModalSelector=(0,s.createSelector)([o.isSSOUserSelector,a.isRecoveryEnabledSelector,e=>"boolean"==typeof e.userSession.personalSettings.RecoveryOptIn,e=>e.userSession.session.isFirstSessionAfterAccountCreation],(e,t,r,a)=>!e&&t&&!r&&!a),t.recoveryHashFromPersonalSettingsSelector=e=>(0,n.personalSettingsSelector)(e).RecoveryHash||"",t.recoveryHashFromPremiumStatusSelector=e=>(0,n.premiumStatusSelector)(e).recoveryHash||"",t.selectTeamAdminData=e=>e.userSession.teamAdminData??{teams:{}},t.accountRecoveryRequestsCountSelector=e=>{let r=(0,i.getCurrentTeamId)(e.userSession.spaceData);if(!r)return 0;let{teams:a}=(0,t.selectTeamAdminData)(e);return Number(a[r]?.notifications?.accountRecoveryRequests?.length??0)}},33345:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.recoverUserData=t.checkDoesLocalRecoveryKeyExist=t.cancelRecoveryRequest=t.checkRecoveryRequestStatus=t.sendRecoveryRequest=t.setupMasterPasswordForRecovery=t.registerDeviceForRecovery=t.startAccountRecovery=void 0;let a=r(20648),o=r(80896),n=r(45407),i=r(4455),s=r(93787),c=r(67972),l=r(28323),u=r(7108),d=r(93748),p=r(49789),S=r(27698),g=r(72375),m=r(72287),y=r(9779);function f(e){return"u2f"===e.type?{type:"u2f",challenges:e.challenges??[]}:e}async function E(e,t){let{storeService:r}=e,{login:o}=t,n=await (0,l.getAuthenticationMethodsForDevice)(r,{login:o,methods:i.remoteSupportedAuthenticationMethod});if((0,l.isApiError)(n))return{success:!1,error:{code:a.RecoveryApiErrorType.StartAccountRecoveryFailed,message:`Start account recovery failed: ${n.message}`}};let s=n.verifications.map(f);return r.dispatch((0,g.saveRecoverySessionData)({verificationMethod:s})),{success:!0,verification:s}}async function A(e,t){try{let{token:r,login:o}=t,{storeService:c,wsService:d}=e,p=c.getState(),S=c.getPlatformInfo().platformName,m=await (0,l.getAuthenticationMethodsForDevice)(c,{login:o,methods:i.remoteSupportedAuthenticationMethod});if((0,l.isApiError)(m))return{success:!1,error:{code:a.RecoveryApiErrorType.RegisterDeviceFailed,message:"Recovery Device request registration failed"}};let y=(0,u.recoveryIsOtpSelector)(p),f=await (0,s.ensureDeviceId)(),E=(0,n.generateUki)(f),A={uki:E,login:o,platform:S,temporary:i.PersistData.PERSIST_DATA_NO,recovery:!0},h=await d.authentication.registerUki({...A,...y?{otp:r}:{token:r}});if("SUCCESS"!==h)return{success:!1,error:{code:a.RecoveryApiErrorType.RegisterDeviceFailed,message:"Recovery Device registration failed"}};c.dispatch((0,g.saveRecoverySessionData)({recoveryUki:E}))}catch(e){return(0,o.sendExceptionLog)({error:e}),{success:!1,error:{code:a.RecoveryApiErrorType.RegisterDeviceFailed,message:e.message}}}return{success:!0}}async function h(e,t){let r="[Account Recovery PI] - Setup Master Password For Recovery ",n=e=>{r+=`- ${e} 
`};try{let{storeService:i,localStorageService:s}=e,{masterPassword:l}=t,d=i.getState();n("recoveryUki select START");let S=(0,u.recoveryUkiSelector)(d);if(!S){let e={code:a.RecoveryApiErrorType.SetupMasterPasswordForRecoveryFailed,message:"recoveryUki does not exist"};return n(`setupMasterPasswordForRecovery failed with error: ${e.code} ${e.message}`),(0,o.sendExceptionLog)({message:r,funcName:"setupMasterPasswordForRecovery"}),{success:!1,error:e}}n("recoveryUki select SUCCESS"),n("dispatch updateMasterPassword START"),i.dispatch((0,p.updateMasterPassword)(l)),n("dispatch updateMasterPassword SUCCESS"),n("makeCyptoService START");let m=(0,c.makeCryptoService)();n("makeCyptoService SUCCESS"),n("generateRsaKeyPair START");let{publicKey:f,privateKey:E}=await m.asymmetricEncryption.generateRsaKeyPair();n("generateRsaKeyPair SUCCESS"),n("dispatch saveRecoverySessionData START"),i.dispatch((0,g.saveRecoverySessionData)({publicKey:f})),n("dispatch saveRecoverySessionData SUCCESS"),n("encryptUkiAndPrivateKey START");let A=await (0,y.encryptUkiAndPrivateKey)(S,E,l,i);return n("encryptUkiAndPrivateKey SUCCESS"),n("storeRecoveryData START"),await s.getInstance().storeRecoveryData(A),n("storeRecoveryData SUCCESS"),{success:!0}}catch(e){return n(`setupMasterPasswordForRecovery failed with error: ${e}`),(0,o.sendExceptionLog)({message:r,funcName:"setupMasterPasswordForRecovery",precisions:e.stack}),{success:!1,error:{code:a.RecoveryApiErrorType.SetupMasterPasswordForRecoveryFailed,message:e.message}}}}async function _(e){try{let{storeService:t,wsService:r}=e;return await (0,y.sendRecoveryRequestToAdmin)(t,r),{success:!0}}catch(e){return(0,o.sendExceptionLog)({error:e}),{success:!1,error:{code:a.RecoveryApiErrorType.RecoveryRequestFailed,message:e.message}}}}async function T(e,t){try{let{storeService:r,localStorageService:o,wsService:n}=e,{masterPassword:i}=t,s=r.getState(),c=(0,d.userLoginSelector)(s);if(!c)return{success:!1,error:{code:a.RecoveryApiErrorType.CheckRecoveryStatusFailed,message:"Missing login"}};r.dispatch((0,p.updateMasterPassword)(i));let l=await (0,y.retrieveRecoveryUkiFromStorage)(r,o,i),{content:{status:u,payload:S,recoveryServerKey:m}}=await n.recovery.request({login:c,uki:l});return S&&m&&r.dispatch((0,g.saveRecoverySessionData)({userServerProtectedSymmetricalKey:S,recoveryServerKeyBase64:m})),{success:!0,response:{status:u}}}catch(e){return{success:!1,error:{code:a.RecoveryApiErrorType.CheckRecoveryStatusFailed,message:e.message}}}}async function v(e){try{let{storeService:t,localStorageService:r,wsService:a}=e,o=t.getState(),n=(0,d.userLoginSelector)(o),i=(0,d.masterPasswordSelector)(o),s=await (0,y.retrieveRecoveryUkiFromStorage)(t,r,i);return await a.recovery.cancelRequest({login:n,uki:s}),await r.getInstance().cleanRecoveryData(),{success:!0}}catch(e){return{success:!1,error:{code:a.RecoveryApiErrorType.CancelRecoveryRequestFailed,message:e.message}}}}async function I(e){try{let{localStorageService:t}=e,r=t.getInstance(),a=await r.doesRecoveryLocalKeyExist();return{success:!0,doesExist:a}}catch(e){return{success:!1,error:{code:a.RecoveryApiErrorType.CheckLocalRecoveryKeyFailed,message:e.message}}}}async function D(e,t){let{localStorageService:r,storeService:n,sessionService:s}=e,l=n.getState(),p=r.getInstance(),f=await (0,y.validateInitialData)(l,p),E="[Account Recovery PI] - Recover User Data ",A=e=>{E+=`- ${e} 
`};if(!f.success)return f;let{masterPassword:h}=t;try{A("Extract PrKey START");let t=await (0,y.extractPrivateKeyFromRecoveryData)(e,h,A);A("Extract PrKey SUCCESS");let{userServerProtectedSymmetricalKey:r}=(0,u.recoveryDataSelector)(l),s=await (0,c.makeAsymmetricEncryption)();A("Decrypt user protected key START");let S=await s.decrypt(t,r);A("Decrypt user protected key SUCCESS"),A("Decrypt server protected key START");let f=await (0,y.extractRecoveryKey)(n,S,A);A("Decrypt server protected key SUCCESS"),A("Extract local Key START");let _=await (0,y.extractLocalKey)(e,f,A);A("Extract local Key SUCCESS"),await (0,y.prepareLocalDataEncryptorService)(e,_),A("Get recovery credentials START");let T=await p.getRecoverySessionCredential();A("Get recovery credentials SUCCESS");let{masterPassword:v}=JSON.parse(atob(T)),I=(0,d.userLoginSelector)(l),D=i.PersistData.PERSIST_DATA_YES;n.dispatch((0,g.saveRecoverySessionData)({recoveryInProgress:!0})),A("Open session START");let P=await (0,m.openSessionWithMasterPassword)(e,I,v,{isDataPersisted:D,serverKey:(0,d.serverKeySelector)(l)},A);if(A("Open session SUCCESS"),P!==a.LoginResultEnum.LoggedIn)return A("Open session SUCCESS but user not logged in"),(0,o.sendExceptionLog)({message:E,funcName:"recoverUserData"}),(0,y.recoveryFlowError)(a.RecoveryApiErrorType.RecoverUserDataFailed,`Unable to login with ${P}`);n.dispatch((0,g.saveRecoverySessionData)({recoveryInProgress:!1,currentPassword:v}))}catch(e){return A(`Recovery failed with error: ${e}`),(0,o.sendExceptionLog)({message:E,funcName:"recoverUserData",precisions:e.stack}),n.dispatch((0,g.resetRecoverySessionData)()),await s.close(!1),(0,S.triggerOpenSessionFailed)(Error(S.AuthenticationCode[S.AuthenticationCode.WRONG_PASSWORD])),(0,y.recoveryFlowError)(a.RecoveryApiErrorType.RecoverUserDataFailed,"Unable to decipher data")}return{success:!0}}t.startAccountRecovery=E,t.registerDeviceForRecovery=A,t.setupMasterPasswordForRecovery=h,t.sendRecoveryRequest=_,t.checkRecoveryRequestStatus=T,t.cancelRecoveryRequest=v,t.checkDoesLocalRecoveryKeyExist=I,t.recoverUserData=D},9779:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.storeSessionCredentialForRecovery=t.prepareLocalDataEncryptorService=t.extractLocalKey=t.extractRecoveryKey=t.extractPrivateKeyFromRecoveryData=t.validateInitialData=t.recoveryFlowError=t.retrieveRecoveryUkiFromStorage=t.triggerCleanOrSetupAccountRecovery=t.isARFeatureActivatedForUser=t.isARAvailableForUser=t.sendRecoveryRequestToAdmin=t.encryptUkiAndPrivateKey=t.resetAdminProtectedSymmetricalKeys=t.sendAdminProtectedSymmetricalKeys=t.getAdminProtectedSymmetricalKeys=t.encryptRecoveryData=t.getRecoveryKey=t.getSetupRequisitesData=void 0;let a=r(20648),o=r(27762),n=r(34978),i=r(25434),s=r(93308),c=r(12971),l=r(18040),u=r(67972),d=r(92180),p=r(80896),S=r(93748),g=r(59565),m=r(72375),y=r(49789),f=r(7108),E=r(4455),A=r(35192),h=r(91848),_=r(37736);function T(e){let t=e.getState(),r=(0,S.activeSpacesSelector)(t)[0],a=r?.teamId;if(!a)throw Error("[getSetupRequisitesData] - user should be part of a team to activate Account Recovery");let n=Number(a),i=(0,S.userLoginSelector)(t),s=(0,o.ukiSelector)(t);if(!i||!s)throw Error("[getSetupRequisitesData] - missing login or uki");return{teamId:n,login:i,uki:s}}async function v(e,t){try{let{teamId:r,login:a,uki:o}=T(e),{content:n}=await t.recovery.getSetupRequisites({login:a,uki:o,teamId:r});return n}catch(e){throw Error(`[getSetupRequisitesData] - getSetupRequisites failed with error ${e}`)}}async function I(e){let t;let r=e.getState(),a=(0,S.recoveryKeySelector)(r);return a?t=(0,s.base64ToBuffer)(a):(t=await (0,c.generateAESKey)(),a=(0,s.bufferToBase64)(t)),{recoveryKeyBufferClear:t,recoveryKeyBase64Clear:a,recoveryKeyRawClear:atob(a)}}async function D({storeService:e,encryptionKey:t,data:r}){let a=(0,i.makeDataEncryptorService)(e),o=(0,d.getCryptoConfig)(e);a.setInstance({raw:t},"",o);let n=await a.getInstance().encrypt(r);return a.close(),n}async function P({storeService:e,encryptedData:t,encryptionKey:r}){let a=(0,i.makeDataEncryptorService)(e),{cryptoConfig:o}=(0,d.parsePayload)(d.ARGON2_DEFAULT_PAYLOAD);a.setInstance({raw:r},"",o);let n=await a.getInstance().decrypt(t,{logging:!0});return a.close(),n}async function O(e,t){let r=(0,u.makeAsymmetricEncryption)(),a=[];for(let o of e){let{login:e,publicKey:n}=o,i=await r.encrypt(n,t);a.push({login:e,key:i})}return a}async function C(e,t,r){try{let a=JSON.stringify(r),{teamId:o,login:n,uki:i}=T(e);await t.recovery.setRecoveryClientKeys({login:n,uki:i,recoveryClientKeys:a,teamId:o});return}catch(e){throw Error(`[sendAdminProtectedSymmetricalKeys] - setRecoveryClientKeys failed with error ${e}`)}}async function b(e,t){try{let{teamId:r,login:a,uki:o}=T(e),n=JSON.stringify([]);await t.recovery.setRecoveryClientKeys({login:a,uki:o,recoveryClientKeys:n,teamId:r});return}catch(e){throw Error(`[resetAdminProtectedSymmetricalKeys] - setRecoveryClientKeys failed with error ${e}`)}}async function R(e,t,r,a){let o=JSON.stringify({recoveryUki:e,privateKey:t}),i=(0,n.deflateUtf16)(o);return await D({storeService:a,encryptionKey:r,data:i})}async function N(e,t){try{let r=e.getState(),a=(0,S.userLoginSelector)(r),{recoveryUki:o,publicKey:n}=(0,f.recoveryDataSelector)(r);if(!a||!o||!n)throw Error("Missing recoveryUki or publicKey");await t.recovery.request({login:a,uki:o,publicKey:n});return}catch(e){throw Error(`[sendAccountRecoveryRequest] - failed with error ${e}`)}}function w(e){let t=(0,g.isSSOUserSelector)(e),r=(0,A.isRecoveryEnabledSelector)(e);return!t&&r}function L(e){let t=w(e),r=(0,S.accountRecoveryOptInSelector)(e);return t&&r}async function U(e,t){let r=e.getState();if(!L(r))return Promise.resolve(!1);let{persistData:a}=e.getAccountInfo();if(a===E.PersistData.PERSIST_DATA_NO)return Promise.resolve(!1);let o=!!(0,S.recoveryKeySelector)(r),n=!!await t.getInstance().doesRecoveryLocalKeyExist();return!o||!n||(0,_.recoveryHashFromPersonalSettingsSelector)(r)!==(0,_.recoveryHashFromPremiumStatusSelector)(r)}async function M(e,t){let r=L(e.getState()),a=t.getInstance(),o=!!await a.doesRecoveryLocalKeyExist(),n=!!await a.doesRecoverySessionCredentialExist();return!r&&(o||n)}async function F(e){let{storeService:t,localStorageService:r,wsService:a}=e,o=t.getState();if(!(0,f.recoveryInProgressSelector)(o)){if(await r.getInstance().cleanRecoveryData(),await U(t,r)){await (0,h.setupAccountRecoveryForDevice)(t,r,a);return}await M(t,r)&&await r.getInstance().cleanRecoverySetupData()}}async function k(e,t,r){try{let a=await t.getInstance().getRecoveryData(),o=await P({storeService:e,encryptedData:a,encryptionKey:r}),i=(0,n.inflateUtf16)(o),{recoveryUki:s}=JSON.parse(i);return s}catch(e){throw Error(`retrieveRecoveryUkiFromStorage failed with error ${e.message}`)}}async function K(e,r){if(!await r.doesRecoveryLocalKeyExist()||!await r.doesRecoveryDataExist()||!await r.doesRecoverySessionCredentialExist())return(0,t.recoveryFlowError)(a.RecoveryApiErrorType.RecoverUserDataFailed,"Missing local data");let{userServerProtectedSymmetricalKey:o,recoveryServerKeyBase64:n}=(0,f.recoveryDataSelector)(e);return o&&n?{success:!0}:(0,t.recoveryFlowError)(a.RecoveryApiErrorType.RecoveryRequestFailed,"missing payload")}async function B(e,t,r){let{localStorageService:a,storeService:o}=e,i=a.getInstance();r("extractPrivateKeyFromRecoveryData - getRecoveryData");let c=await i.getRecoveryData(),l=o.getPlatformInfo();r(`[extra] platform: ${l.platformName}`),r(`[extra] browser: ${l.browser} @ ${l.browserVersion}`);let u=(0,s.base64ToBuffer)(c),p=(0,d.parseCipheredData)(new Uint8Array(u));r(`[extra] cryptoConfig derivation: ${JSON.stringify(p.cryptoConfig)}`),r("extractPrivateKeyFromRecoveryData - decryptRecoveryData");let S=await P({storeService:o,encryptedData:c,encryptionKey:t});r("extractPrivateKeyFromRecoveryData - inflateUtf16 data");let g=(0,n.inflateUtf16)(S);r("extractPrivateKeyFromRecoveryData - parse JSON data");let{recoveryUki:y,privateKey:f}=JSON.parse(g);return o.dispatch((0,m.saveRecoverySessionData)({recoveryUki:y})),f}async function G(e,t,r){let a=e.getState(),{recoveryServerKeyBase64:o}=(0,f.recoveryDataSelector)(a);if(!o)throw Error("Missing payload");let n=atob(o),i=e.getPlatformInfo();r(`[extra] platform: ${i.platformName}`),r(`[extra] browser: ${i.browser} @ ${i.browserVersion}`);let c=(0,s.base64ToBuffer)(t),l=(0,d.parseCipheredData)(new Uint8Array(c));r(`[extra] cryptoConfig derivation: ${JSON.stringify(l.cryptoConfig)}`),r("extractRecoveryKey - decryptRecoveryData");let u=await P({storeService:e,encryptedData:t,encryptionKey:n});return r("extractRecoveryKey - arrayBufferToText"),(0,s.arrayBufferToText)(u)}async function j(e,t,r){let{storeService:a,localStorageService:o}=e,i=o.getInstance();r("extractLocalKey - getRecoveryLocalKey");let c=await i.getRecoveryLocalKey(),l=e.storeService.getPlatformInfo();r(`[extra] platform: ${l.platformName}`),r(`[extra] browser: ${l.browser} @ ${l.browserVersion}`);let u=(0,s.base64ToBuffer)(c),p=(0,d.parseCipheredData)(new Uint8Array(u));r(`[extra] cryptoConfig derivation: ${JSON.stringify(p.cryptoConfig)}`),r("extractLocalKey - decryptRecoveryData");let S=await P({storeService:a,encryptedData:c,encryptionKey:t});return r("extractLocalKey - inflateUtf16 localKey"),(0,n.inflateUtf16)(S)}async function V(e,t){let{localDataEncryptorService:r,storeService:a}=e,o=e.storeService.getUserSession().serverKey,n=(0,l.getNoDerivationCryptoConfig)();r.setInstance({raw:t},o,n),await r.getInstance().prepareCrypto(),a.dispatch((0,y.updateLocalKey)(t))}async function W(e,t){let r=e.getState(),a=(0,S.masterPasswordSelector)(r);if(L(r)&&a){let e=btoa(JSON.stringify({masterPassword:a,recoveryKey:null}));await t.getInstance().storeRecoverySessionCredential(e)}}t.getSetupRequisitesData=v,t.getRecoveryKey=I,t.encryptRecoveryData=D,t.getAdminProtectedSymmetricalKeys=O,t.sendAdminProtectedSymmetricalKeys=C,t.resetAdminProtectedSymmetricalKeys=b,t.encryptUkiAndPrivateKey=R,t.sendRecoveryRequestToAdmin=N,t.isARAvailableForUser=w,t.isARFeatureActivatedForUser=L,t.triggerCleanOrSetupAccountRecovery=F,t.retrieveRecoveryUkiFromStorage=k,t.recoveryFlowError=(e,t)=>{let r=Error(`[AccountRecovery]: ${e} ${t}`);return(0,p.sendExceptionLog)({error:r}),{success:!1,error:{code:e,message:t}}},t.validateInitialData=K,t.extractPrivateKeyFromRecoveryData=B,t.extractRecoveryKey=G,t.extractLocalKey=j,t.prepareLocalDataEncryptorService=V,t.storeSessionCredentialForRecovery=W},91848:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.isRecoveryRequestPending=t.deactivateAccountRecovery=t.setupAccountRecoveryForDevice=t.activateAccountRecovery=void 0;let a=r(20648),o=r(34978),n=r(9779),i=r(6956),s=r(93748),c=r(33170);async function l(e){let{sessionService:t,storeService:r,localStorageService:o,wsService:l}=e,d=r.getState();if(!(0,n.isARAvailableForUser)(d))return{success:!1,error:{code:a.RecoveryApiErrorType.AccountRecoveryNotAvailableError}};(0,s.accountRecoveryOptInSelector)(d)||r.dispatch((0,c.editPersonalSettings)({RecoveryOptIn:!0}));try{await u(r,o,l),await t.getInstance().user.persistPersonalSettings(),await (0,i.sessionForceSync)(t)}catch(e){return{success:!1,error:{code:a.RecoveryApiErrorType.RecoverySetupFailed,message:e.message}}}return{success:!0}}async function u(e,t,r){let{hash:a,recipients:i,recoveryServerKey:s}=await (0,n.getSetupRequisitesData)(e,r),{recoveryKeyBufferClear:l,recoveryKeyBase64Clear:u,recoveryKeyRawClear:d}=await (0,n.getRecoveryKey)(e),p=t.getInstance(),S=await p.getLocalKey(),g=(0,o.deflateUtf16)(S),m=await (0,n.encryptRecoveryData)({storeService:e,encryptionKey:d,data:g});t.getInstance().storeRecoveryLocalKey(m);let y=atob(s),f=await (0,n.encryptRecoveryData)({storeService:e,encryptionKey:y,data:l}),E=await (0,n.getAdminProtectedSymmetricalKeys)(i,f);await (0,n.sendAdminProtectedSymmetricalKeys)(e,r,E),e.dispatch((0,c.editPersonalSettings)({RecoveryHash:a,RecoveryKey:u})),await (0,n.storeSessionCredentialForRecovery)(e,t)}async function d(e){let{sessionService:t,storeService:r,localStorageService:o,wsService:i}=e,s=r.getState();if(!(0,n.isARAvailableForUser)(s))return{success:!1,error:{code:a.RecoveryApiErrorType.AccountRecoveryNotAvailableError}};try{r.dispatch((0,c.editPersonalSettings)({RecoveryKey:"",RecoveryHash:"",RecoveryOptIn:!1})),await t.getInstance().user.persistPersonalSettings(),await o.getInstance().cleanRecoverySetupData(),await (0,n.resetAdminProtectedSymmetricalKeys)(r,i)}catch(e){return{success:!1,error:{code:a.RecoveryApiErrorType.RecoveryDeactivationFailed,message:e.message}}}return{success:!0}}async function p(e){try{let t=await e.localStorageService.getInstance().doesRecoveryDataExist();return{success:!0,response:t}}catch(e){return{success:!1,error:{code:a.RecoveryApiErrorType.IsRecoveryRequestPendingFailed,message:e}}}}t.activateAccountRecovery=l,t.setupAccountRecoveryForDevice=u,t.deactivateAccountRecovery=d,t.isRecoveryRequestPending=p},59029:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.setupSubscriptions=void 0;let a=r(9779);t.setupSubscriptions=function(e,t){e.carbonSessionOpened.on(()=>(0,a.triggerCleanOrSetupAccountRecovery)(t)),e.syncSuccess.on(()=>(0,a.triggerCleanOrSetupAccountRecovery)(t))}},83629:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.config=void 0;let a=r(33273),o=r(96829),n=r(39382);t.config={commands:{decipherRemoteFile:{handler:a.decipherRemoteFileHandler}},queries:{getFileContent:{selector:n.fileContentStrSelector}},liveQueries:{liveFileMeta:{operator:o.fileMetaUpdate$}}}},73323:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.bootstrap=void 0;let a=r(83629);t.bootstrap=e=>{e.register(a.config)}},18305:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.FILE_SETTINGS=t.REMOTE_FILE_KEY_PROD=t.REMOTE_FILE_KEY_DEV=void 0,t.REMOTE_FILE_KEY_DEV=`-----BEGIN PUBLIC KEY-----
MIICIjANBgkqhkiG9w0BAQEFAAOCAg8AMIICCgKCAgEAzOFwZBlj8livLhzIN8xm
y/c+gn9FpUNOEIPoiN7kcAlj+oIlWqW5TgRZLqvyA0WxhTcG7icTpC+UwBXvENdV
3nTzmuB8W6ZnRTjrtAlSxqp0Yfr2eQEGZFTlfBFUneqq4RZ6e/B3nIRHG1sEkVhd
oBbenPWou+WHqaqnah0AZVfxx4bJq1wor1LpH7gxELthvsThBelQz4Lmns4hCjzq
RCDjQ1PG9HpDwwRHyi9xJYWoLR6C3rHZ1mmldg7TS41cCWkKsPDiIrIzEN+94dGG
qSAx4kti0ltRcjLcBuJhQ3FHaAU7ksSubEg+l0W8PWAKjNbhUpFXduqXjxZ9nhuS
2sxETZoadgU6YDEyqk3W7c+dhpTioMZEsJXpBVdC2jbblPHBRXBTmdOdb7xlBrGQ
zoyPpS0PcI9oa8o9na9J8DSqnEbLwXdOlv4TUoxrswD6nmnR31/W+C4PSC8yEUEx
ESiG6IfAakFICxVESBp1VZA7NUbT6JkrhQaz//AVuGAyMoDuXorRGQPit+9DgF2l
eSr0zLzO2MVfMXXKBnueZmjNLvYy2Q2e8QX1jsuvwFhDBt1QmfisdiGSPC7jp0rO
Xdu5eCQuHVYeApipVKry58So783jimUa+mpA0/NUyiYaON7zndtZlQv/y+dqvseT
a2iA73nMVy4y9F95mwdG8ykCAwEAAQ==
-----END PUBLIC KEY-----`,t.REMOTE_FILE_KEY_PROD=`-----BEGIN PUBLIC KEY-----
MIICIjANBgkqhkiG9w0BAQEFAAOCAg8AMIICCgKCAgEAvlEdqD2jCU30/OembiWY
JKxrjiZuRgweXtV2e7yF1T5XyHkqDZ31a9W0rLWrVRbjr1qDdwU94L1iW/8RrUPK
2ue+2XH/8e8EH44Y9HYBeIUTciBKU6dqyqflaxY/wm3VO5af303ba564BVzv/31S
JiHa7QkeVqjY/Za1rv1ZOIwsYBC/SPIK+ofU7qSi6eY8PNe8bje0CFPcwfWRRkNB
ZLQwUwIED1w7playTR8boX5iju+TagAjKSphkj6u+fIkYPdFQgFjSTGu8OwTAerC
xqAWDSVy7fMxLdrDNrdwMTuQvlUIWiK+1CRHm1r6AXGywqCmrndw6q1LvFcwOgI1
2brPOx1BdDabUwau26lICDgPqA67Sk7GLTCv3hA2bHvJhK7E0c260u96hRwjDk/L
8tspQAYGzosyIMTmN29fEtBMlPwClZPqSVa7I7b3Csx4lhRkXI76WxAOmxf5dNQI
2O6dlrxumdfpM8O6ye3iq51D7ZNNegelee/BIrZEcJZzymvkrDDZHJs6oFQ7bERd
p+nJlr4xoiFd9BPCus6z994/8j7lNTvLanNwsdUYRP/tQJZqlhZ7vY+KpyXn+RGw
MYFeWXuH3cG05NwryH6676tcOrkboxbxMCMBUMvZK1CWS57noH/iztYivKNyItxf
i8uoqgc+vDOPPsdujlsgOkcCAwEAAQ==
-----END PUBLIC KEY-----`,t.FILE_SETTINGS={"phishing_urls_test.json":{isLoadedWhileLoggedOut:!0}}},33273:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.decipherRemoteFileHandler=void 0;let a=r(93750),o=r(93748),n=async({storeService:e},t)=>({decipheredFile:await (0,a.decipherRemoteFileUpdate)(t.cipheredFileContent,t.fileMetaData,(0,o.sharingKeysSelector)(e.getState()).privateKey)});t.decipherRemoteFileHandler=n},4693:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.downloadRemoteFileHandler=t.fetchFile=void 0;let a=r(20648),o=r(28323),n=r(43008),i=r(93750),s=r(83929),c=r(88414),l=r(36903),u=r(93748),d=r(95020),p=r(6923),S=r(83533),g=r(91940);async function m(e){try{return(await (0,d.httpGetUsingFetch)(e,{responseType:"arraybuffer"})).data}catch(e){throw new l.RemoteFileError(S.RemoteFileUpdateError.DownloadError,e.message)}}async function y(e,t){let r=await (0,n.getFilesMeta)(e,(0,u.userLoginSelector)(e.getState()),t);if((0,o.isApiError)(r))throw new l.RemoteFileError(S.RemoteFileUpdateError.ServerError,r.message);if((0,n.isGetFilesMetaSuccess)(r)){let{fileInfos:e}=r;if(!function(e){for(let t of a.FileNamesList)if(!(t in e))return!1;return!0}(e))throw Error("Missing keys in the GetFileMeta response");return e}}async function f(e,t,r){let a=await m(t.url);if(!t.key)return new g.DownloadedFile(e,a);let o=await (0,i.decipherRemoteFileUpdate)(a,t,(0,u.sharingKeysSelector)(r.getState()).privateKey);return new g.DownloadedFile(e,o)}function E(e,t,r){let{storeService:a,eventBusService:o}=e;a.dispatch((0,s.updateFileContentAction)({[r.name]:r})),a.dispatch((0,s.updateFileMetaAction)({[r.name]:t})),o.remoteFileChanged(r.name)}async function A(e,[t,r]){let{storeService:o,eventLoggerService:n}=e;if(!function(e){switch(e.status){case a.UPDATE_AVAILABLE_HTTP_STATUS:return!0;case a.NO_CURRENT_UPDATE_HTTP_STATUS:case a.FILE_NOT_FOUND_HTTP_STATUS:case a.SERVER_ERROR_HTTP_STATUS:default:return!1}}(r))return{fileName:t,isUpdated:!1,fileMetaData:r};try{let a=await f(t,r,o);E(e,r.revision,a)}catch(e){return(0,l.assertRemoteFileError)(n,e),{fileName:t,isUpdated:!1,fileMetaData:r}}return{fileName:t,isUpdated:!0,fileMetaData:r}}async function h(e,t){let r=await (0,c.retrieveFileMetaDataFromCipheredLocalStorage)(e);return Object.entries(t).reduce((e,[t,a])=>(null!==r&&t in r.files?e.files[t]=a.revision??r.files[t]:e.files[t]=0,e),{files:{}})}async function _(e,t){let{eventLoggerService:r}=e;return await Promise.all(t.filter(({isUpdated:e})=>e).map(async({fileName:t})=>{try{return await (0,c.writeFileInLocalStorage)(e,t),(0,p.logReceiveRemoteFileSuccess)(r),[t,!0]}catch(e){return(0,l.assertRemoteFileError)(r,e),[t,!1]}}))}t.fetchFile=m;let T=async(e,t)=>{let{storeService:r}=e,a=await h(e,t);try{let t=await y(r,a);if(t&&0!==Object.keys(t).length){let o=await Promise.all(Object.entries(t).map(t=>A(e,t))),n=(await _(e,o)).filter(([e,t])=>!t).map(([e,t])=>e);r.dispatch((0,s.deleteFileMetaAction)(n)),await function(e,t,r){let a=e.localStorageService.getInstance();return Promise.all(t.filter(({isUpdated:e})=>!e).map(async({fileName:t})=>{if(!a.isRemoteFileContentExist(t))return;let o=await (0,c.readFileFromLocalStorage)(e,t);null!==o&&E(e,r[t],o)}))}(e,o,a.files),await (0,c.persistFileMetaInCipheredLocalStorage)(e)}}catch(t){(0,l.assertRemoteFileError)(e.eventLoggerService,t)}};t.downloadRemoteFileHandler=T},46026:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.loadFilesAtInit=t.loadFileContentAtInit=void 0;let a=r(18305),o=r(88414),n=r(36903),i=r(83929);async function s(e,t){let r=await (0,o.readFileFromLocalStorage)(e,t);return null!==r&&(e.storeService.dispatch((0,i.updateFileContentAction)({[t]:r})),!0)}t.loadFileContentAtInit=s,t.loadFilesAtInit=function(e){Object.keys(a.FILE_SETTINGS).forEach(async t=>{if(a.FILE_SETTINGS[t].isLoadedWhileLoggedOut)try{await s(e,t)&&e.eventBusService.remoteFileChanged(t)}catch(t){(0,n.assertRemoteFileError)(e.eventLoggerService,t)}})}},91940:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.DownloadedFile=void 0;let a=r(93308);class o{constructor(e,t){this._buf=t,this.name=e}static fromBase64Str(e,t){return new o(e,(0,a.base64ToBuffer)(t))}toBlob(){return new Blob([this._buf])}toString(){return(0,a.ab2str)(this._buf)}toBase64String(){return(0,a.bufferToBase64)(this._buf)}}t.DownloadedFile=o},93750:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.decipherRemoteFileUpdate=t.decipherFileIntoBlob=t.verifyRemoteFileSignature=t.decipherDecryptionKey=t.computePublicKeyForSignature=void 0;let a=r(34978),o=r(65008),n=r(93308),i=r(86324),s=r(67972),c=r(18305),l=r(36903),u=r(83533),d=r(24592),p="https://static.dashlane.com/runtime-resources/ci/",S=e=>e.startsWith(p+"prod/"),g=e=>e.startsWith(p+"dev/");async function m(e,t){let r=(0,s.makeAsymmetricEncryption)({hashAlgorithm:i.HashAlgorithm.SHA_1});try{return d.decode(await r.decrypt(t,e))}catch(e){throw new l.RemoteFileError(u.RemoteFileUpdateError.DecipherError,"Invalid encryption on deciphering key")}}async function y(e,{signature:r,url:a},o){let n=(0,t.computePublicKeyForSignature)(a);return await e.verify(n,r,o)}async function f(e,t){try{return(0,n.str2ab)((0,a.deflatedUtf8ToUtf16)(await (0,a.decipherDashlaneSecureData)(e,t,"",(0,o.makeGetDerivateKeyWithCacheAndQueue)()),{skipInflate:!0}))}catch(e){throw new l.RemoteFileError(u.RemoteFileUpdateError.DecipherError,"Invalid encryption on file")}}async function E(e,t,r){let a=(0,n.bufferToBase64)(e),o=await m(t.key,r),c=(0,s.makeAsymmetricEncryption)({hashAlgorithm:i.HashAlgorithm.SHA_256});if(!await y(c,t,a))throw new l.RemoteFileError(u.RemoteFileUpdateError.DecipherError,"Invalid signature detected on file");return await f(a,o)}t.computePublicKeyForSignature=e=>{if(S(e))return c.REMOTE_FILE_KEY_PROD;if(g(e))return c.REMOTE_FILE_KEY_DEV;throw new l.RemoteFileError(u.RemoteFileUpdateError.DecipherError,"The file URL is not matching production or dev environnement")},t.decipherDecryptionKey=m,t.verifyRemoteFileSignature=y,t.decipherFileIntoBlob=f,t.decipherRemoteFileUpdate=E},74047:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.isFileRevisionMapper=void 0,t.isFileRevisionMapper=function(e){return"object"==typeof e&&!!e&&!Array.isArray(e)&&"files"in e&&"object"==typeof e.files&&!!e.files&&!Array.isArray(e.files)&&Object.entries(e.files).every(([e,t])=>"string"==typeof e&&"number"==typeof t)}},32593:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.bootstrap=void 0;var a=r(73323);Object.defineProperty(t,"bootstrap",{enumerable:!0,get:function(){return a.bootstrap}})},96829:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.fileMetaUpdate$=void 0;let a=r(95121),o=r(15237),n=r(39382);t.fileMetaUpdate$=()=>(0,a.pipe)((0,o.map)(n.fileMetaUpdateSelector),(0,o.distinctUntilChanged)())},6923:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.logReceiveRemoteFileError=t.logReceiveRemoteFileSuccess=void 0;let a=r(83533),o=(e,t,r)=>{e.logEvent(new a.UserReceiveRemoteFileUpdateEvent({flowStep:t,remoteFileUpdateError:r,packageSource:a.PackageSource.Carbon}))};t.logReceiveRemoteFileSuccess=e=>o(e,a.FlowStep.Complete),t.logReceiveRemoteFileError=(e,t)=>o(e,a.FlowStep.Error,t)},88414:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.writeFileInLocalStorage=t.readFileFromLocalStorage=t.retrieveFileContentFromNonCipheredLocalStorage=t.retrieveFileContentFromCipheredLocalStorage=t.retrieveFileMetaDataFromCipheredLocalStorage=t.persistSingleFileInNonCipheredLocalStorage=t.persistSingleFileContentInCipheredLocalStorage=t.persistFileMetaInCipheredLocalStorage=void 0;let a=r(4455),o=r(39382),n=r(18305),i=r(36903),s=r(83533),c=r(91940),l=e=>{if(!e)throw new i.RemoteFileError(s.RemoteFileUpdateError.LocalStorageError,"LocalStorageService is not initalized")};async function u({localStorageService:e,storeService:t}){e.getInstance();let{persistData:r,isAuthenticated:n}=t.getAccountInfo();if(!n||r===a.PersistData.PERSIST_DATA_NO)return;l(e);let c=e.getInstance();try{await c.storeRemoteFileMeta((0,o.fileMetaUpdateSelector)(t.getState()))}catch{throw new i.RemoteFileError(s.RemoteFileUpdateError.LocalStorageError,"Cannot persist file metadata in local storage")}}async function d({localStorageService:e,storeService:t},r){let{persistData:n,isAuthenticated:c}=t.getAccountInfo(),u=e.getInstance();if(!c||n===a.PersistData.PERSIST_DATA_NO)return;l(u);let d=await (0,o.fileSelector)(t.getState(),r);try{await u.storeRemoteFileContent(r,d.toBase64String())}catch(e){throw new i.RemoteFileError(s.RemoteFileUpdateError.LocalStorageError,`Cannot persist ${r} content in local storage`)}}async function p({storeService:e,storageService:t},r){let{persistData:n,isAuthenticated:c}=e.getAccountInfo();if(!c||n===a.PersistData.PERSIST_DATA_NO)return;let u=t.getLocalStorage();l(u);let d=await (0,o.fileSelector)(e.getState(),r);try{await u.writeItem(r,d.toBase64String())}catch(e){throw new i.RemoteFileError(s.RemoteFileUpdateError.LocalStorageError,`Cannot persist ${r} content in local storage`)}}async function S({localStorageService:e}){let t=e.getInstance();return l(t),await t.isRemoteFileMetaDataExist()?await t.getRemoteFileMeta():Promise.resolve(null)}async function g(e,t){let r=e.getInstance();return l(r),await r.isRemoteFileContentExist(t)?c.DownloadedFile.fromBase64Str(t,await r.getRemoteFileContent(t)):Promise.resolve(null)}async function m(e,t){let r=e.getLocalStorage();return l(r),await r.itemExists(t)?c.DownloadedFile.fromBase64Str(t,await r.readItem(t)):Promise.resolve(null)}t.persistFileMetaInCipheredLocalStorage=u,t.persistSingleFileContentInCipheredLocalStorage=d,t.persistSingleFileInNonCipheredLocalStorage=p,t.retrieveFileMetaDataFromCipheredLocalStorage=S,t.retrieveFileContentFromCipheredLocalStorage=g,t.retrieveFileContentFromNonCipheredLocalStorage=m,t.readFileFromLocalStorage=function(e,t){return n.FILE_SETTINGS[t].isLoadedWhileLoggedOut?m(e.storageService,t):g(e.localStorageService,t)},t.writeFileInLocalStorage=function(e,t){return n.FILE_SETTINGS[t].isLoadedWhileLoggedOut?p(e,t):d(e,t)}},36903:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.assertRemoteFileError=t.RemoteFileError=void 0;let a=r(6923),o=r(80896);class n extends Error{constructor(e,t){super(t),this.name=e,this.name=e}}t.RemoteFileError=n,n.errorInstance="REMOTE_FILE_ERROR",t.assertRemoteFileError=function(e,t){t instanceof n?(0,a.logReceiveRemoteFileError)(e,t.name):(0,o.sendExceptionLog)({error:t})}},39382:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.fileContentStrSelector=t.fileSelector=t.fileMetaUpdateSelector=void 0;let r=e=>e.device.remoteFile;t.fileMetaUpdateSelector=e=>r(e).fileMetaData,t.fileSelector=(e,t)=>r(e).fileContentState[t],t.fileContentStrSelector=(e,r)=>(0,t.fileSelector)(e,r).toString()},13592:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.setupSubscriptions=void 0;let a=r(41140),o=r(28009),n=r(93748);t.setupSubscriptions=function(e,t){e._sessionOpened.on(()=>(0,a.triggerDownloadRemoteFileUpdate)(t,!0)),e.sessionClosed.on(()=>(0,a.triggerDownloadRemoteFileUpdate)(t,!1)),e.coreServicesReady.on(e=>{e.initMode===o.InitMode.Resume&&((0,n.isAuthenticatedSelector)(t.storeService.getState())?(0,a.triggerDownloadRemoteFileUpdate)(t,!0):(0,a.triggerLoadFileAtInit)(t))}),e.appInitialized.on(()=>{(0,a.triggerLoadFileAtInit)(t)})}},41140:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.triggerDownloadRemoteFileUpdate=t.triggerLoadFileAtInit=void 0;let a=r(91360),o=r(4693),n=r(18305),i=r(46026),s="carbon-rfu-alarm";function c(e){return(0,o.downloadRemoteFileHandler)(e,n.FILE_SETTINGS)}t.triggerLoadFileAtInit=function(e){return(0,i.loadFilesAtInit)(e)};let l=!1;async function u(e){let t=await (0,a.alarmsGet)(s);l||(a.alarmsOnAlarm.addListener(t=>{t.name===s&&c(e)}),l=!0),!t&&(0,a.alarmsCreate)(s,{delayInMinutes:1,periodInMinutes:30})}let d=null;t.triggerDownloadRemoteFileUpdate=function(e,t){if(d&&clearInterval(d),t){if((0,a.alarmsIsSupported)()){u(e);return}c(e),d=setInterval(()=>{c(e)},18e5)}}},37270:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.bootstrap=void 0;let a=r(47674),o=r(75335),n=r(30717),i=r(27762),s=r(83619),c=r(43705),l=r(87376),u=r(67003),d=r(50083),p=r(28693),S=r(80896),g=r(56243),m=r(61819),y=r(60402),f=r(73566),E=r(38421),A=r(58423),h=r(94505),_=r(74137),T=r(33411),v=r(22409),I=r(75125),D=r(18219),P=r(23640),O=r(25356),C=r(82443),b=r(50388),R=r(64132),N=r(56594),w=r(90724),L=r(32593),U=r(27195),M=[m.bootstrap,o.bootstrap,i.bootstrap,s.bootstrap,c.bootstrap,l.bootstrap,u.bootstrap,d.bootstrap,p.bootstrap,S.bootstrap,n.bootstrap,g.bootstrap,y.bootstrap,A.bootstrap,f.bootstrap,h.bootstrap,_.bootstrap,v.bootstrap,I.bootstrap,D.bootstrap,P.bootstrap,O.bootstrap,C.bootstrap,b.bootstrap,T.bootstrap,w.vpnApiBootstrap,R.bootstrap,N.bootstrap,E.bootstrap,L.bootstrap,U.bootstrap];t.bootstrap=(e,t,r)=>{console.log("[background/carbon] Running bootstrap hooks...");let o=(0,a.getCoreServices)(e);for(let e=0;e<M.length;++e)try{(0,M[e])(t,o,r)}catch(t){throw console.error(`[background/carbon] Failed running bootstrap hook ${e+1}/${M.length}`,t),t}console.log("[background/carbon] Done running bootstrap hooks")}},6076:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.fetchCurrentLocation=t.initCarbon=t.setPlatform=void 0;let a=r(25903),o=r(20648),n=r(12791),i=r(37265),s=r(7254),c=r(3996),l=r(60595),u=r(50880),d=r(93787),p=r(65559),S=r(47674),g=r(44246),m=r(80896),y=r(73386),f=r(2901),E=r(24768),A=r(47586),h=r(37270),_=r(32034),T=r(2068),v=r(28009),I=r(12826),D=r(3314),P=r(90367);async function O(e){try{console.log("[background/carbon] initializing...");let r=Object.values(D.DashlaneAPISchemesNames);if((0,D.setConfig)((0,a.omit)(r,e?.config??{})),(0,_.setPublicPath)(e.publicPath),!e.storageLayer)throw Error("Missing Storage layer prevents Carbon initialization");let p=(0,S.carbonServices)({storageLayer:new T.CarbonLocalStorage(e.storageLayer),sessionStorage:e.sessionStorage,createClients:e.createClients}),{storeService:g,applicationModulesAccess:m}=(0,S.getCoreServices)(p);await g.completeRehydration();let O=function(e){let t=e.getState(),r=(0,I.appSessionIdSelector)(t)?v.InitMode.Resume:v.InitMode.FirstInit;return console.log(`[background/carbon] Init mode inferred: ${r}`),r}(g);(0,t.setPlatform)(p,e.platformInfo,O),await (0,P.initWebServicesConfig)(e,m,e.platformInfo);let C=(0,E.setupEventBus)(p);console.log("[background/carbon] Publishing lifecycle event coreServicesReady");try{await C.coreServicesReady({initMode:O})}catch(e){throw console.error("[background/carbon] Failed publishing lifecycle event coreServicesReady",e),e}console.log("[background/carbon] Done publishing lifecycle event coreServicesReady"),(0,f.loadFrequencyLists)(),e.plugins&&(0,y.setPlugins)(e.plugins),await (0,d.initAuthenticatedCarbonApplication)(e,p,O);let{debug:b,e2e:R}=e.connectors,{leeloo:N,maverick:w,extension:L,api:U}=e.connectors;console.log("[background/carbon] Activating connectors"),N=N||(0,n.createEventBus)({events:o.CarbonLeelooConnector}),w=w||(0,n.createEventBus)({events:o.CarbonMaverickConnector}),L=L||(0,n.createEventBus)({events:o.ExtensionCarbonConnector}),U=U||(0,n.createEventBus)({events:o.CarbonApiConnector}),b&&(0,l.subscribeToDebugEvents)(b),R&&(0,u.subscribeToE2EEvents)(R,p),(0,i.subscribeToExtensionEvents)(L,p),(0,s.subscribeToLeelooEvents)(N,p),(0,c.subscribeToMaverickEvents)(w,p);let M=new A.TsEventBusCommandQueryBus(p,o.CarbonApiConnector,U);return console.log("[background/carbon] Connectors active"),(0,h.bootstrap)(p,M,e?.infrastructure),console.log("[background/carbon] Publishing lifecycle event appInitialized"),C.appInitialized({initMode:O,abTestForcedVersion:e.abTestForcedVersion}).catch(e=>{console.error("[background/carbon] Failed publishing lifecycle event appInitialized",e)}),p}catch(e){throw console.error("[background/carbon] Initialization failed",e),e}}t.setPlatform=(e,t,r)=>{r===v.InitMode.FirstInit&&e.getInstance(S.CarbonServicesTypeEnum.StoreService).getStore().dispatch((0,g.savePlatformInfo)(t)),(0,p.setPlatformInfo)(t)},t.initCarbon=O,t.fetchCurrentLocation=function(e,t){return e.country.getCurrentCountry().then(e=>{t.dispatch((0,g.saveCurrentLocation)(e))}).catch(e=>{let t=Error(`[Sdk/Default] - fetchCurrentLocation: ${e}`);(0,m.sendExceptionLog)({error:t,code:o.ExceptionCriticality.WARNING})})}},90367:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.initWebServicesConfig=void 0;let a=r(95121),o=r(77323),n=r(20648),i=r(86454),s=r(3314);function c(e){let t=RegExp("https://api--(.*).api-experimental.dashlane.com","g"),r=e.matchAll(t).next();if(!r.done)return`https://ws1--${r.value[1]}.api-experimental.dashlane.com`}async function l(e,t,r){try{if(![n.ApplicationBuildType.DEV,n.ApplicationBuildType.NIGHTLY].includes(r.buildType))return;let l=await (0,a.firstValueFrom)(t.createClients().webServices.queries.settingsForStaging().pipe((0,a.timeoutWith)(1e3,(0,a.of)((0,o.failure)(void 0)))),{defaultValue:(0,o.failure)(void 0)}),u=(0,o.isSuccess)(l)&&(0,o.getSuccess)(l).api;if(u?.override){(0,i.setCloudflareHeaders)(u.cloudflareAccessKeyOverride,u.cloudflareSecretKeyOverride),(0,s.setConfig)({DASHLANE_API_HOST_WITH_SCHEME:u.baseUrlOverride,DASHLANE_WS_HOST_WITH_SCHEME:c(u.baseUrlOverride)});return}e.keys.cloudflareAccess&&e.keys.cloudflareSecret&&(0,i.setCloudflareHeaders)(e.keys.cloudflareAccess,e.keys.cloudflareSecret),e.config.DASHLANE_API_HOST_WITH_SCHEME&&(0,s.setConfig)({DASHLANE_API_HOST_WITH_SCHEME:e.config.DASHLANE_API_HOST_WITH_SCHEME,DASHLANE_WS_HOST_WITH_SCHEME:e.config.DASHLANE_WS_HOST_WITH_SCHEME??c(e.config.DASHLANE_API_HOST_WITH_SCHEME??"")})}catch(e){console.error("[background/carbon] Failed to set webservices config overrides",e)}}t.initWebServicesConfig=l},24768:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.setupEventBus=void 0;let a=r(47674),o=r(77180),n=r(67003),i=r(18629),s=r(62420),c=r(23640),l=r(25356),u=r(50388),d=r(74617),p=r(59029),S=r(41872),g=r(34493),m=r(33990),y=r(17974),f=r(13592),E=r(37314),A=r(98933);function h(e,t){return{moduleName:e,subscriptionFn:t}}let _=[h("ABTests",o.setupSubscriptions),h("Recovery",p.setupSubscriptions),h("Authentication",g.setupSubscriptions),h("CryptoMigration",m.setupSubscriptions),h("DataManagement",n.setupSubscriptions),h("Killswitch",S.setupSubscriptions),h("Login",i.setupSubscriptions),h("PasswordLeak",d.setupSubscriptions),h("Sdk",s.setupSubscriptions),h("Session",c.setupSubscriptions),h("TeamAdmin",u.setupSubscriptions),h("Sharing",l.setupSubscriptions),h("UserSettingsLog",y.setupUserSettingsLogSubscriptions),h("RemoteFileUpdates",f.setupSubscriptions),h("AntiPhishing",E.setupSubscriptions),h("Sync",A.setupSubscriptions)];t.setupEventBus=function(e){let t=(0,a.getCoreServices)(e),r=t.eventBusService;return console.log("[background/carbon] Setting up eventBus subscriptions"),_.forEach(e=>{try{e.subscriptionFn(r,t)}catch(t){throw console.error("[background/carbon] Error while setting up eventBus subscriptions",e.moduleName,t),t}}),console.log("[background/carbon] Done setting up eventBus subscriptions"),r}},62420:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.setupSubscriptions=void 0;let a=r(6076),o=r(28009),n=r(27698);t.setupSubscriptions=function(e,t){e.appInitialized.on(async e=>{let{wsService:r,storeService:i}=t;e.initMode===o.InitMode.FirstInit&&(await (0,a.fetchCurrentLocation)(r,i),(0,n.sendLocationInfo)(i.getPlatform().location))})}},28009:function(e,t){var r;Object.defineProperty(t,"__esModule",{value:!0}),t.InitMode=void 0,(r=t.InitMode||(t.InitMode={})).FirstInit="FirstInit",r.Resume="Resume"},12420:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.makeApplicationModulesAccess=void 0,t.makeApplicationModulesAccess=function(e){return{createClients:()=>e()}}},78453:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.makeApplicationModulesAccess=void 0;var a=r(12420);Object.defineProperty(t,"makeApplicationModulesAccess",{enumerable:!0,get:function(){return a.makeApplicationModulesAccess}})},47674:function(e,t,r){var a,o;Object.defineProperty(t,"__esModule",{value:!0}),t.getCoreServices=t.carbonServices=t.CarbonServicesTypeEnum=void 0;let n=r(897),i=r(25434),s=r(7429),c=r(2068),l=r(79319),u=r(52417),d=r(70362),p=r(82116),S=r(16696),g=r(28666),m=r(28693),y=r(78453);(o=a=t.CarbonServicesTypeEnum||(t.CarbonServicesTypeEnum={})).StoreService="StoreService",o.StorageService="StorageService",o.SessionService="SessionService",o.MasterPasswordEncryptorService="MasterPasswordEncryptorService",o.LocalDataEncryptorService="LocalDataEncryptorService",o.RemoteDataEncryptorService="RemoteDataEncryptorService",o.AuthorizationKeysEncryptorService="AuthorizationKeysEncryptorService",o.LocalStorageService="LocalStorageService",o.WSService="WSService",o.AutoLoginService="AutoLoginService",o.WebAuthnAuthenticationService="WebAuthnAuthenticationService",o.EventBusService="EventBusService",o.EventLoggerService="EventLoggerService",o.TeamDeviceEncryptedConfigEncryptorService="TeamDeviceEncryptedConfigEncryptorService",o.ApplicationModulesAccess="ApplicationModulesAccess",t.carbonServices=e=>{let t=(0,n.makeStoreService)({sessionStorage:e.sessionStorage,store:void 0}),r=(0,g.makeEventBusService)(),o=e.masterPasswordEncryptorService?e.masterPasswordEncryptorService():(0,i.makeDataEncryptorService)(t),f=e.localDataEncryptorService?e.localDataEncryptorService():(0,i.makeDataEncryptorService)(t),E=e.remoteDataEncryptorService?e.remoteDataEncryptorService():(0,i.makeDataEncryptorService)(t),A=e.teamDeviceEncryptedConfigEncryptorService?e.teamDeviceEncryptedConfigEncryptorService():(0,i.makeDataEncryptorService)(t),h=(0,d.makeKeyDataEncryptorService)(),_=(0,i.makeDataEncryptorService)(t),T=Object.assign({},(0,u.makeWSService)(),e.wsService?e.wsService(t):{}),v=(0,c.makeStorageService)();v.setInstance(e.storageLayer);let I=e.authorizationKeysEncryptorService?e.authorizationKeysEncryptorService():(0,d.makeKeyDataEncryptorService)();(0,i.setObfuscatingKey)(I);let D=(0,s.makeLocalStorageService)({masterPasswordEncryptorService:o,localDataEncryptorService:f,authorizationKeysEncryptorService:I,autoLoginEncryptorService:h,webAuthnAuthenticationEncryptorService:_,storageService:v,storeService:t}),P=(0,m.makeEventLoggerService)({storeService:t,storageService:v}),O=(0,y.makeApplicationModulesAccess)(e.createClients),C=O.createClients(),b=C.session,R=(0,l.makeSessionService)({applicationModulesAccess:O,masterPasswordEncryptorService:o,localDataEncryptorService:f,remoteDataEncryptorService:E,storeService:t,localStorageService:D,storageService:v,wsService:T,eventBusService:r,eventLoggerService:P,teamDeviceEncryptedConfigEncryptorService:A,sessionClient:b,deviceManagementClient:C.deviceManagement,pinCodeClient:C.pinCode}),N=(0,p.makeAutoLoginService)({storageService:v,autoLoginEncryptorService:h,localStorageService:D,wsService:T,authorizationKeysEncryptorService:I,storeService:t,sessionClient:b}),w=(0,S.makeWebAuthnAuthenticationService)({webAuthnAuthenticationEncryptorService:_,storeService:t,storageService:v,localStorageService:D,authorizationKeysEncryptorService:I,sessionClient:b});return{services:[{type:a.WSService,instance:T},{type:a.StoreService,instance:t},{type:a.StorageService,instance:v},{type:a.LocalStorageService,instance:D},{type:a.SessionService,instance:R},{type:a.AuthorizationKeysEncryptorService,instance:I},{type:a.AutoLoginService,instance:N},{type:a.WebAuthnAuthenticationService,instance:w},{type:a.EventBusService,instance:r},{type:a.MasterPasswordEncryptorService,instance:o},{type:a.RemoteDataEncryptorService,instance:E},{type:a.LocalDataEncryptorService,instance:f},{type:a.EventLoggerService,instance:P},{type:a.TeamDeviceEncryptedConfigEncryptorService,instance:A},{type:a.ApplicationModulesAccess,instance:O}],getInstance:function(e){let t=this.services.find(t=>t.type===e);if(void 0===t)throw Error("Service "+e+" not defined");return t.instance}}},t.getCoreServices=e=>{let t=e.getInstance(a.StoreService),r=e.getInstance(a.RemoteDataEncryptorService),o=e.getInstance(a.MasterPasswordEncryptorService),n=e.getInstance(a.LocalDataEncryptorService),i=e.getInstance(a.AuthorizationKeysEncryptorService),s=e.getInstance(a.LocalStorageService),c=e.getInstance(a.StorageService),l=e.getInstance(a.SessionService),u=e.getInstance(a.WSService),d=e.getInstance(a.AutoLoginService),p=e.getInstance(a.WebAuthnAuthenticationService),S=e.getInstance(a.EventBusService),g=e.getInstance(a.EventLoggerService),m=e.getInstance(a.TeamDeviceEncryptedConfigEncryptorService),y=e.getInstance(a.ApplicationModulesAccess),f=y.createClients();return{storeService:t,remoteDataEncryptorService:r,masterPasswordEncryptorService:o,localDataEncryptorService:n,authorizationKeysEncryptorService:i,localStorageService:s,storageService:c,sessionService:l,wsService:u,autoLoginService:d,webAuthnAuthenticationService:p,eventBusService:S,eventLoggerService:g,teamDeviceEncryptedConfigEncryptorService:m,applicationModulesAccess:y,moduleClients:f}}},21667:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.config=void 0;let a=r(93748),o=r(59565),n=r(71802),i=r(26222),s=r(42196),c=r(49087),l=r(34698),u=r(83705),d=r(75653),p=r(50743),S=r(29341),g=r(34049);t.config={commands:{validateToken:{handler:c.validateToken},validateMasterPassword:{handler:c.validateMasterPasswordHandler},resetProtectedItemAutofillTimer:{handler:c.resetProtectedItemAutofillTimerHandler},forceSync:{handler:l.forceSyncHandler},updatePremiumChurningDismissDate:{handler:u.updatePremiumChurningDismissDateHandler},setCredentialSearchOrder:{handler:d.setCredentialSearchOrderHandler},refreshSubscriptionInformation:{handler:p.refreshSubscriptionInformationHandler},updateAccountRecoveryKeyPersonalSettings:{handler:S.updateAccountRecoveryKeyPersonalSettingsHandler}},queries:{getActiveSpaces:{selector:a.activeSpacesSelector},getMasterPasswordAndServerKey:{selector:a.masterPasswordAndServerKeySelector},getSyncInfo:{selector:a.syncSelector},getIsSyncInProgress:{selector:a.syncIsInProgressSelector},getPremiumStatus:{selector:a.premiumStatusSelector},getNodePremiumStatus:{selector:a.nodePremiumStatusSelector},getSubscriptionInformation:{selector:a.subscriptionInformationSelector},getIsSSOUser:{selector:o.isSSOUserSelector},getSSOMigrationInfo:{selector:o.ssoMigrationInfoSelector},getSSOProviderInfo:{selector:o.ssoProviderInfoSelector},getUserLogin:{selector:a.userLoginSelector},getPublicUserId:{selector:a.publicUserIdSelector},getAnalyticsInstallationId:{selector:a.analyticsInstallationIdSelector},getUserLoginStatus:{selector:i.loginStatusSelector},getLoginStatus:{selector:i.loginStatusSelector},getWebOnboardingMode:{selector:a.webOnboardingModeSelector},getIsPaymentFailureChurningDismissed:{selector:a.isPaymentFailureChurningDismissedSelector},getCredentialSearchOrder:{selector:a.getCredentialSearchOrderSelector},getDidOpen:{selector:a.didOpenSelector},getPlatformName:{selector:a.platformNameSelector},getAccountAuthenticationType:{selector:n.accountAuthenticationTypeSelector},getSessionInfo:{selector:a.sessionInfoSelector},getUserCryptoSettings:{selector:a.userCryptoSettingsSelector}},liveQueries:{liveSyncInfo:{operator:s.syncInfo$},liveIsSyncInProgress:{operator:s.syncInProgress$},liveLoginStatus:{operator:i.getLoginStatus$},livePremiumStatus:{operator:s.premiumStatus$},liveSubscriptionInformation:{operator:s.subscriptionInformation$},liveServiceProviderUrl:{subject:s.getServiceProviderUrl$},liveWebOnboardingMode:{operator:s.webOnboardingMode$},liveDidOpen:{operator:s.didOpen$},liveIsSSOUser:{operator:g.isSSOUser$},liveSSOMigrationInfo:{operator:g.ssoMigrationInfo$},liveSessionInfo:{operator:s.sessionInfo$}}}},34049:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.ssoMigrationInfo$=t.isSSOUser$=void 0;let a=r(59565),o=r(95121);t.isSSOUser$=()=>(0,o.pipe)((0,o.map)(a.isSSOUserSelector)),t.ssoMigrationInfo$=()=>(0,o.pipe)((0,o.map)(a.ssoMigrationInfoSelector))},67711:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.refreshCredentialsDedupView=void 0;let a=r(20648),o=r(35251),n=r(4172),i=r(28323),s=r(88434),c=r(80896);async function l(e,t){try{let r="web_extension_credentialsDedupView",l=await (0,n.getFeatureFlip)(e,t,r);if((0,i.isApiError)(l))return(0,c.sendExceptionLog)({error:Error("Failed to get credentialsDedupView value"),code:a.ExceptionCriticality.WARNING}),e.dispatch((0,s.credentialsDedupViewUpdated)((0,o.getDefaultCredentialsDedupView)()));return e.dispatch((0,s.credentialsDedupViewUpdated)({credentialsDedupView:l.enabledFeatures[0]===r}))}catch(t){return(0,c.sendExceptionLog)({error:Error(`Failed to refreshCredentialsDedupView: ${t.message}`),code:a.ExceptionCriticality.WARNING}),e.dispatch((0,s.credentialsDedupViewUpdated)((0,o.getDefaultCredentialsDedupView)()))}}t.refreshCredentialsDedupView=l},73547:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.getUsersSSOInfo=t.loadLocalData=t.completeLogin=t.handleGetAuthenticationMethodsForLoginError=t.cacheIsSso=t.cacheOtpStatus=t.handleDeletedProfiles=t.getLocalProfiles=t.checkLogin=void 0;let a=r(20648),o=r(81453),n=r(15535),i=r(4455),s=r(30029),c=r(31935),l=r(76380),u=r(49789),d=r(29509),p=r(27762),S=r(28323),g=r(91783),m=r(74907),y=r(21837),f=r(62923),E=r(93748);async function A(e,r,o){let u,p,g;let f=e.getState(),A=(0,E.userLoginSelector)(f);try{let{profiles:t}=await h(e,r),a=(0,d.getDeviceAccessKeySelector)(f,A);if(!a)throw Error("Unexpectedly missing deviceAccessKey during login");let n=await (0,S.getAuthenticationMethodsForLogin)(e,{login:A,deviceAccessKey:a,methods:i.localSupportedAuthenticationMethod,...t.length?{profiles:t}:{}});if((0,S.isApiError)(n))return I(r,o,n,A);_(r,o,n),u=n.verifications,p=n.accountType,e.dispatch((0,s.storeAccountAuthenticationType)(p))}catch(e){if(!(0,y.isCarbonError)(e,m.HttpError))throw e;u=function(e){let t=(0,n.getUserPublicSetting)(e,"otp2")?c.OtpType.OTP_LOGIN:null,r=(0,n.getUserPublicSetting)(e,"ssoInfos"),a=[];return t===c.OtpType.OTP_LOGIN&&a.push({type:"totp"}),r&&a.push({type:"sso",ssoInfo:{serviceProviderUrl:""}}),a}(A)}let D=u.find(e=>"sso"===e.type);return g=D?.ssoInfo.serviceProviderUrl&&D?.ssoInfo.migration!=="mp_user_to_sso_member"?a.AuthenticationCode.SSO_LOGIN_BYPASS:function(e,t=[]){let r=t.find(e=>"sso"===e.type);v(e,!!r);let o=function(e){if(e.some(e=>"totp"===e.type))return c.OtpType.OTP_LOGIN;if(e.filter(e=>"sso"!==e.type).length>0)throw Error("Unsupported 2FA method requested");return null}(t);return(T(e,o),o===c.OtpType.OTP_LOGIN)?a.AuthenticationCode.ASK_OTP:r&&"mp_user_to_sso_member"!==r.ssoInfo.migration?a.AuthenticationCode.SSO_LOGIN_BYPASS:a.AuthenticationCode.ASK_MASTER_PASSWORD}(A,u),v(A,!!D),function(e,r,o,n){switch(e){case a.AuthenticationCode.SSO_LOGIN_BYPASS:if(!o?.serviceProviderUrl)throw Error("[LocalAuthentication] - Unable to use SSO verification. Missing SSO information.");r.dispatch((0,l.storeSSOSettings)({ssoUser:!0,...(0,t.getUsersSSOInfo)(o)}));break;case a.AuthenticationCode.ASK_OTP:r.dispatch((0,s.enableOtp)(c.OtpType.OTP_LOGIN))}e!==a.AuthenticationCode.SSO_LOGIN_BYPASS&&r.dispatch((0,l.storeSSOSettings)({ssoUser:!1,...(0,t.getUsersSSOInfo)(o)})),r.dispatch((0,s.storeAccountAuthenticationType)(n))}(g,e,D?D.ssoInfo:void 0,p),g}async function h(e,t){return(await (0,p.getLocalAccounts)(e,t)).map(e=>e.login).map(t=>({login:t,deviceAccessKey:(0,d.getDeviceAccessKeySelector)(e.getState(),t)})).reduce((e,t)=>(t.login&&t.deviceAccessKey?e.profiles.push(t):e.ghostProfiles.push(t),e),{profiles:[],ghostProfiles:[]})}async function _(e,t,r){let{profilesToDelete:a}=r;if((a||[]).length>0)return;let o=a.map(e=>e.login);await (0,f.wipeOutLocalAccounts)(e,t,o)}function T(e,t){(0,n.storeUserPublicSetting)(e,"otp2",t===c.OtpType.OTP_LOGIN)}function v(e,t){(0,n.storeUserPublicSetting)(e,"ssoInfos",t)}async function I(e,t,r,o){if(!(0,S.isApiErrorOfType)(S.BusinessError,r))throw Error(`Failed to getAuthenticationMethodsForLogin (${r.code})`);let n=r.code;switch(n){case S.DeviceDeactivated:throw await (0,f.wipeOutLocalAccounts)(e,t,[o]),Error(a.AuthenticationCode[a.AuthenticationCode.DEVICE_NOT_REGISTERED]);case S.UserNotFound:case"SSO_BLOCKED":case"invalid_authentication":throw Error(a.AuthenticationCode[a.AuthenticationCode.TEAM_GENERIC_ERROR]);default:(0,g.assertUnreachable)(n)}}async function D(e,t,r,o,n){let i=e.getUserLogin(),s=(0,d.getDeviceAccessKeySelector)(e.getState(),i),c=await (0,S.completeLoginWithAuthTicket)(e,{login:i,deviceAccessKey:s,authTicket:o});if((0,S.isApiError)(c))return P(t,r,c,i);let{serverKey:l}=c;if(!l)throw Error(a.AuthenticationCode[a.AuthenticationCode.SERVER_KEY_MISSING]);return e.dispatch((0,u.updateisUsingDashlaneAuthenticator)(n)),e.dispatch((0,u.updateServerKey)(l)),a.AuthenticationCode.ASK_MASTER_PASSWORD}async function P(e,t,r,o){if(!(0,S.isApiErrorOfType)(S.BusinessError,r))throw Error(`Failed to complete login (${r.code})`);let n=r.code;switch(n){case"DEVICE_NOT_FOUND":case"DEACTIVATED_DEVICE":throw await (0,f.wipeOutLocalAccounts)(e,t,[o]),Error(a.AuthenticationCode[a.AuthenticationCode.DEVICE_NOT_REGISTERED]);case S.InvalidAuthTicket:throw Error(a.AuthenticationCode[a.AuthenticationCode.TOKEN_NOT_VALID]);default:(0,g.assertUnreachable)(n)}}async function O(e,t,r){return r.getInstance().prepareCrypto(),await e.getInstance().user.loadSessionData(),t.dispatch((0,s.localDataLoaded)()),a.AuthenticationCode.LOGGEDIN}t.checkLogin=A,t.getLocalProfiles=h,t.handleDeletedProfiles=_,t.cacheOtpStatus=T,t.cacheIsSso=v,t.handleGetAuthenticationMethodsForLoginError=I,t.completeLogin=D,t.loadLocalData=O;let C=e=>{if(e.migration)switch(e.migration){case"mp_user_to_sso_member":return o.AuthenticationFlowContracts.SSOMigrationType.MP_TO_SSO;case"sso_member_to_admin":case"sso_member_to_mp_user":return o.AuthenticationFlowContracts.SSOMigrationType.SSO_TO_MP}};t.getUsersSSOInfo=e=>{if(!e)return{serviceProviderUrl:""};let t=C(e);return{serviceProviderUrl:e.serviceProviderUrl?e.serviceProviderUrl:"",...void 0!==t?{migration:t}:{},isNitroProvider:e.isNitroProvider}}},26222:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.getLoginStatus$=t.loginStatusSelector=void 0;let a=r(49548),o=r(25903),n=r(95121),i=r(15237),s=r(64833),c=r(59565),l=(0,a.createSelector)(s.sessionIdSelector,e=>e.userSession.account.isAuthenticated,(e,t)=>e&&t);t.loginStatusSelector=(0,a.createSelector)(l,e=>e.userSession.account,c.ssoMigrationInfoSelector,(e,t,r)=>{if(!e)return{login:null,loggedIn:!1,needsSSOMigration:!1};let{isAuthenticated:a,login:o}=t;return{loggedIn:a,login:o,needsSSOMigration:void 0!==r}}),t.getLoginStatus$=()=>(0,n.pipe)((0,i.map)(t.loginStatusSelector),(0,i.distinctUntilChanged)(o.equals))},60686:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.updateWebOnboardingMode=void 0;let a=r(30350),o=r(27698);t.updateWebOnboardingMode=function(e,t,r){if(!e.isAuthenticated())throw Error("No session set");e.dispatch(a.webOnboardingModeUpdated(r));let n=e.getLocalSettings().webOnboardingMode;o.sendWebOnboardingModeUpdate(n),t.getInstance().user.persistLocalSettings()}},56268:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.makeDashlaneApiPairingService=void 0;let a=r(28323),o=r(22560),n=async(e,t)=>{try{let r=await a.requestPairing(e,t);if(a.isApiError(r))throw r;return r.pairingId?{pairingId:r.pairingId}:void 0}catch(e){(0,o.logError)({message:`Pairing request failed: ${e}`});return}};t.makeDashlaneApiPairingService=e=>({requestPairing:t=>n(e,t)})},25392:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.pairingIdSelector=t.isPairingEnabledSelector=void 0,t.isPairingEnabledSelector=e=>!!e.userSession.session.pairingId,t.pairingIdSelector=e=>e.userSession.session.pairingId},76219:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.requestPairing=void 0;let a=r(25392),o=r(15535),n=r(49789),i=r(56268),s=async(e,t)=>{let r=e.getState();if((0,a.pairingIdSelector)(r)||!(0,o.getSyncAppSetting)("syncWithLocalClients"))return;let s=(0,i.makeDashlaneApiPairingService)(e),c=await s.requestPairing(t),l=c?.pairingId;l&&e.dispatch((0,n.pairingSucceeded)(l))};t.requestPairing=s},33161:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.transformNodePremiumStatus=t.getFreshPremiumStatus=t.refreshSubscriptionInformation=t.refreshPremiumStatus=void 0;let a=r(25903),o=r(20648),n=r(22560),i=r(80896),s=r(92830),c=r(29256),l=r(4455),u=r(35467),d=r(2345),p=r(30350),S=r(28323);async function g(e,t,r,a){let o=e.getLocalSettings().premiumStatus,l=e.getLocalSettings().nodePremiumStatus,d=!l?.currentTimestampUnix||Date.now()-l.currentTimestampUnix>1e4;if(l&&!d)return o;try{let[o,n]=await Promise.all([E(t,r,a),(0,u.getPremiumStatus)(e,r).then(e=>{if((0,S.isApiError)(e))throw Error(`${e.message} (code: ${e.code})`);return e}),m(e,r)]),i=o?.spaces||[],l=v(n),d={...o,planName:o?.planName?.toLowerCase()??null};return e.dispatch((0,s.premiumStatusUpdated)(d)),e.dispatch((0,p.localSettingsNodePremiumStatusUpdated)(l)),(0,c.refreshSpaceData)(e,i),o}catch(t){let e=Error(`[PremiumController] - refreshPremiumStatus: ${t}`);if(n.default.error(e),(0,i.sendExceptionLog)({error:e}),o)return o;throw t}}async function m(e,t){let r=e.getLocalSettings().subscriptionInformation;try{let r=await (0,d.getSubscriptionInformation)(e,t);if((0,S.isApiError)(r))throw Error(`${r.message} (code: ${r.code})`);return e.dispatch((0,p.localSettingsSubscriptionInformationStatusUpdated)(r)),r}catch(t){let e=Error(`[PremiumController] - refreshUserSubscriptionStatus: ${t}`);if(n.default.error(e),(0,i.sendExceptionLog)({error:e}),r)return r;throw t}}t.refreshPremiumStatus=g,t.refreshSubscriptionInformation=m;let y=e=>{if(e.capabilities&&e.capabilities.length)return e.capabilities.reduce((e,t)=>{let{capability:r,...a}=t;return e[r]=a,e},{})},f=e=>{if(e.familyMembership)return e.familyMembership[0]};function E(e,t,r){return e.premium.status({login:t,uki:r,billingInformation:!0,spaces:!0,autoRenewal:!0,familyInformation:!0,previousPlan:!0,needsAutoRenewalFailed:!0}).then(e=>{let t=(0,a.pick)(["statusCode","billingInformation","planName","planType","planFeature","endDate","spaces","autoRenewal","previousPlan","autoRenewalFailed","autoRenewInfo","recoveryHash"],e);return t.capabilities=y(e),e.hasOwnProperty("familyMembership")&&(t.familyMembership=f(e)),t})}t.getFreshPremiumStatus=E;let A=e=>{if(e.capabilities?.length)return e.capabilities.reduce((e,t)=>{let{capability:r,...a}=t;return e[r]=a,e},{})},h=e=>{switch(e.b2cStatus.statusCode){case l.B2CStatusCode.Subscribed:if(e.b2cStatus.planName.includes("grace"))return o.PremiumStatusCode.GRACE_PERIOD;if(e.b2cStatus.isTrial)return o.PremiumStatusCode.NEW_USER;if(e.b2cStatus.autoRenewal)return o.PremiumStatusCode.PREMIUM_CANCELLED;return o.PremiumStatusCode.PREMIUM;case l.B2CStatusCode.Legacy:return o.PremiumStatusCode.OLD_ACCOUNT;case l.B2CStatusCode.Free:default:return o.PremiumStatusCode.NO_PREMIUM}};function _(e){return e.map(e=>({login:e}))}function T(e){return{...e,teamMembership:{...e.teamMembership,billingAdmins:_(e.teamMembership.billingAdmins),teamAdmins:_(e.teamMembership.teamAdmins)}}}function v(e){var t;let r=e.b2bStatus?.currentTeam?{currentTeam:{...t=e.b2bStatus.currentTeam,teamMembership:{...t.teamMembership,billingAdmins:t.teamMembership.billingAdmins.map(e=>({login:e})),teamAdmins:t.teamMembership.teamAdmins.map(e=>({login:e}))}}}:{},a=e.b2bStatus?.pastTeams?{pastTeams:e.b2bStatus.pastTeams.map(T)}:{};return{...e.b2cStatus,planName:e.b2cStatus?.planName?.toLowerCase()??null,currentTimestampUnix:Date.now(),isTrial:e.b2cStatus.isTrial,statusCode:h(e),spaces:e.b2bStatus?function(e){let t=[];return e.currentTeam&&t.push({associatedEmail:e.currentTeam.associatedEmail,billingAdmins:_(e.currentTeam.teamMembership.billingAdmins),color:e.currentTeam.teamInfo.color,companyName:e.currentTeam.teamInfo.name,info:{...e.currentTeam.teamInfo},invitationDate:e.currentTeam.invitationDateUnix,isBillingAdmin:e.currentTeam.teamMembership.isBillingAdmin,isSSOUser:e.currentTeam.teamMembership.isSSOUser,isTeamAdmin:e.currentTeam.teamMembership.isTeamAdmin,isGroupManager:e.currentTeam.teamMembership.isGroupManager,joinDate:e.currentTeam.joinDateUnix,letter:e.currentTeam.teamInfo.letter,membersNumber:e.currentTeam.teamInfo.membersNumber,planType:e.currentTeam.teamInfo.planType,revokeDate:null,shouldDelete:!1,status:o.SpaceStatus.Accepted,teamAdmins:_(e.currentTeam.teamMembership.teamAdmins),teamId:e.currentTeam.teamId.toString(),teamName:e.currentTeam.teamName,tier:e.currentTeam.planFeature}),e.pastTeams&&e.pastTeams.forEach(e=>{t.push({associatedEmail:e.associatedEmail,billingAdmins:_(e.teamMembership.billingAdmins),color:e.teamInfo.color,companyName:e.teamName,info:{...e.teamInfo},invitationDate:e.invitationDateUnix,isBillingAdmin:e.teamMembership.isBillingAdmin,isSSOUser:e.teamMembership.isSSOUser,isTeamAdmin:e.teamMembership.isTeamAdmin,isGroupManager:e.teamMembership.isGroupManager,joinDate:e.joinDateUnix,letter:e.teamInfo.letter,membersNumber:e.teamInfo.membersNumber,planType:e.teamInfo.planType,revokeDate:e.revokeDateUnix,shouldDelete:e.shouldDelete,status:e.status,teamAdmins:_(e.teamMembership.teamAdmins),teamId:e.teamId.toString(),teamName:e.teamName,tier:e.planFeature})}),t}(e.b2bStatus):[],b2bStatus:{statusCode:e.b2bStatus?.statusCode,hasPaid:e.b2bStatus?.hasPaid,...r,...a},capabilities:A(e)}}t.transformNodePremiumStatus=v},45407:function(e,t,r){let a,o;Object.defineProperty(t,"__esModule",{value:!0}),t.getUsersSSOInfo=t.validateMasterPassword=t.registerDevice=t.registerDeviceWithToken=t.registerDeviceWithDashlaneAuthenticator=t.cancelRegistrationWithDashlaneAuthenticator=t.generateUki=t.askServerToSendToken=t.checkLoginWithUki=t.requestDeviceRegistration=t.SendTokenStatus=void 0;let n=r(42387),i=r(25903),s=r(20648),c=r(81453),l=r(4455),u=r(22560),d=r(30350),p=r(31935),S=r(30029),g=r(75795),m=r(83648),y=r(92830),f=r(93308),E=r(18040),A=r(58361),h=r(34978),_=r(49789),T=r(25826),v=r(76380),I=r(57758);var D=r(77116);Object.defineProperty(t,"SendTokenStatus",{enumerable:!0,get:function(){return D.SendTokenStatus}});let P=r(91783),O=r(52780),C=r(49087),b=r(93748),R=r(28323),N=r(80896),w=r(21837);async function L(e){let r;let a=e.getAccountInfo().login,o=await (0,R.getAuthenticationMethodsForDevice)(e,{login:a,methods:l.remoteSupportedAuthenticationMethod});if((0,R.isApiError)(o))return function(e){if(!(0,R.isApiErrorOfType)(R.BusinessError,e))throw Error(`Failed to getAuthenticationMethodsForDevice (${e.code})`);let t=e.code;switch(t){case R.UserNotFound:throw Error(s.AuthenticationCode[s.AuthenticationCode.USER_DOESNT_EXIST]);case R.SSOBlocked:throw Error(s.AuthenticationCode[s.AuthenticationCode.SSO_BLOCKED]);case R.TeamGenericError:case"expired_version":throw Error(s.AuthenticationCode[s.AuthenticationCode.EOL_UPDATE_REQUIRED]);case"DEACTIVATED_USER":throw Error("Unsupported DEACTIVATED_USER");default:(0,P.assertUnreachable)(t)}}(o);let{verifications:n,accountType:i}=o;if(!n)throw Error("[requestDeviceRegistration] - No verification in API response.");let c=n.find(e=>"sso"===e.type);return function(e,r,a,o){if(e===s.AuthenticationCode.SSO_LOGIN_BYPASS){if(!a?.serviceProviderUrl)throw Error("[requestDeviceRegistration - processVerification] - Unable to use SSO verification. Missing SSO information.");r.dispatch((0,v.storeSSOSettings)({ssoUser:!0,...(0,t.getUsersSSOInfo)(a)}))}e!==s.AuthenticationCode.SSO_LOGIN_BYPASS&&r.dispatch((0,v.storeSSOSettings)({ssoUser:!1,...(0,t.getUsersSSOInfo)(a)})),r.dispatch((0,S.storeAccountAuthenticationType)(o))}(r=c?.ssoInfo.serviceProviderUrl&&c?.ssoInfo.migration!=="mp_user_to_sso_member"?s.AuthenticationCode.SSO_LOGIN_BYPASS:function(e=[]){if(e.some(({type:e})=>"email_token"===e))return s.AuthenticationCode.ASK_TOKEN;if(e.some(({type:e})=>"totp"===e))return s.AuthenticationCode.ASK_OTP_FOR_NEW_DEVICE;if(e.some(({type:e})=>"dashlane_authenticator"===e))return s.AuthenticationCode.ASK_DASHLANE_AUTHENTICATOR;throw Error("[requestDeviceRegistration - getVerificationType] - Verification not supported!")}(n),e,c?c.ssoInfo:void 0,i),r}async function U(e,t,r){let a=e.getAccountInfo().login;if(!await M(t,a,r))throw Error(s.AuthenticationCode[s.AuthenticationCode.INVALID_UKI]);return e.dispatch((0,S.confirmUserAuthentication)()),Promise.resolve(s.AuthenticationCode.USE_LOCAL_UKI)}async function M(e,t,r){return"UKI VALID"===await e.authentication.validity({login:t,uki:r})}async function F(e,t){try{await e.commands.requestEmailTokenVerification({login:t})}catch(e){throw u.default.log(`Server failed to send a token with response: ${e.message}`),Error(s.AuthenticationCode[s.AuthenticationCode.SEND_TOKEN_FAILED])}}t.requestDeviceRegistration=L,t.checkLoginWithUki=U,t.askServerToSendToken=F;let k=(e,t)=>{t?e.dispatch((0,S.enableOtp)(p.OtpType.OTP_LOGIN)):e.dispatch((0,S.enableOtp)(p.OtpType.OTP_NEW_DEVICE))};t.generateUki=function(e){return`${e}-${(0,n.v4)()}`};let K=async(e,t,r,a,o,n)=>{let i=n||T.device.getDefaultDeviceName(),s=e.getPlatformInfo(),c=(0,O.secureDeviceName)(i);if("server_carbon_unknown"===s.platformName)throw Error("Unexpected uninitialized platform info");let u={deviceName:c,appVersion:s.appVersion,platform:s.platformName,osCountry:(0,R.makeSafeCountry)(e.getLocation().country||s.country),osLanguage:(0,R.makeSafeLanguage)(s.lang),temporary:r!==l.PersistData.PERSIST_DATA_YES};switch(t.type){case"extraDeviceToken":return{...await (0,R.completeExtraDeviceRegistrationWithToken)(e,{device:u,login:o,verification:{token:(0,l.extractExtraDeviceToken)(t)}}),ssoServerKey:null};case"emailToken":case"otp":case"sso":return(0,R.completeDeviceRegistrationWithAuthTicket)(e,{device:u,login:o,authTicket:a});default:(0,P.assertUnreachable)(t)}},B=(e,t,r,a)=>{let o=a||T.device.getDefaultDeviceName(),n=e.getPlatformInfo(),i=e.getAccountInfo().login,s=(0,O.secureDeviceName)(o);if("server_carbon_unknown"===n.platformName)throw Error("Unexpected unitiliazed platform info");let c={deviceName:s,appVersion:n.appVersion,platform:n.platformName,osCountry:(0,R.makeSafeCountry)(e.getLocation().country||n.country),osLanguage:(0,R.makeSafeLanguage)(n.lang),temporary:t!==l.PersistData.PERSIST_DATA_YES};return(0,R.completeDeviceRegistrationWithAuthTicket)(e,{device:c,login:i,authTicket:r})},G=async(e,t)=>{let r=await (0,C.dashlaneAuthenticatorGetAuthTicket)(e,t);if(!1===r.success){let{error:{code:e,message:t}}=r;if(e===s.AuthenticationCode.BUSINESS_ERROR)throw Error(t);throw Error(s.AuthenticationCode[e])}return a?.(l.CancelDashlaneAuthenticatorRegistration.COMPLETED),r.authTicket};async function j(e,t,r,n){let i;let c=new Promise((e,t)=>{a=e,o=t});try{i=(await Promise.all([G(e,n),c]))[0]}catch(e){if(e===l.CancelDashlaneAuthenticatorRegistration.CANCELLED)return s.AuthenticationCode.DASHLANE_AUTHENTICATOR_LOGIN_CANCELLED;throw e}finally{o=void 0,a=void 0}if(i){let a=await B(e,t,i,n);(0,R.isApiError)(a)&&function(e){if(!(0,R.isApiErrorOfType)(R.BusinessError,e))throw Error(`Failed to complete device registration (${e.code})`);let t=e.code;if(t===R.InvalidAuthTicket)throw Error(s.AuthenticationCode[s.AuthenticationCode.DASHLANE_AUTHENTICATOR_PUSH_NOTIFICATION_DENIED]);(0,P.assertUnreachable)(t)}(a),e.dispatch((0,_.updateisUsingDashlaneAuthenticator)(!0)),e.dispatch((0,_.updateisUsingBackupCode)(!1));let{deviceAccessKey:o,deviceSecretKey:c,settings:l,serverKey:u,deviceAnalyticsId:d,userAnalyticsId:p,publicUserId:S}=a;return H(e,{login:r,deviceAccessKey:o,deviceSecretKey:c,settings:l,serverKey:u,deviceAnalyticsId:d,userAnalyticsId:p,publicUserId:S,isDataPersisted:t}),s.AuthenticationCode.ASK_MASTER_PASSWORD}throw Error("Authentication Ticket is missing")}t.cancelRegistrationWithDashlaneAuthenticator=function(){o?.(l.CancelDashlaneAuthenticatorRegistration.CANCELLED)},t.registerDeviceWithDashlaneAuthenticator=j;let V=async(e,t)=>{let r=await (0,C.convertTokenToAuthTicket)(e,t);if(!1===r.success){let{error:{code:e,message:t}}=r;if(e===s.AuthenticationCode.BUSINESS_ERROR)throw Error(t);throw Error(s.AuthenticationCode[e])}return r.authTicket};async function W(e,t,r,a,o,n,c){let l=await V(e,r),u=await K(e,r,t,l,o,n);if((0,R.isApiError)(u))return function(e,t){if(!(0,R.isApiErrorOfType)(R.BusinessError,e))throw Error(`Failed to complete device registration (${e.code})`);let r=e.code;switch(r){case R.UserNotFound:throw Error(s.AuthenticationCode[s.AuthenticationCode.INVALID_LOGIN]);case R.VerificationFailed:case R.InvalidAuthTicket:if("otp"===t.type)throw Error(s.AuthenticationCode[s.AuthenticationCode.OTP_NOT_VALID]);throw Error(s.AuthenticationCode[s.AuthenticationCode.TOKEN_NOT_VALID]);case R.VerificationMethodDisabled:throw Error(s.AuthenticationCode[s.AuthenticationCode.REGISTER_DEVICE_FAILED]);case"TEMPORARY_DEVICE_FORBIDDEN":throw Error(s.AuthenticationCode[s.AuthenticationCode.TEAM_GENERIC_ERROR]);default:(0,P.assertUnreachable)(r)}}(u,r);let{deviceAccessKey:d,deviceSecretKey:p,settings:S,serverKey:g,ssoServerKey:m,remoteKeys:y,deviceAnalyticsId:T,userAnalyticsId:v,publicUserId:I}=u;if(m){let{masterPasswordEncryptorService:t,remoteDataEncryptorService:r,ssoServiceProviderKey:a}=c;if(!y||(0,i.isEmpty)(y))throw Error("registerDevice failed with error: ssoServerKey or remoteKeys is missing");let o=(0,f.base64ToBuffer)(m),n=y.filter(e=>"sso"===e.type)[0];try{let i=(0,f.base64ToBuffer)(a),s=(0,A.getEncryptionKeyBuffer)(i,o,{skipDerivation:!0}),c=(0,f.arrayBufferToText)(s),l=(0,E.getNoDerivationCryptoConfig)();e.dispatch((0,_.updateMasterPassword)(c)),t.setInstance({raw:c},"",l);let u=await t.getInstance().decrypt(n.key),d=(0,h.deflatedUtf8ToUtf16)(u,{skipUtf8Decoding:!0,skipInflate:!0});r.setInstance({raw:d},"",l),e.dispatch((0,_.updateRemoteKey)(d))}catch(e){throw Error(`registerDevice failed deciphering remoteKey with error: ${e}`)}}return e.dispatch((0,_.updateisUsingDashlaneAuthenticator)(!1)),e.dispatch((0,_.updateisUsingBackupCode)(a)),r?.type==="otp"&&k(e,g),H(e,{deviceAccessKey:d,deviceSecretKey:p,settings:S,serverKey:g,deviceAnalyticsId:T,userAnalyticsId:v,publicUserId:I,isDataPersisted:t,login:o}),s.AuthenticationCode.ASK_MASTER_PASSWORD}async function H(e,t){let{deviceAccessKey:r,deviceSecretKey:a,settings:o,serverKey:n,deviceAnalyticsId:i,userAnalyticsId:s,publicUserId:c,isDataPersisted:l,deviceName:u,login:p}=t;if(e.dispatch((0,I.deviceRegistered)((0,I.makeDeviceRegistrationKeys)(r,a),l,p)),n&&e.dispatch((0,_.updateServerKey)(n)),e.dispatch((0,_.updateSettingsForMPValidation)(o)),i&&e.dispatch((0,_.updateDeviceAnalyticsId)(i)),s&&e.dispatch((0,_.updateUserAnalyticsId)(s)),c&&e.dispatch((0,_.updatePublicUserId)(c)),u){let t=(0,O.secureDeviceName)(u);e.dispatch(d.registerDeviceName(t))}e.dispatch((0,I.deviceRegistered)((0,I.makeDeviceRegistrationKeys)(r,a),l,p))}async function x(e,t){try{let r=e.getState(),a=(0,b.masterPasswordValidationDataSelector)(r),[o]=await m.decrypt(t.getInstance(),e=>{},null,new Map,[a]);return e.dispatch((0,y.applyTransactions)([o])),e.dispatch(d.registerLastSync(g.MIN_SYNC_TIMESTAMP)),s.AuthenticationCode.LOGGEDIN}catch(t){let e=w.CarbonError.fromAnyError(t).addContextInfo("REMOTE LOGIN","validateMasterPassword");throw(0,N.sendExceptionLog)({error:e}),Error(s.AuthenticationCode[s.AuthenticationCode.WRONG_PASSWORD])}}t.registerDeviceWithToken=W,t.registerDevice=H,t.validateMasterPassword=x;let Y=e=>{if(e.migration)switch(e.migration){case"mp_user_to_sso_member":return c.AuthenticationFlowContracts.SSOMigrationType.MP_TO_SSO;case"sso_member_to_admin":case"sso_member_to_mp_user":return c.AuthenticationFlowContracts.SSOMigrationType.SSO_TO_MP}};t.getUsersSSOInfo=e=>{if(!e)return{serviceProviderUrl:""};let t=Y(e);return{serviceProviderUrl:e.serviceProviderUrl?e.serviceProviderUrl:"",...void 0!==t?{migration:t}:{},isNitroProvider:e.isNitroProvider}}},27698:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.sendFeatures=t.sendWebOnboardingModeUpdate=t.sendTeamAdminDataUpdate=t.updatePaymentCardTokenResult=t.reportDataUpdate=t.sendLocationInfo=t.sendLocalAccounts=t.triggerSessionSyncStatus=t.triggerExtensionReload=t.triggerSessionOpened=t.triggerOpenSessionFailed=t.getAuthenticationCodeFromError=t.triggerSsoSolutionChanged=t.triggerServerSidePairingStatusChanged=t.triggerLoginStatusChanged=t.triggerOpenSessionMasterPasswordLess=t.triggerOpenSessionSsoRedirectionToIdpRequired=t.triggerOpenSessionExtraDeviceTokenRequired=t.triggerOpenSessionDashlaneAuthenticator=t.triggerOpenSessionTokenSent=t.triggerAskMasterPassword=t.triggerOpenSessionOTPForNewDeviceRequired=t.triggerOpenSessionOTPSent=t.SessionResumingCode=t.AuthenticationCode=void 0;let a=r(20648);Object.defineProperty(t,"AuthenticationCode",{enumerable:!0,get:function(){return a.AuthenticationCode}});let o=r(16436),n=r(25047),i=r(80896),s=r(22560),c=r(21837),l=r(74907),u=r(27762),d=r(4455);Object.defineProperty(t,"SessionResumingCode",{enumerable:!0,get:function(){return d.SessionResumingCode}});let p=r(59565),S=r(4790),g=r(93748);function m(e){s.default.log(`Session status updated for ${e.login}`);let t=(0,o.default)();t&&t.carbonLoginStatusChanged(e);let r=(0,n.default)();r&&r.carbonLoginStatusChanged(e)}function y(e){if(n.default){let t=(0,n.default)();t&&t.serverSidePairingStatusChanged(e)}}function f(e){let t=e&&e.message&&void 0!==a.AuthenticationCode[e.message]?a.AuthenticationCode[e.message]:a.AuthenticationCode.UNKNOWN_ERROR;return t===a.AuthenticationCode.UNKNOWN_ERROR&&((0,c.isCarbonError)(e,l.HttpError,l.HttpErrorCode.NETWORK_ERROR)&&(t=a.AuthenticationCode.NETWORK_ERROR),e?.message?.includes("TOKEN_NOT_VALID")&&(t=a.AuthenticationCode.TOKEN_NOT_VALID)),t}function E(e){return Promise.resolve({localAccounts:e}).then(e=>{s.default.log("send localAccountsListUpdated to leeloo");let t=(0,o.default)();t&&t.localAccountsListUpdated(e);let r=(0,n.default)();r&&r.localAccountsListUpdated(e)})}function A(e){let t=e.getSpaceData(),{spaces:r}=(0,S.getNodePremiumStatusSpaceData)(e),a=r.reduce((e,t)=>{let{isTeamAdmin:r,isBillingAdmin:a,isGroupManager:o}=t.details;return{isTeamAdmin:r||e.isTeamAdmin,isBillingAdmin:a||e.isBillingAdmin,isGroupManager:!!o||e.isGroupManager}},{isTeamAdmin:!1,isBillingAdmin:!1,isGroupManager:!1}),o=(0,n.default)();o&&o.spaceDataUpdated({...t,rights:a})}function h(e){let t=(0,o.default)();t&&t.webOnboardingModeUpdated(e);let r=(0,n.default)();r&&r.webOnboardingModeUpdated(e)}t.triggerOpenSessionOTPSent=function(e){s.default.log("Ask for OTP");let t=(0,o.default)();t&&t.openSessionOTPSent(e);let r=(0,n.default)();r&&r.openSessionOTPSent(e)},t.triggerOpenSessionOTPForNewDeviceRequired=function(){let e=(0,o.default)();e&&e.openSessionOTPForNewDeviceRequired();let t=(0,n.default)();t&&t.openSessionOTPForNewDeviceRequired()},t.triggerAskMasterPassword=function(e){s.default.log("Ask for master password");let t=(0,o.default)();t&&t.openSessionAskMasterPassword({login:e});let r=(0,n.default)();r&&r.openSessionAskMasterPassword({login:e})},t.triggerOpenSessionTokenSent=function(e){s.default.log("Ask for new device e-mail token");let t=(0,o.default)();t&&t.openSessionTokenSent(e);let r=(0,n.default)();r&&r.openSessionTokenSent(e)},t.triggerOpenSessionDashlaneAuthenticator=function(){(0,s.logDebug)({message:"Ask for new device dashlane authenticator push notification"});let e=(0,o.default)();e&&e.openSessionDashlaneAuthenticator();let t=(0,n.default)();t&&t.openSessionDashlaneAuthenticator()},t.triggerOpenSessionExtraDeviceTokenRequired=function(){let e=(0,o.default)();e&&e.openSessionExtraDeviceTokenRequired();let t=(0,n.default)();t&&t.openSessionExtraDeviceTokenRequired()},t.triggerOpenSessionSsoRedirectionToIdpRequired=function(e,t){let r=(0,o.default)();r&&r.openSessionSsoRedirectionToIdpRequired({serviceProviderRedirectUrl:e,isNitroProvider:t});let a=(0,n.default)();a&&a.openSessionSsoRedirectionToIdpRequired({serviceProviderRedirectUrl:e,isNitroProvider:t})},t.triggerOpenSessionMasterPasswordLess=function(){let e=(0,o.default)();e&&e.openSessionMasterPasswordLess();let t=(0,n.default)();t&&t.openSessionMasterPasswordLess()},t.triggerLoginStatusChanged=m,t.triggerServerSidePairingStatusChanged=y,t.triggerSsoSolutionChanged=function(e){let t=(0,n.default)();t&&t.ssoSolutionChanged(e)},t.getAuthenticationCodeFromError=f,t.triggerOpenSessionFailed=function(e){s.default.log("Failed to open Session"),s.default.log(`error: ${e}`);let t=f(e),r=t===a.AuthenticationCode.UNKNOWN_ERROR?e&&e.message&&"string"==typeof e.message?e.message:"89645128":"",c=Error(`[SessionCommunication] - triggerOpenSessionFailed: ${e}`);c.stack=e.stack,s.default.error(c),(0,i.sendExceptionLog)({error:c,code:function(e){switch(e){case a.AuthenticationCode.INVALID_LOGIN:case a.AuthenticationCode.EMPTY_LOGIN:case a.AuthenticationCode.EMPTY_MASTER_PASSWORD:case a.AuthenticationCode.EMPTY_TOKEN:case a.AuthenticationCode.EMPTY_OTP:case a.AuthenticationCode.NETWORK_ERROR:case a.AuthenticationCode.USER_DOESNT_EXIST:case a.AuthenticationCode.OTP_NOT_VALID:case a.AuthenticationCode.TOKEN_NOT_VALID:case a.AuthenticationCode.TOKEN_TOO_MANY_ATTEMPTS:case a.AuthenticationCode.WRONG_PASSWORD:return a.ExceptionCriticality.WARNING;default:return a.ExceptionCriticality.ERROR}}(t)});let l={errorCode:a.AuthenticationCode[t],additionalErrorInfo:r,displayErrorCode:!0},u=(0,o.default)();u&&u.openSessionFailed(l);let d=(0,n.default)();d&&d.openSessionFailed(l)},t.triggerSessionOpened=function(e,t,r){let o=void 0!==(0,p.ssoMigrationInfoSelector)(e.getState()).migration;m({loggedIn:!0,login:e.getAccountInfo().login,needsSSOMigration:o}),A(e),h(e.getLocalSettings().webOnboardingMode),(0,u.getLocalAccounts)(e,t).then(e=>{E(e)}),void 0!==r&&y({serverSidePairingStatus:r?a.ServerSidePairingStatus.PAIRED:a.ServerSidePairingStatus.UNPAIRED})},t.triggerExtensionReload=function(e){let t=(0,g.didOpenSelector)(e.getState()),r=(0,o.default)();r&&r.reloadExtension(t)},t.triggerSessionSyncStatus=function(e){let t=(0,o.default)();t&&t.sessionSyncStatus(e);let r=(0,n.default)();r&&r.sessionSyncStatus(e)},t.sendLocalAccounts=E,t.sendLocationInfo=function(e){let t=(0,n.default)();t&&t.currentLocationUpdated(e)},t.reportDataUpdate=A,t.updatePaymentCardTokenResult=function(e){let t=(0,n.default)();t&&t.updatePaymentCardTokenResult(e)},t.sendTeamAdminDataUpdate=function(e){let t=(0,n.default)();t&&t.teamAdminDataUpdated(e)},t.sendWebOnboardingModeUpdate=h,t.sendFeatures=function(e){let t=(0,o.default)();t&&t.accountFeaturesChanged(e);let r=(0,n.default)();r&&r.accountFeaturesChanged(e)}},6956:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.refeshAccountInfo=t.AutofillProtectionStatus=t.askWebsiteInfo=t.saveGeneratedPassword=t.generatePassword=t.getPasswordGenerationSettings=t.generateAndSavePassword=t.resumeSession=t.sessionForceSync=t.getAndTriggerRefreshAccountInfo=t.makeSessionController=void 0;let a=r(83533),o=r(49204),n=r(22560),i=r(27698),s=r(13206),c=r(80896),l=r(19767),u=r(33161),d=r(80990),p=r(13776),S=r(52780),g=r(29509),m=r(93748),y=r(49087),f=r(12610),E=r(4790);t.makeSessionController=e=>({askWebsiteInfo:t=>R(e.storeService,t),cancelPremiumSubscription:()=>v(e.storeService,e.sessionService,e.wsService),changeDeviceName:(t,r)=>(function(e,t,r,a){if(e.isAuthenticated()){let e=(0,S.secureDeviceName)(a);return t.getInstance().device.changeDeviceName(r,e).catch(e=>{let t=Error(`[SessionController] - changeDeviceName: ${e}`);n.default.log(t),c.sendExceptionLog({error:t})})}return Promise.resolve(null)})(e.storeService,e.sessionService,t,r),closeSession:()=>{var t;return t=e.sessionService,n.default.log("SessionController/closeSession called"),t.close()},lockSession:()=>e.sessionService.lock(),deactivateDevice:t=>{var r,a,o;return r=e.storeService,a=e.sessionService,o=t,r.isAuthenticated()?a.getInstance().device.deactivateDevice(o).catch(e=>{let t=Error(`[SessionController] - deactivateDevice: ${e}`);n.default.log(t),c.sendExceptionLog({error:t})}):Promise.resolve(null)},generateAndSavePassword:t=>P(e.storeService,e.sessionService,t),generatePassword:t=>C(e.storeService,t),getAccountInfo:()=>(function(e){let t=e.getState();return Promise.resolve({premiumStatus:(0,m.premiumStatusSelector)(t)})})(e.storeService),getAndTriggerRefreshAccountInfo:()=>h(e.storeService,e.sessionService,e.wsService),getPasswordGenerationSettings:()=>O(e.storeService),getCurrentUserInfo:()=>(0,f.getCurrentUserInfo)(e.storeService),getDevicesList:()=>{var t,r;return t=e.storeService,r=e.sessionService,t.isAuthenticated()?r.getInstance().device.fetchDevicesList().catch(e=>(n.default.log("Error while fetching Devices list",e),[])):Promise.resolve([])},getInvoices:()=>{var t,r;return t=e.storeService,r=e.sessionService,t.isAuthenticated()?r.getInstance().payment.fetchInvoices().catch(e=>{let t=Error(`[SessionController] - getInvoices: ${e}`);return n.default.log(t),c.sendExceptionLog({error:t}),null}):Promise.resolve(null)},getPersonalSettings:()=>Promise.resolve(e.storeService.getPersonalSettings()),getUki:()=>{var t;return t=e.storeService,{uki:(0,g.ukiSelector)(t.getState())}},isSaveCredentialDisabled:t=>(0,d.isSaveCredentialDisabledOnDomain)(e.storeService,t),signalSaveCredentialDisabled:t=>(0,d.signalSaveCredentialDisabled)(e.storeService,e.sessionService,t),resumeSession:()=>D(e.storeService,e.storageService,e.sessionService,e.wsService),saveGeneratedPassword:(t,r)=>b(e.storeService,e.sessionService,t,r),sessionForceSync:(t=a.Trigger.Manual)=>T(e.sessionService,t),updateCardToken:(t,r)=>I(e.storeService,e.sessionService,e.wsService,t,r),validateMasterPassword:t=>(0,y.validateMasterPassword)(e.storeService,e.masterPasswordEncryptorService,t)});let A={premiumStatus:{statusCode:null}};async function h(e,t,r){if(!e.isAuthenticated())return A;try{return(await _(e,t,r)).accountInfo}catch(r){n.default.error("Error during getRefreshedAccountInfo",r);let t=(0,m.premiumStatusSelector)(e.getState());return{...A,...t?{premiumStatus:t}:{}}}}async function _(e,t,r){let{user:a}=t.getInstance(),o=(0,u.refreshPremiumStatus)(e,r,e.getUserLogin(),(0,g.ukiSelector)(e.getState())).then(()=>({premiumStatus:e.getLocalSettings().premiumStatus,nodePremiumStatusSpaceData:(0,E.getNodePremiumStatusSpaceData)(e)}));try{await a.fetchAccountInfo()}catch(e){(0,n.logError)(e),c.sendExceptionLog({error:e})}let{premiumStatus:i,nodePremiumStatusSpaceData:s}=await o;if(!i)throw Error("premium info should exist");return{accountInfo:{premiumStatus:i},nodePremiumStatusSpaceData:s}}async function T(e,t=a.Trigger.Manual){await e.getInstance().user.attemptSync(t)}async function v(e,t,r){if(!e.isAuthenticated())return{success:!1};try{return await t.getInstance().payment.cancelPremiumSubscription(),_(e,t,r).catch(e=>{}),{success:!0}}catch(r){let e=r.message,t=Error(`[SessionController] - cancelPremiumSubscription: ${r}`);return n.default.log(t),c.sendExceptionLog({error:t}),{success:!1,reason:e}}}async function I(e,t,r,a,o){try{if(!e.isAuthenticated())return;let{payment:n}=t.getInstance(),s=await n.updatePaymentCard(a,o);i.updatePaymentCardTokenResult(s),_(e,t,r).catch(e=>{})}catch(r){let e=r.message,t=Error(`[SessionController] - updateCardToken: ${r}`);n.default.log(t),c.sendExceptionLog({error:t}),i.updatePaymentCardTokenResult({success:!1,reason:e})}}function D(e,t,r,a){return((0,p.triggerABTestingChanged)(e.getABTesting()),i.sendLocationInfo(e.getPlatform().location),e.isAuthenticated())?h(e,r,a).then(()=>(i.triggerSessionOpened(e,t),!0)):Promise.resolve(null)}function P(e,t,r){return l.generateAndSavePassword(e,t,r)}function O(e){return l.getDefaultPasswordGenerationSettings(e.getPersonalSettings())}function C(e,t){return l.generatePassword(e.getPersonalSettings(),t)}function b(e,t,r,a){return l.saveGeneratedPassword(e,t,r,a)}function R(e,t){return(0,s.getWebsiteInfo)(e,t)}t.getAndTriggerRefreshAccountInfo=h,t.sessionForceSync=T,t.resumeSession=D,t.generateAndSavePassword=P,t.getPasswordGenerationSettings=O,t.generatePassword=C,t.saveGeneratedPassword=b,t.askWebsiteInfo=R,t.AutofillProtectionStatus=(0,o.Enum)("UNPROTECTED","LOCKED","UNLOCKED"),t.refeshAccountInfo=function(e,t,r){_(e,t,r).catch(e=>{})}},29256:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.getFreshSpaceData=t.updateCurrentSpaceWith=t.updateSpaceData=t.refreshSpaceData=void 0;let a=r(45646),o=r(27698);function n(e,t){e.dispatch((0,a.spaceDataUpdated)({spaces:t})),(0,o.reportDataUpdate)(e)}function i(e){return(e||[]).map(e=>({teamId:e.teamId,details:e}))}t.refreshSpaceData=function(e,t){let r=i(t);return n(e,r),Promise.resolve(r)},t.updateSpaceData=n,t.updateCurrentSpaceWith=function(e,t){let r=e.getSpaceData().spaces.map(e=>"accepted"===e.details.status?t(e):e);n(e,r)},t.getFreshSpaceData=i},43392:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.clearIconsCache=t.IconsCacheLoaded=t.iconsRefreshed=t.iconsUpdated=t.ICONS_CACHE_EMPTY=t.ICONS_CACHE_LOADED=t.ICONS_REFRESHED=t.ICONS_UPDATED=void 0,t.ICONS_UPDATED="ICONS_UPDATED",t.ICONS_REFRESHED="ICONS_REFRESHED",t.ICONS_CACHE_LOADED="ICONS_CACHE_LOADED",t.ICONS_CACHE_EMPTY="ICONS_CACHE_EMPTY",t.iconsUpdated=e=>({type:t.ICONS_UPDATED,data:e}),t.iconsRefreshed=e=>({type:t.ICONS_REFRESHED,data:e}),t.IconsCacheLoaded=e=>({type:t.ICONS_CACHE_LOADED,data:e}),t.clearIconsCache=()=>({type:t.ICONS_CACHE_EMPTY})},70607:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.iconsFromStorage=t.iconsToStorage=void 0,t.iconsToStorage=e=>({...e,domains:Array.from(e.domains.entries())}),t.iconsFromStorage=e=>({...e,domains:new Map(e.domains)})},2440:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.getEmptyIconByDomains=void 0;let a=r(43392),o=r(67179),n=r(59587);function i(e,t){let r=t.filter(e=>!!e.domain);if(!r.length)return e;let a=new Map,o=!1;for(let t of r){let{domain:r,...i}=t,s=(0,n.computeHashMD5)(r);e.get(s)||(o=!0,a.set(s,i))}return o?new Map([...e,...a]):e}function s(){return{domains:new Map,lastUpdateTimeSeconds:0}}t.getEmptyIconByDomains=s,t.default=(e=s(),t)=>{switch(t.type){case a.ICONS_UPDATED:{let r=i(e.domains,t.data);if(e.domains!==r)return{...e,domains:r};return e}case a.ICONS_REFRESHED:return{...e,domains:i(e.domains,t.data),lastUpdateTimeSeconds:(0,o.getUnixTimestamp)()};case a.ICONS_CACHE_LOADED:return t.data;case a.ICONS_CACHE_EMPTY:return s();default:return e}}},22198:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.loadedStoredUserABTests=t.refreshedUserABTests=t.SENT_AB_TEST_USAGE_LOG=t.STORED_USER_AB_TEST_LOADED=t.USER_AB_TESTS_UPDATED=void 0,t.USER_AB_TESTS_UPDATED="USER_AB_TEST_UPDATED",t.STORED_USER_AB_TEST_LOADED="STORED_USER_AB_TEST_LOADED",t.SENT_AB_TEST_USAGE_LOG="SENT_AB_TEST_USAGE_LOG",t.refreshedUserABTests=e=>({type:t.USER_AB_TESTS_UPDATED,lastUpdateTimestamp:Date.now(),tests:e}),t.loadedStoredUserABTests=e=>({type:t.STORED_USER_AB_TEST_LOADED,userABTests:e})},94768:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.getEmptyTests=void 0;let a=r(22198);function o(){return{lastUpdateTimestamp:null,tests:{}}}t.getEmptyTests=o,t.default=(e=o(),t)=>{switch(t.type){case a.USER_AB_TESTS_UPDATED:return{...e,tests:t.tests,lastUpdateTimestamp:t.lastUpdateTimestamp};case a.STORED_USER_AB_TEST_LOADED:return{...e,...t.userABTests};default:return e}}},813:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.userABTestVariantSelector=t.userABTestSelector=t.userABTestsSelector=void 0,t.userABTestsSelector=e=>e.userSession.abTests,t.userABTestSelector=(e,r)=>(0,t.userABTestsSelector)(e).tests[r],t.userABTestVariantSelector=(e,r)=>{let a=(0,t.userABTestSelector)(e,r);return a?a.variant:void 0}},70546:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.accountContactInfoRefreshed=t.saveAccountContactInfo=t.ACCOUNT_CONTACT_INFO_REFRESHED=t.SAVE_ACCOUNT_CONTACT_INFO=void 0,t.SAVE_ACCOUNT_CONTACT_INFO="SAVE_ACCOUNT_CONTACT_INFO",t.ACCOUNT_CONTACT_INFO_REFRESHED="ACCOUNT_CONTACT_INFO_REFRESHED",t.saveAccountContactInfo=e=>({type:t.SAVE_ACCOUNT_CONTACT_INFO,accountContactInfo:e}),t.accountContactInfoRefreshed=e=>({type:t.ACCOUNT_CONTACT_INFO_REFRESHED,accountContactInfo:e})},96387:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});let a=r(70546);t.default=(e={},t)=>{switch(t.type){case a.SAVE_ACCOUNT_CONTACT_INFO:case a.ACCOUNT_CONTACT_INFO_REFRESHED:return{...e,...t.accountContactInfo};default:return e}}},40501:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.accountCreationStarted=t.saveAccountKeys=t.saveAccountSettings=t.ACCOUNT_CREATION_STARTED=t.SAVE_ACCOUNT_KEYS=t.SAVE_ACCOUNT_SETTINGS=void 0,t.SAVE_ACCOUNT_SETTINGS="SAVE_ACCOUNT_SETTINGS",t.SAVE_ACCOUNT_KEYS="SAVE_ACCOUNT_KEYS",t.ACCOUNT_CREATION_STARTED="ACCOUNT_CREATION_STARTED",t.saveAccountSettings=function(e){return{type:t.SAVE_ACCOUNT_SETTINGS,settings:e}},t.saveAccountKeys=function(e){return{type:t.SAVE_ACCOUNT_KEYS,accountKey:e}},t.accountCreationStarted=function(e){return{type:t.ACCOUNT_CREATION_STARTED,isSSO:e.isSSO}}},87817:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.getEmptyAccountCreation=void 0;let a=r(40501),o=r(13206);function n(){return{settings:{personalSettings:(0,o.getEmptyPersonalSettings)(),promise:null},accountKey:{promise:null},isSSO:!1}}t.default=(e=n(),t)=>{switch(t.type){case a.SAVE_ACCOUNT_SETTINGS:return{...e,settings:{...t.settings,personalSettings:(0,o.getUpdatedPersonalSettings)(e.settings.personalSettings,t.settings.personalSettings)}};case a.SAVE_ACCOUNT_KEYS:return{...e,accountKey:t.accountKey};case a.ACCOUNT_CREATION_STARTED:return{...n(),isSSO:t.isSSO};default:return e}},t.getEmptyAccountCreation=n},62774:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.isSSOAccountCreationSelector=void 0,t.isSSOAccountCreationSelector=e=>e.userSession.accountCreation.isSSO},30029:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.storeAccountAuthenticationType=t.setPasswordLeaked=t.saveSubscriptionCode=t.localDataLoaded=t.userAuthenticationFailed=t.confirmUserAuthentication=t.enableOtp=t.SET_ACCOUNT_TYPE=t.USER_AUTHENTICATION_FAILED=t.SET_PASSWORD_LEAKED=t.SAVE_SUBSCRIPTION_CODE=t.LOCAL_DATA_LOADED=t.CONFIRM_USER_AUTHENTICATION=t.ENABLE_OTP=void 0;let a=r(4455);t.ENABLE_OTP="ENABLE_OTP",t.CONFIRM_USER_AUTHENTICATION="CONFIRM_USER_AUTHENTICATION",t.LOCAL_DATA_LOADED="LOCAL_DATA_LOADED",t.SAVE_SUBSCRIPTION_CODE="SAVE_SUBSCRIPTION_CODE",t.SET_PASSWORD_LEAKED="SET_PASSWORD_LEAKED",t.USER_AUTHENTICATION_FAILED="USER_AUTHENTICATION_FAILED",t.SET_ACCOUNT_TYPE="SET_ACCOUNT_TYPE",t.enableOtp=e=>({type:t.ENABLE_OTP,otpType:e}),t.confirmUserAuthentication=()=>({type:t.CONFIRM_USER_AUTHENTICATION,sessionStartTime:Date.now()}),t.userAuthenticationFailed=()=>({type:t.USER_AUTHENTICATION_FAILED}),t.localDataLoaded=()=>({type:t.LOCAL_DATA_LOADED,persistData:a.PersistData.PERSIST_DATA_YES}),t.saveSubscriptionCode=e=>({type:t.SAVE_SUBSCRIPTION_CODE,code:e}),t.setPasswordLeaked=e=>({type:t.SET_PASSWORD_LEAKED,isPasswordLeaked:e}),t.storeAccountAuthenticationType=e=>({type:t.SET_ACCOUNT_TYPE,accountAuthenticationType:e})},31935:function(e,t,r){var a,o;Object.defineProperty(t,"__esModule",{value:!0}),t.getEmptyAccount=t.OtpType=void 0;let n=r(92830),i=r(57758),s=r(30029);function c(){return{login:null,isAuthenticated:!1,sessionStartTime:null,persistData:null,otpType:a.NO_OTP,isPasswordLeaked:!1,accountAuthenticationType:"masterPassword"}}(o=a=t.OtpType||(t.OtpType={}))[o.NO_OTP=0]="NO_OTP",o[o.OTP_NEW_DEVICE=1]="OTP_NEW_DEVICE",o[o.OTP_LOGIN=2]="OTP_LOGIN",t.getEmptyAccount=c,t.default=(e=c(),t)=>{switch(t.type){case n.OPEN_SESSION:return{...e,login:t.login};case i.DEVICE_REGISTERED:case s.LOCAL_DATA_LOADED:return{...e,persistData:t.persistData};case s.CONFIRM_USER_AUTHENTICATION:return{...e,isAuthenticated:!0,sessionStartTime:t.sessionStartTime};case s.USER_AUTHENTICATION_FAILED:return{...e,isAuthenticated:!1,sessionStartTime:null};case s.ENABLE_OTP:return{...e,otpType:t.otpType};case s.SAVE_SUBSCRIPTION_CODE:return{...e,subscriptionCode:t.code};case s.SET_PASSWORD_LEAKED:return{...e,isPasswordLeaked:t.isPasswordLeaked};case s.SET_ACCOUNT_TYPE:return{...e,accountAuthenticationType:t.accountAuthenticationType};default:return e}}},71802:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.accountAuthenticationTypeSelector=void 0,t.accountAuthenticationTypeSelector=e=>e.userSession.account.accountAuthenticationType},92830:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.applyTransactions=t.premiumStatusUpdated=t.localSettingsUpdated=t.closeSession=t.openSession=t.saveGeneratedPassword=t.savePersonalDataItems=t.savePersonalDataItem=t.SAVE_PERSONAL_ITEMS=t.SAVE_PERSONAL_ITEM=t.SAVE_GENERATED_PASSWORD=t.PREMIUM_STATUS_UPDATED=t.LOCAL_SETTINGS_UPDATED=t.REMOVE_PERSONAL_ITEM_FROM_TRANSACTION=t.ADD_PERSONAL_ITEM_FROM_TRANSACTION=t.CHANGES_FROM_TRANSACTIONS=t.CLOSE_SESSION=t.OPEN_SESSION=void 0;let a=r(20648),o=r(33170);t.OPEN_SESSION="OPEN_SESSION",t.CLOSE_SESSION="CLOSE_SESSION",t.CHANGES_FROM_TRANSACTIONS="CHANGES_FROM_TRANSACTIONS",t.ADD_PERSONAL_ITEM_FROM_TRANSACTION="ADD_PERSONAL_ITEM_FROM_TRANSACTION",t.REMOVE_PERSONAL_ITEM_FROM_TRANSACTION="REMOVE_PERSONAL_ITEM_FROM_TRANSACTION",t.LOCAL_SETTINGS_UPDATED="LOAD_STORED_LOCAL_SETTINGS",t.PREMIUM_STATUS_UPDATED="PREMIUM_STATUS_UPDATED",t.SAVE_GENERATED_PASSWORD="SAVE_GENERATED_PASSWORD",t.SAVE_PERSONAL_ITEM="SAVE_PERSONAL_ITEM",t.SAVE_PERSONAL_ITEMS="SAVE_PERSONAL_ITEMS",t.savePersonalDataItem=function(e,r,o){return{type:t.SAVE_PERSONAL_ITEM,dataType:a.DATAMODELOBJECT_TYPE_TO_CARBON_STORE_KEY[r],dataModelObject:e,changeHistory:o}},t.savePersonalDataItems=function(e,r,o){return{type:t.SAVE_PERSONAL_ITEMS,dataType:a.DATAMODELOBJECT_TYPE_TO_CARBON_STORE_KEY[r],dataModelObjects:e,changeHistory:o}},t.saveGeneratedPassword=function(e){return{type:t.SAVE_GENERATED_PASSWORD,generatedPassword:e}},t.openSession=e=>({type:t.OPEN_SESSION,login:e}),t.closeSession=()=>({type:t.CLOSE_SESSION}),t.localSettingsUpdated=e=>({type:t.LOCAL_SETTINGS_UPDATED,data:Object.assign({},e)}),t.premiumStatusUpdated=e=>({type:t.PREMIUM_STATUS_UPDATED,premiumStatus:e}),t.applyTransactions=e=>{let r=e.map(e=>{let r;return r="SETTINGS"===e.type?o.PersonalSettingsActionType.EditFromTransaction:"BACKUP_REMOVE"===e.action?t.REMOVE_PERSONAL_ITEM_FROM_TRANSACTION:t.ADD_PERSONAL_ITEM_FROM_TRANSACTION,"BACKUP_EDIT"===e.action&&e.content&&(e.content.LastBackupTime=Math.floor(e.backupDate/1e3)),{type:r,itemId:e.identifier,content:e.content}});return{type:t.CHANGES_FROM_TRANSACTIONS,actions:r}}},95516:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.resetAuthTicketInfo=t.updateAuthTicketInfo=void 0;let a=r(77196);t.updateAuthTicketInfo=e=>({type:a.ADD_AUTH_TICKET_DATA,data:e}),t.resetAuthTicketInfo=()=>({type:a.RESET_AUTH_TICKET_DATA})},92343:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.getEmptyAuthTicketInfo=void 0;let a=r(77196);t.getEmptyAuthTicketInfo=()=>({login:null,date:0,authTicket:null}),t.default=(e=(0,t.getEmptyAuthTicketInfo)(),r)=>{switch(r.type){case a.ADD_AUTH_TICKET_DATA:return{...e,...r.data};case a.RESET_AUTH_TICKET_DATA:return{...e,...(0,t.getEmptyAuthTicketInfo)()};default:return e}}},77196:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.RESET_AUTH_TICKET_DATA=t.ADD_AUTH_TICKET_DATA=void 0,t.ADD_AUTH_TICKET_DATA="ADD_AUTH_TICKET_DATA",t.RESET_AUTH_TICKET_DATA="RESET_AUTH_TICKET_DATA"},20106:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.blacklistedUserSessionKeys=void 0,t.blacklistedUserSessionKeys=["iconsCache","personalData","teamAdminData","sharingData"]},31571:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.updateBreachRefreshTimestamp=t.UPDATE_BREACHES_REFRESH_TIMESTAMP=void 0,t.UPDATE_BREACHES_REFRESH_TIMESTAMP="UPDATE_BREACHES_REFRESH_TIMESTAMP",t.updateBreachRefreshTimestamp=e=>({type:t.UPDATE_BREACHES_REFRESH_TIMESTAMP,lastBreachRefreshTimestamp:e})},79643:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.breachRefreshMetaDataReducer=t.getEmptyBreachRefreshMetadata=void 0;let a=r(31571);t.getEmptyBreachRefreshMetadata=()=>({lastBreachRefreshTimestamp:0}),t.breachRefreshMetaDataReducer=(e=(0,t.getEmptyBreachRefreshMetadata)(),r)=>r.type===a.UPDATE_BREACHES_REFRESH_TIMESTAMP?{lastBreachRefreshTimestamp:r.lastBreachRefreshTimestamp}:e},34056:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.changeMPDone=t.changeMPStart=t.SET_CHANGE_MP_DONE=t.SET_CHANGE_MP_START=void 0,t.SET_CHANGE_MP_START="SET_CHANGE_MP_START",t.SET_CHANGE_MP_DONE="SET_CHANGE_MP_DONE",t.changeMPStart=()=>({type:t.SET_CHANGE_MP_START}),t.changeMPDone=()=>({type:t.SET_CHANGE_MP_DONE})},69806:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.getEmptyChangeMPData=void 0;let a=r(34056);function o(){return{changeMPinProgress:!1}}t.getEmptyChangeMPData=o,t.default=(e=o(),t)=>{switch(t.type){case a.SET_CHANGE_MP_START:return{...e,changeMPinProgress:!0};case a.SET_CHANGE_MP_DONE:return{...e,changeMPinProgress:!1};default:return e}}},9986:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.credentialOTPUpdatedAction=t.CREDENTIAL_OTP_UPDATED=void 0,t.CREDENTIAL_OTP_UPDATED="CREDENTIAL_OTP_UPDATED",t.credentialOTPUpdatedAction=(e,r)=>({type:t.CREDENTIAL_OTP_UPDATED,credentialId:e,otp:r})},1876:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.credentialOTPUpdatedAction=t.credentialOTPs=void 0;var a=r(17874);Object.defineProperty(t,"credentialOTPs",{enumerable:!0,get:function(){return a.credentialOTPs}});var o=r(9986);Object.defineProperty(t,"credentialOTPUpdatedAction",{enumerable:!0,get:function(){return o.credentialOTPUpdatedAction}})},17874:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.credentialOTPs=void 0,t.credentialOTPs=function(e={},t){return"CREDENTIAL_OTP_UPDATED"===t.type?{...e,[t.credentialId]:t.otp}:e}},88434:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.credentialsDedupViewUpdated=void 0;let a=r(56189);t.credentialsDedupViewUpdated=e=>({type:a.CREDENTIAL_DEDUP_VIEW_UPDATED,credentialsDedupView:e})},35251:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.credentialsDedupViewReducer=t.getDefaultCredentialsDedupView=void 0;let a=r(56189);function o(){return{credentialsDedupView:!1}}t.getDefaultCredentialsDedupView=o,t.credentialsDedupViewReducer=function(e=o(),t){return t.type===a.CREDENTIAL_DEDUP_VIEW_UPDATED?{...e,...t.credentialsDedupView}:e}},56189:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.CREDENTIAL_DEDUP_VIEW_UPDATED=void 0,t.CREDENTIAL_DEDUP_VIEW_UPDATED="CREDENTIAL_DEDUP_VIEW_UPDATED"},36566:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.teamDirectorySyncNotInProgress=t.teamDirectorySyncInProgress=t.TEAM_DIRECTORY_SYNC_NOT_IN_PROGRESS=t.TEAM_DIRECTORY_SYNC_IN_PROGRESS=void 0,t.TEAM_DIRECTORY_SYNC_IN_PROGRESS="TEAM_DIRECTORY_SYNC_IN_PROGRESS",t.TEAM_DIRECTORY_SYNC_NOT_IN_PROGRESS="TEAM_DIRECTORY_SYNC_NOT_IN_PROGRESS",t.teamDirectorySyncInProgress=e=>({type:t.TEAM_DIRECTORY_SYNC_IN_PROGRESS,teamId:e}),t.teamDirectorySyncNotInProgress=e=>({type:t.TEAM_DIRECTORY_SYNC_NOT_IN_PROGRESS,teamId:e})},94426:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.isTeamDirectorySyncInProgress=t.getEmptyState=void 0;let a=r(36566);function o(){return{syncsInProgress:{}}}t.getEmptyState=o,t.isTeamDirectorySyncInProgress=function(e,t){return e.syncsInProgress[t]},t.default=(e=o(),t)=>{switch(t.type){case a.TEAM_DIRECTORY_SYNC_IN_PROGRESS:let{teamId:r}=t;return{...e,syncsInProgress:{...e.syncsInProgress,[r]:!0}};case a.TEAM_DIRECTORY_SYNC_NOT_IN_PROGRESS:let{teamId:n}=t;return{...e,syncsInProgress:{...e.syncsInProgress,[n]:!1}};default:return e}}},83929:function(e,t){var r,a;Object.defineProperty(t,"__esModule",{value:!0}),t.deleteFileMetaAction=t.updateFileContentAction=t.updateFileMetaAction=t.FileActionsType=void 0,(a=r=t.FileActionsType||(t.FileActionsType={})).UpdateFileMeta="UPDATE_FILE_META",a.UpdateFileContent="UPDATE_FILE_CONTENT",a.DeleteFileMeta="DELETE_FILE_META",t.updateFileMetaAction=e=>({type:r.UpdateFileMeta,filesMeta:e}),t.updateFileContentAction=e=>({type:r.UpdateFileContent,filesContent:e}),t.deleteFileMetaAction=e=>({type:r.DeleteFileMeta,fileNames:e})},57112:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.remoteFileReducer=t.defaultRemoteFileState=void 0;let a=r(83929);t.defaultRemoteFileState=()=>({fileMetaData:{files:{}},fileContentState:{}});let o=(e,t)=>({...e,fileMetaData:{files:{...e.fileMetaData.files,...t.filesMeta}}}),n=(e,t)=>({...e,fileContentState:{...e.fileContentState,...t.filesContent}}),i=(e,t)=>({...e,fileMetaData:{files:function(e,t){let r={...e};for(let e of t)e in r&&delete r[e];return r}(e.fileMetaData.files,t.fileNames)}});t.remoteFileReducer=(e=(0,t.defaultRemoteFileState)(),r)=>{switch(r?.type){case a.FileActionsType.UpdateFileMeta:return o(e,r);case a.FileActionsType.UpdateFileContent:return n(e,r);case a.FileActionsType.DeleteFileMeta:return i(e,r)}return e}},96066:function(e,t){function r(e){return"boolean"==typeof e?e:"string"==typeof e?"true"===e.toLowerCase()||"yes"===e.toLowerCase():!!e}function a(e,t){return"boolean"===t?e?"true":"false":"yes-no"===t?e?"YES":"NO":null}function o(e){return"object"==typeof e?e:JSON.parse(e)}function n(e){return JSON.stringify(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.fixProperties=t.fixPropertiesTypes=t.ObjectToJson=t.jsonToObject=t.booleanToString=t.stringToBoolean=void 0,t.stringToBoolean=r,t.booleanToString=a,t.jsonToObject=o,t.ObjectToJson=n,t.fixPropertiesTypes=function(e,t,a,n,i){let s={};return e.filter(e=>!!i[e]).forEach(e=>{s[e]=r(i[e])}),t.filter(e=>!!i[e]).forEach(e=>{s[e]=Number(i[e])}),a.filter(e=>!!i[e]).forEach(e=>{s[e]=o(i[e])}),n.filter(e=>i.hasOwnProperty(e)).forEach(e=>{let t=i[e];s[e]=null===t?"":String(t)}),Object.assign({},i,s)},t.fixProperties={fromStore:function(e,t,r,o){let i={};return Object.keys(e).filter(e=>!!o[e]).forEach(t=>{i[t]=a(o[t],e[t])}),Object.keys(t).filter(e=>!!o[e]).forEach(e=>{i[e]=o[e]&&o[e].toString()}),Object.keys(r).filter(e=>!!o[e]).forEach(e=>{i[e]=n(o[e])}),Object.assign({},o,i)},fromTransaction:function(e,t,a,n){let i={};return Object.keys(e).filter(e=>!!n[e]).forEach(e=>{i[e]=r(n[e])}),Object.keys(t).filter(e=>!!n[e]).forEach(e=>{i[e]=Number(n[e])}),Object.keys(a).filter(e=>!!n[e]).forEach(e=>{i[e]=o(n[e])}),Object.assign({},n,i)}}},30350:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.credentialSearchOrderUpdated=t.premiumChurningDismissDateUpdated=t.webOnboardingModeUpdated=t.localSettingsSubscriptionInformationStatusUpdated=t.localSettingsNodePremiumStatusUpdated=t.localSettingsPremiumStatusUpdated=t.registerDeviceName=t.registerLastSync=t.loadStoredLocalSettings=t.CREDENTIAL_SEARCH_ORDER_UPDATED=t.PREMIUM_CHURNING_DISMISS_DATE_UPDATED=t.WEB_ONBOARDING_MODE_RESET=t.WEB_ONBOARDING_MODE_UPDATED=t.SUBSCRIPTION_INFORMATION_UPDATED=t.NODE_PREMIUM_STATUS_UPDATED=t.PREMIUM_STATUS_UPDATED=t.REGISTER_DEVICE_NAME=t.REGISTER_LAST_SYNC=t.LOAD_STORED_LOCAL_SETTINGS=void 0,t.LOAD_STORED_LOCAL_SETTINGS="LOCAL_SETTINGS/LOAD_STORED_LOCAL_SETTINGS",t.REGISTER_LAST_SYNC="LOCAL_SETTINGS/REGISTER_LAST_SYNC",t.REGISTER_DEVICE_NAME="LOCAL_SETTINGS/REGISTER_DEVICE_NAME",t.PREMIUM_STATUS_UPDATED="LOCAL_SETTINGS/PREMIUM_STATUS_UPDATED",t.NODE_PREMIUM_STATUS_UPDATED="LOCAL_SETTINGS/NODE_PREMIUM_STATUS_UPDATED",t.SUBSCRIPTION_INFORMATION_UPDATED="LOCAL_SETTINGS/SUBSCRIPTION_INFORMATION_UPDATED",t.WEB_ONBOARDING_MODE_UPDATED="LOCAL_SETTINGS/WEB_ONBOARDING_MODE_UPDATED",t.WEB_ONBOARDING_MODE_RESET="LOCAL_SETTINGS/WEB_ONBOARDING_MODE_RESET",t.PREMIUM_CHURNING_DISMISS_DATE_UPDATED="PREMIUM_CHURNING_DISMISS_DATE_UPDATED",t.CREDENTIAL_SEARCH_ORDER_UPDATED="CREDENTIAL_SEARCH_ORDER_UPDATED",t.loadStoredLocalSettings=e=>({type:t.LOAD_STORED_LOCAL_SETTINGS,data:Object.assign({},e)}),t.registerLastSync=e=>({type:t.REGISTER_LAST_SYNC,lastSync:e}),t.registerDeviceName=e=>({type:t.REGISTER_DEVICE_NAME,deviceName:e}),t.localSettingsPremiumStatusUpdated=e=>({type:t.PREMIUM_STATUS_UPDATED,premiumStatus:e}),t.localSettingsNodePremiumStatusUpdated=e=>({type:t.NODE_PREMIUM_STATUS_UPDATED,nodePremiumStatus:e}),t.localSettingsSubscriptionInformationStatusUpdated=e=>({type:t.SUBSCRIPTION_INFORMATION_UPDATED,subscriptionInformation:e}),t.webOnboardingModeUpdated=e=>({type:t.WEB_ONBOARDING_MODE_UPDATED,webOnboardingMode:e}),t.premiumChurningDismissDateUpdated=e=>({type:t.PREMIUM_CHURNING_DISMISS_DATE_UPDATED,premiumChurningDismissDate:e}),t.credentialSearchOrderUpdated=e=>({type:t.CREDENTIAL_SEARCH_ORDER_UPDATED,credentialSearchOrder:e})},57836:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.getEmptyLocalSettings=t.getEmptyOnboardingMode=t.getEmptyLoginStepInfo=void 0;let a=r(25903),o=r(20648),n=r(4544),i=r(30350),s=r(82189),c=r(57758);function l(){return{step:null,login:"",validated:!1}}t.getEmptyLoginStepInfo=l;let u=(e,t)=>[o.LoginStep.Password,o.LoginStep.OTPToken].includes(t)?t:e.step,d=(e,t)=>t===o.LoginStep.OTPToken?!!e.login:![o.LoginStep.OTP1,o.LoginStep.OTP2].includes(t)&&e.validated,p=(e,t)=>Object.entries(t).every(([t,r])=>e?.[t]===r);function S(){return{uki:null,lastSync:0,premiumStatus:null,nodePremiumStatus:null,subscriptionInformation:null,deviceName:null,webOnboardingMode:(0,t.getEmptyOnboardingMode)(),premiumChurningDismissDate:null,credentialSearchOrder:null,userMessages:[],loginStepInfo:l()}}t.default=(e=S(),t)=>{switch(t.type){case i.LOAD_STORED_LOCAL_SETTINGS:{let r=S();return{...r,...e,...t.data,webOnboardingMode:{...r.webOnboardingMode,...e.webOnboardingMode,...t.data.webOnboardingMode,completedSteps:{...r.webOnboardingMode.completedSteps,...e.webOnboardingMode.completedSteps,...t.data.webOnboardingMode.completedSteps}}}}case c.DEVICE_REGISTERED:if("uki"===t.registrationType.type)return{...e,uki:t.registrationType.uki};return e;case i.REGISTER_LAST_SYNC:return Object.assign({},e,{lastSync:t.lastSync});case i.REGISTER_DEVICE_NAME:return Object.assign({},e,{deviceName:t.deviceName});case i.PREMIUM_STATUS_UPDATED:return Object.assign({},e,{premiumStatus:t.premiumStatus});case i.NODE_PREMIUM_STATUS_UPDATED:return Object.assign({},e,{nodePremiumStatus:t.nodePremiumStatus});case i.SUBSCRIPTION_INFORMATION_UPDATED:return Object.assign({},e,{subscriptionInformation:t.subscriptionInformation});case i.WEB_ONBOARDING_MODE_UPDATED:{let r=(0,a.mergeDeepRight)(S(),e);return(0,a.mergeDeepRight)(r,{webOnboardingMode:t.webOnboardingMode})}case i.PREMIUM_CHURNING_DISMISS_DATE_UPDATED:return Object.assign({},e,{premiumChurningDismissDate:t.premiumChurningDismissDate});case i.CREDENTIAL_SEARCH_ORDER_UPDATED:return Object.assign({},e,{credentialSearchOrder:t.credentialSearchOrder});case s.USER_MESSAGE_ADDED:return Object.assign({},e,{userMessages:[...e.userMessages,t.userMessage]});case s.USER_MESSAGES_DISMISSED:return Object.assign({},e,{userMessages:e.userMessages.some(e=>p(e,t.predicate))?e.userMessages.map(e=>p(e,t.predicate)?{...e,dismissedAt:Date.now()}:e):[...e.userMessages,{...t.predicate,dismissedAt:Date.now()}]});case n.UPDATE_LOGIN_STEP_INFO_LOGIN:return Object.assign({},e,{loginStepInfo:{...e.loginStepInfo,login:t.login}});case n.UPDATE_LOGIN_STEP_INFO_STEP:return Object.assign({},e,{loginStepInfo:{...e.loginStepInfo,step:u(e.loginStepInfo,t.step),validated:d(e.loginStepInfo,t.step)}});case n.RESET_LOGIN_STEP_INFO:return Object.assign({},e,{loginStepInfo:l()});default:return e}},t.getEmptyOnboardingMode=()=>({flowCredentialInApp:!1,flowLoginCredentialOnWeb:!1,flowLoginCredentialOnWebSite:null,flowSaveCredentialOnWeb:!1,flowImportPasswords:!1,flowAddMobileOnWeb:!1,flowTryAutofillOnWeb:!1,leelooStep:null,popoverStep:null,completedSteps:{saveCredentialInApp:!1,loginCredentialOnWeb:!1,saveCredentialOnWeb:!1,importPasswordsShown:!1,onboardingHubShown:!1,addMobileOnWeb:!1,tryAutofillOnWeb:!1}}),t.getEmptyLocalSettings=S},370:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.deviceNameSelector=void 0,t.deviceNameSelector=e=>e.userSession.localSettings.deviceName},50666:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.loadNotificationsStatus=t.markAsInteracted=t.markAsUnseen=t.markAsSeen=t.LOAD_NOTIFICATIONS_STATE=t.MARK_AS_INTERACTED=t.MARK_AS_UNSEEN=t.MARK_AS_SEEN=void 0,t.MARK_AS_SEEN="MarkAsSeen",t.MARK_AS_UNSEEN="MarkAsUnseen",t.MARK_AS_INTERACTED="MarkAsInteracted",t.LOAD_NOTIFICATIONS_STATE="LoadNotificationsState",t.markAsSeen=e=>({type:t.MARK_AS_SEEN,notification:e}),t.markAsUnseen=e=>({type:t.MARK_AS_UNSEEN,notification:e}),t.markAsInteracted=e=>({type:t.MARK_AS_INTERACTED,notification:e}),t.loadNotificationsStatus=e=>({type:t.LOAD_NOTIFICATIONS_STATE,state:e})},43588:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.getEmptyNotificationsState=void 0;let a=r(20648),o=r(50666),n={paymentFailureChurned:a.NotificationStatus.Unseen,paymentFailureChurning:a.NotificationStatus.Unseen,switchToMlAnalysisEngine:a.NotificationStatus.Unseen,dWMb2bAutoEnrollTooltip:a.NotificationStatus.Unseen,tacGetTheExtensionBanner:a.NotificationStatus.Unseen,tacEnableAccountRecoveryBanner:a.NotificationStatus.Unseen,tacOnlyOneAdminBanner:a.NotificationStatus.Unseen,tacDarkWebInsightsNewBadge:a.NotificationStatus.Unseen,passwordHistoryBanner:a.NotificationStatus.Unseen,sharingCenterDisabledBanner:a.NotificationStatus.Unseen,accountRecoveryAvailableAdminTooltip:a.NotificationStatus.Unseen,activateInviteLink:a.NotificationStatus.Unseen,mpToSsoMigrationDoneDialog:a.NotificationStatus.Seen};function i(){return n}t.getEmptyNotificationsState=i,t.default=(e=i(),t)=>{switch(t.type){case o.MARK_AS_INTERACTED:return{...e,[t.notification]:a.NotificationStatus.Interacted};case o.MARK_AS_SEEN:return{...e,[t.notification]:a.NotificationStatus.Seen};case o.MARK_AS_UNSEEN:return{...e,[t.notification]:a.NotificationStatus.Unseen};case o.LOAD_NOTIFICATIONS_STATE:return{...e,...t.state};default:return e}}},42585:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.notificationsStatus$=void 0;let a=r(95121),o=r(15237),n=r(13344);t.notificationsStatus$=function(){let e=n.notificationsStatusSelector;return(0,a.pipe)((0,o.map)(e),(0,o.distinctUntilChanged)())}},13344:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.notificationsStatusSelector=void 0,t.notificationsStatusSelector=e=>e.userSession.notificationsStatus},68220:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.receivedInvoiceList=t.RECEIVED_INVOICE_LIST=void 0,t.RECEIVED_INVOICE_LIST="RECEIVED_USER_LIST",t.receivedInvoiceList=e=>({type:t.RECEIVED_INVOICE_LIST,invoicesList:e})},64479:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.getEmptyPaymentsState=void 0;let a=r(68220);function o(){return{invoicesList:[]}}t.getEmptyPaymentsState=o,t.default=(e=o(),t)=>t.type===a.RECEIVED_INVOICE_LIST?{...e,invoicesList:t.invoicesList}:e},38121:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.viewedQueriedInvoicesSelector=t.searchGetters=t.invoiceMappersSelector=t.invoiceListYearsSelector=t.allInvoicesLengthSelector=t.allInvoicesSelector=void 0;let a=r(60974),o=r(7299),n=r(23674),i=r(92595),s=r(28919);t.allInvoicesSelector=e=>e.userSession.paymentsState.invoicesList,t.allInvoicesLengthSelector=e=>e.userSession.paymentsState.invoicesList.length,t.invoiceListYearsSelector=e=>{let t=e.userSession.paymentsState.invoicesList;return t.length?[...new Set(t.map(e=>(0,a.fromUnixTime)(e.startDate).getFullYear().toString()))]:[]},t.invoiceMappersSelector=e=>(0,s.getInvoiceMappers)(),t.searchGetters=[(0,i.stringProp)("amountPaid"),(0,i.stringProp)("planName"),(0,i.stringProp)("startDate"),(0,i.stringProp)("invoiceId"),(0,i.stringProp)("startYear")];let c=(0,n.match)(t.searchGetters),l=(0,o.getQuerySelector)(t.allInvoicesSelector,()=>c,t.invoiceMappersSelector);t.viewedQueriedInvoicesSelector=(e,t)=>l(e,t)},93625:function(e,t){function r(e){return{type:t.DELETE_VAULT_MODULE_ITEM,payload:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.updateBreachesUpdaterStatus=t.teamSpaceContentControlApplied=t.storeChangesToUpload=t.breachesUpdated=t.updateLastBackupTime=t.removePersonalItem=t.deleteVaultModuleItemsBulk=t.deleteVaultModuleItem=t.saveGeneratedPassword=t.savePaymentCard=t.unscheduleRemainingChanges=t.clearUploadedChanges=t.scheduleChangesForSync=t.loadStoredPersonalData=t.DELETE_VAULT_MODULE_ITEMS_BULK=t.DELETE_VAULT_MODULE_ITEM=t.UNSCHEDULE_REMAINING_CHANGES=t.CLEAR_UPLOADED_CHANGES=t.SCHEDULE_CHANGES_FOR_SYNC=t.UPDATE_BREACHES_UPDATER_STATUS=t.TEAMSPACE_CONTENT_CONTROLLED=t.STORE_CHANGES_TO_UPLOAD=t.BREACHES_UPDATED=t.UPDATE_LAST_BACKUP_TIME=t.SAVE_PAYMENT_CARD=t.SAVE_PERSONAL_ITEMS=t.SAVE_PERSONAL_ITEM=t.SAVE_GENERATED_PASSWORD=t.LOAD_STORED_PERSONAL_DATA=void 0,t.LOAD_STORED_PERSONAL_DATA="PERSONAL_DATA/LOAD_STORED_PERSONAL_DATA",t.SAVE_GENERATED_PASSWORD="PERSONAL_DATA/SAVE_GENERATED_PASSWORD",t.SAVE_PERSONAL_ITEM="PERSONAL_DATA/SAVE_PERSONAL_ITEM",t.SAVE_PERSONAL_ITEMS="PERSONAL_DATA/SAVE_PERSONAL_ITEMS",t.SAVE_PAYMENT_CARD="SAVE_PAYMENT_CARD",t.UPDATE_LAST_BACKUP_TIME="UPDATE_LAST_BACKUP_TIME",t.BREACHES_UPDATED="BREACHES_UPDATED",t.STORE_CHANGES_TO_UPLOAD="STORE_CHANGES_TO_UPLOAD",t.TEAMSPACE_CONTENT_CONTROLLED="TEAMSPACE_CONTENT_CONTROLLED",t.UPDATE_BREACHES_UPDATER_STATUS="UPDATE_BREACHES_UPDATER_STATUS",t.SCHEDULE_CHANGES_FOR_SYNC="SCHEDULE_CHANGES_FOR_SYNC",t.CLEAR_UPLOADED_CHANGES="CLEAR_UPLOADED_CHANGES",t.UNSCHEDULE_REMAINING_CHANGES="UNSCHEDULE_REMAINING_CHANGES",t.DELETE_VAULT_MODULE_ITEM="DELETE_VAULT_MODULE_ITEM",t.DELETE_VAULT_MODULE_ITEMS_BULK="DELETE_VAULT_MODULE_ITEMS_BULK",t.loadStoredPersonalData=e=>({type:t.LOAD_STORED_PERSONAL_DATA,data:Object.assign({},e)}),t.scheduleChangesForSync=()=>({type:t.SCHEDULE_CHANGES_FOR_SYNC}),t.clearUploadedChanges=e=>({type:t.CLEAR_UPLOADED_CHANGES,uploadedItemIds:e}),t.unscheduleRemainingChanges=()=>({type:t.UNSCHEDULE_REMAINING_CHANGES}),t.savePaymentCard=function(e){return{type:t.SAVE_PAYMENT_CARD,paymentCard:e}},t.saveGeneratedPassword=function(e){return{type:t.SAVE_GENERATED_PASSWORD,generatedPassword:e}},t.deleteVaultModuleItem=r,t.deleteVaultModuleItemsBulk=function(e){return{type:t.DELETE_VAULT_MODULE_ITEMS_BULK,payload:e}},t.removePersonalItem=function(e,t,a){return r({kwType:e,id:t,changeHistory:a})},t.updateLastBackupTime=function(e,r){return{type:t.UPDATE_LAST_BACKUP_TIME,transactions:e,backupTimeSec:r}},t.breachesUpdated=function(e,r,a){return{type:t.BREACHES_UPDATED,changes:e,revision:r,dataLeaksRefreshDate:a}},t.storeChangesToUpload=function(e){return{type:t.STORE_CHANGES_TO_UPLOAD,changesToUpload:e}},t.teamSpaceContentControlApplied=function(e,r,a){return{type:t.TEAMSPACE_CONTENT_CONTROLLED,updates:e,deletions:r,changeHistories:a}},t.updateBreachesUpdaterStatus=e=>({type:t.UPDATE_BREACHES_UPDATER_STATUS,breachesUpdaterStatus:e})},75180:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.PERSONAL_DATA_COLLECTIONS_KEYS=void 0;let a=r(20648);t.PERSONAL_DATA_COLLECTIONS_KEYS=Object.keys(a.DATAMODELOBJECT_TYPE_TO_CARBON_STORE_KEY).map(e=>a.DATAMODELOBJECT_TYPE_TO_CARBON_STORE_KEY[e])},64419:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.countPersonalDataItems=t.getEmptyBreachesMetadata=t.getLegacyEmptyBreaches=t.saveChangesToUpload=t.breachesUpdated=t.updateCredential=t.updateCredentials=t.updateLastBackupTime=t.saveObjects=t.saveGeneratedPassword=t.savePersonalDataItems=t.savePersonalDataItem=t.savePaymentCard=t.deleteVaultModulePersonalDataItemsBulk=t.deleteVaultModulePersonalDataItem=t.teamSpaceContentControlApplied=t.savePersonalSettings=t.removePersonalItemFromTransaction=t.addPersonalItemFromTransaction=t.getEmptyPersonalDataState=t.reducer=void 0;let a=r(25903),o=r(20648),n=r(75180),i=r(33795),s=r(93625),c=r(74453),l=r(33170),u=r(80306),d=r(96285);function p(){return{addresses:[],bankAccounts:[],changesToUpload:[],changeHistories:[],collections:[],companies:[],credentialCategories:[],credentials:[],driverLicenses:[],emails:[],fiscalIds:[],generatedPasswords:[],idCards:[],identities:[],notes:[],passkeys:[],passports:[],paymentCards:[],paypalAccounts:[],personalWebsites:[],phones:[],secrets:[],securityBreaches:[],securityBreachesMetadata:(0,t.getEmptyBreachesMetadata)(),socialSecurityIds:[],breachesUpdaterStatus:o.BreachesUpdaterStatus.UNKNOWN,secureFileInfo:[]}}t.reducer=(e=p(),t,r)=>{switch(t.type){case s.LOAD_STORED_PERSONAL_DATA:return{...e,...(0,i.fixPersistedPersonalData)(t.data)};case s.DELETE_VAULT_MODULE_ITEM:return A(e,t.payload);case s.DELETE_VAULT_MODULE_ITEMS_BULK:return h(e,t.payload);case s.SAVE_PAYMENT_CARD:return _(e,t);case s.SAVE_PERSONAL_ITEM:return T(e,t,r);case s.SAVE_PERSONAL_ITEMS:return v(e,t,r);case s.SAVE_GENERATED_PASSWORD:return I(e,t,r);case s.CLEAR_UPLOADED_CHANGES:return m(e,t);case s.SCHEDULE_CHANGES_FOR_SYNC:return g(e,t);case s.UNSCHEDULE_REMAINING_CHANGES:return y(e,t);case l.PersonalSettingsActionType.Edit:return f(e);case s.UPDATE_LAST_BACKUP_TIME:return D(e,t);case s.BREACHES_UPDATED:return O(e,t);case s.STORE_CHANGES_TO_UPLOAD:return C(e,t);case s.TEAMSPACE_CONTENT_CONTROLLED:return E(e,t);case s.UPDATE_BREACHES_UPDATER_STATUS:return{...e,breachesUpdaterStatus:t.breachesUpdaterStatus};default:return e}},t.getEmptyPersonalDataState=p;let S=(e,t)=>!e||!t||!o.DATAMODELOBJECT_TYPE_TO_CARBON_STORE_KEY.hasOwnProperty(t.kwType);t.addPersonalItemFromTransaction=function(e,t){if(S(t.itemId,t.content))return e;let r=o.DATAMODELOBJECT_TYPE_TO_CARBON_STORE_KEY[t.content.kwType],a=(0,i.fixPersonalDataItemFromExternalSource)(t.content,t.itemId);return{...e,[r]:b(e[r],a)}},t.removePersonalItemFromTransaction=function(e,t){return t.itemId?t.content?L(e,[t.itemId],t.content.kwType):L(e,[t.itemId]):e};let g=(e,t)=>({...e,changesToUpload:e.changesToUpload.map(d.markChangeAsScheduled)}),m=(e,t)=>({...e,changesToUpload:(0,d.filterOutUploadedChanges)(e.changesToUpload,t.uploadedItemIds)}),y=(e,t)=>({...e,changesToUpload:e.changesToUpload.map(d.markChangeAsReadyForNextSync)});function f(e){if(e.changesToUpload.find(e=>"KWSettingsManagerApp"===e.kwType))return e;let t=(0,u.createUploadChange)({itemId:"SETTINGS_userId",kwType:"KWSettingsManagerApp",action:"EDIT"});return{...e,changesToUpload:[...e.changesToUpload,t]}}function E(e,t){let{updates:r,deletions:a,changeHistories:n}=t,i=r.reduce((e,t)=>{let{kwType:r}=t,a=o.DATAMODELOBJECT_TYPE_TO_CARBON_STORE_KEY[r];return a?{...e,[a]:b(e[a]||[],t)}:e},e),s=r.map(u.createUploadChangeForItem),c=Object.keys(a).reduce((e,t)=>L(e,a[t],t),i),l=Object.keys(a).reduce((e,t)=>e.concat(a[t].map((0,u.createUploadChangeForDeletion)(t))),[]),d=R(e.changeHistories.filter(e=>!a.KWAuthentifiant.includes(e.ObjectId)),n),p=[...s,...l,...n.map(u.createUploadChangeForItem)],S=N(e.changesToUpload,p);return{...c,changesToUpload:S,changeHistories:d}}function A(e,t){let{changeHistory:r,kwType:a,id:o}=t,n=L(e,[o],a),i=(0,u.createUploadChangeForDeletion)(a)(o),s=r?[(0,u.createUploadChangeForItem)(r)]:[],c=s.length?[i,...s]:i,l=r?b(e.changeHistories,r):e.changeHistories,d=N(n.changesToUpload,c);return{...n,changesToUpload:d,changeHistories:l}}function h(e,t){let{kwType:r,items:a}=t,o=L(e,a.map(({id:e})=>e),r),n=(0,u.createUploadChangeForDeletion)(r),i=a.reduce((e,{id:t,changeHistory:r})=>{let a=n(t);if(e.changesToUpload.push(a),r){let t=(0,u.createUploadChangeForItem)(r);e.changesToUpload.push(t),e.changeHistories=b(e.changeHistories,r)}return e},{changesToUpload:[],changeHistories:o.changeHistories}),s=N(o.changesToUpload,i.changesToUpload);return{...o,changesToUpload:s,changeHistories:i.changeHistories}}function _(e,{paymentCard:t}){return{...e,changesToUpload:N(e.changesToUpload,(0,u.createUploadChangeForItem)(t)),paymentCards:b(e.paymentCards,t)}}function T(e,{dataType:t,dataModelObject:r,changeHistory:a},o){let n=(0,c.associateTeamSpaceId)(r,o.spaces,e.credentials),i=a?{changeHistories:b(e.changeHistories,a)}:{},s=a?[(0,u.createUploadChangeForItem)(a)]:[],l=[(0,u.createUploadChangeForItem)(r),...s];return{...e,changesToUpload:N(e.changesToUpload,l),[t]:b(e[t],n),...i}}function v(e,{dataType:t,dataModelObjects:r,changeHistory:a},o){let n=r.map(t=>(0,c.associateTeamSpaceId)(t,o.spaces,e.credentials)),i=[...r.map(u.createUploadChangeForItem),...a.map(u.createUploadChangeForItem)];return{...e,changesToUpload:N(e.changesToUpload,i),[t]:R(e[t],n),changeHistories:R(e.changeHistories,a)}}function I(e,{generatedPassword:t},r){let a=(0,c.associateTeamSpaceId)(t,r.spaces,e.credentials);return{...e,changesToUpload:N(e.changesToUpload,(0,u.createUploadChangeForItem)(t)),generatedPasswords:b(e.generatedPasswords,a)}}function D(e,{transactions:t,backupTimeSec:r}){return Object.keys(e).reduce((a,o)=>(Array.isArray(e[o])&&(a[o]=function(e,t,r){let a=e.filter(e=>t.includes(e.Id)).map(e=>Object.assign(e,{LastBackupTime:r}));return e.filter(e=>!t.includes(e.Id)).concat(a)}(e[o],t,r)),a),e)}function P(e,t){let{credentials:r}=e,a=b(r,t);return{...e,credentials:a}}function O(e,t){let{changes:{updates:r,deletions:a}}=t,n=o.DataModelType.KWSecurityBreach,i=L(e,a,n),s=r.map(u.createUploadChangeForItem),c=a.map((0,u.createUploadChangeForDeletion)(n)),l=N(i.changesToUpload,[...s,...c]),d=R(i.securityBreaches,r),p=void 0!==t.dataLeaksRefreshDate?t.dataLeaksRefreshDate:i.securityBreachesMetadata.latestDataLeaksBreachesUpdate;return{...i,securityBreaches:d,securityBreachesMetadata:{latestPublicBreachesRevision:t.revision,latestDataLeaksBreachesUpdate:p},changesToUpload:l}}function C(e,{changesToUpload:t}){return{...e,changesToUpload:N(e.changesToUpload,t)}}function b(e,t){var r,a;return(r=e,a=t.Id,r.filter(e=>e.Id!==a)).concat(t)}function R(e,t){return[...w(e,t.map(e=>e.Id)),...t]}function N(e,t){let r=(t=Array.isArray(t)?t:[t]).concat(e||[]);return(0,a.uniqBy)((0,a.prop)("itemId"),r)}function w(e,t){return e.filter(e=>!t.includes(e.Id))}function L(e,t,r){if(r&&o.DATAMODELOBJECT_TYPE_TO_CARBON_STORE_KEY[r]){let a=o.DATAMODELOBJECT_TYPE_TO_CARBON_STORE_KEY[r],n=e[a],i=w(e[a],t);return n.length===i.length?e:{...e,[a]:i}}let a=n.PERSONAL_DATA_COLLECTIONS_KEYS.reduce((r,a)=>{if(!(a in e))return r;let o=w(e[a],t);return{...r,[a]:o}},{});return 0===Object.keys(a).length?e:{...e,...a}}t.savePersonalSettings=f,t.teamSpaceContentControlApplied=E,t.deleteVaultModulePersonalDataItem=A,t.deleteVaultModulePersonalDataItemsBulk=h,t.savePaymentCard=_,t.savePersonalDataItem=T,t.savePersonalDataItems=v,t.saveGeneratedPassword=I,t.saveObjects=function(e,t){return(0,a.reduce)((e,t)=>{let r=o.DATAMODELOBJECT_TYPE_TO_CARBON_STORE_KEY[t.kwType];return r&&(e[r]=e[r].concat(t)),e},{...e},t)},t.updateLastBackupTime=D,t.updateCredentials=function(e,t){return t.reduce((e,t)=>P(e,t),e)},t.updateCredential=P,t.breachesUpdated=O,t.saveChangesToUpload=C,t.getLegacyEmptyBreaches=()=>({revision:0,breaches:[]}),t.getEmptyBreachesMetadata=()=>({latestPublicBreachesRevision:0,latestDataLeaksBreachesUpdate:0}),t.countPersonalDataItems=e=>Object.keys(o.DATAMODELOBJECT_TYPE_TO_CARBON_STORE_KEY).reduce((t,r)=>t+e[o.DATAMODELOBJECT_TYPE_TO_CARBON_STORE_KEY[r]].length,0)},4773:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});let a=r(25903),o=r(20648),n=r(48140);t.default=function(e){let t=(0,a.isNil)(e.LocaleFormat)?o.Country.UNIVERSAL:e.LocaleFormat,r=(0,a.isNil)(e.SpaceId)?n.PERSONAL_SPACE_ID:e.SpaceId;return{...e,LocaleFormat:t,SpaceId:r}}},15916:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.fixPasskeyTypesFromTransaction=t.fixBreachTypesFromStore=t.fixBreachTypesFromTransaction=t.fixCommonPropertiesTypes=t.fixGeneratedPasswordsTypes=t.fixCredentialTypesFromStore=t.fixSecretTypesFromStore=t.fixNoteTypesFromStore=t.fixAttachmentProperties=t.fixNoteTypesFromTransaction=t.fixSecretTypesFromTransaction=t.fixAllStringObject=t.fixLinkedServicesTypes=t.fixDomainIconTypes=t.fixTrustedUrlTypes=t.fixCredentialTypesFromTransaction=void 0;let a=r(96066),o=["CreationDatetime","LastBackupTime","UserModificationDatetime"],n=["Id","SpaceId"];function i(e){return(0,a.fixPropertiesTypes)([],[],[],["TrustedUrl","TrustedUrlExpire"],e)}function s(e){let{urls:t,...r}=(0,a.fixPropertiesTypes)([],[],[],["backgroundColor","mainColor"],e),o="object"==typeof t&&null!==t?u(t):{};return{...r,urls:o}}function c(e){let t=Array.isArray(e.associated_domains)?e.associated_domains.map(l):[];return{...e,associated_domains:t}}function l(e){return(0,a.fixPropertiesTypes)([],[],[],["domain","source"],e)}function u(e){let t=Object.keys(e);return(0,a.fixPropertiesTypes)([],[],[],t,e)}function d(e){return(0,a.fixPropertiesTypes)([],["version","localSize","remoteSize","creationDatetime","userModificationDatetime"],[],["id","type","filename","downloadKey","cryptoKey","owner"],e)}t.fixCredentialTypesFromTransaction=function(e){let t=["LastUse","ModificationDatetime","NumberUse","Strength"].concat(o),r=["Alias","Category","ConnectionOptions","Email","Login","Note","OtpSecret","OtpUrl","Password","Port","SID","SecondaryLogin","Server","Title","Url","UserSelectedUrl"].concat(n),{TrustedUrlGroup:l,Attachments:u,LinkedServices:p,domainIcon:S,...g}=(0,a.fixPropertiesTypes)(["AutoLogin","AutoProtected","Checked","SharedObject","SubdomainOnly","UseFixedUrl","limitedPermissions"],t,["Attachments","LinkedServices"],r,e),m=Array.isArray(u)?{Attachments:u.map(d)}:{},y="object"==typeof S&&null!==S?{domainIcon:s(S)}:{},f=p?{LinkedServices:c(p)}:{},E=l&&l.length>0?l.map(i):[];return{...g,...m,...f,...y,TrustedUrlGroup:E}},t.fixTrustedUrlTypes=i,t.fixDomainIconTypes=s,t.fixLinkedServicesTypes=c,t.fixAllStringObject=u,t.fixSecretTypesFromTransaction=function(e){let{Attachments:t,...r}=(0,a.fixPropertiesTypes)([],[],["Attachments"],[],e),o=Array.isArray(t)?{Attachments:t.map(d)}:{};return{...r,...o}},t.fixNoteTypesFromTransaction=function(e){let t=["CreationDate","UpdateDate"].concat(o),r=["Title","Content","Category"].concat(n),{Attachments:i,Type:s,...c}=(0,a.fixPropertiesTypes)(["Secured"],t,["Attachments"],r,e),l=Array.isArray(i)?{Attachments:i.map(d)}:{};return{...c,...l,Type:s||"GRAY"}},t.fixAttachmentProperties=d,t.fixNoteTypesFromStore=function(e){let t={};return["Attachments"].filter(t=>!!e[t]).forEach(r=>{t[r]=JSON.stringify(e[r])}),Object.assign({},e,t)},t.fixSecretTypesFromStore=function(e){let t={};return["Attachments"].filter(t=>!!e[t]).forEach(r=>{t[r]=JSON.stringify(e[r])}),Object.assign({},e,t)},t.fixCredentialTypesFromStore=function(e){let t={};return["Attachments","LinkedServices"].filter(t=>!!e[t]).forEach(r=>{t[r]=JSON.stringify(e[r])}),Object.assign({},e,t)},t.fixGeneratedPasswordsTypes=function(e){let t=["GeneratedDate"].concat(o);return(0,a.fixPropertiesTypes)([],t,[],[],e)},t.fixCommonPropertiesTypes=function(e){return(0,a.fixPropertiesTypes)([],o,[],[],e)},t.fixBreachTypesFromTransaction=function(e){let t=[...o,"ContentRevision"],r=[...n,"BreachId","Status"],i=(0,a.fixPropertiesTypes)([],t,["Content","LeakedPasswords"],r,e);return Array.isArray(i.LeakedPasswords)||(i.LeakedPasswords=[]),i},t.fixBreachTypesFromStore=function(e){let t={};return["Content","LeakedPasswords"].filter(t=>!!e[t]).forEach(r=>{t[r]=JSON.stringify(e[r])}),Array.isArray(e.LeakedPasswords)||(t.LeakedPasswords=JSON.stringify([])),{...e,...t}},t.fixPasskeyTypesFromTransaction=function(e){let t=[...o,"Counter","KeyAlgorithm"],r=[...n,"CredentialId","RpId","RpName","UserDisplayName","UserHandle"];return(0,a.fixPropertiesTypes)([],t,["PrivateKey"],r,e)}},33795:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.fixPersistedPersonalData=t.fixPersonalDataItemFromExternalSource=void 0;let a=r(25903),o=r(20648),n=r(15916),i=r(4773),s=r(26530),c=[{key:"credentials",isData:o.isCredential,fixData:e=>(0,n.fixCredentialTypesFromTransaction)(e),addDefaultValues:e=>(0,i.default)(e)},{key:"notes",isData:o.isNote,fixData:e=>(0,n.fixNoteTypesFromTransaction)(e),addDefaultValues:e=>(0,i.default)(e)},{key:"secrets",isData:o.isSecret,fixData:e=>(0,n.fixSecretTypesFromTransaction)(e),addDefaultValues:e=>(0,i.default)(e)},{key:"generatedPasswords",isData:o.isGeneratedPassword,fixData:e=>(0,n.fixGeneratedPasswordsTypes)(e),addDefaultValues:e=>e},{key:"securityBreaches",isData:s.isBreach,fixData:e=>(0,n.fixBreachTypesFromTransaction)(e),addDefaultValues:e=>e},{key:"passkeys",isData:o.isPasskey,fixData:e=>(0,n.fixPasskeyTypesFromTransaction)(e),addDefaultValues:e=>e}];t.fixPersonalDataItemFromExternalSource=function(e,t){let r=t?{...e,Id:t}:e,a=c.find(e=>e.isData(r));return a?u(a,r):(0,n.fixCommonPropertiesTypes)(r)};let l=["breaches","versionedBreaches"];function u(e,t){return e.addDefaultValues(e.fixData(t))}t.fixPersistedPersonalData=function(e){let t={};c.forEach(r=>{let a=e[r.key];if(!a)return;let o=a.map(e=>u(r,e));t[r.key]=o});let r=(t.credentials??[]).filter(e=>!!e.Id);return{...(0,a.omit)(l,e),...t,credentials:r}}},33170:function(e,t){var r,a;Object.defineProperty(t,"__esModule",{value:!0}),t.editPersonalSettings=t.loadStoredPersonalSettings=t.PersonalSettingsActionType=t.TOGGLE_DASHLANE_ON_SITE=t.TOGGLE_DASHLANE_ON_PAGE=void 0,t.TOGGLE_DASHLANE_ON_PAGE="TOGGLE_DASHLANE_ON_PAGE",t.TOGGLE_DASHLANE_ON_SITE="TOGGLE_DASHLANE_ON_SITE",(a=r=t.PersonalSettingsActionType||(t.PersonalSettingsActionType={})).Edit="EDIT_PERSONAL_SETTINGS",a.EditFromTransaction="EDIT_PERSONAL_SETTINGS_FROM_TRANSACTION",a.LoadFromStorage="LOAD_PERSONAL_SETTINGS_FROM_STORAGE",t.loadStoredPersonalSettings=e=>({type:r.LoadFromStorage,data:Object.assign({},e)}),t.editPersonalSettings=e=>({type:r.Edit,content:Object.assign({},e)})},79937:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.fixPersonalSettingTypes=void 0;let a=r(25903),o=r(96066),n={GeneratorDefaultAvoidAmbiguousChars:"boolean",GeneratorDefaultDigits:"boolean",GeneratorDefaultLetters:"boolean",GeneratorDefaultMixedCase:"boolean",GeneratorDefaultPronounceable:"boolean",GeneratorDefaultSymbols:"boolean",RecoveryOptIn:"boolean",ProtectPasswords:"boolean",ProtectPayments:"boolean",ProtectIDs:"boolean",RichIcons:"boolean",SecuredDataShowScreenshots:"yes-no",SecuredDataShowPassword:"yes-no",SecuredDataShowIDs:"yes-no",SecuredDataShowCreditcard:"yes-no",SecuredDataAutofillCreditcard:"yes-no",SyncBackup:"yes-no",SyncBackupPurchase:"yes-no",SyncBackupPersonaldata:"yes-no",SyncBackupPasswords:"yes-no",SyncBackupCreditCardsNumber:"yes-no",SyncBackupCreditCardsCCV:"yes-no"},i={GeneratorDefaultSize:"number",accountCreationDatetime:"number"},s={SpaceAnonIds:"json",AutofillSettings:"json"},c=(0,a.curry)(o.fixProperties.fromTransaction)(n,i,s),l=(0,a.curry)(o.fixProperties.fromStore)(n,i,s);t.fixPersonalSettingTypes={fromTransaction:c,fromStore:l}},13206:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.getWebsiteInfo=t.getUpdatedPersonalSettings=t.getEmptyPersonalSettings=t.makeBasePersonalSettings=void 0;let a=r(25903),o=r(12857),n=r(33170),i=r(79937),s=r(93748);function c(){return{AccountRecoveryKey:null,AccountRecoveryKeyId:null,DisabledDomainsList:[],DisabledUrlsList:[],DisabledDomainsAutologinList:[],DisabledUrlsAutologinList:[],SyncBackupCreditCardsCCV:null,SyncBackupCreditCardsNumber:null,SyncBackupPasswords:null,SyncBackupPersonaldata:null,SyncBackupPurchase:null,SecuredDataAutofillCreditcard:!0,SecuredDataShowCreditcard:!0,SecuredDataShowIDs:!0,SecuredDataShowPassword:!1,SecuredDataShowScreenshots:!0,ProtectPasswords:!1,ProtectPayments:!0,RichIcons:!0,ProtectIDs:!1,CryptoUserPayload:null,...(0,t.makeBasePersonalSettings)()}}t.makeBasePersonalSettings=()=>({RealLogin:null,SecurityEmail:null,accountCreationDatetime:null,Format:null,Language:null,AnonymousUserId:null,UsagelogToken:null,SyncBackup:null,AutofillSettings:{isAutofillDisabled:!1,isAutologinDisabled:!1,disabledSourceTypes:[],disabledDomains:[],isFollowUpNotificationEnabled:!0},SecuredDataAutofillCreditcard:!0,SecuredDataShowCreditcard:!0,SecuredDataShowIDs:!0,SecuredDataShowPassword:!1,SecuredDataShowScreenshots:!0,ProtectPasswords:!1,ProtectPayments:!0,ProtectIDs:!1,RichIcons:!0,kwType:"KWSettingsManagerApp",Id:"SETTINGS_userId",LastBackupTime:null}),t.getEmptyPersonalSettings=c,t.default=(e=c(),t)=>{switch(t.type){case n.PersonalSettingsActionType.LoadFromStorage:return(0,a.mergeDeepRight)(e,i.fixPersonalSettingTypes.fromTransaction(t.data));case n.PersonalSettingsActionType.EditFromTransaction:return(0,a.mergeDeepRight)(e,i.fixPersonalSettingTypes.fromTransaction(t.content));case n.PersonalSettingsActionType.Edit:return(0,a.mergeDeepRight)(e,t.content);default:return e}},t.getUpdatedPersonalSettings=function(e,t){let r=c();for(let e of Object.keys(r))t[e]||void 0===t[e]||(t[e]=r[e]);return{...e,...t}},t.getWebsiteInfo=function(e,t){let r=new o.ParsedURL(t).getRootDomain(),n=e.getPersonalSettings(),i=(0,s.spaceDisabledDomainsListSelector)(e.getState());return{disabledAutofillOnDomain:(0,a.contains)(r,n.DisabledDomainsList),disabledAutofillOnPage:(0,a.contains)(t,n.DisabledUrlsList),disabledAutologinOnDomain:(0,a.contains)(r,[...n.DisabledDomainsAutologinList,...i]),disabledAutologinOnPage:(0,a.contains)(t,n.DisabledUrlsAutologinList),disabledFromSpaces:!1}}},44246:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.saveCurrentLocation=t.savePlatformInfo=t.LOAD_ANONYMOUS_APPLICATION_ID=t.SAVE_CURRENT_LOCATION=t.SAVE_PLATFORM_INFO=void 0,t.SAVE_PLATFORM_INFO="SAVE_PLATFORM_INFO",t.SAVE_CURRENT_LOCATION="SAVE_CURRENT_LOCATION",t.LOAD_ANONYMOUS_APPLICATION_ID="LOAD_ANONYMOUS_APPLICATION_ID",t.savePlatformInfo=e=>({type:t.SAVE_PLATFORM_INFO,info:e}),t.saveCurrentLocation=e=>({type:t.SAVE_CURRENT_LOCATION,location:e})},4221:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.getEmptyPlatform=t.defaultPlatformInfo=void 0;let a=r(20648),o=r(44246);t.default=(e=i(),r)=>{switch(r.type){case o.SAVE_PLATFORM_INFO:var n,s;return{...e,info:(n=r.info,s=t.defaultPlatformInfo,{platformName:n.platformName||s.platformName,appVersion:n.appVersion||s.appVersion,browser:n.browser||s.browser,browserVersion:n.browserVersion||s.browserVersion,country:n.country||s.country,os:n.os||s.os,osCountry:n.osCountry||s.osCountry,osVersion:n.osVersion||s.osVersion,lang:n.lang||s.lang,manifestVersion:n.manifestVersion||s.manifestVersion,buildType:n.buildType??a.ApplicationBuildType.PRODUCTION})};case o.SAVE_CURRENT_LOCATION:return{...e,location:r.location};default:return e}};let n={country:null,isEu:!0};function i(){return{info:t.defaultPlatformInfo,location:n}}t.defaultPlatformInfo={platformName:"server_carbon_unknown",appVersion:"unknown_version",browser:"browser_carbon_unknown",browserVersion:"unknown_browser_version",country:"country_carbon_unknown",os:"os_carbon_unknown",osCountry:"os_country_carbon_unknown",osVersion:"unknown_os_version",lang:"lang_carbon_unknown",buildType:a.ApplicationBuildType.PRODUCTION},t.getEmptyPlatform=i},72375:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.resetRecoverySessionData=t.saveRecoverySessionData=t.RESET_RECOVERY_SESSION_DATA=t.SAVE_RECOVERY_SESSION_DATA=void 0,t.SAVE_RECOVERY_SESSION_DATA="SAVE_RECOVERY_SESSION_DATA",t.RESET_RECOVERY_SESSION_DATA="RESET_RECOVERY_SESSION_DATA",t.saveRecoverySessionData=e=>({type:t.SAVE_RECOVERY_SESSION_DATA,data:e}),t.resetRecoverySessionData=()=>({type:t.RESET_RECOVERY_SESSION_DATA})},32176:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.getEmptyRecoveryState=void 0;let a=r(72375);t.getEmptyRecoveryState=()=>({recoveryUki:null,publicKey:null,userServerProtectedSymmetricalKey:null,recoveryServerKeyBase64:null,recoveryInProgress:!1,currentPassword:null,verificationMethod:null}),t.default=(e=(0,t.getEmptyRecoveryState)(),r)=>{switch(r.type){case a.SAVE_RECOVERY_SESSION_DATA:return{...e,...r.data};case a.RESET_RECOVERY_SESSION_DATA:return(0,t.getEmptyRecoveryState)();default:return e}}},85795:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.userSessionReducer=t.userSessionRootReducer=void 0;let a=r(20781),o=r(25903),n=r(94768),i=r(64479),s=r(31935),c=r(87817),l=r(92343),u=r(1876),d=r(69806),p=r(94426),S=r(57836),g=r(30350),m=r(64419),y=r(13206),f=r(51345),E=r(24765),A=r(6117),h=r(2440),_=r(45646),T=r(32370),v=r(57350),I=r(48240),D=r(72524),P=r(32176),O=r(96387),C=r(91042),b=r(39801),R=r(7484),N=r(92830),w=r(93625),L=r(43588),U=r(71825),M=r(15703),F=r(38263),k=r(51810),K=r(80084),B=r(35251),G=r(79643),j=r(33170);t.userSessionRootReducer=(e,t)=>{switch(t.type){case N.CLOSE_SESSION:return;case N.CHANGES_FROM_TRANSACTIONS:return V(e,t);case N.LOCAL_SETTINGS_UPDATED:let r=t.data;return Object.assign({},e,{localSettings:(0,S.default)(e.localSettings,(0,g.loadStoredLocalSettings)(r)),spaceData:(0,A.default)(e.spaceData,(0,_.spacesUpdated)(r.premiumStatus.spaces))});case N.PREMIUM_STATUS_UPDATED:let a=t.premiumStatus;return Object.assign({},e,{localSettings:(0,S.default)(e.localSettings,(0,g.localSettingsPremiumStatusUpdated)(a)),spaceData:(0,A.default)(e.spaceData,(0,_.spacesUpdated)(a.spaces))});default:return e}};let V=(e,t)=>t.actions.reduce((e,t)=>{switch(t.type){case j.PersonalSettingsActionType.EditFromTransaction:return{...e,personalSettings:(0,y.default)(e.personalSettings,t)};case N.REMOVE_PERSONAL_ITEM_FROM_TRANSACTION:return{...e,personalData:(0,m.removePersonalItemFromTransaction)(e.personalData,t)};case N.ADD_PERSONAL_ITEM_FROM_TRANSACTION:return{...e,personalData:(0,m.addPersonalItemFromTransaction)(e.personalData,t)}}return e},e),W=(e,t)=>{switch(t.type){case N.SAVE_GENERATED_PASSWORD:return Object.assign({},e,{personalData:(0,m.reducer)(e.personalData,{...t,type:w.SAVE_GENERATED_PASSWORD},{spaces:e.localSettings.premiumStatus?.spaces??[]})});case N.SAVE_PERSONAL_ITEM:return Object.assign({},e,{personalData:(0,m.reducer)(e.personalData,{...t,type:w.SAVE_PERSONAL_ITEM},{spaces:e.localSettings.premiumStatus?.spaces??[]})});case N.SAVE_PERSONAL_ITEMS:return Object.assign({},e,{personalData:(0,m.reducer)(e.personalData,{...t,type:w.SAVE_PERSONAL_ITEMS},{spaces:e.localSettings.premiumStatus?.spaces??[]})});default:return e}};t.userSessionReducer=(e,r)=>{let g=(0,a.combineReducers)({abTests:n.default,account:s.default,accountContactInfo:O.default,accountCreation:c.default,authTicketInfo:l.default,credentialOTPs:u.credentialOTPs,changeMPData:d.default,directorySync:p.default,iconsCache:h.default,localSettings:S.default,loginDeviceLimitFlow:C.default,notificationsStatus:L.default,paymentsState:i.default,personalData:m.reducer,personalSettings:y.default,sdkAuthentication:U.default,recoveryData:P.default,session:M.default,sharingData:f.default,spaceData:A.default,ssoSettings:v.default,sync:T.default,teamAdminData:E.default,twoFactorAuthenticationEnableFlow:b.twoFactorAuthenticationEnableFlow,twoFactorAuthenticationDisableFlow:R.twoFactorAuthenticationDisableFlow,userActivity:I.default,vaultReport:D.default,vpnData:F.VPNReducers,importPersonalData:k.ImportDataStateReducer,secureFileStorageState:K.SecureFileStorageReducer,credentialsDedupViewState:B.credentialsDedupViewReducer,breachRefreshMetaData:G.breachRefreshMetaDataReducer}),_=(0,o.partialRight)(g,[r]),N=(0,o.partialRight)(W,[r]);return(0,o.pipe)(t.userSessionRootReducer,N,_)(e,r)}},32395:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.loadAnonymousPartnerId=t.loadSdkAuthentication=t.saveStyxKeys=t.saveAppKeys=t.saveDashlaneServerDeltaTimestamp=t.LOAD_ANONYMOUS_PARTNER_ID=t.LOAD_CLIENT_AUTHENTICATION_DATA=t.SAVE_DASHLANE_SERVER_DELTA_TIMESTAMP=t.SAVE_STYX_KEYS=t.SAVE_APP_KEYS=void 0;let a=r(67179);t.SAVE_APP_KEYS="SAVE_APP_KEYS",t.SAVE_STYX_KEYS="SAVE_STYX_KEYS",t.SAVE_DASHLANE_SERVER_DELTA_TIMESTAMP="SAVE_DASHLANE_SERVER_DELTA_TIMESTAMP",t.LOAD_CLIENT_AUTHENTICATION_DATA="LOAD_CLIENT_AUTHENTICATION_DATA",t.LOAD_ANONYMOUS_PARTNER_ID="LOAD_ANONYMOUS_PARTNER_ID",t.saveDashlaneServerDeltaTimestamp=e=>({type:t.SAVE_DASHLANE_SERVER_DELTA_TIMESTAMP,dashlaneServerDeltaTimestamp:Math.round((0,a.getUnixTimestamp)()-e)}),t.saveAppKeys=e=>({type:t.SAVE_APP_KEYS,appKeys:e}),t.saveStyxKeys=e=>({type:t.SAVE_STYX_KEYS,styxKeys:e}),t.loadSdkAuthentication=e=>({type:t.LOAD_CLIENT_AUTHENTICATION_DATA,data:e}),t.loadAnonymousPartnerId=e=>({type:t.LOAD_ANONYMOUS_PARTNER_ID,anonymousPartnerId:e})},71825:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.getEmptySdkAuthentication=void 0;let a=r(32395);function o(){return{anonymousPartnerId:null,appKeys:null,dashlaneServerDeltaTimestamp:null,styxKeys:null}}t.getEmptySdkAuthentication=o,t.default=(e=o(),t)=>{switch(t.type){case a.SAVE_APP_KEYS:return{...e,appKeys:t.appKeys};case a.SAVE_STYX_KEYS:return{...e,styxKeys:t.styxKeys};case a.SAVE_DASHLANE_SERVER_DELTA_TIMESTAMP:return{...e,dashlaneServerDeltaTimestamp:t.dashlaneServerDeltaTimestamp};case a.LOAD_CLIENT_AUTHENTICATION_DATA:return{...e,...t.data};case a.LOAD_ANONYMOUS_PARTNER_ID:return{...e,...t};default:return e}}},62839:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.secureFileStartCipheringAction=t.secureFileUploadErrorAction=t.secureFileUploadChunkAction=t.secureFileUploadClearAction=t.secureFileUploadDoneAction=t.secureFileStartUploadAction=t.secureFileClearAction=t.SECURE_FILE_START_CIPHERING=t.SECURE_FILE_UPLOAD_CHUNK=t.SECURE_FILE_UPLOAD_ERROR=t.SECURE_FILE_UPLOAD_CLEAR=t.SECURE_FILE_UPLOAD_DONE=t.SECURE_FILE_START_UPLOAD=t.SECURE_FILE_CLEAR=void 0,t.SECURE_FILE_CLEAR="SECURE_FILE_CLEAR",t.SECURE_FILE_START_UPLOAD="SECURE_FILE_START_UPLOAD",t.SECURE_FILE_UPLOAD_DONE="SECURE_FILE_UPLOAD_DONE",t.SECURE_FILE_UPLOAD_CLEAR="SECURE_FILE_UPLOAD_CLEAR",t.SECURE_FILE_UPLOAD_ERROR="SECURE_FILE_UPLOAD_ERROR",t.SECURE_FILE_UPLOAD_CHUNK="SECURE_FILE_UPLOAD_CHUNK",t.SECURE_FILE_START_CIPHERING="SECURE_FILE_START_CIPHERING",t.secureFileClearAction=e=>({type:t.SECURE_FILE_CLEAR,downloadKey:e}),t.secureFileStartUploadAction=e=>({type:t.SECURE_FILE_START_UPLOAD,contentLength:e}),t.secureFileUploadDoneAction=()=>({type:t.SECURE_FILE_UPLOAD_DONE}),t.secureFileUploadClearAction=()=>({type:t.SECURE_FILE_UPLOAD_CLEAR}),t.secureFileUploadChunkAction=e=>({type:t.SECURE_FILE_UPLOAD_CHUNK,bytesSent:e}),t.secureFileUploadErrorAction=()=>({type:t.SECURE_FILE_UPLOAD_ERROR}),t.secureFileStartCipheringAction=()=>({type:t.SECURE_FILE_START_CIPHERING})},76769:function(e,t,r){var a=this&&this.__createBinding||(Object.create?function(e,t,r,a){void 0===a&&(a=r);var o=Object.getOwnPropertyDescriptor(t,r);(!o||("get"in o?!t.__esModule:o.writable||o.configurable))&&(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,a,o)}:function(e,t,r,a){void 0===a&&(a=r),e[a]=t[r]}),o=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||a(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),o(r(14741),t),o(r(62839),t)},80084:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.getEmptySecureFileStorageState=t.SecureFileStorageReducer=void 0;let a=r(20648),o=r(76769),n=r(62839),i={upload:{status:a.FileUploadStatus.None,bytesSent:0,contentLength:0}};t.SecureFileStorageReducer=(e=i,t)=>{switch(t.type){case o.SECURE_FILE_CLEAR:return{...e,upload:i.upload};case n.SECURE_FILE_START_UPLOAD:return{...e,upload:{...e.upload,status:a.FileUploadStatus.Initial,contentLength:t.contentLength,bytesSent:0}};case n.SECURE_FILE_UPLOAD_CHUNK:{let r=e.upload;if(0===r.contentLength)return e;let o=r.bytesSent+t.bytesSent;return{...e,upload:{...e.upload,status:a.FileUploadStatus.Uploading,bytesSent:o<r.contentLength?o:r.bytesSent}}}case n.SECURE_FILE_START_CIPHERING:return{...e,upload:{...e.upload,status:a.FileUploadStatus.Ciphering}};case n.SECURE_FILE_UPLOAD_ERROR:return{...e,upload:{...e.upload,status:a.FileUploadStatus.Error}};case n.SECURE_FILE_UPLOAD_DONE:if(0===e.upload.contentLength)return e;return{...e,upload:{bytesSent:0,contentLength:0,status:a.FileUploadStatus.Done}};case o.SECURE_FILE_UPLOAD_CLEAR:return{...e,upload:{bytesSent:0,contentLength:0,status:a.FileUploadStatus.None}};default:return e}},t.getEmptySecureFileStorageState=()=>i},14741:function(e,t){Object.defineProperty(t,"__esModule",{value:!0})},49789:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.updateIsFirstSessionAfterAccountCreation=t.updateisUsingBackupCode=t.updateisUsingDashlaneAuthenticator=t.updateSessionDidOpen=t.pairingSucceeded=t.updatePublicUserId=t.updateDeviceAnalyticsId=t.updateUserAnalyticsId=t.updateAnalyticsIds=t.loadAnalyticsIds=t.updateRemoteKey=t.updateIsLocalKeyMigrationRequired=t.updateLocalKey=t.updateSettingsForMPValidation=t.updateCryptoKwc3FixedSalt=t.updateLastMasterPasswordCheck=t.updateMasterPassword=t.updateServerKey=t.loadSessionKeys=t.updateKeyPair=t.shouldRememberMeForSSOUpdated=t.rememberMasterPasswordUpdated=t.UPDATE_IS_FIRST_SESSION_AFTER_ACCOUNT_CREATION=t.UPDATE_IS_USING_BACKUP_CODE=t.UPDATE_IS_USING_AUTHENTICATOR=t.UPDATE_SESSION_DID_OPEN=t.PAIRING_SUCCEEDED=t.LOAD_ANALYTICS_IDS=t.UPDATE_PUBLIC_USER_ID=t.UPDATE_DEVICE_ANALYTICS_ID=t.UPDATE_USER_ANALYTICS_ID=t.UPDATE_ANALYTICS_IDS=t.UPDATE_IS_LOCAL_KEY_MIGRATION_REQUIRED=t.UPDATE_REMOTE_KEY=t.UPDATE_LOCAL_KEY=t.UPDATE_SETTINGS_FOR_MP_VALIDATION=t.USE_NEW_AUTH_API=t.LOAD_SESSION_KEYS=t.UPDATE_CRYPTO_KWC3_FIXED_SALT=t.UPDATE_LAST_MASTER_PASSWORD_CHECK=t.UPDATE_SERVER_KEY=t.UPDATE_MASTER_PASSWORD=t.UPDATE_KEY_PAIR=t.REMEMBER_ME_FOR_SSO_UPDATED=t.REMEMBER_MASTER_PASSWORD_UPDATED=void 0,t.REMEMBER_MASTER_PASSWORD_UPDATED="REMEMBER_MASTER_PASSWORD_UPDATED",t.REMEMBER_ME_FOR_SSO_UPDATED="REMEMBER_ME_FOR_SSO_UPDATED",t.UPDATE_KEY_PAIR="UPDATE_KEY_PAIR",t.UPDATE_MASTER_PASSWORD="UPDATE_MASTER_PASSWORD",t.UPDATE_SERVER_KEY="UPDATE_SERVER_KEY",t.UPDATE_LAST_MASTER_PASSWORD_CHECK="UPDATE_LAST_MASTER_PASSWORD_CHECK",t.UPDATE_CRYPTO_KWC3_FIXED_SALT="UPDATE_CRYPTO_KWC3_FIXED_SALT",t.LOAD_SESSION_KEYS="LOAD_SESSION_KEYS",t.USE_NEW_AUTH_API="USE_NEW_AUTH_API",t.UPDATE_SETTINGS_FOR_MP_VALIDATION="UPDATE_SETTINGS_FOR_MP_VALIDATION",t.UPDATE_LOCAL_KEY="UPDATE_LOCAL_KEY",t.UPDATE_REMOTE_KEY="UPDATE_REMOTE_KEY",t.UPDATE_IS_LOCAL_KEY_MIGRATION_REQUIRED="UPDATE_IS_LOCAL_KEY_MIGRATION_REQUIRED",t.UPDATE_ANALYTICS_IDS="UPDATE_ANALYTICS_IDS",t.UPDATE_USER_ANALYTICS_ID="UPDATE_USER_ANALYTICS_ID",t.UPDATE_DEVICE_ANALYTICS_ID="UPDATE_DEVICE_ANALYTICS_ID",t.UPDATE_PUBLIC_USER_ID="UPDATE_PUBLIC_USER_ID",t.LOAD_ANALYTICS_IDS="LOAD_ANALYTICS_IDS",t.PAIRING_SUCCEEDED="PAIRING_SUCCEEDED",t.UPDATE_SESSION_DID_OPEN="UPDATE_SESSION_DID_OPEN",t.UPDATE_IS_USING_AUTHENTICATOR="UPDATE_IS_USING_AUTHENTICATOR",t.UPDATE_IS_USING_BACKUP_CODE="UPDATE_IS_USING_BACKUP_CODE",t.UPDATE_IS_FIRST_SESSION_AFTER_ACCOUNT_CREATION="UPDATE_IS_FIRST_SESSION_AFTER_ACCOUNT_CREATION",t.rememberMasterPasswordUpdated=e=>({type:t.REMEMBER_MASTER_PASSWORD_UPDATED,rememberMasterPassword:e}),t.shouldRememberMeForSSOUpdated=e=>({type:t.REMEMBER_ME_FOR_SSO_UPDATED,shouldRememberMeForSSO:e}),t.updateKeyPair=e=>({type:t.UPDATE_KEY_PAIR,keyPair:e}),t.loadSessionKeys=e=>({type:t.LOAD_SESSION_KEYS,sessionKeys:e}),t.updateServerKey=e=>({type:t.UPDATE_SERVER_KEY,serverKey:e||""}),t.updateMasterPassword=e=>({type:t.UPDATE_MASTER_PASSWORD,masterPassword:e}),t.updateLastMasterPasswordCheck=()=>({type:t.UPDATE_LAST_MASTER_PASSWORD_CHECK}),t.updateCryptoKwc3FixedSalt=e=>({type:t.UPDATE_CRYPTO_KWC3_FIXED_SALT,cryptoKwc3FixedSalt:e}),t.updateSettingsForMPValidation=e=>({type:t.UPDATE_SETTINGS_FOR_MP_VALIDATION,settings:e}),t.updateLocalKey=e=>({type:t.UPDATE_LOCAL_KEY,localKey:e}),t.updateIsLocalKeyMigrationRequired=e=>({type:t.UPDATE_IS_LOCAL_KEY_MIGRATION_REQUIRED,isLocalKeyMigrationRequired:e}),t.updateRemoteKey=e=>({type:t.UPDATE_REMOTE_KEY,remoteKey:e}),t.loadAnalyticsIds=e=>({type:t.LOAD_ANALYTICS_IDS,userAnalyticsId:e.userAnalyticsId,deviceAnalyticsId:e.deviceAnalyticsId}),t.updateAnalyticsIds=(e,r)=>({type:t.UPDATE_ANALYTICS_IDS,userAnalyticsId:e,deviceAnalyticsId:r}),t.updateUserAnalyticsId=e=>({type:t.UPDATE_USER_ANALYTICS_ID,userAnalyticsId:e}),t.updateDeviceAnalyticsId=e=>({type:t.UPDATE_DEVICE_ANALYTICS_ID,deviceAnalyticsId:e}),t.updatePublicUserId=e=>({type:t.UPDATE_PUBLIC_USER_ID,publicUserId:e}),t.pairingSucceeded=e=>({type:t.PAIRING_SUCCEEDED,pairingId:e}),t.updateSessionDidOpen=e=>({type:t.UPDATE_SESSION_DID_OPEN,didOpen:e}),t.updateisUsingDashlaneAuthenticator=e=>({type:t.UPDATE_IS_USING_AUTHENTICATOR,withAuthenticator:e}),t.updateisUsingBackupCode=e=>({type:t.UPDATE_IS_USING_BACKUP_CODE,withBackupCode:e}),t.updateIsFirstSessionAfterAccountCreation=()=>({type:t.UPDATE_IS_FIRST_SESSION_AFTER_ACCOUNT_CREATION})},15703:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});let a=r(98233),o=r(92830),n=r(49789),i=r(30029);function s(){return{sessionId:null,rememberMasterPassword:null,shouldRememberMeForSSO:null,masterPassword:null,remoteKey:null,localKey:null,lastMasterPasswordCheck:0,serverKey:"",keyPair:null,cryptoKwc3FixedSalt:null,sessionKeys:null,settingsForMPValidation:null,isLocalKeyMigrationRequired:!1,analyticsIds:{userAnalyticsId:"",deviceAnalyticsId:""},publicUserId:"",pairingId:null,didOpen:!1,isUsingDashlaneAuthenticator:!1,isUsingBackupCode:!1,isFirstSessionAfterAccountCreation:!1}}t.default=(e=s(),t)=>{switch(t.type){case o.OPEN_SESSION:return{...e,sessionId:(0,a.default)()};case n.UPDATE_KEY_PAIR:return{...e,keyPair:t.keyPair};case n.REMEMBER_MASTER_PASSWORD_UPDATED:return{...e,rememberMasterPassword:t.rememberMasterPassword};case n.REMEMBER_ME_FOR_SSO_UPDATED:return{...e,shouldRememberMeForSSO:t.shouldRememberMeForSSO};case n.UPDATE_MASTER_PASSWORD:return{...e,masterPassword:t.masterPassword??null};case n.LOAD_SESSION_KEYS:return{...e,sessionKeys:t.sessionKeys};case n.UPDATE_SERVER_KEY:return{...e,serverKey:t.serverKey};case n.UPDATE_LAST_MASTER_PASSWORD_CHECK:return{...e,lastMasterPasswordCheck:Date.now()};case n.UPDATE_CRYPTO_KWC3_FIXED_SALT:return{...e,cryptoKwc3FixedSalt:t.cryptoKwc3FixedSalt};case i.CONFIRM_USER_AUTHENTICATION:return{...e,settingsForMPValidation:null};case n.UPDATE_SETTINGS_FOR_MP_VALIDATION:return{...e,settingsForMPValidation:t.settings};case n.UPDATE_LOCAL_KEY:if(e.localKey!==t.localKey)return{...e,localKey:t.localKey};return e;case n.UPDATE_REMOTE_KEY:if(e.remoteKey!==t.remoteKey)return{...e,remoteKey:t.remoteKey};return e;case n.UPDATE_IS_LOCAL_KEY_MIGRATION_REQUIRED:return{...e,isLocalKeyMigrationRequired:t.isLocalKeyMigrationRequired};case n.LOAD_ANALYTICS_IDS:case n.UPDATE_ANALYTICS_IDS:return{...e,analyticsIds:{userAnalyticsId:t.userAnalyticsId,deviceAnalyticsId:t.deviceAnalyticsId}};case n.UPDATE_USER_ANALYTICS_ID:return{...e,analyticsIds:{...e.analyticsIds,userAnalyticsId:t.userAnalyticsId}};case n.UPDATE_DEVICE_ANALYTICS_ID:return{...e,analyticsIds:{...e.analyticsIds,deviceAnalyticsId:t.deviceAnalyticsId}};case n.UPDATE_PUBLIC_USER_ID:return{...e,publicUserId:t.publicUserId};case n.PAIRING_SUCCEEDED:return{...e,pairingId:t.pairingId};case n.UPDATE_SESSION_DID_OPEN:return{...e,didOpen:t.didOpen};case n.UPDATE_IS_USING_AUTHENTICATOR:return{...e,isUsingDashlaneAuthenticator:t.withAuthenticator};case n.UPDATE_IS_USING_BACKUP_CODE:return{...e,isUsingBackupCode:t.withBackupCode};case n.UPDATE_IS_FIRST_SESSION_AFTER_ACCOUNT_CREATION:return{...e,isFirstSessionAfterAccountCreation:!0};default:return e}}},73614:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.userGroupsUpdated=t.sharingDataUpdated=t.USER_GROUPS_UPDATED=t.SHARING_DATA_ITEMS_UPDATED=void 0,t.SHARING_DATA_ITEMS_UPDATED="SHARING_DATA_ITEMS_UPDATED",t.USER_GROUPS_UPDATED="USER_GROUPS_UPDATED",t.sharingDataUpdated=e=>({type:t.SHARING_DATA_ITEMS_UPDATED,sharingData:e}),t.userGroupsUpdated=e=>({type:t.USER_GROUPS_UPDATED,userGroups:e})},51345:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.getEmptyState=void 0;let a=r(73614);function o(){return{items:[],itemGroups:[],userGroups:[]}}t.default=(e=o(),t)=>{switch(t.type){case a.SHARING_DATA_ITEMS_UPDATED:let{sharingData:r}=t;return{...r};case a.USER_GROUPS_UPDATED:let{userGroups:n}=t;return{...e,userGroups:n};default:return e}},t.getEmptyState=o},45646:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.spaceDataUpdated=t.spacesUpdated=t.SPACE_DATA_UPDATED=t.SPACES_UPDATED=void 0,t.SPACES_UPDATED="SPACES_UPDATED",t.SPACE_DATA_UPDATED="SPACE_DATA_UPDATED",t.spacesUpdated=e=>({type:t.SPACES_UPDATED,spaces:e}),t.spaceDataUpdated=e=>({type:t.SPACE_DATA_UPDATED,spaceData:e})},6117:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.getEmptySpaceDataState=void 0;let a=r(45646);function o(){return{spaces:[]}}t.default=(e=o(),t)=>{switch(t.type){case a.SPACES_UPDATED:return{...e,spaces:(t.spaces||[]).map(e=>({teamId:e.teamId,details:e}))};case a.SPACE_DATA_UPDATED:return{...t.spaceData};default:return e}},t.getEmptySpaceDataState=o},76380:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.resetSSOSettings=t.storeSSOSettings=void 0;let a=r(57350);t.storeSSOSettings=e=>({type:a.SET_SSO_SETTINGS,data:e}),t.resetSSOSettings=()=>({type:a.SET_SSO_SETTINGS,data:(0,a.getEmptySSOSettings)()})},57350:function(e,t){function r(){return{ssoUser:!1,serviceProviderUrl:"",ssoServiceProviderKey:"",migration:void 0,ssoToken:""}}Object.defineProperty(t,"__esModule",{value:!0}),t.getEmptySSOSettings=t.SET_SSO_SETTINGS=void 0,t.SET_SSO_SETTINGS="SET_SSO_SETTINGS",t.default=(e=r(),a)=>a.type===t.SET_SSO_SETTINGS?Object.assign({},e,{...a.data}):e,t.getEmptySSOSettings=r},30111:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.syncFailure=t.syncSuccess=t.syncStarted=t.SYNC_FAILURE=t.SYNC_SUCCESS=t.SYNC_STARTED=void 0,t.SYNC_STARTED="SYNC_STARTED",t.SYNC_SUCCESS="SYNC_SUCCESS",t.SYNC_FAILURE="SYNC_FAILURE",t.syncStarted=()=>({type:t.SYNC_STARTED,isInProgress:!0,startTime:Date.now()}),t.syncSuccess=e=>({type:t.SYNC_SUCCESS,isInProgress:!1,isUploadEnabled:e}),t.syncFailure=()=>({type:t.SYNC_FAILURE,isInProgress:!1})},32370:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.getEmptySyncState=void 0;let a=r(20648),o=r(30111);function n(){return{isUploadEnabled:!1,syncIntervalTimeMs:3e5,status:a.SyncStatuses.READY}}t.getEmptySyncState=n,t.default=(e=n(),t)=>{switch(t.type){case o.SYNC_STARTED:return{...e,startTime:t.startTime,status:a.SyncStatuses.IN_PROGRESS};case o.SYNC_FAILURE:return{...e,status:a.SyncStatuses.FAILURE};case o.SYNC_SUCCESS:return{...e,status:a.SyncStatuses.SUCCESS,isUploadEnabled:t.isUploadEnabled};default:return e}}},63743:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.specialItemGroupUpdated=t.userGroupAdminItemCreated=t.teamAdminDataUpdated=t.userGroupsDeleted=t.userGroupsCreated=t.userGroupsUpdated=t.SPECIAL_ITEM_GROUP_UPDATED=t.GROUP_ADMIN_ITEM_CREATED=t.TEAM_ADMIN_DATA_UPDATED=t.TEAM_ADMIN_USER_GROUPS_DELETED=t.TEAM_ADMIN_USER_GROUPS_CREATED=t.TEAM_ADMIN_USER_GROUPS_UPDATED=void 0,t.TEAM_ADMIN_USER_GROUPS_UPDATED="TEAM_ADMIN_USER_GROUPS_UPDATED",t.TEAM_ADMIN_USER_GROUPS_CREATED="TEAM_ADMIN_USER_GROUPS_CREATED",t.TEAM_ADMIN_USER_GROUPS_DELETED="TEAM_ADMIN_USER_GROUPS_DELETED",t.TEAM_ADMIN_DATA_UPDATED="TEAM_ADMIN_DATA_UPDATED",t.GROUP_ADMIN_ITEM_CREATED="GROUP_ADMIN_ITEM_CREATED",t.SPECIAL_ITEM_GROUP_UPDATED="SPECIAL_ITEM_GROUP_UPDATED",t.userGroupsUpdated=(e,r)=>({type:t.TEAM_ADMIN_USER_GROUPS_UPDATED,teamId:e,userGroups:r}),t.userGroupsCreated=(e,r)=>({type:t.TEAM_ADMIN_USER_GROUPS_CREATED,teamId:e,userGroups:r}),t.userGroupsDeleted=(e,r)=>({type:t.TEAM_ADMIN_USER_GROUPS_DELETED,teamId:e,userGroups:r}),t.teamAdminDataUpdated=e=>({type:t.TEAM_ADMIN_DATA_UPDATED,teamAdminData:e}),t.userGroupAdminItemCreated=(e,r)=>({type:t.GROUP_ADMIN_ITEM_CREATED,teamId:e,userGroupAdminItem:r}),t.specialItemGroupUpdated=(e,r)=>({type:t.SPECIAL_ITEM_GROUP_UPDATED,teamId:e,specialItemGroup:r})},24765:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.getEmptyState=void 0;let a=r(63743);function o(e,t){let r={};return Object.keys(e).forEach(t=>{r[t]=e[t]}),Object.keys(t).forEach(e=>{r[e]=Object.assign({},r[e],t[e])}),r}function n(){return{teams:{}}}t.default=(e=n(),t)=>{switch(t.type){case a.TEAM_ADMIN_DATA_UPDATED:let{teamAdminData:r}=t;return{teams:o(e.teams,r.teams)};case a.TEAM_ADMIN_USER_GROUPS_UPDATED:return{teams:o(e.teams,{[t.teamId]:{teamId:t.teamId,userGroups:t.userGroups}})};case a.TEAM_ADMIN_USER_GROUPS_CREATED:let i=e.teams[t.teamId]?e.teams[t.teamId].userGroups:[];return{teams:o(e.teams,{[t.teamId]:{teamId:t.teamId,userGroups:i.concat(t.userGroups)}})};case a.TEAM_ADMIN_USER_GROUPS_DELETED:let s=t.userGroups.map(e=>e.groupId),c=e.teams[t.teamId]?e.teams[t.teamId].userGroups:[];return{teams:o(e.teams,{[t.teamId]:{teamId:t.teamId,userGroups:c.filter(e=>!s.includes(e.groupId))}})};case a.GROUP_ADMIN_ITEM_CREATED:var l,u;let d=(l=e.teams)[u=t.teamId]&&l[u].userGroupAdminItems||[];return{teams:o(e.teams,{[t.teamId]:{teamId:t.teamId,userGroupAdminItems:d.concat([t.userGroupAdminItem])}})};case a.SPECIAL_ITEM_GROUP_UPDATED:return{teams:o(e.teams,{[t.teamId]:{teamId:t.teamId,specialItemGroup:t.specialItemGroup}})};default:return e}},t.getEmptyState=n},92126:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.userActivityLastSentAtUpdated=void 0;let a=r(80519);t.userActivityLastSentAtUpdated=e=>({type:a.LAST_SENT_AT_UPDATED,lastSentAt:e})},48240:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.getEmptyUserActivityState=void 0;let a=r(80519);function o(){return{lastSentAt:void 0}}t.default=(e=o(),t)=>t.type===a.LAST_SENT_AT_UPDATED?{...e,lastSentAt:t.lastSentAt}:e,t.getEmptyUserActivityState=o},80519:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.LAST_SENT_AT_UPDATED=void 0,t.LAST_SENT_AT_UPDATED="LAST_SENT_AT_UPDATED"},84495:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.vaultReportLastSentAtUpdated=void 0;let a=r(30646);t.vaultReportLastSentAtUpdated=e=>({type:a.LAST_SENT_AT_UPDATED,lastSentAt:e})},72524:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.getEmptyVaultReportState=void 0;let a=r(30646);function o(){return{lastSentAt:void 0}}t.default=(e=o(),t)=>t.type===a.LAST_SENT_AT_UPDATED?{...e,lastSentAt:t.lastSentAt}:e,t.getEmptyVaultReportState=o},30646:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.LAST_SENT_AT_UPDATED=void 0,t.LAST_SENT_AT_UPDATED="LAST_SENT_AT_UPDATED"},4183:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.bootstrap=void 0;let a=r(21667);t.bootstrap=e=>{e.register(a.config)}},34698:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.forceSyncHandler=void 0;let a=r(83533);async function o({sessionService:e}){await e.getInstance().user.attemptSync(a.Trigger.Manual)}t.forceSyncHandler=o},50743:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.refreshSubscriptionInformationHandler=void 0;let a=r(33161),o=async e=>(0,a.refreshSubscriptionInformation)(e.storeService,e.storeService.getAccountInfo().login);t.refreshSubscriptionInformationHandler=o},75653:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.setCredentialSearchOrderHandler=void 0;let a=r(30350);t.setCredentialSearchOrderHandler=(e,t)=>(e.storeService.dispatch((0,a.credentialSearchOrderUpdated)(t.order)),e.sessionService.getInstance().user.persistLocalSettings(),Promise.resolve())},29341:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.updateAccountRecoveryKeyPersonalSettingsHandler=void 0;let a=r(33170);t.updateAccountRecoveryKeyPersonalSettingsHandler=(e,t)=>(e.storeService.dispatch((0,a.editPersonalSettings)(t)),Promise.resolve())},23640:function(e,t,r){var a=this&&this.__createBinding||(Object.create?function(e,t,r,a){void 0===a&&(a=r);var o=Object.getOwnPropertyDescriptor(t,r);(!o||("get"in o?!t.__esModule:o.writable||o.configurable))&&(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,a,o)}:function(e,t,r,a){void 0===a&&(a=r),e[a]=t[r]}),o=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||a(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),t.bootstrap=t.setupSubscriptions=void 0,o(r(4455),t);var n=r(29194);Object.defineProperty(t,"setupSubscriptions",{enumerable:!0,get:function(){return n.setupSubscriptions}});var i=r(4183);Object.defineProperty(t,"bootstrap",{enumerable:!0,get:function(){return i.bootstrap}})},42196:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.sessionInfo$=t.getServiceProviderUrl$=t.emitServiceProviderUrl=t.webOnboardingMode$=t.subscriptionInformation$=t.premiumStatus$=t.syncInProgress$=t.syncInfo$=t.didOpen$=void 0;let a=r(95121),o=r(15237),n=r(93748);t.didOpen$=()=>(0,a.pipe)((0,o.map)(n.didOpenSelector),(0,o.distinctUntilChanged)()),t.syncInfo$=()=>(0,a.pipe)((0,o.map)(n.syncSelector),(0,o.distinctUntilChanged)()),t.syncInProgress$=()=>(0,a.pipe)((0,o.map)(n.syncIsInProgressSelector),(0,o.distinctUntilChanged)()),t.premiumStatus$=()=>(0,a.pipe)((0,o.map)(n.premiumStatusSelector),(0,o.distinctUntilChanged)()),t.subscriptionInformation$=()=>(0,a.pipe)((0,o.map)(n.subscriptionInformationSelector),(0,o.distinctUntilChanged)()),t.webOnboardingMode$=()=>(0,a.pipe)((0,o.map)(n.webOnboardingModeSelector),(0,o.distinctUntilChanged)());let i=new a.Subject;t.emitServiceProviderUrl=e=>i.next(e),t.getServiceProviderUrl$=()=>i,t.sessionInfo$=()=>(0,a.pipe)((0,o.map)(n.sessionInfoSelector),(0,o.distinctUntilChanged)())},83705:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.updatePremiumChurningDismissDateHandler=t.SendTokenStatus=void 0;var a=r(77116);Object.defineProperty(t,"SendTokenStatus",{enumerable:!0,get:function(){return a.SendTokenStatus}});let o=r(30350);t.updatePremiumChurningDismissDateHandler=e=>{let t=new Date;return e.storeService.dispatch((0,o.premiumChurningDismissDateUpdated)(t.getTime())),e.sessionService.getInstance().user.persistLocalSettings(),Promise.resolve()}},49087:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.resetProtectedItemAutofillTimerHandler=t.validateMasterPasswordHandler=t.validateMasterPassword=t.validateToken=t.convertTokenToAuthTicket=t.dashlaneAuthenticatorGetAuthTicket=t.handlePerformValidationError=t.SendTokenStatus=void 0;let a=r(20648),o=r(28323);var n=r(77116);Object.defineProperty(t,"SendTokenStatus",{enumerable:!0,get:function(){return n.SendTokenStatus}});let i=r(91783),s=r(95516),c=r(49789),l=r(56994),u=(e,t)=>({success:!1,error:{code:e,message:t}});function d(e,t,r){if(!(0,o.isApiErrorOfType)(o.BusinessError,e))return u(a.AuthenticationCode.REGISTER_DEVICE_FAILED);let n=e.code;switch(n){case o.VerificationFailed:if(t)return u(a.AuthenticationCode.OTP_NOT_VALID);if(r)return u(a.AuthenticationCode.DASHLANE_AUTHENTICATOR_PUSH_NOTIFICATION_DENIED);return u(a.AuthenticationCode.TOKEN_NOT_VALID);case o.InvalidOTPBlocked:return u(a.AuthenticationCode.OTP_TOO_MANY_ATTEMPTS);case o.InvalidOTPAlreadyUsed:return u(a.AuthenticationCode.OTP_ALREADY_USED);case o.AccountBlockedContactSupport:return u(a.AuthenticationCode.TOKEN_ACCOUNT_LOCKED);case o.VerificationTimeout:return u(a.AuthenticationCode.TOKEN_EXPIRED);case o.VerificationRequiresRequest:return u(a.AuthenticationCode.TOKEN_TOO_MANY_ATTEMPTS);case o.VerificationMethodDisabled:return u(a.AuthenticationCode.REGISTER_DEVICE_FAILED);case o.InvalidSsoToken:case o.B2bSsoUserNotFound:return u(a.AuthenticationCode.SSO_VERIFICATION_FAILED);case o.UserHasNoActiveAuthenticator:return u(a.AuthenticationCode.NO_ACTIVE_AUTHENTICATOR);case o.FailedToContactAuthenticatorDevice:return u(a.AuthenticationCode.FAILED_TO_CONTACT_AUTHENTICATOR_DEVICE);default:return u(a.AuthenticationCode.BUSINESS_ERROR,`Unexpected business_error: ${n}`)}}t.handlePerformValidationError=d;let p=async(e,t)=>{let{login:r}=e.getAccountInfo();e.dispatch((0,s.resetAuthTicketInfo)());try{let a=await (0,o.performDashlaneAuthenticatorVerification)(e,{login:r,deviceName:t});if((0,o.isApiError)(a))return d(a,!1,!0);let n=a.authTicket;return e.dispatch((0,s.updateAuthTicketInfo)({login:r,authTicket:n,date:Date.now()})),{success:!0,authTicket:n}}catch(e){if(e.getAdditionalInfo()?.response?.status===l.HttpStatusCode.GATEWAY_TIMEOUT)return d(o.verificationTimeoutError,!1,!0);throw e}};t.dashlaneAuthenticatorGetAuthTicket=p;let S=async(e,t)=>{let r,n;let{login:c}=e.getAccountInfo();switch(e.dispatch((0,s.resetAuthTicketInfo)()),t.type){case"emailToken":if(!(0,o.isEmailTokenValid)(t.value))return u(a.AuthenticationCode.TOKEN_NOT_VALID);if(n=await (0,o.performEmailTokenVerification)(e,{login:c,token:t.value}),(0,o.isApiError)(n))return d(n);r=n.authTicket;break;case"extraDeviceToken":if(!(0,o.isExtraDeviceTokenValid)(t.value))return u(a.AuthenticationCode.TOKEN_NOT_VALID);return{success:!0,authTicket:void 0};case"sso":if(!t.value)return u(a.AuthenticationCode.TOKEN_NOT_VALID);if(n=await (0,o.performSsoVerification)(e,{login:c,ssoToken:t.value}),(0,o.isApiError)(n))return d(n);r=n.authTicket;break;case"otp":if(!t.value)return u(a.AuthenticationCode.TOKEN_NOT_VALID);if(n=await (0,o.performTotpVerification)(e,{login:c,otp:t.value}),(0,o.isApiError)(n))return d(n,!0);r=n.authTicket;break;default:(0,i.assertUnreachable)(t)}return e.dispatch((0,s.updateAuthTicketInfo)({login:c,authTicket:r,date:Date.now()})),{success:!0,authTicket:r}};t.convertTokenToAuthTicket=S;let g=async(e,r)=>{let{storeService:a}=e;return(0,t.convertTokenToAuthTicket)(a,r)};t.validateToken=g;let m=async(e,t,r)=>{let a=t.getInstance().isKey(e.getUserSession().serverKey,r);return a&&e.dispatch((0,c.updateLastMasterPasswordCheck)()),a};t.validateMasterPassword=m;let y=async(e,r)=>{let{storeService:a,masterPasswordEncryptorService:o}=e;return await (0,t.validateMasterPassword)(a,o,r)};t.validateMasterPasswordHandler=y,t.resetProtectedItemAutofillTimerHandler=e=>(e.storeService.dispatch((0,c.updateLastMasterPasswordCheck)()),Promise.resolve())},7108:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.recoveryIsOtpSelector=t.recoveryInProgressSelector=t.recoveryDataSelector=t.recoveryUkiSelector=void 0,t.recoveryUkiSelector=e=>e.userSession.recoveryData.recoveryUki,t.recoveryDataSelector=e=>e.userSession.recoveryData,t.recoveryInProgressSelector=e=>e.userSession.recoveryData.recoveryInProgress,t.recoveryIsOtpSelector=e=>["totp","duo_push","u2f"].includes(e.userSession.recoveryData.verificationMethod[0]?.type??"")},93748:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.userCryptoSettingsSelector=t.sessionInfoSelector=t.sessionEncryptorKeysSelector=t.getCredentialSearchOrderSelector=t.analyticsInstallationIdSelector=t.isPaymentFailureChurningDismissedSelector=t.lastMasterPasswordCheckSelector=t.didOpenSelector=t.publicUserIdSelector=t.analyticsIdsSelector=t.applicationBuildTypeSelector=t.platformNameSelector=t.appVersionSelector=t.isAuthenticatedSelector=t.richIconsSettingSelector=t.protectPasswordsSettingSelector=t.personalSettingsSelector=t.authTicketInfoSelector=t.sharingKeysSelector=t.recoveryKeySelector=t.accountRecoveryOptInSelector=t.userCryptoFixedSalt=t.userDefaultCryptoSelector=t.isLocalKeyMigrationRequiredSelector=t.remoteKeySelector=t.isRemoteKeyActivatedSelector=t.serverKeySelector=t.spaceDisabledDomainsListSelector=t.localKeySelector=t.isLocalKeyActivatedSelector=t.webOnboardingModeSelector=t.masterPasswordValidationDataSelector=t.spacesSelector=t.userLoginSelector=t.masterPasswordSelector=t.masterPasswordAndServerKeySelector=t.userIdSelector=t.activeSpacesSelector=t.subscriptionInformationSelector=t.nodePremiumStatusSelector=t.premiumStatusSelector=t.syncIsInProgressSelector=t.syncSelector=void 0;let a=r(49548),o=r(20648),n=r(29509),i=r(15535),s=r(48169),c=e=>Date.now()-e>864e5;t.syncSelector=e=>e.userSession.sync,t.syncIsInProgressSelector=e=>e.userSession.sync.status===o.SyncStatuses.IN_PROGRESS,t.premiumStatusSelector=e=>e.userSession.localSettings.premiumStatus,t.nodePremiumStatusSelector=e=>e.userSession.localSettings.nodePremiumStatus,t.subscriptionInformationSelector=e=>e.userSession.localSettings.subscriptionInformation,t.activeSpacesSelector=e=>{let r=(0,t.premiumStatusSelector)(e);return(r&&r.spaces||[]).filter(e=>"accepted"===e.status)},t.userIdSelector=e=>e.userSession.account.login,t.masterPasswordAndServerKeySelector=e=>{let{userSession:t}=e,{masterPassword:r,serverKey:a}=t.session;return{password:r,serverKey:a}},t.masterPasswordSelector=e=>e.userSession.session.masterPassword,t.userLoginSelector=e=>e.userSession.account.login,t.spacesSelector=e=>e.userSession.spaceData.spaces,t.masterPasswordValidationDataSelector=e=>e.userSession.session.settingsForMPValidation,t.webOnboardingModeSelector=e=>e.userSession.localSettings.webOnboardingMode,t.isLocalKeyActivatedSelector=e=>!!e.userSession.session.localKey,t.localKeySelector=e=>e.userSession.session.localKey,t.spaceDisabledDomainsListSelector=(0,a.createSelector)(t.spacesSelector,e=>e.reduce((e,t)=>{let r=[];return t&&t.details&&t.details.info&&t.details.info.autologinDomainDisabledArray&&(r=t.details.info.autologinDomainDisabledArray),[...e,...r]},[])),t.serverKeySelector=e=>e.userSession.session.serverKey,t.isRemoteKeyActivatedSelector=e=>!!e.userSession.session.remoteKey,t.remoteKeySelector=e=>e.userSession.session.remoteKey,t.isLocalKeyMigrationRequiredSelector=e=>e.userSession.session.isLocalKeyMigrationRequired,t.userDefaultCryptoSelector=e=>e.userSession.personalSettings.CryptoUserPayload,t.userCryptoFixedSalt=e=>e.userSession.personalSettings.CryptoFixedSalt,t.accountRecoveryOptInSelector=e=>e.userSession.personalSettings.RecoveryOptIn||!1,t.recoveryKeySelector=e=>e.userSession.personalSettings.RecoveryKey,t.sharingKeysSelector=e=>e.userSession.session.keyPair,t.authTicketInfoSelector=e=>e.userSession.authTicketInfo,t.personalSettingsSelector=e=>e.userSession.personalSettings,t.protectPasswordsSettingSelector=e=>{let{ProtectPasswords:t}=e.userSession.personalSettings;return t},t.richIconsSettingSelector=e=>{let t=e.userSession.spaceData.spaces.find(e=>"accepted"===e.details.status);if(t&&!t.details?.info?.richIconsEnabled)return!1;let{RichIcons:r}=e.userSession.personalSettings;return r},t.isAuthenticatedSelector=e=>e.userSession.account.isAuthenticated,t.appVersionSelector=e=>(0,n.platformInfoSelector)(e).appVersion,t.platformNameSelector=e=>(0,n.platformInfoSelector)(e).platformName,t.applicationBuildTypeSelector=e=>(0,n.platformInfoSelector)(e).buildType,t.analyticsIdsSelector=e=>e.userSession.session.analyticsIds,t.publicUserIdSelector=e=>e.userSession.session.publicUserId,t.didOpenSelector=e=>e.userSession.session.didOpen,t.lastMasterPasswordCheckSelector=e=>e.userSession.session.lastMasterPasswordCheck,t.isPaymentFailureChurningDismissedSelector=e=>c(e.userSession.localSettings.premiumChurningDismissDate),t.analyticsInstallationIdSelector=(0,a.createSelector)(t.userLoginSelector,t.isAuthenticatedSelector,t.applicationBuildTypeSelector,(e,t,r)=>{let a=e&&(0,s.isInternalTestUser)(e)&&t;return r===o.ApplicationBuildType.DEV||r===o.ApplicationBuildType.QA||a?(0,i.getCommonAppSetting)("installationId"):null}),t.getCredentialSearchOrderSelector=e=>e.userSession.localSettings.credentialSearchOrder??o.CredentialSearchOrder.NAME,t.sessionEncryptorKeysSelector=e=>({masterPassword:(0,t.masterPasswordSelector)(e),serverKey:(0,t.serverKeySelector)(e),localKey:(0,t.localKeySelector)(e),remoteKey:(0,t.remoteKeySelector)(e)}),t.sessionInfoSelector=e=>({password:(0,t.masterPasswordSelector)(e),serverKey:(0,t.serverKeySelector)(e),localKey:(0,t.localKeySelector)(e),cryptoUserPayload:(0,t.userDefaultCryptoSelector)(e),cryptoFixedSalt:(0,t.userCryptoFixedSalt)(e),devicesKeys:(0,n.deviceKeysSelector)(e)}),t.userCryptoSettingsSelector=e=>({cryptoUserPayload:e.userSession.personalSettings.CryptoUserPayload,cryptoFixedSalt:e.userSession.personalSettings.CryptoFixedSalt})},64833:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.sessionStartTimeSelector=t.sessionIdSelector=void 0,t.sessionIdSelector=e=>e.userSession.session.sessionId,t.sessionStartTimeSelector=e=>e.userSession.account.sessionStartTime},59565:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.isSSOUserSelector=t.ssoProviderInfoSelector=t.ssoMigrationInfoSelector=t.serviceProviderUrlSelector=t.ssoSettingsSelector=void 0;let a=r(81453),o=r(49548);t.ssoSettingsSelector=e=>e.userSession.ssoSettings,t.serviceProviderUrlSelector=e=>(0,t.ssoSettingsSelector)(e).serviceProviderUrl,t.ssoMigrationInfoSelector=(0,o.createSelector)(t.ssoSettingsSelector,({migration:e,serviceProviderUrl:t,ssoToken:r})=>({migration:r?a.AuthenticationFlowContracts.SSOMigrationType.MP_TO_SSO_WITH_INFO:e,serviceProviderUrl:t})),t.ssoProviderInfoSelector=(0,o.createSelector)(t.ssoSettingsSelector,({serviceProviderUrl:e,isNitroProvider:t})=>({serviceProviderUrl:e,isNitroProvider:t})),t.isSSOUserSelector=e=>e.userSession.ssoSettings.ssoUser},29194:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.setupSubscriptions=void 0;let a=r(27698),o=r(33161),n=r(93748),i=r(29509),s=r(17062),c=r(96053),l=r(82189),u=r(20648),d=r(4544),p=r(28009);t.setupSubscriptions=function(e,t){let{storeService:r,wsService:S,sessionService:g}=t;e.coreServicesReady.on(async e=>{if(e.initMode===p.InitMode.Resume&&(t.sessionService.tryRestoreInstance(),g.isSessionStarted())){console.log("[background/carbon] Loading non non-resumable data from storage");let{user:e}=t.sessionService.getInstance();await e.loadNonResumableSessionData(),console.log("[background/carbon] Done loading non non-resumable data from storage")}}),e.carbonSessionOpened.on(()=>{r.dispatch((0,d.resetLoginStepInfo)());let e=r.getState(),t=(0,n.premiumStatusSelector)(e);1!==(0,c.getUserMessagesByTypeSelector)(e,u.UserMessageTypes.TRIAL_EXPIRED).length||(0,s.isTrialExpired)({premiumStatus:t})||(r.dispatch((0,l.userMessagesDismissed)((0,s.createTrialExpiredUserMessage)())),g.getInstance().user.persistLocalSettings())}),e.sessionClosed.on(e=>{(0,a.triggerLoginStatusChanged)({loggedIn:!1,login:e.login})}),e.familyMemberLeft.on(async()=>{let e=(0,n.userLoginSelector)(r.getState()),t=(0,i.ukiSelector)(r.getState());await (0,o.refreshPremiumStatus)(r,S,e,t)})}},4455:function(e,t){var r,a,o;Object.defineProperty(t,"__esModule",{value:!0}),t.B2CStatusCode=t.CancelDashlaneAuthenticatorRegistration=t.PersistData=t.SessionResumingCode=t.extractExtraDeviceToken=t.makeExtraDeviceToken=t.extractOTP=t.makeSsoToken=t.makeOTP=t.extractEmailToken=t.makeEmailToken=t.remoteSupportedAuthenticationMethod=t.localSupportedAuthenticationMethod=void 0,t.localSupportedAuthenticationMethod=["totp","duo_push"],t.remoteSupportedAuthenticationMethod=["email_token","totp","duo_push","dashlane_authenticator","u2f"],t.makeEmailToken=e=>({type:"emailToken",value:e}),t.extractEmailToken=e=>e.value,t.makeOTP=e=>({type:"otp",value:e}),t.makeSsoToken=e=>({type:"sso",value:e}),t.extractOTP=e=>e.value,t.makeExtraDeviceToken=e=>({type:"extraDeviceToken",value:e}),t.extractExtraDeviceToken=e=>e.value,(t.SessionResumingCode||(t.SessionResumingCode={})).INVALID_LOGIN_IN_STORE="invalid_login_in_store",(r=t.PersistData||(t.PersistData={}))[r.PERSIST_DATA_YES=0]="PERSIST_DATA_YES",r[r.PERSIST_DATA_NO=1]="PERSIST_DATA_NO",(a=t.CancelDashlaneAuthenticatorRegistration||(t.CancelDashlaneAuthenticatorRegistration={})).CANCELLED="cancelled",a.COMPLETED="completed",(o=t.B2CStatusCode||(t.B2CStatusCode={})).Free="free",o.Subscribed="subscribed",o.Legacy="legacy"},12610:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.getCurrentUserInfo=void 0;let a=r(29509);t.getCurrentUserInfo=function(e){let t=e.getUserSession().keyPair;return{login:e.getUserLogin(),uki:(0,a.ukiSelector)(e.getState()),privateKey:t&&t.privateKey}}},32646:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.authorizationMiddleware=void 0,t.authorizationMiddleware=e=>async t=>{let{config:{allowedPlatforms:r},services:{storeService:a}}=await t,{platformName:o}=a.getPlatformInfo();if(r&&!r.includes(o))throw Error("You are not allowed to connect to this slot");return await e(t)}},51864:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.debugMiddleware=t.perfDebugMiddleware=void 0,r(95674),t.perfDebugMiddleware=e=>async t=>e(t),t.debugMiddleware=e=>async t=>{let r=await t;try{console.log(`[background/carbon] Processing CarbonApi request (type:${r.messageType}, name:${r.messageName}, id:${r.requestId})`);let a=await e(t);return console.log(`[background/carbon] Done processing CarbonApi request (type:${r.messageType}, name:${r.messageName}, id:${r.requestId})`),a}catch(e){throw console.error(`[background/carbon] Error while processing CarbonApi request (type:${r.messageType}, name:${r.messageName}, id:${r.requestId})`,e),e}}},66039:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.perfDebugMiddleware=t.debugMiddleware=t.authorizationMiddleware=void 0;var a=r(32646);Object.defineProperty(t,"authorizationMiddleware",{enumerable:!0,get:function(){return a.authorizationMiddleware}});var o=r(51864);Object.defineProperty(t,"debugMiddleware",{enumerable:!0,get:function(){return o.debugMiddleware}}),Object.defineProperty(t,"perfDebugMiddleware",{enumerable:!0,get:function(){return o.perfDebugMiddleware}})},78935:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.CommandQueryBus=void 0;let a=r(95121),o=r(15237),n=r(42387),i=r(47674),s=r(60697),c=r(66039);class l{constructor(e){this.services=(0,i.getCoreServices)(e)}register(e){let{commands:t,queries:r,liveQueries:a}=e;Object.keys(t).forEach(e=>{this._registerCommand(e,t[e])}),Object.keys(r).forEach(e=>{this._registerQuery(e,r[e])}),Object.keys(a).forEach(e=>{this._registerLiveQuery(e,a[e])})}_registerCommand(e,t){let r=r=>Promise.resolve({messageType:"command",messageName:e,requestId:(0,n.v4)(),services:this.services,arg:r,config:t,logTags:[l.API_LOG_TAG,l.COMMAND_LOG_TAG]}),a=[c.debugMiddleware,c.authorizationMiddleware,c.perfDebugMiddleware,()=>e=>e.then(async e=>{let{arg:t,config:r,services:a}=e,{handler:o}=r,n=await o(a,t);return{...e,result:n}})];this.registerCommand(e,e=>(0,s.buildMiddlewarePipeline)(...a)(r(e)).then(e=>e.result))}_registerQuery(e,t){let r=r=>Promise.resolve({messageType:"query",messageName:e,requestId:(0,n.v4)(),services:this.services,arg:r,config:t,logTags:[l.API_LOG_TAG,l.QUERY_LOG_TAG]}),a=[c.debugMiddleware,c.authorizationMiddleware,c.perfDebugMiddleware,()=>e=>e.then(async e=>{let{arg:r,services:a}=e,{selector:o,selectorFactory:n}=t;if(o){let{storeService:t}=a,n=await o(t.getState(),r);return{...e,result:n}}if(n){let{storeService:t}=a,o=await n(this.services),i=await Promise.resolve(o(t.getState(),r));return{...e,result:i}}})];this.registerQuery(e,e=>(0,s.buildMiddlewarePipeline)(...a)(r(e)).then(e=>e.result))}_registerLiveQuery(e,t){this.registerLiveQuery(e,r=>{let{operator:n,subject:i,operatorFactory:s}=t;if(n){let{storeService:t}=this.services;return t.getState$().pipe(n(r),(0,o.skip)(1),(0,o.catchError)(t=>{throw console.error(`[background/carbon] Error while processing CarbonApi liveQuery (name:${e})`,t),t}))}if(!s)return i(r);{let{storeService:t}=this.services,n=t.getState$();return(0,a.from)(s(t.getState(),this.services)).pipe((0,a.switchMap)(e=>n.pipe(e(r),(0,o.skip)(1))),(0,o.catchError)(t=>{throw console.error(`[background/carbon] Error while processing CarbonApi liveQuery (name:${e})`,t),t}))}})}}t.CommandQueryBus=l,l.API_LOG_TAG="API",l.COMMAND_LOG_TAG="Command",l.QUERY_LOG_TAG="Query"},58329:function(e,t,r){var a=this&&this.__createBinding||(Object.create?function(e,t,r,a){void 0===a&&(a=r);var o=Object.getOwnPropertyDescriptor(t,r);(!o||("get"in o?!t.__esModule:o.writable||o.configurable))&&(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,a,o)}:function(e,t,r,a){void 0===a&&(a=r),e[a]=t[r]}),o=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||a(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),o(r(47509),t),o(r(78935),t)},47509:function(e,t){Object.defineProperty(t,"__esModule",{value:!0})},74819:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.EventStore=void 0;let a=r(95121),o=r(42387),n=r(15237),i=r(91783),s=r(75177);t.EventStore=class{constructor(){this._operation$=new a.Subject,this.subs=new Set,this.add=async(e,t)=>{let r=(0,o.v4)(),a=new Promise((e,t)=>{let a=this._operationResults$.subscribe(o=>{o.id===r&&(!0===o.success?e(r):t(o.error),a.unsubscribe(),this.subs.delete(a))});this.subs.add(a)});return this.triggerAdd(e,r,t),a},this.remove=async(e,t)=>{let r=new Promise((e,r)=>{let a=this._operationResults$.subscribe(o=>{o.id===t&&(!0===o.success?e():r(o.error),a.unsubscribe(),this.subs.delete(a))});this.subs.add(a)});return this.triggerRemove(e,t),r},this.removeAll=async e=>{let t=(0,o.v4)(),r=new Promise((e,r)=>{let a=this._operationResults$.subscribe(o=>{o.id===t&&(!0===o.success?e():r(o.error),a.unsubscribe(),this.subs.delete(a))});this.subs.add(a)});return this.triggerRemoveAll(e,t),r},this.onAdd=async e=>{let{id:t,event:r,topic:a,type:o}=e,n={id:t,topic:a,type:o};try{let e=await this.retrieve(),o={...e,[a]:[...e[a]||[],{id:t,event:r}]};return await this.store(o),{...n,success:!0,event:r}}catch(e){return{...n,success:!1,error:e}}},this.onRemove=async e=>{let{id:t,topic:r,type:a}=e,o={id:t,topic:r,type:a};try{let e=await this.retrieve(),a={...e,[r]:(e[r]||[]).filter(e=>e.id!==t)};return await this.store(a),{...o,success:!0}}catch(e){return{...o,success:!1,error:e}}},this.onRemoveAll=async e=>{let{id:t,topic:r,type:a}=e,o={id:t,topic:r,type:a};try{let e={...await this.retrieve(),[r]:[]};return await this.store(e),{...o,success:!0}}catch(e){return{...o,success:!1,error:e}}},this.onOperation=async e=>{switch(e.type){case s.OperationType.Add:return this.onAdd(e);case s.OperationType.Remove:return this.onRemove(e);case s.OperationType.RemoveAll:return this.onRemoveAll(e);default:return(0,i.assertUnreachable)(e)}},this.setupOperationsHandling=()=>{let e=this._operation$.pipe((0,n.concatMap)(this.onOperation),(0,n.share)()),t=e.subscribe();this.subs.add(t),this._operationResults$=e},this.setupOperationsHandling()}newItems$(e){return this._operationResults$.pipe((0,n.filter)(e=>e.type===s.OperationType.Add&&e.success),(0,n.filter)(t=>t.topic===e))}async getItems(e){return(await this.retrieve())[e]}teardown(){this.subs.forEach(e=>e.unsubscribe())}async triggerAdd(e,t,r){let a={event:r,id:t,topic:e,type:s.OperationType.Add};this._operation$.next(a)}async triggerRemove(e,t){let r={id:t,topic:e,type:s.OperationType.Remove};this._operation$.next(r)}async triggerRemoveAll(e,t){let r={id:t,topic:e,type:s.OperationType.RemoveAll};this._operation$.next(r)}}},75177:function(e,t){var r;Object.defineProperty(t,"__esModule",{value:!0}),t.OperationType=void 0,(r=t.OperationType||(t.OperationType={})).Add="add",r.Remove="remove",r.RemoveAll="removeAll"},19661:function(e,t,r){var a=this&&this.__createBinding||(Object.create?function(e,t,r,a){void 0===a&&(a=r);var o=Object.getOwnPropertyDescriptor(t,r);(!o||("get"in o?!t.__esModule:o.writable||o.configurable))&&(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,a,o)}:function(e,t,r,a){void 0===a&&(a=r),e[a]=t[r]}),o=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||a(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),o(r(58329),t)},60697:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.buildMiddlewarePipeline=void 0;var a=r(393);Object.defineProperty(t,"buildMiddlewarePipeline",{enumerable:!0,get:function(){return a.buildMiddlewarePipeline}})},393:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.buildMiddlewarePipeline=void 0,t.buildMiddlewarePipeline=(...e)=>t=>e.reduceRight((e,t)=>t(e),e=>e)(t)},14301:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.config=void 0;let a=r(21815),o=r(34938),n=r(44546);t.config={commands:{convertItemToDashlaneXml:{handler:a.convertItemToDashlaneXmlHandler},convertDashlaneXmlToItem:{handler:o.convertDashlaneXmlToItem},saveSharedItemsToVault:{handler:n.saveSharedItemsToVault}},queries:{},liveQueries:{}}},25567:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.makeItemGroupService=t.SHARING_VERSION=t.DELETE_ITEM_GROUP=t.CREATE_SPECIAL_ITEM_GROUP=void 0;let a=r(61681),o=r(50897),n=r(86527);async function i(e,r,i,s){let c=(0,a.generateItemUuid)(),[l,u]=await Promise.all([e.symmetricEncryption.generateNewAESKey(),function(e,t,r){let a=r&&r.users&&r.users.find(e=>e.userId===t.login),o=a&&a.groupKey;return e.asymmetricEncryption.decrypt(t.privateKey,o)}(e,r,i)]),d=await e.symmetricEncryption.decryptAES256(u,i.privateKey),[p,S,g]=await Promise.all([e.asymmetricEncryption.encrypt(i.publicKey,l),(0,n.generateProposeSignature)(e,l,i.groupId),(0,n.generateAcceptSignature)(e,d,c,l)]),m={type:t.CREATE_SPECIAL_ITEM_GROUP,sharingVersion:t.SHARING_VERSION,groupId:c,teamId:i.teamId,alias:r.login,groups:[{groupId:i.groupId,permission:"admin",groupKey:p,proposeSignature:S,acceptSignature:g}]};return s.length&&(m.items=await (0,o.createItemsForUserGroups)(e,l,s)),m}async function s(e,r){return{type:t.DELETE_ITEM_GROUP,sharingVersion:t.SHARING_VERSION,groupId:e,revision:r}}t.CREATE_SPECIAL_ITEM_GROUP="createUserGroupsItemGroup",t.DELETE_ITEM_GROUP="deleteItemGroup",t.SHARING_VERSION=4,t.makeItemGroupService=function(e,t){return{makeCreateSpecialItemGroupEvent:(e,r,a)=>i(t,e,r,a),createSpecialItemGroup:({login:t,uki:r},a)=>e.itemGroup.createSpecialItemGroup(t,r,a),makeDeleteItemGroupEvent:(e,t)=>s(e,t),deleteItemGroup:({login:t,uki:r},a)=>e.itemGroup.deleteGroup(t,r,a).then(({itemGroups:e})=>e).catch(o=>{if("Conflict"===o.message){var n;return(n=[a.groupId],e.sharing.get(t,r,{type:"getSharing",sharingVersion:4,userGroupIds:n}).then(({itemGroupErrors:e,itemGroups:t})=>{if(e&&e.length)throw Error(e[0].message);return t})).then(o=>{let[{revision:n,teamId:i}]=o;return i?e.itemGroup.deleteGroup(t,r,{...a,revision:n}).then(({itemGroups:e})=>e):o})}throw o})}}},99625:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.makeItemService=t.SHARING_VERSION=t.UPDATE_ITEM=t.ADD_ITEMS=t.REMOVE_ITEMS=void 0;let a=r(67972);async function o(e,t,r){return{itemId:e,itemKey:t,content:r}}async function n(e,r,a){return{type:t.ADD_ITEMS,sharingVersion:t.SHARING_VERSION,revision:r,groupId:e,items:a}}async function i(e,r,o){if(!o)throw Error("Missing payload. See method documentation.");let{item:n,itemId:i,itemContent:s}=o;if(!n&&!(i&&s))throw Error("insufficient arguments: item or (itemId and content) must be provided.");if(n&&(i||s))throw Error("item and (itemId | content) cannot both be provided");let c=(0,a.makeSymmetricEncryption)(),l=s??await c.encryptSharingItem(r,n);return{type:t.UPDATE_ITEM,sharingVersion:t.SHARING_VERSION,itemId:i??n?.Id,content:l,timestamp:e}}t.REMOVE_ITEMS="removeItems",t.ADD_ITEMS="addItems",t.UPDATE_ITEM="updateItem",t.SHARING_VERSION=4;let s=(e,t,r,a)=>e.itemGroup.updateItem(t,r,a);function c(e,t,r,a){return e.itemGroup.addItems(t,r,a)}let l=(e,r,a)=>Promise.resolve({type:t.REMOVE_ITEMS,sharingVersion:t.SHARING_VERSION,groupId:e,revision:r,items:[...a]}),u=(e,t,r,a)=>e.itemGroup.removeItems(t,r,a);t.makeItemService=function(){return{makeItemUpload:o,makeAddItemsEvent:n,addItems:c,makeUpdateItemEvent:i,updateItem:s,makeRemoveItemsEvent:l,removeItems:u}}},62318:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.getRecipientsCount=t.doesUserReceiveItemGroupViaGroup=t.isUserLastAdmin=void 0,t.isUserLastAdmin=function(e,t){let r=(e.users||[]).filter(({permission:e,rsaStatus:t,status:r})=>"admin"===e&&"sharingKeys"===t&&"accepted"===r),a=(e.groups||[]).filter(({permission:e,status:t})=>"admin"===e&&"accepted"===t),o=r.some(e=>e.userId===t),n=r.filter(({userId:e})=>t!==e),i=a.length+n.length>0;return o&&!i},t.doesUserReceiveItemGroupViaGroup=function(e,t,r){let a=t.filter(({users:e})=>(e||[]).some(e=>e.userId===r&&"accepted"===e.status)).map(({groupId:e})=>e);return(e.groups||[]).some(({groupId:e,status:t})=>a.includes(e)&&"accepted"===t)},t.getRecipientsCount=function(e,t){return function(e,t){let{itemGroups:r}=e,a=r.find(e=>(e.items||[]).some(e=>e.itemId===t));return a?(a.users||[]).filter(e=>!["revoked","refused"].includes(e.status)):[]}(e,t).length+function(e,t){let{itemGroups:r}=e,a=r.find(e=>(e.items||[]).some(e=>e.itemId===t));return a?(a.groups||[]).filter(e=>!["revoked","refused"].includes(e.status)):[]}(e,t).length}},12278:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.revokeRemoteControlledSharedItems=void 0;let a=r(95121),o=r(77323),n=r(42598),i=r(80896),s=r(37653),c=r(49705),l=r(86471),u=({deletedItemIds:e,updatedItemIds:t})=>e.length>0||t.length>0,d=async(e,t)=>{let r=await (0,a.firstValueFrom)(t.queries.getInvites());if((0,o.isFailure)(r))throw Error(`Failiure in findMyPendingInvitesToRefuse: ${(0,o.getFailure)(r)}`);let i=(0,c.spacesWithForcedCategorizationEnabledSelector)(e.getState());return(0,o.getSuccess)(r).pendingSharedItems.reduce((e,t)=>{if(t.itemType!==n.ShareableItemType.Credential)return e;let r=i.map(e=>e.details),a=(0,s.pickBestTeamSpaceForForcedCategorizationForSharedItem)(r,t);return a&&a.domainsMatchResult===l.TeamDomainsMatchResult.SomeFieldsMatch&&e.push(t.sharedItemId),e},(0,o.safeCast)([]))};async function p(e,t,r,a){try{let{hiddenItemIds:o}=a,{commands:{remoteControlSharedItems:n}}=t,i=await d(e,r);await n({vaultItemIds:o,pendingInvitesIds:i,shouldRunSync:u(a)})}catch(t){let e=Error(`[SharingRemoteControl] - revokeRemoteControlledSharedItems: ${t}`);(0,i.sendExceptionLog)({error:e})}}t.revokeRemoteControlledSharedItems=p},76417:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.makeUserGroupService=t.checkUsersPublicKey=t.ConvertUserGroupMemberToUserUpdate=t.ConvertUserGroupMemberToUserUpdateWithInvite=t.ConvertUserGroupMemberToUserUpload=t.createUserUploadEvent=t.makeUserGroupAdminItem=t.makeGroupKeyItem=t.decryptGroupKey=t.UPDATE_USER_GROUP_USERS=t.REVOKE_USER_GROUP_USERS=t.INVITE_USER_GROUP_USERS=t.REFUSE_USER_GROUP=t.ACCEPT_USER_GROUP=t.RENAME_USER_GROUP=t.DELETE_USER_GROUP=t.CREATE_TEAM_ADMINS_USER_GROUP=t.CREATE_USER_GROUP=t.SHARING_VERSION=void 0;let a=r(24592),o=r(61681),n=r(93308),i=r(4729),s=r(72331),c=r(86527),l=r(80896);function u(e,t,r,o){return e.asymmetricEncryption.sign(t,a.encode(r+"-accepted-"+o))}function d(e,t,r){if(!(0,n.isBase64Encoded)(r))throw Error("INVALID_GROUP_KEY");return e.asymmetricEncryption.decrypt(t.privateKey,r)}async function p(e,t,r,o,n){let s=(0,i.getAdminDataFromTeamAdminData)(r,o),c=(0,i.getSpecialItemGroupFromAdminData)(s).revision,l=JSON.stringify(n),[u,d]=await Promise.all([e.symmetricEncryption.generateNewAESKey(),(0,i.getSpecialItemGroupKey)(e,t,s)]),[p,S]=await Promise.all([e.symmetricEncryption.encryptAES256(u,a.encode(l)),e.symmetricEncryption.encryptAES256(d,a.encode(u))]);return{itemId:n.itemId,itemKey:S,content:p,itemGroupRevision:c}}async function S(e,t,r,a){return g("createTeamAdminsUserGroup",e,t,r,a)}async function g(e,r,n,i,s){let[c,l]=await Promise.all([r.asymmetricEncryption.generateRsaKeyPair(),r.symmetricEncryption.generateNewAESKey()]),u=(0,o.generateItemUuid)(),d=await r.symmetricEncryption.encryptAES256(l,a.encode(c.privateKey));return{groupId:u,name:i.name,publicKey:c.publicKey,privateKey:d,sharingVersion:t.SHARING_VERSION,teamId:i.teamId,type:e,users:await Promise.all(s.map(e=>A(r,e,n,l,u)))}}async function m(e){return{itemId:(0,o.generateItemUuid)(),groupId:(0,o.generateItemUuid)(),groupKey:await e.symmetricEncryption.generateNewAESKey()}}async function y(e,r,o,n,i){let s=await e.asymmetricEncryption.generateRsaKeyPair(),{teamId:c,externalId:l,name:u}=n;return{groupId:i.groupId,name:u,publicKey:s.publicKey,privateKey:await e.symmetricEncryption.encryptAES256(i.groupKey,a.encode(s.privateKey)),sharingVersion:t.SHARING_VERSION,teamId:c,type:"createUserGroup",users:[],groupKeyItem:await p(e,r,o,c.toString(),i),externalId:l}}async function f(e,r,a,o){let n={type:t.DELETE_USER_GROUP,sharingVersion:t.SHARING_VERSION,groupId:e,revision:r};return a&&o&&(n.groupKeyItem={itemId:a,itemGroupRevision:o}),n}async function E(e,r,a){return{type:t.RENAME_USER_GROUP,sharingVersion:t.SHARING_VERSION,groupId:e,revision:r,name:a}}async function A(e,t,r,a,o){let n=await P(e,t,a);return t.Login===r.login&&(n.acceptSignature=await u(e,r.privateKey,o,a)),n}async function h(e,r,a,o,n,i){let s=n.map(async t=>{try{let o=await A(e,t,r,i,a);return{success:!0,user:o}}catch(t){let e=Error(`[UserGroupService] - makeBaseInviteMembersEvent: ${t}`);return(0,l.sendExceptionLog)({error:e}),{success:!1}}}),c=(await Promise.all(s)).filter(e=>e.success).map(e=>e.user);return{groupId:a,revision:o,sharingVersion:t.SHARING_VERSION,type:t.INVITE_USER_GROUP_USERS,users:c}}async function _(e,r,a){return{type:t.REVOKE_USER_GROUP_USERS,sharingVersion:t.SHARING_VERSION,revision:r,groupId:e,users:a}}async function T(e,r,a){return{type:t.UPDATE_USER_GROUP_USERS,sharingVersion:t.SHARING_VERSION,revision:r,groupId:e,users:await Promise.all(a.map(e=>C(e)))}}async function v(e,r,a,o,n){return{type:t.UPDATE_USER_GROUP_USERS,sharingVersion:t.SHARING_VERSION,revision:o,groupId:r,users:await Promise.all(n.map(t=>O(e,t,a)))}}async function I(e,r,a){let o=a.users.find(e=>e.userId===r.login).groupKey,n=await d(e,r,o),i=await u(e,r.privateKey,a.groupId,n);return{type:t.ACCEPT_USER_GROUP,sharingVersion:4,revision:a.revision,groupId:a.groupId,acceptSignature:i}}async function D(e,t,r){let a=r.users.find(e=>e.userId===t.login),o=await d(e,t,a.groupKey);return(0,c.isProposeSignatureValid)(e,a.proposeSignature,a.userId,o)}async function P(e,t,r){let o=await C(t);if(!t.Login){let n=await (0,c.generateProposeSignature)(e,r,t.Alias);return await (0,c.validateProposeSignature)("[ItemGroupService] - ConvertUserGroupMemberToUserUpload (no login)",e,r,n,a.encode(t.Alias)),{...o,userId:t.Alias,alias:t.Alias,proposeSignatureUsingAlias:!0,proposeSignature:n}}let[n,i]=await Promise.all([e.asymmetricEncryption.encrypt(t.PublicKey,r),(0,c.generateProposeSignature)(e,r,t.Login)]);return await (0,c.validateProposeSignature)("[ItemGroupService] - ConvertUserGroupMemberToUserUpload",e,r,i,a.encode(t.Login)),{...o,alias:t.Alias,groupKey:n,proposeSignatureUsingAlias:!1,proposeSignature:i}}async function O(e,t,r){let o=await C(t),[n,i]=await Promise.all([e.asymmetricEncryption.encrypt(t.PublicKey,r),(0,c.generateProposeSignature)(e,r,t.Login)]);return await (0,c.validateProposeSignature)("[ItemGroupService] - ConvertUserGroupMemberToUserUpdateWithInvite",e,r,i,a.encode(t.Login)),{...o,groupKey:n,proposeSignature:i}}async function C(e){return{permission:e.Permission,userId:e.Login}}function b(e,t,r,a){return e(t,r,{type:"getSharing",sharingVersion:4,userGroupIds:a}).then(({userGroupErrors:e,userGroups:t})=>{if(e&&e.length)throw Error(e[0].message);return t})}function R({teamId:e}){if(!e)throw Error("USER_GROUP_DELETED")}t.SHARING_VERSION=4,t.CREATE_USER_GROUP="createUserGroup",t.CREATE_TEAM_ADMINS_USER_GROUP="createTeamAdminsUserGroup",t.DELETE_USER_GROUP="deleteUserGroup",t.RENAME_USER_GROUP="renameUserGroup",t.ACCEPT_USER_GROUP="acceptUserGroup",t.REFUSE_USER_GROUP="refuseUserGroup",t.INVITE_USER_GROUP_USERS="inviteUserGroupUsers",t.REVOKE_USER_GROUP_USERS="revokeUserGroupUsers",t.UPDATE_USER_GROUP_USERS="updateUserGroupUsers",t.decryptGroupKey=d,t.makeGroupKeyItem=p,t.makeUserGroupAdminItem=m,t.createUserUploadEvent=A,t.ConvertUserGroupMemberToUserUpload=P,t.ConvertUserGroupMemberToUserUpdateWithInvite=O,t.ConvertUserGroupMemberToUserUpdate=C,t.checkUsersPublicKey=e=>{let t=Object.keys(e).filter(t=>!e[t].publicKey);return t.length>0?Promise.reject(Error(JSON.stringify({message:"Users missing public Key: "+t,code:"MISSING_PUBLIC_KEY"}))):Promise.resolve(e)};let N=e=>{let t="ITEM_GROUP_UPDATE_CONFLICT";return"getAdditionalInfo"in e&&e.getAdditionalInfo().webServiceSubMessage===t||e.message.includes(t)},w=e=>{let t="Conflict";return!!("getAdditionalInfo"in e&&e.getAdditionalInfo().message.startsWith(t))||e.message.startsWith(t)};function L(e,t,r,a,o){return e(r,a,o).catch(n=>{if(N(n))return b(t,r,a,[o.groupId]).then(([t])=>{R(t);let{revision:n}=t;return e(r,a,{...o,revision:n})});throw n})}t.makeUserGroupService=function(e,r){return{makeUserGroupAdminItem:()=>m(r),makeCreateUserGroupEvent:(e,t,a,o)=>y(r,e,t,a,o),makeCreateSpecialUserGroupEvent:(e,t,a)=>S(r,e,t,a),createUserGroup:({login:t,uki:r},a,o)=>e.userGroup.create(t,r,o).catch(n=>{if(N(n))return(0,s.loadSpecialItemGroup)(e,t,r,a).then(a=>e.userGroup.create(t,r,{...o,groupKeyItem:{...o.groupKeyItem,itemGroupRevision:a.revision}}));throw n}),makeDeleteUserGroupEvent:(e,t,r,a)=>f(e,t,r,a),deleteUserGroup:({login:t,uki:r},a,o)=>e.userGroup.delete(t,r,o).catch(n=>{if(N(n))return(0,s.loadSpecialItemGroup)(e,t,r,a).then(a=>e.userGroup.delete(t,r,{...o,groupKeyItem:{...o.groupKeyItem,itemGroupRevision:a.revision}}));if(w(n))return b(e.sharing.get,t,r,[o.groupId]).then(a=>{let[{revision:n,teamId:i}]=a;return i?e.userGroup.delete(t,r,{...o,revision:n}):{userGroups:a}});throw n}),makeRenameUserGroupEvent:(e,t,r)=>E(e,t,r),renameUserGroup:({login:t,uki:r},a)=>(function(e,t,r,a){let o=e.userGroup.rename;return o(t,r,a).catch(n=>{if(w(n))return b(e.sharing.get,t,r,[a.groupId]).then(e=>{R(e[0]);let[{name:n,revision:i}]=e;return n===a.name?{userGroups:e}:o(t,r,{...a,revision:i})});throw n})})(e,t,r,a),makeAcceptUserGroupEvent:(e,t)=>I(r,e,t),acceptUserGroup:({login:t,uki:r},a)=>L(e.userGroup.accept,e.sharing.get,t,r,a),makeInviteMembersEventAsAdmin:(e,t,a,o)=>h(r,a,e.groupId,t,o,e.groupKey),inviteUserGroupMembers:({login:t,uki:r},a)=>e.userGroup.invite(t,r,a).catch(o=>{if(w(o))return b(e.sharing.get,t,r,[a.groupId]).then(o=>{R(o[0]);let[{revision:n,users:i}]=o,s=a.users.filter(e=>!i.find(t=>t.userId===e.userId&&"accepted"===t.status));return s.length?e.userGroup.invite(t,r,{...a,revision:n,users:s}):{userGroups:o}});throw o}),makeRevokeMembersEvent:(e,t,r)=>_(e,t,r),revokeUserGroupMembers:({login:t,uki:r},a)=>e.userGroup.revoke(t,r,a).catch(o=>{if(w(o))return b(e.sharing.get,t,r,[a.groupId]).then(o=>{R(o[0]);let[{revision:n,users:i}]=o,s=a.users.filter(e=>i.find(t=>t.userId===e&&"accepted"===t.status));return s.length?e.userGroup.revoke(t,r,{...a,revision:n,users:s}):{userGroups:o}});throw o}),makeUpdateMembersEvent:(e,t,r)=>T(e,t,r),makeUpdateMembersWithInviteEvent:(e,t,a,o)=>v(r,e,t,a,o),updateUserGroupMembers:({login:t,uki:r},a)=>L(e.userGroup.update,e.sharing.get,t,r,a),findExistingUsersByAliases:r=>e.userAlias.findUsersByAliases(r).then(t.checkUsersPublicKey),findUsersByAliases:t=>e.userAlias.findUsersByAliases(t),isCurrentUserProposeSignatureValid:(e,t)=>D(r,e,t)}}},66879:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.makeSharingService=void 0;let a=r(67972),o=r(76417),n=r(25567),i=r(99625);t.makeSharingService=function(e,t){let r=(0,a.makeCryptoService)();return{ws:t,store:e,crypto:r,userGroup:(0,o.makeUserGroupService)(t,r),itemGroup:(0,n.makeItemGroupService)(t,r),item:(0,i.makeItemService)()}}},54732:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.getLimitedSharedItemIds=void 0,t.getLimitedSharedItemIds=(e,t,r,a)=>{let o=new Set(e.userGroups.filter(e=>e.users.some(e=>e.userId===a&&"accepted"===e.status)).map(e=>e.groupId)),n=(r??[]).reduce((e,t)=>({...e,[t.groupId]:t}),{}),i=new Set((t??[]).filter(e=>(e.users??[]).some(e=>e.login===a&&"accepted"===e.status)||(e.userGroups??[]).some(e=>o.has(e.uuid)&&"accepted"===e.status)).map(e=>e.uuid));return e.itemGroups.filter(e=>{let t=e.users?.some(e=>e.userId===a&&"admin"===e.permission&&"accepted"===e.status),r=e.groups?.some(e=>o.has(e.groupId)&&"admin"===e.permission&&"accepted"===e.status),s=n[e.groupId]?.collections?.some(e=>i.has(e.uuid)&&"admin"===e.permission&&"accepted"===e.status);return!(t||r||s)}).map(e=>(e.items||[]).map(e=>e.itemId)).reduce((e,t)=>e.concat(t),[]).reduce((e,t)=>({...e,[t]:!0}),{})}},75021:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.isSharedSelector=void 0;let a=r(53175);t.isSharedSelector=(e,t)=>{let{items:r}=(0,a.sharingDataSelector)(e);return r.some(e=>e.itemId===t)}},90456:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.limitedSharingItemsSelector=void 0;let a=r(49548),o=r(54732),n=r(93748),i=r(53175),s=r(84177);t.limitedSharingItemsSelector=(0,a.createSelector)(i.sharingDataSelector,s.sharedCollectionsSelector,s.sharedCollectionItemsSelector,n.userIdSelector,o.getLimitedSharedItemIds)},84177:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.sharedCollectionItemsSelector=t.sharedCollectionsSelector=void 0,t.sharedCollectionsSelector=e=>e.userSession.sharingData.collections,t.sharedCollectionItemsSelector=e=>e.userSession.sharingData.itemGroups},53175:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.sharingDataSelector=void 0,t.sharingDataSelector=e=>e.userSession.sharingData},86527:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.validateProposeSignature=t.isProposeSignatureValid=t.generateProposeSignature=t.isAcceptSignatureValid=t.generateAcceptSignature=void 0;let a=r(24592),o=r(80896);function n(e,t,r){return new Promise((o,n)=>{e.symmetricEncryption.signHmacSHA256(t,a.encode(r)).then(o,n)})}async function i(e,t,r,a,n){if(!await t.symmetricEncryption.verifyHmacSHA256(r,a,n)){let t=Error(`${e}: INVALID_PROPOSE_CREATION Failed to validate newly created propose signature`);throw(0,o.sendExceptionLog)({error:t}),t}}t.generateAcceptSignature=function(e,t,r,o){return new Promise((n,i)=>{e.asymmetricEncryption.sign(t,a.encode(r+"-accepted-"+o)).then(n,i)})},t.isAcceptSignatureValid=function(e,t,r,a){return new Promise((o,n)=>{e.asymmetricEncryption.verify(r,t,a).then(o,n)})},t.generateProposeSignature=n,t.isProposeSignatureValid=function(e,t,r,a){return n(e,a,r).then(e=>t===e)},t.validateProposeSignature=i},96538:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.getSharingStatusDetail=t.getNotShared=void 0;let a=r(25903),o=r(62318);t.getNotShared=()=>({isShared:!1});let n=(e,t)=>e[t]?"limited":"admin";t.getSharingStatusDetail=(0,a.curry)((e,r,a,i)=>{let{itemGroups:s,userGroups:c}=r,l=s.find(e=>(e.items||[]).map(e=>e.itemId).includes(i));if(!l)return(0,t.getNotShared)();let u=(0,o.getRecipientsCount)(r,i);return{groupSharing:(0,o.doesUserReceiveItemGroupViaGroup)(l,c,a),isShared:!0,lastAdmin:(0,o.isUserLastAdmin)(l,a),permission:n(e,i),recipientsCount:u}})},38947:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.emptySessionResponse=t.updateUserGroupMembers=t.getSharedData=t.computeUserGroupMember=t.extractAliasesFromMembers=t.revokeUserGroupMembers=t.inviteUserGroupMembers=t.renameUserGroup=t.deleteUserGroup=t.deleteItemGroup=t.createSpecialItemGroup=t.createSpecialUserGroup=t.createUserGroup=t.buildSharingData=t.mergeSharingData=t.getCleanSharingData=t.getOutdatedSharingParams=void 0;let a=r(25903),o=r(20648),n=r(80896),i=r(22560),s=r(4729),c=r(4790);function l(e,{groupId:t,revision:r}){if(!e.privateKey)throw Error("PRIVATE_KEY_MISSING");if(!t)throw Error("GROUP_ID_MISSING");if(!r)throw Error("GROUP_REVISION_MISSING")}function u(e,t){return{itemIds:e.items.filter(({id:e,timestamp:r})=>!t.items.find(t=>t.itemId===e&&t.timestamp>=r)).map(e=>e.id),itemGroupIds:e.itemGroups.filter(({id:e,revision:r})=>!t.itemGroups.find(t=>t.groupId===e&&t.revision===r)).map(e=>e.id),userGroupIds:e.userGroups.filter(({id:e,revision:r})=>!t.userGroups.find(t=>t.groupId===e&&t.revision===r)).map(e=>e.id)}}function d(e,t){let{items:r,itemGroups:a,userGroups:o}=e;return{items:t.items.filter(e=>r.find(t=>t.id===e.itemId)),itemGroups:t.itemGroups.filter(e=>a.find(t=>t.id===e.groupId)),userGroups:t.userGroups.filter(e=>o.find(t=>t.id===e.groupId))}}function p(e,t){let r=(e,t,r)=>{let a=t.filter(t=>!e.find(e=>r(e)===r(t)));return e.map(e=>t.find(t=>r(t)===r(e))||e).concat(a)};return{items:r(e.items,t.items,a.prop("itemId")),itemGroups:r(e.itemGroups,t.itemGroups,a.prop("groupId")),userGroups:r(e.userGroups,t.userGroups,a.prop("groupId"))}}async function S(e,t,r,o,n){let i=d(o,n),s=u(o,i),c=a.unnest(a.values(s));return a.compose(a.equals(0),a.length)(c)?i:p(i,await A(e,t,r,s))}t.getOutdatedSharingParams=u,t.getCleanSharingData=d,t.mergeSharingData=p,t.buildSharingData=S;let g=(e,t,r)=>{let a=(0,c.getNodePremiumStatusSpaceData)(r),o=a.spaces.find(t=>Number(t.teamId)===e);if(!o)throw Error("TEAM_NOT_FOUND");if(!(0,c.hasSpecialUserGroupAccessInSpace)(o.teamId,a))throw Error("USER_DOES_NOT_HAVE_SPECIAL_USER_GROUP_ACCESS_FOR_TEAM");if(!t.privateKey)throw Error("PRIVATE_KEY_MISSING")};async function m(e,t,r){try{if(l(t,r),0===r.users.length)throw Error("USERS_NOT_SUPPLIED");let{groupId:a,revision:o,users:n}=r,i=await e.userGroup.makeRevokeMembersEvent(a,o,n),{userGroups:s}=await e.userGroup.revokeUserGroupMembers(t,i);return{userGroups:s}}catch(e){return y("Error while revokeUserGroupMembers",e,r)}}function y(e,t,r){return(0,n.sendExceptionLog)({error:t}),i.Debugger.log(e,t),Promise.resolve({userGroups:[],error:{message:t.message,action:r}})}function f(e){return JSON.stringify(e.map(e=>e.Alias))}function E(e,t){return e.map(e=>{if(!t[e.Alias])throw Error(`User details not found for alias: ${e.Alias}`);return{Alias:e.Alias,Login:t[e.Alias].login,PublicKey:t[e.Alias].publicKey,Permission:e.Permission}})}async function A(e,t,r,a){if(!(a.itemIds||a.itemGroupIds||a.userGroupIds))throw Error("MISSING_PARAMETERS");let o={...a,type:"getSharing",sharingVersion:4},{itemErrors:n,items:i,itemGroupErrors:s,itemGroups:c,userGroupErrors:l,userGroups:u}=await e.sharing.get(t,r,o);if(n&&n.length)throw Error(n[0].message);if(s&&s.length)throw Error(s[0].message);if(l&&l.length)throw Error(l[0].message);return{items:i,itemGroups:c,userGroups:u}}async function h(e,t,r){if(l(t,r),0===r.users.length)throw Error("USERS_NOT_SUPPLIED");let{login:a,uki:o}=t,{groupId:n,revision:i,users:s}=r,c=JSON.stringify(s.map(e=>e.alias)),u=await e.userGroup.findExistingUsersByAliases({login:a,uki:o,aliases:c}),d=s.map(e=>({Alias:e.alias,Login:u[e.alias].login,PublicKey:u[e.alias].publicKey,Permission:e.permission})),p=await e.userGroup.makeUpdateMembersEvent(n,i,d),{userGroups:S}=await e.userGroup.updateUserGroupMembers(t,p);return{userGroups:S}}t.createUserGroup=function(e,t,r,a){return Promise.resolve().then(()=>(g(a.teamId,t,e.store),e.userGroup.makeUserGroupAdminItem().then(o=>Promise.all([e.userGroup.makeCreateUserGroupEvent(t,r,a,o),Promise.resolve(o)])))).then(([o,n])=>e.userGroup.createUserGroup(t,r.teams[a.teamId],o).then(({userGroups:e,itemGroups:t})=>({userGroups:e,userGroupAdminItem:n,itemGroups:t}))).catch(e=>y("Error while creating userGroup ",e,a))},t.createSpecialUserGroup=function(e,t,r,a){let n={teamId:a,name:"_team_admin_user_group"};return Promise.resolve().then(()=>{g(a,t,e.store);let n=r.spaces.find(e=>Number(e.teamId)===a).details.teamAdmins.map(e=>({Alias:e.login,Login:e.login,Permission:"admin",Status:e.login===t.login?o.SpaceStatus.Accepted:o.SpaceStatus.Pending})),i=f(n);return e.userGroup.findExistingUsersByAliases({login:t.login,uki:t.uki,aliases:i}).then(e=>({findUserServiceResponse:e,members:n}))}).then(({findUserServiceResponse:r,members:a})=>{let o=E(a,r);return e.userGroup.makeCreateSpecialUserGroupEvent(t,n,o)}).then(r=>e.userGroup.createUserGroup(t,{teamId:String(a)},r)).then(({userGroups:e})=>e&&e.length&&e[0])},t.createSpecialItemGroup=function(e,t,r,a){return Promise.resolve().then(()=>(g(r.teamId,t,e.store),e.itemGroup.makeCreateSpecialItemGroupEvent(t,r,a))).then(r=>e.itemGroup.createSpecialItemGroup(t,r))},t.deleteItemGroup=function(e,t,{groupId:r,revision:a}){return Promise.resolve().then(()=>(l(t,{groupId:r,revision:a}),e.itemGroup.makeDeleteItemGroupEvent(r,a).then(r=>e.itemGroup.deleteItemGroup(t,r)))).catch(e=>(y("Error while deleting itemGroup ",e,{groupId:r,revision:a}),[]))},t.deleteUserGroup=function(e,t,r,a){let o=(0,s.findTeamForGroup)(r,a.groupId);return Promise.resolve().then(()=>{l(t,a);let{groupId:r,revision:n}=a,i=(o&&o.userGroupAdminItems||[]).find(e=>e.groupId===a.groupId),s=o.specialItemGroup&&o.specialItemGroup.revision;return e.userGroup.makeDeleteUserGroupEvent(r,n,i.itemId,s)}).then(r=>e.userGroup.deleteUserGroup(t,o,r)).catch(e=>y("Error while deleting userGroup ",e,a))},t.renameUserGroup=function(e,t,r){return Promise.resolve().then(()=>{l(t,r);let{groupId:a,revision:o,name:n}=r;return e.userGroup.makeRenameUserGroupEvent(a,o,n).then(r=>e.userGroup.renameUserGroup(t,r))}).catch(e=>y("Error while renaming userGroup ",e,r))},t.inviteUserGroupMembers=function(e,t,r,a,o){return Promise.resolve().then(()=>{if(l(t,a),0===a.users.length)throw Error("USERS_NOT_SUPPLIED");let{login:n,uki:i}=t,c=JSON.stringify(a.users.map(e=>e.alias));return e.userGroup.findUsersByAliases({login:n,uki:i,aliases:c}).then(n=>{let i=a.users.map(e=>{let t={Alias:e.alias,Permission:e.permission},r=n[e.alias];if(!r)return t;let{login:a,publicKey:o}=r;return a&&o?{...t,Login:a,PublicKey:o}:t}),{revision:c}=a,l=(0,s.getUserGroupAdminItem)(r,o.teamId.toString(),o.groupId);if(!l)throw Error("USER_GROUP_ADMIN_ITEM_NOT_AVAILABLE");return e.userGroup.makeInviteMembersEventAsAdmin(l,c,t,i)}).then(r=>e.userGroup.inviteUserGroupMembers(t,r))}).catch(e=>y("Error while inviteUserGroupMembers",Error(`[SharingController] - inviteUserGroupMembers: ${e}`),a)).then(e=>Object.assign({refusedMembers:{}},e))},t.revokeUserGroupMembers=m,t.extractAliasesFromMembers=f,t.computeUserGroupMember=E,t.getSharedData=A,t.updateUserGroupMembers=h,t.emptySessionResponse=function(e){return Promise.reject({error:{message:"SESSION_EMPTY",action:e}})}},95938:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.bootstrap=void 0;let a=r(14301);t.bootstrap=e=>{e.register(a.config)}},34938:function(e,t,r){var a,o;Object.defineProperty(t,"__esModule",{value:!0}),t.convertDashlaneXmlToItem=t.ConvertDashlaneXmlToErrorCode=void 0;let n=r(20648),i=r(56708),s=r(15916);async function c(e,t){let{storeService:r}=e;if(!r.isAuthenticated())return{success:!1,error:{code:a.NOT_AUTHENTICATED}};let{xml:o}=t;if(!o||""===o)return{success:!1,error:{code:a.INVALID_XML}};let{__type__:c,...l}=await (0,i.parseDashlaneXml)(o),u={...l,kwType:l.kwType||c};return(0,n.isCredential)(u)?u=(0,s.fixCredentialTypesFromTransaction)(u):(0,n.isNote)(u)?u=(0,s.fixNoteTypesFromTransaction)(u):(0,n.isSecret)(u)&&(u=(0,s.fixSecretTypesFromTransaction)(u)),{success:!0,item:u}}(o=a=t.ConvertDashlaneXmlToErrorCode||(t.ConvertDashlaneXmlToErrorCode={})).INVALID_XML="INVALID_XML",o.NOT_AUTHENTICATED="NOT_AUTHENTICATED",t.convertDashlaneXmlToItem=c},21815:function(e,t,r){var a,o;Object.defineProperty(t,"__esModule",{value:!0}),t.convertItemToDashlaneXml=t.convertItemToDashlaneXmlHandler=t.ConvertItemToDashlaneXmlErrorCode=void 0;let n=r(56708);async function i(e,t){let{storeService:r}=e,{item:a}=t;return s(r,a)}async function s(e,t){if(!e.isAuthenticated())return{success:!1,error:{code:a.NOT_AUTHENTICATED}};let r=(0,n.getDashlaneXml)(t);return r&&""!==r?{success:!0,xml:r}:{success:!1,error:{code:a.INVALID_XML}}}(o=a=t.ConvertItemToDashlaneXmlErrorCode||(t.ConvertItemToDashlaneXmlErrorCode={})).INVALID_XML="INVALID_XML",o.NOT_AUTHENTICATED="NOT_AUTHENTICATED",t.convertItemToDashlaneXmlHandler=i,t.convertItemToDashlaneXml=s},44546:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.saveSharedItemsToVault=void 0;let a=r(25903),o=r(20648),n=r(29509),i=r(37313),s=r(98770),c=r(24445),l=r(3469),u=r(76760),d=r(18299),p=r(3313),S=r(45657),g=r(92830);function m(e,t,r){let o=(0,a.pick)(e,r);return(0,a.mergeRight)(t,o)}let y=async(e,t)=>{let{items:r}=t,{storeService:a}=e,y=a.getPersonalData(),f=(0,n.platformInfoSelector)(a.getState()),E=(0,i.getInstance)(),A=(0,s.getInstance)(),h=[],_=[],T=[],v=[],I=[];for(let e of r)if((0,o.isCredential)(e)){let t=e.Id?(0,c.findDataModelObject)(e.Id,y.credentials||[]):null,r=t?m(l.sharedFields,t,e):e,o=(0,p.getUpdatedItemChangeHistory)({deviceName:a.getLocalSettings().deviceName,personalData:y,change:(0,S.makeUpdateChange)(r),userLogin:a.getUserLogin(),platformInfo:f});h.push(e.Id),_.push(r),o&&T.push(o)}else if((0,o.isNote)(e)){let t=e.Id?(0,c.findDataModelObject)(e.Id,y.notes||[]):null,r=t?m(d.sharedFields,t,e):e;v.push(r)}else if((0,o.isSecret)(e)){let t=e.Id?(0,c.findDataModelObject)(e.Id,y.secrets||[]):null,r=t?m(u.sharedFields,t,e):e;I.push(r)}if(_.length){let e=A.lockTopic("iconsUpdates");await E.add("iconsUpdates",{credentialIds:h,type:"credentialUpdates"});let t=(0,g.savePersonalDataItems)(_,o.DataModelType.KWAuthentifiant,T);a.dispatch(t),A.releaseTopic("iconsUpdates",e)}if(v.length){let e=(0,g.savePersonalDataItems)(v,o.DataModelType.KWSecureNote,[]);a.dispatch(e)}if(I.length){let e=(0,g.savePersonalDataItems)(I,o.DataModelType.KWSecret,[]);a.dispatch(e)}};t.saveSharedItemsToVault=y},25356:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.bootstrap=t.setupSubscriptions=void 0;let a=r(92901);Object.defineProperty(t,"setupSubscriptions",{enumerable:!0,get:function(){return a.setupSubscriptions}});var o=r(95938);Object.defineProperty(t,"bootstrap",{enumerable:!0,get:function(){return o.bootstrap}})},92901:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.setupSubscriptions=void 0;let a=r(12278);t.setupSubscriptions=function(e,t){let{storeService:r,applicationModulesAccess:o}=t,{sharingInvites:n,sharingRemoteControl:i}=o.createClients();e.teamSpaceContentControlDone.on(e=>{(0,a.revokeRemoteControlledSharedItems)(r,i,n,e)})}},51414:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.convertDeviceKeysToUki=t.convertUkiToDeviceKeys=void 0,t.convertUkiToDeviceKeys=e=>{if(e){let t=e.split("-");if(t.length>0){let[r]=t;return{accessKey:r,secretKey:e}}}return null},t.convertDeviceKeysToUki=e=>`${e.accessKey}-${e.secretKey}`},4790:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.hasSpecialUserGroupAccessInSpace=t.hasTACAccessInCurrentSpace=t.getNodePremiumStatusSpaceData=t.makeSpaceData=t.isGroupManagerInCurrentSpace=t.isTeamAdminInCurrentSpace=t.isBillingAdminInCurrentSpace=t.getCurrentTeamId=t.getCurrentSpaceId=t.getCurrentSpace=void 0;let a=r(29256);function o(e){return{spaces:e}}t.getCurrentSpace=e=>e.spaces.find(e=>"accepted"===e.details.status),t.getCurrentSpaceId=e=>{let r=(0,t.getCurrentSpace)(e);return r?Number(r.teamId):void 0},t.getCurrentTeamId=t.getCurrentSpaceId,t.isBillingAdminInCurrentSpace=e=>{let r=(0,t.getCurrentSpace)(e);return!!r&&r.details.isBillingAdmin},t.isTeamAdminInCurrentSpace=e=>{let r=(0,t.getCurrentSpace)(e);return!!r&&r.details.isTeamAdmin},t.isGroupManagerInCurrentSpace=e=>{let r=(0,t.getCurrentSpace)(e);return!!r&&r.details.isGroupManager},t.makeSpaceData=o,t.getNodePremiumStatusSpaceData=e=>{let t=e.getLocalSettings().nodePremiumStatus?.spaces;return o((0,a.getFreshSpaceData)(t??[]))},t.hasTACAccessInCurrentSpace=e=>{let r=(0,t.getNodePremiumStatusSpaceData)(e),a=(0,t.getCurrentSpace)(r);return!!a&&(a.details.isTeamAdmin||a.details.isBillingAdmin||a.details.isGroupManager)},t.hasSpecialUserGroupAccessInSpace=(e,t)=>{let r=t.spaces.find(t=>t.teamId===e&&"accepted"===t.details.status);return r?.details.isTeamAdmin||r?.details.isGroupManager}},897:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.makeStoreService=void 0;let a=r(60433),o=r(95121),n=r(7598),i=(e,t)=>{if(!t)return console.log("[background/carbon] StoreSession init: no session storage"),{completeRehydration:()=>Promise.resolve(),flush:()=>Promise.resolve()};{let t=()=>{},r=new Promise(e=>{t=()=>{console.log("[background/carbon] StoreSession init: rehydration from session storage done"),e()}});console.log("[background/carbon] StoreSession init: session storage enabled");let o=(0,a.persistStore)(e,null,t);return{completeRehydration:()=>r,flush:()=>o.flush()}}};t.makeStoreService=e=>{let t=e?.sessionStorage,r=e?.store||(0,n.createStore)(t),a=i(r,t),s=()=>r.getState(),c=new o.BehaviorSubject(s());return r.subscribe(()=>c.next(s())),{...a,dispatch:e=>r.dispatch(e),getABTesting:()=>s().device.abtesting,getAccountInfo:()=>s().userSession.account,getAccountCreation:()=>s().userSession.accountCreation,getLocation:()=>s().device.platform.location,getSdkAuthentication:()=>s().userSession.sdkAuthentication,getLocalSettings:()=>s().userSession.localSettings,getPersonalData:()=>s().userSession.personalData,getPersonalSettings:()=>s().userSession.personalSettings,getNotificationStatus:()=>s().userSession.notificationsStatus,getPlatform:()=>s().device.platform,getPlatformInfo:()=>s().device.platform.info,getSharingData:()=>s().userSession.sharingData,getSpaceData:()=>s().userSession.spaceData,getState$:()=>c,getState:()=>s(),getStore:()=>r,getSyncStatus:()=>s().userSession.sync,getTeamAdminData:()=>s().userSession.teamAdminData,getUserLogin:()=>s().userSession.account.login,getUserSession:()=>s().userSession.session,isAuthenticated:()=>!!(s().userSession.session.sessionId&&s().userSession.account.isAuthenticated),hasSessionId:()=>!!s().userSession.session.sessionId}}},74869:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.getGlobalPersistenceReducer=void 0;let a=r(60433),o=r(59231),n=e=>(t,r)=>({...t,...Object.keys(e).reduce((a,o)=>(a[o]=t[o],e[o].forEach(e=>{a[o][e]=r[o][e]}),a),{})}),i=e=>Object.keys(e).map(t=>(0,o.createBlacklistFilter)(t,e[t]));t.getGlobalPersistenceReducer=(e,t,r)=>{if(r){let o={key:"root",stateReconciler:n(t),storage:r,version:1,serialize:!1,deserialize:!1,transforms:i(t)};return(0,a.persistReducer)(o,e)}return e}},7598:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.createStore=t.globalReducer=void 0;let a=r(20781),o=r(7273),n=r(4221),i=r(14132),s=r(70515),c=r(15876),l=r(85795),u=r(20106),d=r(67293),p=r(57112),S=r(3104),g=r(10814),m=r(74869),y=r(98699),f=r(86630),E=(0,a.combineReducers)({platform:n.default,abtesting:i.default,application:s.applicationReducer,remoteFile:p.remoteFileReducer,globalExtensionSettings:S.globalExtensionSettingsReducer,antiPhishing:g.AntiPhishingReducer,eventLogger:y.eventLoggerReducer,killswitch:f.killswitchReducer});t.globalReducer=(e,t)=>{let r=e?e.device:void 0,a=e?e.authentication:void 0,n=e?e.userSession:void 0,i=e?e.inMemoryInterSessionUnsynced:void 0;return{device:E(r,t),authentication:(0,c.authenticationReducer)(a,t),userSession:(0,l.userSessionReducer)(n,t),inMemoryInterSessionUnsynced:(0,o.inMemoryInterSessionUnsyncedSliceReducer)(i,t)}},t.createStore=function(e,r){let o=(0,m.getGlobalPersistenceReducer)(t.globalReducer,{device:d.blacklistedDeviceKeys,userSession:u.blacklistedUserSessionKeys},e);return(0,a.createStore)(o,r)}},50261:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.config=void 0;let a=r(35192),o=r(93490),n=r(56);t.config={commands:{getTeamInfo:{handler:o.getTeamInfo},computePlanPricing:{handler:n.computePlanPricing}},queries:{getIsRecoveryEnabled:{selector:a.isRecoveryEnabledSelector}},liveQueries:{}}},56:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.computePlanPricing=void 0;let a=r(20648),o=r(28323),n=r(39786),i=r(93748);async function s(e,t){let{storeService:r}=e,s=(0,i.userLoginSelector)(r.getState());if(!s)throw Error(a.AuthenticationCode[a.AuthenticationCode.USER_UNAUTHORIZED]);let c=await (0,n.computePlanPricingRequest)(r,s,t.seats);if((0,o.isApiError)(c))return{success:!1,error:{code:a.ComputePlanPricingErrorType.ComputePlanPricingFailed,message:`Compute Plan Pricing failed: ${c.message}`}};let{additionalSeats:l,renewal:u}=c;return"string"==typeof l?{success:!1,error:{code:a.ComputePlanPricingErrorType.ComputePlanPricingFailed,message:`Compute Plan Pricing failed for additional seat: ${l}`}}:"string"==typeof u?{success:!1,error:{code:a.ComputePlanPricingErrorType.ComputePlanPricingFailed,message:`Compute Plan Pricing failed for renewal: ${u}`}}:{success:!0,data:{additionalSeats:l,renewal:u}}}t.computePlanPricing=s},93490:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.getTeamInfo=void 0;let a=r(20648),o=r(28323),n=r(93748);async function i(e){let{storeService:t}=e,r=(0,n.userLoginSelector)(t.getState()),a=await (0,o.teamStatus)(t,r);if((0,o.isApiError)(a))return s(a);let{billing:i,seats:c,info:l,planTier:u,capabilities:d}=a;return{success:!0,data:{billing:i,teamInfo:l,planTier:u,capabilities:d,seats:c}}}t.getTeamInfo=i;let s=e=>e.code===o.NotAdmin?c(a.AuthenticationCode.UNAUTHORIZED,e.message):c(a.AuthenticationCode.UNKNOWN_ERROR,e.message),c=(e,t)=>({success:!1,reason:e,message:t})},19997:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.setTeamSettings=t.makeSettingsController=void 0;let a=r(25903),o=r(12610),n=r(29256);t.makeSettingsController=(e,t)=>({setTeamSettings:r=>c(e,t,(0,o.getCurrentUserInfo)(e),r)});let i=e=>e.replace(/([A-Z])/g,(e,t)=>`_${t.toLowerCase()}`),s=(e,t)=>null!==t?{type:`set_${i(e)}`,value:t}:{type:`unset_${i(e)}`};function c(e,t,{login:r,uki:o},{teamId:i,settings:c}){let l=(0,a.zipWith)(s,(0,a.keys)(c),(0,a.values)(c));return t.settings.setTeamSettings({login:r,uki:o,teamId:i,operations:l}).then(()=>((0,n.updateCurrentSpaceWith)(e,e=>Object.assign({},e,{details:Object.assign({},e.details,{info:Object.assign({},e.details.info,c)})})),{})).catch(e=>({error:e}))}t.setTeamSettings=c},286:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.bootstrap=void 0;let a=r(50261);t.bootstrap=e=>{e.register(a.config)}},82443:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.bootstrap=void 0;var a=r(286);Object.defineProperty(t,"bootstrap",{enumerable:!0,get:function(){return a.bootstrap}})},35192:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.isPersonalSpaceEnabledSelector=t.isRecoveryEnabledSelector=void 0;let a=r(93748);t.isRecoveryEnabledSelector=e=>{let t=(0,a.activeSpacesSelector)(e)[0];return t?.info?.recoveryEnabled??!1},t.isPersonalSpaceEnabledSelector=e=>{let t=(0,a.activeSpacesSelector)(e)[0];return t?.info?.personalSpaceEnabled??!0}},11527:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.config=void 0;let a=r(1972),o=r(56786),n=r(12202),i=r(32927),s=r(11368),c=r(81931),l=r(12631),u=r(70556),d=r(58113),p=r(23683),S=r(42250),g=r(65866),m=r(27730),y=r(90253),f=r(78271),E=r(10934),A=r(67631),h=r(99041),_=r(14500),T=r(61947),v=r(46902),I=r(13116),D=r(31858),P=r(13676),O=r(73316),C=r(60845),b=r(19510),R=r(65220),N=r(58761),w=r(1765),L=r(57251),U=r(51621),M=r(6735);t.config={commands:{completeTeamDomainRegistration:{handler:a.completeTeamDomainRegistration},deactivateTeamDomain:{handler:o.deactivateTeamDomain},getTeamDomains:{handler:i.getTeamDomains},getTeamDevice:{handler:s.getTeamDevice},listTeamDevices:{handler:c.listTeamDevices},deactivateTeamDevice:{handler:l.deactivateTeamDevice},registerTeamDomain:{handler:n.registerTeamDomain},registerTeamDevice:{handler:u.registerTeamDevice},registerTeamDeviceAccount:{handler:f.registerTeamDeviceAccount},getEncryptionServiceConfig:{handler:S.getEncryptionServiceConfig},generateAndSaveEncryptionServiceConfig:{handler:g.generateAndSaveEncryptionServiceConfig},clearSelfHostedESSettings:{handler:m.clearSelfHostedESSettings},getTeamDeviceEncryptedConfig:{handler:y.getTeamDeviceEncryptedConfig},updateTeamDeviceEncryptedConfig:{handler:E.updateTeamDeviceEncryptedConfig},updateTeamSettings:{handler:O.updateTeamSettings},parseMetadataFields:{handler:A.parseMetadataFieldsHandler},persistAdminProvisioningKey:{handler:h.persistAdminProvisioningKey},removeAdminProvisioningKey:{handler:T.removeAdminProvisioningKey},persistMassDeploymentTeamKey:{handler:I.persistMassDeploymentTeamKey},createSSOConnectorConfig:{handler:d.createSSOConnectorConfig},generateSSOConnectorKey:{handler:p.generateSSOConnectorKey},getRecoveryCodesAsTeamCaptain:{handler:P.getRecoveryCodesAsTeamCaptain},getInviteLink:{handler:C.getInviteLink},requestInviteLinkToken:{handler:M.requestInviteLinkToken},getInviteLinkForAdmin:{handler:b.getInviteLinkForAdmin},changeInviteLinkTeamKey:{handler:R.changeInviteLinkTeamKey},createInviteLink:{handler:N.createInviteLink},toggleInviteLink:{handler:w.toggleInviteLink},getLastADSyncDate:{handler:L.getLastADSyncDate},getSpecialUserGroupInviteValuesForMemberInTeam:{handler:U.getSpecialUserGroupInviteValuesForMemberInTeam},getSpecialUserGroupRevision:{handler:U.getSpecialUserGroupRevision}},queries:{getAdminProvisioningKey:{selector:_.adminProvisioningKeySelector},getMassDeploymentTeamKey:{selector:D.massDeploymentTeamKeySelector}},liveQueries:{liveMassDeploymentTeamKey:{operator:v.massDeploymentTeamKey$}}}},37238:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.makeDirectorySyncController=void 0;let a=r(23440),o=r(12610);t.makeDirectorySyncController=e=>{let{storeService:t,wsService:r,sessionService:n,sharingService:i}=e;return{directorySyncForAllTeams:()=>a.directorySyncForAllTeams(t,r,n),keyValidatedByTacAdmin:(e,s)=>(function(e,t,r,n,i,s){let c=t.getTeamAdminData().teams[i],l=(0,o.getCurrentUserInfo)(t);return a.saveDirectorySyncKey(e,t,n,l,c,i,s).then(()=>a.directorySyncForTeam(t,r,n,i)).catch(()=>{})})(i,t,r,n,e,s),keyRejectedByTacAdmin:(e,o)=>a.keyRejectedByTacAdmin(t,r,e,o)}}},30046:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.createTeamDeviceAccount=void 0;let a=r(28323),o=r(93748),n=async(e,t)=>{let{storeService:r}=e,n=r.getState(),i=(0,o.userLoginSelector)(n);if(!i)throw Error(`
            [createTeamDeviceAccount] - Session not opened!
        `);let s=await (0,a.createTeamDeviceAccount)(r,i,t);return(0,a.isApiError)(s)?{success:!1,error:{code:(0,a.getCode)(s.code,a.createTeamDeviceAccountErrors)}}:{success:!0,data:{login:s.login}}};t.createTeamDeviceAccount=n},12631:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.deactivateTeamDevice=void 0;let a=r(28323),o=r(93748);async function n(e,{teamDeviceAccessKey:t}){let{storeService:r}=e,n=r.getState(),i=(0,o.userLoginSelector)(n);if(!i)throw Error(`
            [registerTeamDeviceRequest] - Session not opened!
        `);let s=await (0,a.deactivateTeamDevice)(r,i,{teamDeviceAccessKey:t});return(0,a.isApiError)(s)?{success:!1,error:{code:(0,a.getCode)(s.code,a.deactivateTeamDeviceErrors)}}:{success:!0,data:{}}}t.deactivateTeamDevice=n},11368:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.getTeamDevice=void 0;let a=r(28323),o=r(93748);async function n(e,t){let{storeService:r}=e,{teamDeviceAccessKey:n}=t,i=r.getState(),s=(0,o.userLoginSelector)(i);if(!s)throw Error("[getTeamDevice] - Session not opened!");let c=await (0,a.getTeamDevice)(r,s,{teamDeviceAccessKey:n});return(0,a.isApiError)(c)?{success:!1,error:{code:(0,a.getCode)(c.code,a.getTeamDeviceErrors)}}:{success:!0,data:{teamDevice:c.teamDevice}}}t.getTeamDevice=n},81931:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.listTeamDevices=void 0;let a=r(28323),o=r(93748);async function n(e){let{storeService:t}=e,r=t.getState(),n=(0,o.userLoginSelector)(r);if(!n)throw Error("[listTeamDevices] - Session not opened!");let i=await (0,a.listTeamDevices)(t,n);return(0,a.isApiError)(i)?{success:!1,error:{code:(0,a.getCode)(i.code,a.listTeamDevicesErrors)}}:{success:!0,data:{teamDevices:i.teamDevices}}}t.listTeamDevices=n},70556:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.registerTeamDevice=void 0;let a=r(28323),o=r(93748);async function n(e,t){let{storeService:r}=e,{deviceName:n,platform:i}=t,s=r.getState(),c=(0,o.userLoginSelector)(s);if(!c)throw Error(`
            [registerTeamDeviceRequest] - Session not opened!
        `);let l=await (0,a.registerTeamDevice)(r,c,{platform:i,deviceName:n});return(0,a.isApiError)(l)?{success:!1,error:{code:(0,a.getCode)(l.code,a.registerTeamDeviceErrors)}}:{success:!0,data:{teamUuid:l.teamUuid,deviceAccessKey:l.deviceAccessKey,deviceSecretKey:l.deviceSecretKey}}}t.registerTeamDevice=n},57251:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.getLastADSyncDate=void 0;let a=r(28323),o=r(93748),n=r(82901);async function i(e){let{storeService:t}=e,r=(0,o.userLoginSelector)(t.getState()),i={success:!1,error:{code:a.NotAdmin}};if(!r)return i;try{(0,n.requireAdmin)(t)}catch{return i}let s=await (0,a.lastADSyncDate)(t,r);return(0,a.isApiError)(s)?{success:!1,error:{code:(0,a.getCode)(s.code,a.lastADSyncDateErrors)}}:{success:!0,data:{...s}}}t.getLastADSyncDate=i},23440:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.isDirectorySyncActivated=t.keyRejectedByTacAdmin=t.isSignatureValid=t.buildVerifiedSyncResponseData=t.keyToXMLB64=t.chainOperations=t.batchOperations=t.directorySyncForTeam=t.directorySyncForAllTeams=t.saveDirectorySyncKey=void 0;let a=r(63743),o=r(36566),n=r(94426),i=r(86363),s=r(67972),c=r(22560),l=r(80896),u=r(4729),d=r(61681),p=r(25047),S=r(72331),g=r(29509),m=r(83533),y=r(24592);async function f(e,t,r,o,n,i,s){return c().catch(function(t){if("Bad Request (ITEM_GROUP_UPDATE_CONFLICT)"===t.message)return function(){let{login:t,uki:r}=o;return(0,S.loadSpecialItemGroup)(e.ws,t,r,n).then(p).then(c).then(()=>{})}();throw t});function c(){return l().then(()=>{r.getInstance().user.attemptSync(m.Trigger.SettingsChange)})}async function l(){let t=await g();return e.item.addItems(e.ws,o.login,o.uki,t)}function p(e){let r=(0,a.specialItemGroupUpdated)(i,e);return t.dispatch(r),Promise.resolve()}async function g(){let{specialItemGroup:t}=n,{crypto:r}=e,a=await r.symmetricEncryption.generateNewAESKey(),i=await (0,u.getSpecialItemGroupKey)(r,o,n),c=y.encode(JSON.stringify({publicKey:s})),l=await r.symmetricEncryption.encryptAES256(a,c),p=await r.symmetricEncryption.encryptAES256(i,y.encode(a)),S=(0,d.generateItemUuid)(),g=await e.item.makeItemUpload(S,p,l);return await e.item.makeAddItemsEvent(t.groupId,t.revision,[g])}}t.saveDirectorySyncKey=f,t.directorySyncForAllTeams=function(e,t,r){return Object.keys(e.getTeamAdminData().teams).map(a=>_(e,t,r,a))};class E extends Error{constructor(e=""){super(e),this.name="NoRequestError"}}class A extends Error{constructor(e=""){super(e),this.name="NewPublicKeyError"}}class h extends Error{constructor(e="",t){super(e),this.name="InvalidSignatureError",this.syncResponse=t}}function _(e,t,r,a){let s=(0,i.makeTeamAdminController)(e,t);if(function(){let t=e.getState().userSession.directorySync;return(0,n.isTeamDirectorySyncInProgress)(t,a)}())return c.default.log(`[Directory Sync] Skipping: sync already in progress for team ${a}`),Promise.resolve();return e.dispatch((0,o.teamDirectorySyncInProgress)(a)),u().then(f).then(_).then(D).then(O).then(m).catch(y);async function u(){let r=e.getUserLogin(),o=(0,g.ukiSelector)(e.getState()),n={teamId:Number(a),login:r,uki:o};return await t.teamPlans.getDirectorySyncRequest(n)}function d(){e.dispatch((0,o.teamDirectorySyncNotInProgress)(a))}function S(r,o){let{content:{id:n}}=r,i=e.getUserLogin(),s=(0,g.ukiSelector)(e.getState()),c=Object.assign({},{teamId:Number(a),login:i,uki:s,requestId:n},o?{syncError:o}:{});return t.teamPlans.updateDirectorySyncRequestStatus(c)}async function m(e){return d(),S(e).then(()=>{})}async function y(e){switch(d(),e.name){case"NoRequestError":case"NewPublicKeyError":break;case"InvalidSignatureError":{let{syncResponse:t}=e;S(t,"invalid_signature").then(()=>{});break}default:{let t=Error(`[Directory Sync] unexpected error for team ${a}: ${e}`);(0,l.sendExceptionLog)({error:t})}}}async function f(e){if(!e.content)throw new E;return e}async function _(t){let{publicKey:r,id:o}=t.content,n=e.getTeamAdminData().teams[a].directorySyncKey,i=n&&n.publicKey,s=I(r);if(s!==i){(0,p.default)().checkDirectorySyncKeyRequest({teamId:a,publicKey:s,requestId:o});let e=`[Directory Sync] in sync request ${t.content.id} for team ${a}: new public key detected for syncRequest.`;throw c.default.log(e),new A}return t}async function D(e){if(!await P(e,a)){let t=`[Directory Sync] in sync request ${e.content.id} for team ${a}: invalid signature.`;throw c.default.log(t),new h(t,e)}return e}async function O(t){let o=e.getTeamAdminData().teams[a].userGroups||[],n=t.content.userGroups||[],i=function(e,t){let r=t.map(e=>e.groupId);return e.filter(e=>!!e.externalId).filter(e=>!r.includes(e.externalId))}(o,n),c=function(e,t){let r=e.filter(e=>!!e.externalId).map(e=>e.externalId);return t.filter(e=>!r.includes(e.groupId))}(o,n),u=function(e,t){let r=e.filter(e=>!!e.externalId).map(e=>e.externalId);return t.filter(e=>r.includes(e.groupId))}(o,n),d=i.map(e=>(function(e){let t=function(e){let{groupId:t,revision:r}=e;return{groupId:t,revision:r}}(e);return()=>s.deleteUserGroupAction(t)})(e)),p=c.map(e=>(function(e){let t=function(e){let t=e.groupName,r=e.groupId;return{teamId:Number(a),externalId:r,name:t}}(e);return()=>s.createUserGroupAction(r,t).then(t=>{var r,a;return r=t,a=e,r.userGroups.length>0?b(r.userGroups[0],a):Promise.resolve()})})(e)),S=u.map(e=>(function(e,t){var r,a;let o=t.find(t=>t.externalId===e.groupId);if(!o)return[];let n=[];return e.groupName!==o.name&&n.push(()=>(function(e,t){var r,a;let o=(r=e,a=t,{groupId:r.groupId,name:a.groupName,revision:r.revision});return s.renameUserGroupAction(o)})(o,e)),function(e,t){let r=e.users.map(e=>e.alias);return t.memberLogins.some(e=>!r.includes(e))}(o,e)&&n.push(()=>b(o,e)),r=o,a=e,r.users.map(e=>e.alias).some(e=>!a.memberLogins.includes(e))&&n.push(()=>(function(e,t){let r=e.users.map(e=>e.alias).filter(e=>!t.memberLogins.includes(e)),a={groupId:e.groupId,revision:e.revision,users:r};return s.revokeUserGroupMembersAction(a)})(o,e)),n})(e,o)).reduce((e,t)=>e.concat(t),[]),g=[...d,...p];return[...await v(g),...await T(S)].filter(e=>e.error).map(e=>e.error).forEach(e=>{let r=Error(`[Directory Sync] in sync request ${t.content.id} for team ${a}: an operation on groups failed: ${e}`);(0,l.sendExceptionLog)({error:r})}),t}function C(e){return{alias:e,permission:"limited"}}function b(e,t){let r=e.users.map(e=>e.alias),o=t.memberLogins.filter(e=>!r.includes(e)),n={groupId:e.groupId,revision:e.revision,users:o.map(C),teamId:Number(a)};return s.inviteUserGroupMembersAction(n,!0)}}function T(e){return Promise.all(e.map(e=>e().then(e=>({success:!0,result:e})).catch(e=>({success:!1,error:e}))))}async function v(e,t=[]){let r;let[a,...o]=e;if(!a)return t;try{let e=await a();r={success:!0,result:e}}catch(e){r={success:!1,error:e}}return v(o,[...t,r])}function I({modulus:e,exponent:t}){let r=`<RSAKeyValue><Modulus>${e}</Modulus><Exponent>${t}</Exponent></RSAKeyValue>`;return y.encode(r)}function D(e,t,r){return e+t.sort(function(e,t){return e.groupId<t.groupId?-1:+(e.groupId>t.groupId)}).map(r?function(e){let t=e.memberLogins.sort(a);return e.groupId+e.groupName+t.join("")}:function(e){let t=e.memberLogins.sort();return e.groupId+e.groupName+t.join("")}).join("");function a(e,t){let r=o(e),a=o(t);return r<a?-1:r>a?1:function(e,t){if(e.length<t.length)return -1;if(e.length>t.length)return 1;let r=e.split("-").length-1,a=t.split("-").length-1;return r<a?-1:+(r>a)}(e,t)}function o(e){let t=e.replace(/[-']/g,"");return(t=(t=t.replace(/\./g,"$")).replace(/@/g,"%")).replace(/_/g,"'")}}async function P(e,t){let{content:{signature:r,userGroups:a,publicKey:o}}=e,n=async e=>{let n=D(t,a,e),i=y.encode(n),c=(0,s.makeAsymmetricEncryption)();return await c.verifyJwk(o,r,i)},i=await n(!1);return i||n(!0)}t.directorySyncForTeam=_,t.batchOperations=T,t.chainOperations=v,t.keyToXMLB64=I,t.buildVerifiedSyncResponseData=D,t.isSignatureValid=P,t.keyRejectedByTacAdmin=function(e,t,r,a){let o=e.getUserLogin(),n=(0,g.ukiSelector)(e.getState()),i={teamId:Number(r),login:o,uki:n,requestId:a,syncError:"key_rejected"};return t.teamPlans.updateDirectorySyncRequestStatus(i).then(()=>{})},t.isDirectorySyncActivated=function(e){let t=e.spaces.find(e=>e.details&&e.details.info&&"accepted"===e.details.status);return!!t&&["full","provision-only"].includes(t.details.info.activeDirectorySyncType)}},1972:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.completeTeamDomainRegistration=void 0;let a=r(28323),o=r(93748);async function n(e){let{storeService:t}=e,r=(0,o.userLoginSelector)(t.getState()),n=await (0,a.completeDomainRegistration)(t,r);return(0,a.isApiError)(n)?{success:!1,error:{code:(0,a.getCode)(n.code,a.completeDomainRegistrationErrors)}}:{success:!0,domains:n.domain.map(e=>({...e,name:e.domain}))}}t.completeTeamDomainRegistration=n},56786:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.deactivateTeamDomain=void 0;let a=r(28323),o=r(93748);async function n(e,t){let{storeService:r}=e,n=(0,o.userLoginSelector)(r.getState()),i=await (0,a.deactivateDomain)(r,n,t);return(0,a.isApiError)(i)?{success:!1,error:{code:(0,a.getCode)(i.code,a.deactivateDomainErrors)}}:{success:!0}}t.deactivateTeamDomain=n},32927:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.getTeamDomains=void 0;let a=r(28323),o=r(93748);async function n(e){let{storeService:t}=e,r=(0,o.userLoginSelector)(t.getState()),n=await (0,a.listDomains)(t,r);return(0,a.isApiError)(n)?{success:!1,error:{code:(0,a.getCode)(n.code,a.listDomainErrors)}}:{success:!0,domains:n.domains.map(e=>({id:e.id,name:e.domain,status:e.status,dnsToken:e.dnsToken,lastVerificationAttemptDateUnix:e.lastVerificationAttemptDateUnix}))}}t.getTeamDomains=n},12202:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.registerTeamDomain=void 0;let a=r(28323),o=r(93748);async function n(e,t){let{storeService:r}=e,n=(0,o.userLoginSelector)(r.getState()),i=await (0,a.requestDomainRegistration)(r,n,t);return(0,a.isApiError)(i)?{success:!1,error:{code:(0,a.getCode)(i.code,a.requestDomainRegistrationErrors)}}:{success:!0,data:{computedToken:i.computedToken,challengeDomain:i.challengeDomain}}}t.registerTeamDomain=n},15659:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.clearEncryptionServiceConfig=void 0;let a=r(18926),o=async e=>(await (0,a.removeTeamAdminItem)(e,"encryptionServiceData"),!0);t.clearEncryptionServiceConfig=o},40583:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.createAzureEncryptionServiceConfig=t.createAwsLinuxEncryptionServiceConfig=void 0,t.createAwsLinuxEncryptionServiceConfig=({configEncryptionKey:e,deviceSecretKey:t,deviceAccessKey:r,teamUuid:a})=>`DASHLANE_SSO_TEAM_DEVICE_ACCESS_KEY=${r}
DASHLANE_SSO_TEAM_DEVICE_SECRET_KEY=${t}
DASHLANE_SSO_TEAM_UUID=${a}
DASHLANE_CONFIG_ENCRYPTION_KEY=${e}
`,t.createAzureEncryptionServiceConfig=({configEncryptionKey:e,deviceSecretKey:t,deviceAccessKey:r,teamUuid:a,encryptionServiceEndpoint:o})=>{let{host:n}=new URL(o),i=n.split(".").slice(0,-2).join(".");return`{
      "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentParameters.json#",
      "contentVersion": "1.0.0.0",
      "parameters": {
        "siteName": {
          "value": "${i}"
        },
        "servicePlanSku": {
          "value": "B1"
        },
        "servicePlanCapacity": {
          "value": 1
        },
        "location": {
          "value": "[resourceGroup().location]"
        },
        "DASHLANE_CONFIG_ENCRYPTION_KEY": {
          "value": "${e}"
        },
        "DASHLANE_SSO_TEAM_DEVICE_ACCESS_KEY": {
          "value": "${r}"
        },
        "DASHLANE_SSO_TEAM_DEVICE_SECRET_KEY": {
          "value": "${t}"
        },
        "DASHLANE_SSO_TEAM_UUID": {
          "value": "${a}"
        }
      }
    }
    `}},65866:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.generateAndSaveEncryptionServiceConfig=void 0;let a=r(93308),o=r(12971),n=r(28323),i=r(82901),s=r(40583),c=r(42250),l=r(47254),u=r(78271),d=r(42387),p=r(10934),S=r(60974),g=r(73316),m=r(27698),y=async()=>{let e=await (0,o.generate64BytesKey)(),t=(0,a.bufferToBase64)(e);return{encryptionKeyUuid:(0,d.v4)().toLowerCase(),key:t}},f=async(e,t,r,a={},o)=>{let{deviceSecretKey:n,deviceAccessKey:i,teamUuid:c}=await (0,u.reregisterTeamDevice)(e,o),{devicePrivateKey:d,devicePublicKey:f}=await (0,u.generateDeviceKeyPair)(e),E=await (0,u.registerTeamDeviceAccount)(e,{deviceAccessKey:i,devicePublicKey:f,devicePrivateKey:d});if(!1===E.success)return{success:!1,error:E.error};await (0,g.updateTeamSettings)(e,{ssoSolution:"self-hosted-saml",provisioningSolution:"self-hosted-scim"}),(0,m.triggerSsoSolutionChanged)("self-hosted-saml");let{encryptionKeyUuid:A,key:h}=await y(),_={config:("Microsoft Azure"===t?s.createAzureEncryptionServiceConfig:s.createAwsLinuxEncryptionServiceConfig)({deviceSecretKey:n,deviceAccessKey:i,teamUuid:c,configEncryptionKey:`${A}|${h}`,encryptionServiceEndpoint:r}),configEncryptionKey:h,teamUuid:c,deviceAccessKey:i,deviceSecretKey:n,encryptionKeyUuid:A,deploymentLocation:t,devicePublicKey:f,devicePrivateKey:d,lastGeneratedTimeStamp:(0,S.getUnixTime)(Date.now())},T=await (0,p.updateTeamDeviceEncryptedConfig)(e,{teamDeviceUrl:r,...a},_);if(!1===T.success)return{success:!1,error:T.error};let v=await (0,l.persistEncryptionServiceConfig)(e,_);return!1===v.success?{success:!1,error:v.error}:{success:!0,data:{basicConfig:{..._},encryptionServiceReloadingStatus:T.data.encryptionServiceReloadingStatus}}},E=["AWS","Microsoft Azure"];async function A(e,{deploymentLocation:t,encryptionServiceEndpoint:r,updateTeamDeviceConfigParams:a={}}){let o;let{storeService:s}=e;if((0,i.requireAdmin)(s),!E.includes(t))return{success:!1,error:{code:n.InvalidRequestError}};let l=await (0,c.getEncryptionServiceConfig)(e);return l.success?await f(e,t,r,a,l.data):await f(e,t,r,a)}t.generateAndSaveEncryptionServiceConfig=A},42250:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.getEncryptionServiceConfig=void 0;let a=r(28323),o=r(76369),n=r(82901);t.getEncryptionServiceConfig=({storeService:e})=>{(0,n.requireAdmin)(e);try{let t=(0,o.currentTeamIdSelector)(e.getState()),r=(0,o.adminDataForTeamSelector)(e.getState(),t);if(!r?.encryptionServiceData?.basicConfigs?.[0])return Promise.resolve({success:!1,error:{code:a.BasicConfigNotFound}});return Promise.resolve({success:!0,data:r.encryptionServiceData.basicConfigs[0]})}catch{return Promise.resolve({success:!1,error:{code:a.UnknownError}})}}},47254:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.persistEncryptionServiceConfig=t.saveOrUpdateEncryptionServiceConfig=void 0;let a=r(95121),o=r(77323),n=r(28323),i=r(12610),s=r(66879),c=r(27594),l=r(4729),u=r(76369),d=r(82901),p=r(83533),S=()=>({success:!1,error:{code:n.UnknownError}}),g=/[\dA-F]{8}-[\dA-F]{4}-[\dA-F]{4}-[\dA-F]{4}-[\dA-F]{12}/i,m=({teamUuid:e,encryptionKeyUuid:t,deviceAccessKey:r,deviceSecretKey:a})=>{let o=Object.entries({teamUuid:!!(e&&!e.match(g)),encryptionKeyUuid:!!(t&&!t.match(g)),deviceAccessKey:!!(r&&16!==r.length),deviceSecretKey:!!(a&&64!==a.length)}).reduce((e,[t,r])=>r?{[t]:!0,...e}:e,{});return Object.keys(o).length>0?o:null},y=async(e,t,r,n,i,s)=>{let c;let{sessionService:u,applicationModulesAccess:d}=e,{crypto:S,item:g,ws:m}=t,{specialItemGroup:y}=n;if(!y)throw Error("Cannot find specialItemGroup in adminData");let{specialItemGroup:{items:f},encryptionServiceData:E}=n,{itemId:A}=E,{getTeamAdminSharingData:h}=d.createClients().sharingSync.queries,_=await (0,a.firstValueFrom)(h());if((0,o.isSuccess)(_)){let{specialItems:e}=(0,o.getSuccess)(_);if(e&&e[A]){let{timestamp:t}=e[A];c=t}}if(!c)throw Error("trying to update config before it was created.");let T={...s,...i},v=await (0,l.getSpecialItemGroupKey)(S,r,n),{itemKey:I}=f.find(({itemId:e})=>e===A),D=await S.symmetricEncryption.decryptAES256(v,I),P=await S.symmetricEncryption.encryptAES256(D,btoa(JSON.stringify({basicConfigs:[T]}))),O=await g.makeUpdateItemEvent(c,I,{itemId:A,itemContent:P});if(!(await g.updateItem(m,r.login,r.uki,O)).items.length)throw Error("unable to update encryption service special item");return await u.getInstance().user.attemptSync(p.Trigger.SettingsChange),T},f=async(e,t,r)=>(await (0,c.createOrUpdateSpecialItem)(e,t,{basicConfigs:[r]})).basicConfigs[0],E=async(e,t)=>{if(m(t))return null;let{storeService:r,wsService:a}=e,o=(0,s.makeSharingService)(r,a),n=(0,i.getCurrentUserInfo)(r),c=(0,u.currentTeamIdSelector)(r.getState()),l=(0,u.adminDataForTeamSelector)(r.getState(),c);if(!l)throw Error("Cannot find adminData");let d=l?.encryptionServiceData?.basicConfigs?.[0];return d?await y(e,o,n,l,t,d):await f(e,o,t)};t.saveOrUpdateEncryptionServiceConfig=E;let A=async(e,r)=>{(0,d.requireAdmin)(e.storeService);let a=await (0,t.saveOrUpdateEncryptionServiceConfig)(e,r);return a?{success:!0,data:a}:S()};t.persistEncryptionServiceConfig=A},78271:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.registerTeamDeviceAccount=t.reregisterTeamDevice=t.generateDeviceKeyPair=void 0;let a=r(20648),o=r(96304),n=r(28323),i=r(66879),s=r(86527),c=r(12610),l=r(4729),u=r(76369),d=r(70556),p=r(12631),S=r(30046),g=r(72331),m=r(77442),y=e=>{let t=Math.floor(0x100000000*Math.random()).toString(16);return`special-admin-${e}-${t}@teamdevice.dashlane.com`},f=async e=>{let{storeService:t,wsService:r}=e,{crypto:a}=(0,i.makeSharingService)(t,r),o=await a.asymmetricEncryption.generateRsaKeyPair();return{devicePrivateKey:o.privateKey.replace(m.PRIVATE_KEY_HEADER,"").replace(m.PRIVATE_KEY_FOOTER,"").replace(/[\r\n ]/gm,""),devicePublicKey:o.publicKey.replace(m.PUBLIC_KEY_HEADER,"").replace(m.PUBLIC_KEY_FOOTER,"").replace(/[\r\n ]/gm,"")}};t.generateDeviceKeyPair=f;let E=async(e,t,r=a.TeamDevicePlatform.ENCRYPTION_SERVICE)=>{t?.deviceAccessKey&&await (0,p.deactivateTeamDevice)(e,{teamDeviceAccessKey:t.deviceAccessKey});let o=await (0,d.registerTeamDevice)(e,{platform:r,deviceName:m.ENCRYPTION_SERVICE_HUMAN_DEVICE_NAME});if(o.success)return o.data;throw Error(n.DeviceNotFound)};t.reregisterTeamDevice=E;let A=async(e,r)=>{let a,d;r.shouldGenerateDeviceKeyPair?{devicePublicKey:a,devicePrivateKey:d}=await (0,t.generateDeviceKeyPair)(e):(a=r.devicePublicKey,d=r.devicePrivateKey);let{storeService:p,wsService:f}=e,{crypto:E}=(0,i.makeSharingService)(p,f),A=(0,c.getCurrentUserInfo)(p),h=(0,u.currentTeamIdSelector)(p.getState()),_=(0,u.adminDataForTeamSelector)(p.getState(),h),{revision:T}=await (0,g.loadSpecialUserGroup)(f,A.login,A.uki,_),v=await (0,l.getSpecialUserGroupKey)(E,A,_),I=`${m.PUBLIC_KEY_HEADER}
${a}
${m.PUBLIC_KEY_FOOTER}`,D=await E.asymmetricEncryption.encrypt(I,v),P=y(h),O=await (0,s.generateProposeSignature)(E,v,P),C=await (0,S.createTeamDeviceAccount)(e,{teamDeviceAccessKey:r.deviceAccessKey,publicKey:a,proposeSignature:O,userGroupRevision:T,groupKey:D,teamDeviceLogin:P});return!1===C.success?{success:!1,error:{code:(0,n.getCode)(C.error.code,o.createTeamDeviceAccountErrors)}}:{success:!0,data:{login:C.data.login,devicePrivateKey:d,devicePublicKey:a}}};t.registerTeamDeviceAccount=A},23053:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.mapTeamDeviceEncryptedConfig=t.generateTeamDeviceEncryptedConfig=void 0;let r={scimSignatureKey:{defaultValue:"",configMapping:"DASHLANE_SCIM_SIGNATURE_KEY"},scimAuthToken:{defaultValue:"",configMapping:"DASHLANE_SCIM_AUTHENTICATION_TOKEN"},scimEnabled:{defaultValue:!1,configMapping:"DASHLANE_SCIM_ENABLED"},teamDevicePublicKey:{defaultValue:"",configMapping:"DASHLANE_SCIM_TEAMDEVICE_PUBLIC_KEY"},teamDevicePrivateKey:{defaultValue:"",configMapping:"DASHLANE_SCIM_TEAMDEVICE_PRIVATE_KEY"},connectorEndpoint:{defaultValue:"",configMapping:"DASHLANE_SSO_CONNECTOR_ENDPOINT"},connectorKey:{defaultValue:"",configMapping:"DASHLANE_SSO_CONNECTOR_KEY"},samlIdpCertificate:{defaultValue:"",configMapping:"DASHLANE_SSO_SAML_IDP_CERTIFICATE"},samlIdpEntryPoint:{defaultValue:"",configMapping:"DASHLANE_SSO_SAML_IDP_ENTRYPOINT"}},a=(e,t)=>"boolean"==typeof t||"boolean"==typeof e?t??e?"true":"false":`${t??e}`,o=(e,t)=>t?t.length>0&&"boolean"==typeof e?"true"===t:"boolean"==typeof e?e:t??e:e;t.generateTeamDeviceEncryptedConfig=e=>Object.entries(r).map(([t,r])=>`${r.configMapping}=${a(r.defaultValue,e[t])}`).join("\n");let n=e=>Object.keys(r).every(t=>t in e);t.mapTeamDeviceEncryptedConfig=e=>{let t=e.split("\n").reduce((e,t)=>{let r=t.indexOf("="),[a,o]=[t.slice(0,r),t.slice(r+1)];return{...e,[a]:o}},{}),a=Object.entries(r).reduce((e,[r,{configMapping:a,defaultValue:n}])=>({...e,[r]:o(n,t[a])}),{});if(n(a))return a;throw Error("incomplete data when creating object from config string")}},90253:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.getTeamDeviceEncryptedConfig=t.getParsedTeamDeviceEncryptedConfig=void 0;let a=r(20648),o=r(34978),n=r(28323),i=r(18040),s=r(93748),c=r(82901),l=r(42250),u=r(23053),d=async(e,{configEncryptionKey:t,encryptedConfig:r})=>{if(!r||!t)throw Error("missing config or encryption key");let{teamDeviceEncryptedConfigEncryptorService:a}=e,n=(0,i.getNoDerivationCryptoConfig)();a.setInstance({raw:atob(t)},"",n);let s=await a.getInstance().decrypt(r),c=(0,o.deflatedUtf8ToUtf16)(s,{skipInflate:!0});return(0,u.mapTeamDeviceEncryptedConfig)(c)};async function p(e,{deviceAccessKey:r,draft:o}){let{storeService:i}=e;(0,c.requireAdmin)(i);let u=(0,s.userLoginSelector)(i.getState());if(!u)throw Error(a.AuthenticationCode[a.AuthenticationCode.USER_UNAUTHORIZED]);let d=await (0,l.getEncryptionServiceConfig)(e);if(!1===d.success)return{success:!1,error:{code:d.error.code===n.BasicConfigNotFound?n.TeamDeviceEncryptedConfigNotFound:n.UnknownError}};let{data:{deviceAccessKey:p,configEncryptionKey:S}}=d;try{let a=await (0,n.getTeamDeviceEncryptedConfig)(i,u,{configurationVersion:0,deviceAccessKey:r||p,draft:o});if((0,n.isApiError)(a))return{success:!1,error:{code:(0,n.getCode)(a.code,n.getTeamDeviceEncryptedConfigErrors)}};let s=await (0,t.getParsedTeamDeviceEncryptedConfig)(e,{encryptedConfig:a.encryptedConfiguration,configEncryptionKey:S});return{success:!0,data:{config:a.encryptedConfiguration,configurationVersion:a.configurationVersion,deviceAccessKey:r,encryptionKeyUuid:a.encryptionKeyUuid,configProperties:s}}}catch(e){return{success:!1,error:{code:n.TeamDeviceEncryptedConfigNotFound}}}}t.getParsedTeamDeviceEncryptedConfig=d,t.getTeamDeviceEncryptedConfig=p},10934:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.updateTeamDeviceEncryptedConfig=void 0;let a=r(28323),o=r(34978),n=r(18040),i=r(66879),s=r(12610),c=r(93748),l=r(19997),u=r(76369),d=r(42250),p=r(67631),S=r(23683),g=r(2862),m=r(42012),y=r(18926),f=r(82901),E=r(90253),A=r(23053),h=r(76981),_=r(93490),T=async(e,t={},r)=>{let{storeService:T,teamDeviceEncryptedConfigEncryptorService:v,wsService:I}=e;(0,f.requireAdmin)(T);let D=(0,c.userLoginSelector)(T.getState());if(!D)throw Error("missing login");let P={ssoEnabled:!1,ssoIdpMetaData:"",ssoEndpoint:""},O=await (0,_.getTeamInfo)(e);O.success&&(P.ssoEnabled=O.data.teamInfo.ssoEnabled,P.ssoIdpMetaData=O.data.teamInfo.ssoIdpMetadata,P.ssoEndpoint=O.data.teamInfo.ssoServiceProviderUrl);let C=parseInt((0,u.currentTeamIdSelector)(T.getState()),10),b=null,R=null;if(P.ssoIdpMetaData&&({samlIdpCertificate:b,samlIdpEntryPoint:R}=await (0,p.parseMetadataFields)(P.ssoIdpMetaData)),"string"==typeof t.ssoIdpMetadata){let{ssoIdpMetadata:e}=t;if(e)try{({samlIdpCertificate:b,samlIdpEntryPoint:R}=await (0,p.parseMetadataFields)(e))}catch(e){return{success:!1,error:{code:a.UnknownError}}}if((await (0,l.setTeamSettings)(T,I,(0,s.getCurrentUserInfo)(T),{teamId:C,settings:{ssoIdpMetadata:e||null,ssoIdpEntrypoint:R}})).error)return{success:!1,error:{code:a.UnknownError}}}let N=await (0,d.getEncryptionServiceConfig)(e),w=r||(N.success&&N.data.deviceAccessKey&&N.data.configEncryptionKey&&N.data.encryptionKeyUuid&&N.data.devicePrivateKey&&N.data.devicePublicKey?N.data:null);if(!w)return{success:!1,error:{code:a.DeviceKeyNotFound}};let{deviceAccessKey:L,encryptionKeyUuid:U,configEncryptionKey:M,devicePrivateKey:F,devicePublicKey:k}=w,K=U.toLowerCase(),B=await (0,E.getTeamDeviceEncryptedConfig)(e,{draft:!1,deviceAccessKey:L}),G={},j=0;if(!1===B.success&&B.error.code!==a.TeamDeviceEncryptedConfigNotFound)return{success:!1,error:{code:a.UnknownError}};if(!0===B.success){let{data:t}=B;G=await (0,E.getParsedTeamDeviceEncryptedConfig)(e,{encryptedConfig:t.config,configEncryptionKey:M}),j=t.configurationVersion}let V=(0,i.makeSharingService)(T,I),W=(0,u.currentTeamIdSelector)(T.getState()),H=(0,u.adminDataForTeamSelector)(T.getState(),W),x=H?.ssoConnectorKey?.ssoConnectorKey;if(!x||t.ssoConnectorKey)try{x&&t.ssoConnectorKey&&await (0,y.removeTeamAdminItem)(e,"ssoConnectorKey");let r=t.ssoConnectorKey??await (0,S.generateSSOConnectorKey)();x=await (0,g.persistSSOConnectorKey)(e,V,r)}catch(e){return{success:!1,error:{code:a.UnknownError}}}let Y=H?.scimSignatureKey?.scimSignatureKey;if(!Y){let t=await (0,h.generateSCIMSignatureKey)();Y=await (0,m.persistSCIMSignatureKey)(e,V,t)}let q={scimAuthToken:t?.scimAuthToken??G?.scimAuthToken??"",scimEnabled:t?.scimEnabled??G?.scimEnabled??!1,connectorEndpoint:t?.connectorEndpoint??G?.connectorEndpoint??P.ssoEndpoint??"",samlIdpEntryPoint:R??G?.samlIdpEntryPoint??"",samlIdpCertificate:b??G?.samlIdpCertificate??""},$=!!(t.ssoEnabled||G.connectorKey||P.ssoEnabled),Q={...q,teamDevicePrivateKey:F,teamDevicePublicKey:k,connectorKey:$?x:"",scimSignatureKey:q.scimEnabled?Y:""},z=(0,A.generateTeamDeviceEncryptedConfig)(Q),X=(0,o.utf16ToDeflatedUtf8)(z,{skipUtf8Encoding:!0,skipDeflate:!0}),J=(0,n.getNoDerivationCryptoConfig)();v.setInstance({raw:atob(M)},"",J);let Z=v.getInstance(),ee=await Z.encrypt(X),et={configurationVersion:j,deviceAccessKey:L,ssoServiceEnabled:$,scimServiceEnabled:Q.scimEnabled,encryptionKeyUuid:K,draft:!1,encryptedConfiguration:ee,teamDeviceUrl:t.teamDeviceUrl},er=await (0,a.updateTeamDeviceEncryptedConfig)(T,D,et);return(0,a.isApiError)(er)?{success:!1,error:{code:(0,a.getCode)(er.code,a.updateTeamDeviceEncryptedConfigErrors)}}:{success:!0,data:{configurationVersion:er.configurationVersion,encryptionServiceReloadingStatus:er.encryptionServiceReloadingStatus}}};t.updateTeamDeviceEncryptedConfig=T},14500:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.adminProvisioningKeySelector=void 0;let a=r(76369);t.adminProvisioningKeySelector=e=>{let t=(0,a.currentTeamIdSelector)(e),r=(0,a.adminDataForTeamSelector)(e,t);return{adminProvisioningKey:r.adminProvisioningKey?.adminProvisioningKey??null}}},99041:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.persistAdminProvisioningKey=void 0;let a=r(28323),o=r(66879),n=r(27594),i=async(e,t)=>{let{adminProvisioningKey:r}=t,i=(0,o.makeSharingService)(e.storeService,e.wsService);try{if(!await (0,n.createOrUpdateSpecialItem)(e,i,{adminProvisioningKey:r}))return{success:!1,error:"failed to persist adminProvisioningKey"};return{success:!0}}catch(e){return{success:!1,error:`${e?.message??a.UnknownError}`}}};t.persistAdminProvisioningKey=i},61947:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.removeAdminProvisioningKey=void 0;let a=r(18926),o=async e=>(await (0,a.removeTeamAdminItem)(e,"adminProvisioningKey"),{success:!0});t.removeAdminProvisioningKey=o},27730:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.clearSelfHostedESSettings=void 0;let a=r(20648),o=r(28323),n=r(12610),i=r(19997),s=r(82901),c=r(12631),l=r(76369),u=r(15659),d=r(42250),p=async e=>{let{storeService:t,wsService:r}=e;try{(0,s.requireAdmin)(t)}catch(e){if(e.message===a.AuthenticationCode[a.AuthenticationCode.USER_UNAUTHORIZED])return{success:!1,error:{code:o.NotAdmin}}}let p=await (0,d.getEncryptionServiceConfig)(e),S=[];if(p.success){if(p.data.config&&await (0,u.clearEncryptionServiceConfig)(e),p.data.deviceAccessKey&&!(await (0,c.deactivateTeamDevice)(e,{teamDeviceAccessKey:p.data.deviceAccessKey})).success)return{success:!1,error:{code:o.DeactivatedTeamDevice}}}else S.push(o.BasicConfigNotFound);let g=parseInt((0,l.currentTeamIdSelector)(t.getState()),10);return(await (0,i.setTeamSettings)(t,r,(0,n.getCurrentUserInfo)(t),{teamId:g,settings:{ssoServiceProviderUrl:null,ssoIdpMetadata:null,ssoIdpEntrypoint:null}})).error?{success:!1,error:{code:o.UnknownError}}:{success:!0,...S?{warnings:S}:{}}};t.clearSelfHostedESSettings=p},77442:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.PUBLIC_KEY_FOOTER=t.PUBLIC_KEY_HEADER=t.PRIVATE_KEY_FOOTER=t.PRIVATE_KEY_HEADER=t.ENCRYPTION_SERVICE_HUMAN_DEVICE_NAME=void 0,t.ENCRYPTION_SERVICE_HUMAN_DEVICE_NAME="Encryption Service",t.PRIVATE_KEY_HEADER="-----BEGIN RSA PRIVATE KEY-----",t.PRIVATE_KEY_FOOTER="-----END RSA PRIVATE KEY-----",t.PUBLIC_KEY_HEADER="-----BEGIN RSA PUBLIC KEY-----",t.PUBLIC_KEY_FOOTER="-----END RSA PUBLIC KEY-----"},82901:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.requireAdmin=void 0;let a=r(20648),o=r(4790);t.requireAdmin=e=>{if(!(0,o.hasTACAccessInCurrentSpace)(e))throw Error(a.AuthenticationCode[a.AuthenticationCode.USER_UNAUTHORIZED])}},76981:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.generateSCIMSignatureKey=void 0;let a=r(93308),o=r(60355),n=async()=>{let e=await (0,o.getRandomValues)(32);return(0,a.bufferToBase64)(e)};t.generateSCIMSignatureKey=n},42012:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.persistSCIMSignatureKey=void 0;let a=r(27594),o=async(e,t,r)=>(await (0,a.createOrUpdateSpecialItem)(e,t,{scimSignatureKey:r})).scimSignatureKey;t.persistSCIMSignatureKey=o},2862:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.persistSSOConnectorKey=void 0;let a=r(27594),o=async(e,t,r)=>(await (0,a.createOrUpdateSpecialItem)(e,t,{ssoConnectorKey:r})).ssoConnectorKey;t.persistSSOConnectorKey=o},65220:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.changeInviteLinkTeamKey=void 0;let a=r(20648),o=r(28323),n=r(82901),i=r(93748);async function s(e){let{storeService:t}=e;try{let e=(0,i.userLoginSelector)(t.getState()),r={success:!1,error:{code:a.InviteLinkResponseErrorCode.NotAdmin}};try{(0,n.requireAdmin)(t)}catch{return r}if(!e)return r;let s=await (0,o.changeInviteLinkTeamKey)(t,e);if((0,o.isApiError)(s))return{success:!1,error:{code:(0,o.getCode)(s.code,o.getInviteLinkErrors)}};return{success:!0,data:s}}catch(e){return{success:!1,error:{code:a.InviteLinkResponseErrorCode.InviteLinkNotFound}}}}t.changeInviteLinkTeamKey=s},58761:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.createInviteLink=void 0;let a=r(20648),o=r(28323),n=r(82901),i=r(93748);async function s(e,t){let{storeService:r}=e;try{let e=(0,i.userLoginSelector)(r.getState()),s={success:!1,error:{code:a.InviteLinkResponseErrorCode.NotAdmin}};try{(0,n.requireAdmin)(r)}catch{return s}if(!e)return s;let c=await (0,o.createInviteLink)(r,e,t);if((0,o.isApiError)(c))return{success:!1,error:{code:(0,o.getCode)(c.code,o.getInviteLinkErrors)}};return{success:!0,data:c}}catch(e){return{success:!1,error:{code:a.InviteLinkResponseErrorCode.InviteLinkNotFound}}}}t.createInviteLink=s},19510:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.getInviteLinkForAdmin=void 0;let a=r(20648),o=r(28323),n=r(82901),i=r(93748);async function s(e){let{storeService:t}=e;try{let e=(0,i.userLoginSelector)(t.getState()),r={success:!1,error:{code:a.InviteLinkResponseErrorCode.NotAdmin}};try{(0,n.requireAdmin)(t)}catch{return r}if(!e)return r;let s=await (0,o.getInviteLinkForAdmin)(t,e);if((0,o.isApiError)(s))return{success:!1,error:{code:(0,o.getCode)(s.code,o.getInviteLinkErrors)}};return{success:!0,data:s}}catch(e){return{success:!1,error:{code:a.InviteLinkResponseErrorCode.InviteLinkNotFound}}}}t.getInviteLinkForAdmin=s},60845:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.getInviteLink=void 0;let a=r(20648),o=r(28323);async function n(e,t){let{storeService:r}=e;try{let e=await (0,o.getInviteLink)(r,t);if((0,o.isApiError)(e))return{success:!1,error:{code:(0,o.getCode)(e.code,o.getInviteLinkErrors)}};return{success:!0,data:e}}catch(e){return{success:!1,error:{code:a.InviteLinkResponseErrorCode.InviteLinkNotFound}}}}t.getInviteLink=n},6735:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.requestInviteLinkToken=void 0;let a=r(20648),o=r(28323);async function n(e,t){let{storeService:r}=e;try{let e=await (0,o.requestInviteLinkToken)(r,t);if((0,o.isApiError)(e))return{success:!1,error:{code:(0,o.getCode)(e.code,o.getInviteLinkErrors)}};return{success:!0,data:e}}catch(e){return{success:!1,error:{code:a.InviteLinkResponseErrorCode.UserInviteLinkNotFound}}}}t.requestInviteLinkToken=n},1765:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.toggleInviteLink=void 0;let a=r(20648),o=r(28323),n=r(82901),i=r(93748);async function s(e,t){let{storeService:r}=e;try{let e=(0,i.userLoginSelector)(r.getState()),s={success:!1,error:{code:a.InviteLinkResponseErrorCode.NotAdmin}};try{(0,n.requireAdmin)(r)}catch{return s}if(!e)return s;let c=await (0,o.toggleInviteLink)(r,e,t);if((0,o.isApiError)(c))return{success:!1,error:{code:(0,o.getCode)(c.code,o.getInviteLinkErrors)}};return{success:!0,data:c}}catch(e){return{success:!1,error:{code:a.InviteLinkResponseErrorCode.InviteLinkNotFound}}}}t.toggleInviteLink=s},58223:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.isMassDeploymentTeamKey=void 0,t.isMassDeploymentTeamKey=e=>"massDeploymentTeamAccessKey"in e&&"massDeploymentTeamSecretKey"in e},46902:function(e,t,r){var a=this&&this.__createBinding||(Object.create?function(e,t,r,a){void 0===a&&(a=r);var o=Object.getOwnPropertyDescriptor(t,r);(!o||("get"in o?!t.__esModule:o.writable||o.configurable))&&(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,a,o)}:function(e,t,r,a){void 0===a&&(a=r),e[a]=t[r]}),o=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||a(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),o(r(58223),t),o(r(13116),t),o(r(31858),t),o(r(99896),t)},99896:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.massDeploymentTeamKey$=void 0;let a=r(95121),o=r(15237),n=r(31858);t.massDeploymentTeamKey$=()=>(0,a.pipe)((0,o.map)(n.massDeploymentTeamKeySelector),(0,o.distinctUntilChanged)())},13116:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.persistMassDeploymentTeamKey=void 0;let a=r(28323),o=r(66879),n=r(27594),i=async(e,t)=>{let{massDeploymentTeamAccessKey:r,massDeploymentTeamSecretKey:i}=t,s=(0,o.makeSharingService)(e.storeService,e.wsService);try{if(!await (0,n.createOrUpdateSpecialItem)(e,s,{massDeploymentTeamAccessKey:r,massDeploymentTeamSecretKey:i}))return{success:!1,error:"failed to persist massDeploymentTeamKey credentials"};return{success:!0}}catch(e){return{success:!1,error:`${e?.message??a.UnknownError}`}}};t.persistMassDeploymentTeamKey=i},31858:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.massDeploymentTeamKeySelector=void 0;let a=r(76369);t.massDeploymentTeamKeySelector=e=>{let t=(0,a.currentTeamIdSelector)(e),r=(0,a.adminDataForTeamSelector)(e,t);return{massDeploymentTeamAccessKey:r.massDeploymentTeamKey?.massDeploymentTeamAccessKey??null,massDeploymentTeamSecretKey:r.massDeploymentTeamKey?.massDeploymentTeamSecretKey??null}}},56966:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.createConfigString=void 0,t.createConfigString=(e,t,r,a,o,n,i)=>`
DASHLANE_SSO_CONNECTOR_ENDPOINT=${t}
DASHLANE_SSO_SAML_IDP_CERTIFICATE=${n}
DASHLANE_SSO_SAML_IDP_ENTRYPOINT=${i}
DASHLANE_SSO_CONNECTOR_KEY=${e}
DASHLANE_SSO_TEAM_DEVICE_ACCESS_KEY=${a}
DASHLANE_SSO_TEAM_DEVICE_SECRET_KEY=${r}
DASHLANE_SSO_TEAM_UUID=${o}
`},58113:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.createSSOConnectorConfig=void 0;let a=r(20648),o=r(70556),n=r(56966),i=r(67631),s=r(19997),c=r(12610),l=r(76369);async function u(e,t){let{connectorUrl:r,connectorKey:u,idpMetadata:d}=t;if(!r||!d)throw Error(`[createConfig] : Missing request information -
                Received connectorUrl : ${!!r} or
                Received idpMetadata: ${!!d}
            `);let p=await (0,o.registerTeamDevice)(e,{platform:a.TeamDevicePlatform.SSO_CONNECTOR,deviceName:"SSO Connector"});if(!1===p.success)return{success:!1,error:{code:p.error.code}};let S=p.data.deviceSecretKey,g=p.data.deviceAccessKey,m=p.data.teamUuid;try{let{samlIdpCertificate:t,samlIdpEntryPoint:a}=await (0,i.parseMetadataFields)(d),{storeService:o,wsService:p}=e,y=(0,l.currentTeamIdSelector)(o.getState()),f=parseInt(y,10);if(isNaN(f))throw Error("[createSSOConnectorConfig] : Unable to retrieve teamId from [parseInt(currentTeamIdString, 10)]");await (0,s.setTeamSettings)(o,p,(0,c.getCurrentUserInfo)(o),{teamId:f,settings:{ssoIdpEntrypoint:a}});let E=(0,n.createConfigString)(u||"",r.toLowerCase(),S,g,m,t,a);return{success:!0,config:E}}catch(e){return{success:!1,error:{code:e.message}}}}t.createSSOConnectorConfig=u},23683:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.generateSSOConnectorKey=void 0;let a=r(93308),o=r(12971),n=r(42387);async function i(){let e=await (0,o.generate64BytesKey)(),t=(0,a.bufferToBase64)(e);return`${(0,n.v4)()}|${t}`}t.generateSSOConnectorKey=i},67631:function(e,t,r){var a,o;Object.defineProperty(t,"__esModule",{value:!0}),t.parseMetadataFieldsHandler=t.parseMetadataFields=t.SamlTags=void 0;let n=r(20648),i=r(92546),s=r(56708);function c(e){let t=(0,s.findAllKWXMLElementsOfType)(e,a.IDP_SSO_DESCRIPTOR,[]);if(1!==t.length)throw Error(n.IDPMetadataParseErrors.INVALID_IDP_SSO_DESCRIPTOR);return t[0]}(o=a=t.SamlTags||(t.SamlTags={})).IDP_SSO_DESCRIPTOR="IDPSSODescriptor",o.KEY_DESCRIPTOR="KeyDescriptor",o.SINGLE_SIGN_ON_SERVICE="SingleSignOnService",o.CERTIFICATE="X509Certificate";let l=async e=>{let t=e.trim().replace(/[\r\n\t]/gm,""),r=await new Promise((e,r)=>{(0,i.parseXml)((t,a)=>{if(t||!(0,i.isKWXMLElement)(a)){r(Error(n.IDPXmlParseErrors.XML_PARSE_FAILED));return}e(a)},t)});return{samlIdpCertificate:function(e){let t=(0,s.findAllKWXMLElementsOfType)(c(e),a.KEY_DESCRIPTOR,[]).filter(e=>!e.__attributes__?.use||e.__attributes__?.use==="signing");if(!t.length)throw Error(n.IDPMetadataParseErrors.KEY_DESCRIPTOR_NOT_FOUND);let r=[];t.forEach(e=>(0,s.findAllKWXMLElementsOfType)(e,a.CERTIFICATE,r));let o=[...new Set(r.map(e=>e.__value__))];if(!o.length)throw Error(n.IDPMetadataParseErrors.MISSING_CERTIFICATE);let i=o[o.length-1];if(!i?.length)throw Error(n.IDPMetadataParseErrors.MISSING_CERTIFICATE);if(i.length<64)throw Error(n.IDPMetadataParseErrors.CERTIFICATE_TOO_SHORT);if(i.length>4096)throw Error(n.IDPMetadataParseErrors.CERTIFICATE_TOO_LONG);try{atob(i)}catch{throw Error(n.IDPMetadataParseErrors.CERTIFICATE_DECODE_FAILED)}return i}(r),samlIdpEntryPoint:function(e){let t=c(e).__children__.filter(e=>{if((0,i.isKWXMLElement)(e))return(0,s.removeNamespace)(e.__type__)===a.SINGLE_SIGN_ON_SERVICE}).find(e=>{if((0,i.isKWXMLElement)(e)){let t=e.__attributes__.Binding;if("string"==typeof t)return t.includes("HTTP-POST")}});if(!t)throw Error(n.IDPMetadataParseErrors.IDP_ENTRYPOINT_NOT_FOUND);if((0,i.isKWXMLElement)(t)){let e=t.__attributes__.Location;if("string"==typeof e)return e}throw Error(n.IDPMetadataParseErrors.INVALID_ENTRYPOINT)}(r)}};t.parseMetadataFields=l;let u=async(e,{ssoIdpMetadata:r})=>{try{let{samlIdpCertificate:e,samlIdpEntryPoint:a}=await (0,t.parseMetadataFields)(r);return{success:!0,data:{samlIdpCertificate:e,samlIdpEntryPoint:a}}}catch(r){let e=Object.values(n.IDPXmlParseErrors),t=Object.values(n.IDPMetadataParseErrors);return{success:!1,error:e.concat(t).includes(r.message)?r.message:n.IDPXmlParseErrors.XML_PARSE_FAILED}}};t.parseMetadataFieldsHandler=u},73316:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.updateTeamSettings=void 0;let a=r(12610),o=r(4790),n=r(19997),i=async(e,t)=>{let r=(0,o.getCurrentSpaceId)(e.storeService.getSpaceData()),i=await (0,n.setTeamSettings)(e.storeService,e.wsService,(0,a.getCurrentUserInfo)(e.storeService),{teamId:r,settings:t});return i.error?{success:!1,error:i.error.message}:{success:!0}};t.updateTeamSettings=i},51621:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.getSpecialUserGroupRevision=t.getSpecialUserGroupInviteValuesForMemberInTeam=t.removeTeamAdmin=t.addTeamAdmin=t.proposeMembers=t.getMembers=void 0,r(25903);let a=r(12610),o=r(67972),n=r(4729),i=r(72331),s=r(66879),c=r(22839),l=r(28323),u=e=>{let t="accepted"===e.status&&Object.keys(e).includes("nbrPasswords");return{...e,isBillingAdmin:t&&e.isBillingAdmin,isTeamCaptain:t&&e.isTeamCaptain,isGroupManager:t&&e.isGroupManager,hasPublicKey:t&&e.hasPublicKey,accountRecoveryKeyStatus:t?e.accountRecoveryKeyStatus:"disabled",compromisedPasswords:(t&&e.compromisedPasswords)??0,securityIndex:t&&e.securityIndex,nbrPasswords:t&&e.nbrPasswords,accountType:t&&e.accountType||"masterPassword",..."pending"===e.status&&e.lastUpdateDateUnix?{}:{lastUpdateDateUnix:e.lastUpdateDateUnix}}};async function d(e,t,{teamId:r}){let a=await (0,c.getTeamMembers)(e,t,{teamId:r,orderBy:"login",limit:0});return(0,l.isApiError)(a)?{success:!1,error:Error(a.message)}:{success:!0,members:a.members.map(u)}}async function p(e,{login:t,uki:r},{proposedMemberLogins:a,teamId:o,origin:n,notificationOptions:i={skipAccountCreationRequiredAlerts:!1}}){let{content:s}=await e.teamPlans.proposeMembers({login:t,uki:r,teamId:o,proposedMemberLogins:a,force:!0,origin:n,notificationOptions:i});return s}async function S(e,{teamId:t,memberLogin:r}){let{ws:s,store:c}=e,l=(0,a.getCurrentUserInfo)(c),u=c.getTeamAdminData(),d=(0,n.getAdminDataFromTeamAdminData)(u,String(t)),{revision:p}=await (0,i.loadSpecialUserGroup)(s,l.login,l.uki,d),{groupKey:S,proposeSignature:g}=await (0,n.makeInviteToSpecialUserGroup)(e,(0,o.makeCryptoService)(),l,u,{teamId:t,memberLogin:r});return await e.ws.teamPlans.addTeamAdmin({login:l.login,uki:l.uki,teamId:t,memberLogin:r,memberAlias:r,groupKey:S,proposeSignature:g,userGroupRevision:p}),{}}async function g(e,{teamId:t,memberLogin:r}){let{ws:o,store:s}=e,c=(0,a.getCurrentUserInfo)(s),l=s.getTeamAdminData(),u=(0,n.getAdminDataFromTeamAdminData)(l,String(t)),{revision:d}=await (0,i.loadSpecialUserGroup)(o,c.login,c.uki,u);return await o.teamPlans.removeTeamAdmin({login:c.login,uki:c.uki,teamId:t,memberLogin:r,userGroupRevision:d}),{}}async function m(e,{teamId:t,memberLogin:r}){let{wsService:i,storeService:c}=e,l=(0,s.makeSharingService)(c,i),u=(0,a.getCurrentUserInfo)(c),d=c.getTeamAdminData(),{groupKey:p,proposeSignature:S}=await (0,n.makeInviteToSpecialUserGroup)(l,(0,o.makeCryptoService)(),u,d,{teamId:t,memberLogin:r});return{groupKey:p,proposeSignature:S}}async function y(e,{teamId:t}){let{wsService:r,storeService:o}=e,s=(0,a.getCurrentUserInfo)(o),c=o.getTeamAdminData(),l=(0,n.getAdminDataFromTeamAdminData)(c,String(t)),{revision:u}=await (0,i.loadSpecialUserGroup)(r,s.login,s.uki,l);return{specialUserGroupRevision:u}}t.getMembers=d,t.proposeMembers=p,t.addTeamAdmin=S,t.removeTeamAdmin=g,t.getSpecialUserGroupInviteValuesForMemberInTeam=m,t.getSpecialUserGroupRevision=y},63296:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.getUserGroupKey=t.syncUserGroupManagementForAllTeams=void 0;let a=r(5768),o=r(72331),n=r(94227),i=r(21726),s=r(70900);t.syncUserGroupManagementForAllTeams=function(e,t,r,c,l,u,d){let p=(0,o.syncAdministrableTeamList)(l,d);return Promise.all(Object.keys(p.teams).map(l=>{var d,S,g,m,y,f;return d=e,S=t,g=r,m=c,y=p.teams[l],f=u,Promise.resolve(y).then(e=>(0,o.syncAdminData)(S,g,e,f)).then(e=>(0,a.setupUserGroupManagement)(d,g,m,e)).then(e=>e.status===n.SyncUserGroupManagementStatus.NEEDS_FRESH_SHARING_DATA?e:(0,i.filterOutInvalidUserGroupUsers)(d.crypto,e.adminData).then(e=>(0,s.sendUserGroupInvitesToNewUsers)(d,g,e)).then(e=>({status:n.SyncUserGroupManagementStatus.COMPLETE,adminData:e})))})).then(e=>{let t={};return e.map(e=>e.adminData).forEach(e=>{t[e.teamId]=e}),{status:e.some(e=>e.status===n.SyncUserGroupManagementStatus.NEEDS_FRESH_SHARING_DATA)?n.SyncUserGroupManagementStatus.NEEDS_FRESH_SHARING_DATA:n.SyncUserGroupManagementStatus.COMPLETE,teamAdminData:{teams:t}}})},t.getUserGroupKey=function(e,t){if(!e)return null;let r=e.find(e=>e.groupId===t);return r?r.groupKey:null}},50897:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.getUserGroupAdminItemsFromMigration=t.createItemsForUserGroups=void 0;let a=r(61681),o=r(24592);async function n(e,t,r){let a=r.users.find(e=>e.userId===t.login);if(!a)throw Error("Couldnt find self in user group");return await e.asymmetricEncryption.decrypt(t.privateKey,a.groupKey)}async function i(e,t,r){let a=await e.symmetricEncryption.generateNewAESKey(),[n,i]=await Promise.all([e.symmetricEncryption.encryptAES256(a,o.encode(JSON.stringify(r))),e.symmetricEncryption.encryptAES256(t,o.encode(a))]);return{itemId:r.itemId,itemKey:i,content:n}}async function s(e,t,r){return{itemId:(0,a.generateItemUuid)(),groupId:r.groupId,groupKey:await n(e,t,r)}}async function c(e,t,r){return await Promise.all(r.map(r=>i(e,t,r)))}async function l(e,t,r){return await Promise.all((r.userGroups||[]).map(r=>s(e,t,r)))}t.createItemsForUserGroups=c,t.getUserGroupAdminItemsFromMigration=l},70900:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.sendUserGroupInvitesToNewUsers=void 0;let a=r(80896),o=r(22560),n=r(63296);function i(e){return e.users.filter(e=>"publicKey"===e.rsaStatus)}t.sendUserGroupInvitesToNewUsers=function(e,t,r){return Promise.resolve().then(()=>{var e;return(e=r).userGroups?e.userGroups.reduce((e,t)=>e.concat(i(t)),[]):[]}).then(s=>s.length?(function(e,t,r){let{login:a,uki:o}=t,n=JSON.stringify(r.map(e=>e.alias));return e.userGroup.findUsersByAliases({login:a,uki:o,aliases:n})})(e,t,s).then(s=>Promise.all(r.userGroups.map(c=>{var l;let u=i(c);if(!u.length)return Promise.resolve(c);let d=(l=s,u.map(e=>({Alias:e.alias,Login:l[e.alias].login,PublicKey:l[e.alias].publicKey,Permission:e.permission}))),p=(0,n.getUserGroupKey)(r.userGroupAdminItems,c.groupId);return e.userGroup.makeUpdateMembersWithInviteEvent(c.groupId,p,c.revision,d).then(r=>e.userGroup.updateUserGroupMembers(t,r)).then(e=>e[0]).catch(e=>{let t=Error(`[sendUserGroupInvitesToNewUsers] - Cannot send update event for one user group - groupId: ${c.groupId} - error: ${e}`);return o.default.error(t),(0,a.sendExceptionLog)({error:t}),c})})).then(e=>({...r,userGroups:e}))):r)}},5768:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.createSpecialGroups=t.setupUserGroupManagement=void 0;let a=r(22560),o=r(38947),n=r(4729),i=r(50897),s=r(94227);function c(e,t,r,n){return a.Debugger.log("setting up group sharing for team: "+n.teamId),Promise.resolve(n).then(a=>a.specialUserGroup?a:(0,o.createSpecialUserGroup)(e,t,r,Number(a.teamId)).then(e=>Object.assign({},a,{specialUserGroup:e}))).then(r=>r.specialItemGroup?r:(0,i.getUserGroupAdminItemsFromMigration)(e.crypto,t,n).then(a=>(0,o.createSpecialItemGroup)(e,t,r.specialUserGroup,a).then(e=>Object.assign({},r,{specialItemGroup:e,userGroupAdminItems:a}))))}t.setupUserGroupManagement=function(e,t,r,a){let o=a.specialUserGroup,i=a.specialItemGroup;if(!o)return i?Promise.reject(Error("UserGroupManagementSetupService - no special user group, but a special item group is present")):c(e,t,r,a).then(e=>({status:s.SyncUserGroupManagementStatus.COMPLETE,adminData:e}));let l=(0,n.getUserInUserGroup)(t.login,o);return l?"pending"===l.status?i?Promise.reject(Error("UserGroupManagementSetupService - special user group is not accepted, but a special item group is present")):Promise.resolve().then(()=>e.userGroup.isCurrentUserProposeSignatureValid(t,o)).then(e=>{if(!e)throw Error("UserGroupManagementSetupService - INVALID_PROPOSE_SIGNATURE")}).then(()=>e.userGroup.makeAcceptUserGroupEvent(t,o)).then(r=>e.userGroup.acceptUserGroup(t,r)).then(({userGroups:e})=>{if(1!==e.length)throw Error(`UserGroupManagementSetupService - Invalid response from UserGroupService.acceptUserGroup - ${e}`);return e[0]}).then(e=>Object.assign({},a,{specialUserGroup:e})).then(e=>({status:s.SyncUserGroupManagementStatus.NEEDS_FRESH_SHARING_DATA,adminData:e})):"accepted"===l.status?i?Promise.resolve({status:s.SyncUserGroupManagementStatus.COMPLETE,adminData:a}):c(e,t,r,a).then(e=>({status:s.SyncUserGroupManagementStatus.COMPLETE,adminData:e})):Promise.reject(Error("UserGroupManagementSetupService - current user status in special user group is neither accepted or pending")):Promise.reject(Error("UserGroupManagementSetupService - Current user us missing from special user group"))},t.createSpecialGroups=c},72331:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.loadSpecialUserGroup=t.loadSpecialItemGroup=t.syncAdminDataFromSharingData=t.createUserGroupAdminItemInState=t.deleteAdministrableUserGroups=t.updateAdministrableUserGroupList=t.updateTeamAdminData=t.filterTeamAdminData=t.syncAdminData=t.syncAdministrableTeamList=t.getUserGroupDescriptionsForTeam=void 0;let a=r(38947),o=r(63743),n=r(27698),i=r(4729),s=r(46902),c=r(67972),l=r(4790);function u(e,t,r,a){return e.teamPlans.findUserGroups({login:t,uki:r,teamId:a}).then(e=>e.content.userGroups)}async function d(e,t,r,a){let o=await m(t,r,a);return o.specialUserGroup&&!(0,i.hasUserAcceptedUserGroup)(t.login,o.specialUserGroup)?o:y(e,t.login,t.uki,o)}function p(e){let t={};return Object.keys(e.teams).forEach(r=>{let a=e.teams[r];if(!a){t[r]={teamId:r};return}t[r]={teamId:r,userGroups:a.userGroups||[],notifications:a.notifications||{accountRecoveryRequests:[]}}}),{teams:t}}async function S(e,t,r){let a=(0,c.makeCryptoService)(),{specialItemGroup:o,specialItems:n}=r,{userGroupAdminItems:s,directorySyncKey:l,encryptionServiceData:u,ssoConnectorKey:d,scimSignatureKey:p,adminProvisioningKey:S,massDeploymentTeamKey:m}=g(await Promise.all(o?.items?.map(({itemId:r,itemKey:o})=>{let s=n[r];if(!s)throw Error("Unexpected error: missing itemKey");return i.decryptAdminItem(a,e,t,s,o)})??[]));return{...t,userGroupAdminItems:s,directorySyncKey:l,encryptionServiceData:u,ssoConnectorKey:d,scimSignatureKey:p,adminProvisioningKey:S,massDeploymentTeamKey:m}}t.getUserGroupDescriptionsForTeam=u,t.syncAdministrableTeamList=function(e,t){let r={},a=(0,l.getNodePremiumStatusSpaceData)(t),o=a.spaces.filter(e=>(0,l.hasSpecialUserGroupAccessInSpace)(e.teamId,a)).map(e=>e.teamId);return Object.keys(e.teams).filter(e=>!!e).filter(e=>o.includes(e)).forEach(t=>{r[t]=e.teams[t]}),o.forEach(e=>{r[e]||(r[e]={teamId:e})}),{teams:r}},t.syncAdminData=d,t.filterTeamAdminData=p,t.updateTeamAdminData=function(e,t){e.dispatch((0,o.teamAdminDataUpdated)(t)),(0,n.sendTeamAdminDataUpdate)(p(t))},t.updateAdministrableUserGroupList=function(e,t,r){e.dispatch((0,o.userGroupsUpdated)(t,r)),(0,n.sendTeamAdminDataUpdate)(p(e.getTeamAdminData()))},t.deleteAdministrableUserGroups=function(e,t,r){e.dispatch((0,o.userGroupsDeleted)(t,r)),(0,n.sendTeamAdminDataUpdate)(p(e.getTeamAdminData()))},t.createUserGroupAdminItemInState=function(e,t,r){e.dispatch((0,o.userGroupAdminItemCreated)(t,r))};let g=e=>e.reduce((e,t)=>((0,i.isUserGroupAdminItem)(t)?e.userGroupAdminItems.push(t):(0,i.isDirectorySyncKey)(t)?e.directorySyncKey=t:(0,i.isEsBasicConfigsData)(t)?e.encryptionServiceData=t:(0,i.isSSOConnectorKey)(t)?e.ssoConnectorKey=t:(0,i.isSCIMSignatureKey)(t)?e.scimSignatureKey=t:(0,i.isAdminProvisioningKey)(t)?e.adminProvisioningKey=t:(0,s.isMassDeploymentTeamKey)(t)&&(e.massDeploymentTeamKey=t),e),{userGroupAdminItems:[],directorySyncKey:null,encryptionServiceData:null,ssoConnectorKey:null,scimSignatureKey:null,adminProvisioningKey:null,massDeploymentTeamKey:null});async function m(e,t,r){return S(e,function(e,t){let{specialItemGroup:r,specialUserGroup:a}=t;return{...e,specialItemGroup:r,specialUserGroup:a}}(t,r),r)}async function y(e,t,r,o){let n={items:[],itemGroups:[],userGroups:(await u(e,t,r,Number(o.teamId))).map(e=>({id:e.groupId,revision:e.revision}))},i={items:[],itemGroups:[],userGroups:(o.userGroups||[]).filter(e=>!!e)},s=await (0,a.buildSharingData)(e,t,r,n,i);return{...o,userGroups:s.userGroups}}async function f(e,t,r,o){if(!o.specialItemGroup||!o.specialItemGroup.groupId)throw Error("specialItemGroup is missing from adminData");let{itemGroups:n}=await (0,a.getSharedData)(e,t,r,{itemIds:[],itemGroupIds:[o.specialItemGroup.groupId],userGroupIds:[]});if(n&&1===n.length)return n[0];throw Error("could not fetch specialItemGroup")}async function E(e,t,r,o){let{userGroups:n}=await (0,a.getSharedData)(e,t,r,{itemIds:[],itemGroupIds:[],userGroupIds:o.specialUserGroup?.groupId?[o.specialUserGroup.groupId]:[]});if(n&&1===n.length)return n[0];throw Error("Could not fetch specialUserGroup")}t.syncAdminDataFromSharingData=m,t.loadSpecialItemGroup=f,t.loadSpecialUserGroup=E},94227:function(e,t){var r;Object.defineProperty(t,"__esModule",{value:!0}),t.SyncUserGroupManagementStatus=void 0,(r=t.SyncUserGroupManagementStatus||(t.SyncUserGroupManagementStatus={}))[r.NEEDS_FRESH_SHARING_DATA=0]="NEEDS_FRESH_SHARING_DATA",r[r.COMPLETE=1]="COMPLETE"},21726:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.filterOutInvalidUserGroupUsers=void 0;let a=r(86527),o=r(63296);t.filterOutInvalidUserGroupUsers=function(e,t){return t.userGroups?Promise.all(t.userGroups.map(r=>{var n,i,s;return(n=e,i=(0,o.getUserGroupKey)(t.userGroupAdminItems,r.groupId),Promise.all((s=r.users).map(e=>{if("refused"===e.status||"revoked"===e.status)return Promise.resolve(!0);if(!e.proposeSignature||null===i)return Promise.resolve(!1);let t=e.proposeSignatureUsingAlias?e.alias:e.userId;return(0,a.isProposeSignatureValid)(n,e.proposeSignature,t,i)})).then(e=>s.filter((t,r)=>e[r]))).then(e=>({...r,users:e}))})).then(e=>({...t,userGroups:e})):Promise.resolve(t)}},4729:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.findTeamForGroup=t.syncUserGroupManagement=t.isAdminProvisioningKey=t.isSCIMSignatureKey=t.isSSOConnectorKey=t.isEsBasicConfigsData=t.isDirectorySyncKey=t.isUserGroupAdminItem=t.decryptAdminItem=t.getUserGroup=t.getUserGroupAdminItem=t.getSpecialItemGroupKey=t.getSpecialItemGroupFromAdminData=t.getAdminDataFromTeamAdminData=t.makeInviteToSpecialUserGroup=t.getPublicKeyForUser=t.encryptGroupKeyForUser=t.getSpecialUserGroupPrivateKey=t.getSpecialUserGroupKey=t.hasUserAcceptedUserGroup=t.getUserInUserGroup=t.getSpecialUserGroup=void 0;let a=r(38947),o=r(12610),n=r(86527),i=r(76417),s=r(63296),c=r(72331),l=r(66879);function u(e){return e.specialUserGroup}function d(e,t,r){let a=u(r);if(!a)throw Error("specialUserGroup is not available in adminData");let o=a.users.find(e=>e.userId===t.login);if(!o)throw Error("couldnt find self in specialUserGroup users");return(0,i.decryptGroupKey)(e,t,o.groupKey)}async function p(e,t,r){let a=await d(e,t,r),o=u(r);return await e.symmetricEncryption.decryptAES256(a,o.privateKey)}function S(e,t,r){return e.asymmetricEncryption.encrypt(t,r)}function g(e,t,r){return e.userGroup.findExistingUsersByAliases({login:t.login,uki:t.uki,aliases:(0,a.extractAliasesFromMembers)([{Alias:r}])}).then(e=>e[r].publicKey)}function m(e,t){return e.teams[t]}function y(e){return e.specialItemGroup}async function f(e,t,r){let a=y(r);if(!a)throw Error("specialItemGroup is not available in adminData");let o=await p(e,t,r),n=u(r).groupId,i=a.groups.find(e=>e.groupId===n);if(!i)throw Error("couldnt find specialUserGroup in specialItemGroup groups");return e.asymmetricEncryption.decrypt(o,i.groupKey)}async function E(e,t,r,a,o){let n=await f(e,t,r),i=await e.symmetricEncryption.decryptAES256(n,o);return{...JSON.parse(await e.symmetricEncryption.decryptAES256(i,a.content)),itemId:a.itemId}}t.getSpecialUserGroup=u,t.getUserInUserGroup=function(e,t){return t.users.find(t=>t.userId===e)},t.hasUserAcceptedUserGroup=function(e,t){return t.users.some(t=>t.userId===e&&"accepted"===t.status)},t.getSpecialUserGroupKey=d,t.getSpecialUserGroupPrivateKey=p,t.encryptGroupKeyForUser=S,t.getPublicKeyForUser=g,t.makeInviteToSpecialUserGroup=function(e,t,r,a,{teamId:o,memberLogin:i,publicKey:s}){let c=m(a,String(o)),l=s?Promise.resolve(s):g(e,r,i);return Promise.all([d(t,r,c),l]).then(([e,r])=>Promise.all([S(t,r,e),(0,n.generateProposeSignature)(t,e,i)])).then(([e,t])=>({groupKey:e,proposeSignature:t,userGroupRevision:u(c).revision}))},t.getAdminDataFromTeamAdminData=m,t.getSpecialItemGroupFromAdminData=y,t.getSpecialItemGroupKey=f,t.getUserGroupAdminItem=function(e,t,r){return(m(e,t).userGroupAdminItems||[]).find(e=>e.groupId===r)},t.getUserGroup=function(e,t){return Object.keys(e.teams).map(t=>e.teams[t]&&e.teams[t].userGroups).reduce((e,t)=>t.concat(e),[]).find(e=>e.groupId===t)},t.decryptAdminItem=E,t.isUserGroupAdminItem=function(e){return"groupId"in e},t.isDirectorySyncKey=function(e){return"publicKey"in e},t.isEsBasicConfigsData=e=>"basicConfigs"in e,t.isSSOConnectorKey=e=>"ssoConnectorKey"in e,t.isSCIMSignatureKey=e=>"scimSignatureKey"in e,t.isAdminProvisioningKey=e=>"adminProvisioningKey"in e,t.syncUserGroupManagement=function(e,t,r){let a=e.getSpaceData(),n=e.getTeamAdminData(),i=(0,o.getCurrentUserInfo)(e),u=(0,l.makeSharingService)(e,t);return i.privateKey?(0,s.syncUserGroupManagementForAllTeams)(u,t,(0,o.getCurrentUserInfo)(e),a,n,r,e).then(t=>((0,c.updateTeamAdminData)(e,t.teamAdminData),t.status)):Promise.reject(Error("PRIVATE_KEY_MISSING"))},t.findTeamForGroup=function(e,t){let r=Object.keys(e.teams).find(r=>e.teams[r].userGroups.some(e=>e.groupId===t));return r&&e&&e.teams&&e.teams[r]}},13676:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.getRecoveryCodesAsTeamCaptain=void 0;let a=r(20648),o=r(28323),n=r(61767),i=r(93748),s=e=>{switch(e.code){case n.GetRecoveryCodesAsTeamCaptainNotAdminErrorCode:return a.GetRecoveryCodesAsTeamCaptainErrorCode.NotAdmin;case n.GetRecoveryCodesAsTeamCaptainInternalErrorCode:return a.GetRecoveryCodesAsTeamCaptainErrorCode.InternalError;default:return a.GetRecoveryCodesAsTeamCaptainErrorCode.UnknownError}};async function c(e,t){let{storeService:r}=e,a=(0,i.userLoginSelector)(r.getState()),c=await (0,n.getRecoveryCodesAsTeamCaptain)(r,a,t);return(0,o.isApiError)(c)?{success:!1,error:{code:s(c)}}:{success:!0,data:{recoveryCodes:c.recoveryCodes}}}t.getRecoveryCodesAsTeamCaptain=c},76369:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.currentSpaceInfoSelector=t.currentTeamIdSelector=t.adminDataForTeamSelector=void 0;let r=e=>e.userSession.teamAdminData;t.adminDataForTeamSelector=(e,t)=>{let a=r(e);return a.teams?a.teams[t]:void 0},t.currentTeamIdSelector=e=>{let t=e.userSession.spaceData.spaces.find(e=>"accepted"===e.details.status);if(t)return t.teamId},t.currentSpaceInfoSelector=e=>{let t=e.userSession.spaceData.spaces.find(e=>"accepted"===e.details.status);if(t)return t.info}},86363:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.makeTeamAdminController=void 0;let a=r(66879),o=r(12610),n=r(51621),i=r(72331),s=r(38947),c=r(4729),l=r(29256),u=r(63743);function d(e,t,r){return n.proposeMembers(t,(0,o.getCurrentUserInfo)(e),r)}function p(e,t){return(0,c.getUserGroup)(e.getTeamAdminData(),t)}t.makeTeamAdminController=(e,t)=>({getMembers:t=>{var r,a;return r=e,a=t,n.getMembers(r,(0,o.getCurrentUserInfo)(r).login,a)},proposeMembers:r=>d(e,t,r),addTeamAdmin:r=>(function(e,t,r){if(!e.isAuthenticated())return(0,s.emptySessionResponse)(r);let o=(0,a.makeSharingService)(e,t);return n.addTeamAdmin(o,r).catch(e=>({error:e}))})(e,t,r),removeTeamAdmin:r=>(function(e,t,r){if(!e.isAuthenticated())return(0,s.emptySessionResponse)(r);let o=(0,a.makeSharingService)(e,t);return n.removeTeamAdmin(o,r).catch(e=>({error:e}))})(e,t,r),createUserGroupAction:(r,n)=>(function(e,t,r,n){if(!e.isAuthenticated())return(0,s.emptySessionResponse)(n);let c=(0,a.makeSharingService)(e,r),l=(0,o.getCurrentUserInfo)(e),d=e.getTeamAdminData();return(0,s.createUserGroup)(c,l,d,n).then(r=>{if(Array.isArray(r.itemGroups)&&r.itemGroups.length>0){let t=r.itemGroups[0],a=String(t.teamId),o=(0,u.specialItemGroupUpdated)(a,t);e.dispatch(o)}let a=n.teamId,o=e.getTeamAdminData().teams[a]&&e.getTeamAdminData().teams[a].userGroups||[];return(0,i.updateAdministrableUserGroupList)(e,a.toString(),o.concat(r.userGroups)),r.userGroupAdminItem&&((0,i.createUserGroupAdminItemInState)(e,a.toString(),r.userGroupAdminItem),t.getInstance().user.persistTeamAdminData().then(()=>r)),r}).then(e=>({userGroups:e.userGroups,error:e.error}))})(e,r,t,n),deleteUserGroupAction:r=>(function(e,t,r){if(!e.isAuthenticated())return(0,s.emptySessionResponse)(r);let n=(0,a.makeSharingService)(e,t),c=(0,o.getCurrentUserInfo)(e),l=p(e,r.groupId);return(0,s.deleteUserGroup)(n,c,e.getTeamAdminData(),r).then(({userGroups:t,itemGroups:r})=>{let a=r[0],o=String(a.teamId),n=(0,u.specialItemGroupUpdated)(o,a);return e.dispatch(n),(0,i.deleteAdministrableUserGroups)(e,String(l.teamId),t),{userGroups:t}})})(e,t,r),renameUserGroupAction:r=>(function(e,t,r){if(!e.isAuthenticated())return(0,s.emptySessionResponse)(r);let n=(0,a.makeSharingService)(e,t),c=(0,o.getCurrentUserInfo)(e);return(0,s.renameUserGroup)(n,c,r).then(({userGroups:t})=>{if(t&&1===t.length){let a=String(t[0].teamId),o=(e.getTeamAdminData().teams[a]&&e.getTeamAdminData().teams[a].userGroups||[]).map(e=>e.groupId===r.groupId&&t[0]||e);(0,i.updateAdministrableUserGroupList)(e,a,o)}return{userGroups:t}})})(e,t,r),inviteUserGroupMembersAction:(r,n)=>(function(e,t,r,n){if(!e.isAuthenticated())return(0,s.emptySessionResponse)(r);let c=(0,a.makeSharingService)(e,t),l=(0,o.getCurrentUserInfo)(e),u=e.getTeamAdminData(),S=p(e,r.groupId),g={};return r.users.forEach(e=>g[e.alias]=e),d(e,t,{proposedMemberLogins:Object.keys(g),teamId:r.teamId,origin:"teamInviteUserGroupUsers",notificationOptions:{skipAccountCreationRequiredAlerts:!0,skipReproposals:n}}).then(t=>{let a=Object.keys(t.proposedMembers).map(e=>g[e]);t.accountCreationRequiredMembers.forEach(e=>a.push(g[e]));let o={};if(Object.keys(t.refusedMembers).forEach(e=>{let r=t.refusedMembers[e];if("already_member"===r){a.push(g[e]);return}o[e]=r}),0===a.length)return{userGroups:[S],refusedMembers:o};let n={...r,users:a};return(0,s.inviteUserGroupMembers)(c,l,u,n,S).then(t=>{if(t.error)return t;let a=String(t.userGroups[0].teamId),n=(e.getTeamAdminData().teams[a]&&e.getTeamAdminData().teams[a].userGroups||[]).map(e=>e.groupId===r.groupId&&t.userGroups&&t.userGroups[0]||e);return(0,i.updateAdministrableUserGroupList)(e,String(S.teamId),n),{...t,refusedMembers:o}})}).catch(e=>{if(e?.additionalInfo?.code===400)return Promise.resolve({refusedMembers:{},userGroups:[],error:{message:e.additionalInfo?.webServiceSubMessage||"unknown error"}});throw e})})(e,t,r,n),revokeUserGroupMembersAction:r=>(function(e,t,r){if(!e.isAuthenticated())return(0,s.emptySessionResponse)(r);let n=(0,a.makeSharingService)(e,t),c=(0,o.getCurrentUserInfo)(e);return(0,s.revokeUserGroupMembers)(n,c,r).then(t=>{if(t&&t.userGroups&&1===t.userGroups.length){let a=t.userGroups[0],o=(e.getTeamAdminData().teams[a.teamId]&&e.getTeamAdminData().teams[a.teamId].userGroups||[]).map(e=>e.groupId===r.groupId&&t.userGroups&&t.userGroups[0]||e);(0,i.updateAdministrableUserGroupList)(e,String(a.teamId),o)}return t})})(e,t,r),updateUserGroupMembersAction:r=>(function(e,t,r){if(!e.isAuthenticated())return(0,s.emptySessionResponse)(r);let n=(0,a.makeSharingService)(e,t),i=(0,o.getCurrentUserInfo)(e);return(0,s.updateUserGroupMembers)(n,i,r)})(e,t,r),teamUpdateHandler:t=>{var r,a;return r=e,a=t,Promise.resolve().then(()=>{if(!r.isAuthenticated())return[Error("no session set")];if(["adminPromoted","adminDemoted"].includes(a.action)&&(()=>{let e=r.getSpaceData().spaces.map(e=>{if(e.details.teamId!==a.teamId.toString())return e;let t=function(e,t){let{teamAdmins:r}=e.details;switch(t.action){case"adminPromoted":return r.concat(t.users.map(e=>({login:e})));case"adminDemoted":return r.filter(e=>!t.users.includes(e.login));default:return r}}(e,a);return Object.assign({},e,{details:Object.assign({},e.details,{teamAdmins:t})})});(0,l.updateSpaceData)(r,e)})(),"memberRevoked"===a.action){let e=r.getTeamAdminData().teams[a.teamId],t=(e.userGroups||[]).map(e=>Object.assign({},e,{users:e.users.filter(e=>!a.users.includes(e.alias))}));(0,i.updateAdministrableUserGroupList)(r,e.teamId,t)}return null})},confirmFreeTrial:e=>{var r,a;return r=t,a=e,r.teamPlans.confirmFreeTrial({token:a})},getPremiumStatus:e=>{var r,a;return r=t,a=e,r.premium.status(a)},getTeamTokens:()=>(function(e,t){let r=e.getUserLogin();return t.qa.tokens({login:r})})(e,t),registerFreeTrial:e=>{var r,a;return r=t,a=e,r.teamPlans.registerFreeTrial(a)},acceptTeamInvite:e=>(function(e,t){let{token:r}=t;return e.teamPlans.acceptTeam({token:r})})(t,e)})},4978:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.bootstrap=void 0;let a=r(11527);t.bootstrap=e=>{e.register(a.config)}},27594:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.createOrUpdateSpecialItem=void 0;let a=r(83533),o=r(61681),n=r(12610),i=r(82901),s=r(4729),c=r(76369),l=async(e,t,r)=>{let{storeService:l,sessionService:u}=e;(0,i.requireAdmin)(l);let d=(0,c.currentTeamIdSelector)(l.getState()),p=(0,c.adminDataForTeamSelector)(l.getState(),d),S=(0,n.getCurrentUserInfo)(l),{crypto:g,item:m,ws:y}=t,{specialItemGroup:f}=p;if(!f)throw Error("Cannot find specialItemGroup in adminData");let E=await (0,s.getSpecialItemGroupKey)(g,S,p),A=(0,o.generateItemUuid)(),h=await g.symmetricEncryption.generateNewAESKey(),_=await g.symmetricEncryption.encryptAES256(E,btoa(h)),T=await g.symmetricEncryption.encryptAES256(h,btoa(JSON.stringify(r))),v=await m.makeItemUpload(A,_,T),I=await m.makeAddItemsEvent(f.groupId,f.revision,[v]),D=await m.addItems(y,S.login,S.uki,I);if(!D?.items?.find(({itemId:e})=>e===A))throw Error("unable to persist item");return await u.getInstance().user.attemptSync(a.Trigger.SettingsChange),r};t.createOrUpdateSpecialItem=l},50388:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.bootstrap=t.setupSubscriptions=void 0;var a=r(92668);Object.defineProperty(t,"setupSubscriptions",{enumerable:!0,get:function(){return a.setupSubscriptions}});var o=r(4978);Object.defineProperty(t,"bootstrap",{enumerable:!0,get:function(){return o.bootstrap}})},18926:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.removeTeamAdminItem=void 0;let a=r(66879),o=r(12610),n=r(76369),i=r(83533),s=async({storeService:e,sessionService:t,wsService:r},s)=>{let c=(0,a.makeSharingService)(e,r),l=(0,o.getCurrentUserInfo)(e),u=(0,n.currentTeamIdSelector)(e.getState()),d=(0,n.adminDataForTeamSelector)(e.getState(),u),{specialItemGroup:p}=d,{item:S,ws:g}=c;if(!p)throw Error("Cannot find specialItemGroup in adminData");let{revision:m,groupId:y}=p,f=d[s];if(!f)return{success:!0};let{itemId:E}=f,A=await S.makeRemoveItemsEvent(y,m,[E]);return await S.removeItems(g,l.login,l.uki,A),await t.getInstance().user.attemptSync(i.Trigger.SettingsChange),{success:!0}};t.removeTeamAdminItem=s},92668:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.setupSubscriptions=void 0;let a=r(66879),o=r(23440),n=r(37238);t.setupSubscriptions=function(e,t){let{sessionService:r,storeService:i,localStorageService:s,wsService:c}=t,l=(0,a.makeSharingService)(i,c),u=(0,n.makeDirectorySyncController)({sessionService:r,sharingService:l,storeService:i,localStorageService:s,wsService:c});e.syncSuccess.on(()=>{let e=i.getSpaceData();(0,o.isDirectorySyncActivated)(e)&&u.directorySyncForAllTeams()})}},79319:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.makeSessionService=void 0;let a=r(98215),o=r(12735),n=r(64833),i=r(72802),s=r(88910);t.makeSessionService=e=>{let t=null,r=null,c=null,l=(e=!0)=>t?t.closeSession(e):Promise.resolve(),u=()=>t?t.lockSession():Promise.resolve();return{isSessionStarted:()=>{let{storeService:t}=e,r=t.getState();return!!(0,n.sessionStartTimeSelector)(r)},setInstance:(n,i)=>{t=(0,a.makeUserSessionService)(e,n,i),r=(0,s.makeUserDeviceService)(e),c=(0,o.makeUserPaymentService)(e.storeService,e.wsService)},close:(e=!0)=>l(e).then(()=>{t=null,r=null,c=null}),lock:()=>u().then(()=>{t=null,r=null,c=null}),tryRestoreInstance:()=>{let{storeService:l}=e,u=l.getState();if(!(0,n.sessionIdSelector)(u)){(0,i.setupEncryptorServices)(e);return}t=(0,a.makeResumedUserSessionService)(e),r=(0,s.makeUserDeviceService)(e),c=(0,o.makeUserPaymentService)(e.storeService,e.wsService)},getInstance:()=>{if(!t)throw Error("makeSessionService: You must call setInstance(login: string, password: string) before getting the instance");return{user:t,device:r,payment:c}}}}},88910:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.makeUserDeviceService=void 0;let a=r(77323),o=r(95121);t.makeUserDeviceService=({deviceManagementClient:e})=>({fetchDevicesList:()=>n(e),deactivateDevice:t=>i(e,t),changeDeviceName:(t,r)=>s(e,t,r)});let n=async e=>{let t=await (0,o.firstValueFrom)(e.queries.listAuthorisedDevice());return(0,a.isSuccess)(t)?t.data:t.error},i=async(e,t)=>{await e.commands.revokeAuthorisedDevice({deviceId:t})},s=async(e,t,r)=>{await e.commands.renameAuthorisedDevice({deviceId:t,updatedName:r})}},12735:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.makeUserPaymentService=void 0;let a=r(27762),o=r(12709),n=r(28323);t.makeUserPaymentService=(e,t)=>({fetchInvoices:()=>i(e),updatePaymentCard:(r,a)=>s(e,t,r,a),cancelPremiumSubscription:()=>c(e,t)});let i=async e=>{let t=e.getAccountInfo().login,r=await (0,o.listInvoices)(e,t);return(0,n.isApiError)(r)?[]:r.invoices},s=(e,t,r,o)=>{let n=e.getAccountInfo().login,i=(0,a.ukiSelector)(e.getState());return t.premium.updateCardToken({login:n,uki:i,tokenId:r,stripeAccount:o}).then(e=>({success:e.success&&!e.error,reason:e.error?e.error.message:null}))},c=(e,t)=>{let r=e.getAccountInfo().login,o=(0,a.ukiSelector)(e.getState());return t.premium.setAutoRenewal({login:r,uki:o,enabled:!1}).then(()=>{})}},98215:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.generateRsaKeys=t.treatKeysResult=t.isSyncInProgress=t.storeSync=t.hasTreatProblems=t.makeResumedUserSessionService=t.makeUserSessionService=t.ON_USER_SESSION_CLOSED=void 0;let a=r(95121),o=r(83533),n=r(20648),i=r(77323),s=r(34978),c=r(27698),l=r(92830),u=r(4544),d=r(22560),p=r(93625),S=r(33170),g=r(73614),m=r(87829),y=r(75795),f=r(30111),E=r(30350),A=r(94227),h=r(67972),_=r(4455),T=r(80896),v=r(49789),I=r(36598),D=r(63743),P=r(4729),O=r(32395),C=r(33727),b=r(30029),R=r(63011),N=r(99882),w=r(58682),L=r(92846),U=r(29509),M=r(63484),F=r(77010),k=r(21486),K=r(22198),B=r(813),G=r(93748),j=r(50666),V=r(10303),W=r(56517),H=r(37313),x=r(98770),Y=r(92126),q=r(84495),$=r(5485),Q=r(43747),z=r(43392),X=r(96332),J=r(28323),Z=r(10039),ee=r(76219),et=r(33161),er=r(18040),ea=r(79683),eo=r(16659),en=r(72802),ei=r(63860),es=r(21837),ec=r(67711),el=r(64419),eu=r(70546);t.ON_USER_SESSION_CLOSED="OnUserSessionClosed";let ed=(e,t,r=!1)=>{let a;e.localStorageService.setInstance(t),r&&e.storeService.dispatch((0,l.openSession)(t));let o=(0,er.getNoDerivationCryptoConfig)();e.teamDeviceEncryptedConfigEncryptorService.setInstance({raw:e.storeService.getUserSession().masterPassword},e.storeService.getUserSession().serverKey,o),(0,en.setupEncryptorServices)(e),e.localStorageService.setInstance(t);let n=e.cryptoService||(0,h.makeCryptoService)(),i=new W.LocalStorageEventStore(e.localStorageService);(0,H.setInstance)(i),(0,x.setInstance)(i),(0,Q.setInstance)(e.storeService,e.localStorageService,e.wsService);let s=null,c=()=>{if(null!==s)return;let{storeService:t,wsService:r}=e;s=setInterval(()=>{(0,eo.refreshTwoFactorAuthenticationInfoService)(t,r)},ea.ENFORCE_2FA_POLICY_REFRESH_TIMER_INTERVAL)},u=()=>{clearInterval(s)};return a=e.storeService.getUserSession(),e.storeService.getStore().subscribe(()=>{let t=e.storeService.getUserSession();t!==a&&(a.masterPassword!==t.masterPassword||a.serverKey!==t.serverKey)&&""!==t.masterPassword&&(d.Debugger.log("Master Password || Server Key updated"),t.masterPassword||t.serverKey?e.masterPasswordEncryptorService.setInstance({raw:t.masterPassword},t.serverKey):e.masterPasswordEncryptorService.close(),a=t)}),{loadSessionData:()=>eD(e.localStorageService,e.storeService),loadNonResumableSessionData:()=>eP(e.localStorageService,e.storeService),accountExistsLocally:()=>e_(e),refreshSessionData:()=>eq(e,t),getSyncArgs:()=>eT(e.storeService,e.masterPasswordEncryptorService,e.wsService),sync:t=>ek(e,n,u,t),attemptSync:t=>em(e,n,u,t),requestNewSync:t=>eh(e,n,u,t),startPeriodic2FAInfoRefresh:()=>c(),stopPeriodic2FAInfoRefresh:()=>u(),refreshContactInfo:()=>eY(e.storeService,e.wsService),fetchSubscriptionCode:()=>(function(e,t){let r=e.getAccountInfo().login,a=(0,U.ukiSelector)(e.getState());return t.premium.getSubscriptionCode({login:r,uki:a}).then(t=>{let r=t&&t.content&&t.content.subscriptionCode;return e.dispatch((0,b.saveSubscriptionCode)(r)),r})})(e.storeService,e.wsService),persistLocalSettings:()=>ej(e.localStorageService,e.storeService),persistPersonalData:()=>eV(e.localStorageService,e.storeService),persistPersonalSettings:()=>eW(e.localStorageService,e.storeService),persistAllData:()=>ex(e.localStorageService,e.storeService),persistTeamAdminData:()=>eH(e.localStorageService,e.storeService),persistLocalKey:t=>e.localStorageService.getInstance().storeLocalKey(t),closeSession:(t=!0)=>eS(e,u,t),lockSession:()=>eg(e),fetchAccountInfo:()=>(function(e,t){let r=e.getUserSession(),a=r.analyticsIds,o=r.publicUserId;return a.userAnalyticsId&&a.deviceAnalyticsId&&o?Promise.resolve({userAnalyticsId:a.userAnalyticsId,deviceAnalyticsId:a.deviceAnalyticsId,publicUserId:o}):(0,X.accountInfo)(e,t).then(t=>{if((0,J.isApiError)(t)||"success"!==t.code)throw Error("Unable to fetch updated account info");return e.dispatch((0,v.updateAnalyticsIds)(t.userAnalyticsId,t.deviceAnalyticsId)),e.dispatch((0,v.updatePublicUserId)(t.publicUserId)),{userAnalyticsId:t.userAnalyticsId,deviceAnalyticsId:t.deviceAnalyticsId,publicUserId:t.publicUserId}})})(e.storeService,e.storeService.getUserLogin())}};t.makeUserSessionService=(e,t,r)=>{if(!t)throw Error(n.AuthenticationCode[n.AuthenticationCode.EMPTY_LOGIN]);let a=t.toLowerCase();if(!(0,I.isValidLogin)(a))throw Error(n.AuthenticationCode[n.AuthenticationCode.INVALID_LOGIN]);if(!r&&""===r)throw Error(n.AuthenticationCode[n.AuthenticationCode.EMPTY_MASTER_PASSWORD]);return e.storeService.dispatch((0,v.updateMasterPassword)(r)),e.storeService.dispatch((0,v.updateServerKey)("")),ed(e,a,!0)},t.makeResumedUserSessionService=e=>{let t=((0,G.userLoginSelector)(e.storeService.getState())??"").toLowerCase();if(!(0,I.isValidLogin)(t))throw Error(c.SessionResumingCode[c.SessionResumingCode.INVALID_LOGIN_IN_STORE]);return ed(e,t)};let ep=async(e,t)=>{let{storageService:r,storeService:a,eventBusService:o,sessionClient:n,pinCodeClient:i}=e;if(a.isAuthenticated()){if(t){await (0,Z.cleanRememberMeStorageData)(a,r,n);try{await i.commands.deactivate()}catch(t){let e=es.CarbonError.fromAnyError(t).addContextInfo("LOGOUT","deactivatePinCode").addAdditionalInfo({comment:"Failed to deactivate pin code on manual logout"});await (0,T.sendExceptionLog)({error:e})}}o.sessionClosed({login:null})}(0,$.clearInstance)(),(0,x.clearInstance)(),(0,H.clearInstance)(),(0,Q.clearInstance)();let{anonymousPartnerId:s,dashlaneServerDeltaTimestamp:c,appKeys:d,styxKeys:p}=a.getSdkAuthentication();a.dispatch((0,u.resetLoginStepInfo)()),a.dispatch((0,v.updateSessionDidOpen)(!1)),a.dispatch((0,l.closeSession)()),a.dispatch((0,O.loadSdkAuthentication)({anonymousPartnerId:s,dashlaneServerDeltaTimestamp:c,appKeys:d,styxKeys:p}))},eS=async(e,t,r=!0)=>{let{storeService:a}=e;a.isAuthenticated()&&(await (0,ei.waitUntilSyncComplete)(e.storeService),t()),await ep(e,!0),r&&c.triggerExtensionReload(a)},eg=async e=>{let{storeService:t}=e;if(!t.isAuthenticated()){let e=es.CarbonError.fromAnyError(Error("No user session to lock")).addContextInfo("LOCK USER SESSION","UserSessionService");throw(0,T.sendExceptionLog)({error:e}),e}await ep(e,!1),c.triggerExtensionReload(t)},em=async(e,t,r,a)=>{try{return await ek(e,t,r,a)}catch(t){let e=Error(`Sync failed: ${t}`);(0,T.sendExceptionLog)({error:e,code:n.ExceptionCriticality.WARNING})}},ey=!1,ef=()=>{},eE=Promise.resolve(),eA=()=>{eE=new Promise(e=>ef=e)},eh=async(e,t,r,a)=>{if(!ey)return ey=!0,await eE,ey=!1,em(e,t,r,a)};async function e_(e){let t=await (0,L.getLocalAccounts)(e.storeService,e.storageService),r=e.storeService.getUserLogin(),a=e.localStorageService.getInstance(),o=t.some(({login:e})=>r===e);if(o){let e=await a.doesPersonalDataExist();return!!(r&&o&&e)}let n=await a.doesLocalDataExist();return!!(r&&n)}let eT=(e,t,r,a,n)=>{let i=e.getLocalSettings(),s=e.getAccountInfo().login,c=n===o.Trigger.InitialLogin?0:i.lastSync,l=n===o.Trigger.InitialLogin?m.SyncType.FIRST_SYNC:m.SyncType.LIGHT_SYNC;return{dataEncryptorService:t,storeService:e,login:s,uki:(0,U.ukiSelector)(e.getState()),lastSyncTimestamp:c,syncType:l,personalData:e.getPersonalData(),needsKeys:!e.getUserSession().keyPair,ws:r,announce:a||(e=>{})}},ev=(e,t,r)=>Object.assign(eT(e,t,r),{lastSyncTimestamp:y.MAX_SYNC_TIMESTAMP}),eI=e=>t=>(0,T.sendExceptionLog)({message:`[Crypto] unable to ${e}. ErrorMessage: ${t}`}),eD=async(e,t)=>{let r=e.getInstance().getPersonalData().then(e=>(d.Debugger.log("Personal data has been deciphered successfully"),e)).catch(e=>((0,T.sendExceptionLog)({message:`[Crypto] unable to loadPersonalData. ErrorMessage: ${e}`}),(0,el.getEmptyPersonalDataState)())),a=e.getInstance().getLocalSettings().then(e=>(d.Debugger.log("Local settings have been deciphered successfully"),e)).catch(e=>({error:!0,logError:()=>eI("loadLocalSettings")(e)})),o=e.getInstance().getPersonalSettings().then(e=>(d.Debugger.log("Personal settings have been deciphered successfully"),e)).catch(e=>({error:!0,logError:()=>eI("loadPersonalSettings")(e)})),i=e.getInstance().doesNotificationStatusExist().then(r=>{r&&e.getInstance().getNotificationStatus().then(e=>(d.Debugger.log("Notifications status have been deciphered successfully"),t.dispatch((0,j.loadNotificationsStatus)(e)),e)).catch(e=>({error:!0,logError:()=>eI("loadNotificationsStatus")(e)}))}),s=e.getInstance().getUserABTests().then(e=>(d.Debugger.log("User AB tests have been deciphered successfully"),e)).catch(e=>({error:!0,logError:()=>eI("loadUserABTests")(e)})),u=e.getInstance().getAnalyticsIds().then(e=>((0,d.logInfo)({message:"User Analytics IDs have been deciphered successfully"}),e)).catch(e=>({error:!0,logError:()=>eI("loadAnalticsIds")(e)})),m=(0,F.loadUserAuthenticationData)(e,t),y=[r,a,o];if(await e.getInstance().hasAuthenticationData()){let e=m.then(e=>(0,k.isLoadAuthenticationSuccess)(e)||e.message===k.FailedToRehydrateAuthenticationData?{error:!1}:{error:!0,logError:()=>eI("loadAuthenticationData")(e.error)});y.push(e)}let f=await Promise.all(y),E=f.every(e=>!!e&&e.error),A=f.some(e=>!!e&&e.error);if(E)throw Error(n.AuthenticationCode[n.AuthenticationCode.WRONG_PASSWORD]);if(A)throw f.forEach(e=>!!e&&e.logError instanceof Function&&e.logError()),Error(n.AuthenticationCode[n.AuthenticationCode.DATA_TAMPERED_ERROR]);try{t.dispatch((0,p.loadStoredPersonalData)(await r));let e=await a;if(e){let r=(0,l.localSettingsUpdated)(e);t.dispatch(r),c.sendWebOnboardingModeUpdate(e.webOnboardingMode)}t.dispatch((0,S.loadStoredPersonalSettings)(await o)),t.dispatch((0,K.loadedStoredUserABTests)(await s)),t.dispatch((0,v.loadAnalyticsIds)(await u)),await m.then(e=>{if(!(0,k.isLoadAuthenticationSuccess)(e))throw e.error})}catch(t){let e=`An error occurred when trying to write personalData, localSettings or personalSettings in Redux store ${t} `;throw d.Debugger.error(e),Error(e)}let h=e.getInstance().getSharingData().then(e=>{d.Debugger.log(`sharingData loaded for ${t.getAccountInfo().login}`),t.dispatch((0,g.sharingDataUpdated)(e))}).catch(eI("loadSharingDataPromise")),_=e.getInstance().getTeamAdminData().then(e=>{d.Debugger.log(`teamAdminData loaded for ${t.getAccountInfo().login}`),t.dispatch((0,D.teamAdminDataUpdated)(e))}).catch(eI("loadTeamAdminDataPromise")),I=e.getInstance().getIcons().then(e=>{if(null!==e){let r=(0,z.IconsCacheLoaded)(e);t.dispatch(r)}}).catch(eI("loadIconsDataPromise")),P=e.getInstance().doesUserActivityExist().then(async r=>{if(r){let{lastSentAt:r}=await e.getInstance().getUserActivity();t.dispatch((0,Y.userActivityLastSentAtUpdated)(r))}}).catch(eI("loadUserActivity")),O=e.getInstance().doesVaultReportExist().then(async r=>{if(r){let{lastSentAt:r}=await e.getInstance().getVaultReport();t.dispatch((0,q.vaultReportLastSentAtUpdated)(r))}}).catch(eI("loadVaultReport"));return Promise.resolve().then(()=>{Promise.all([h,_,i,I,P,O])})},eP=async(e,t)=>{let r=e=>t=>{let r=`[Session] unable to ${e}. ErrorMessage: ${t}`;return d.Debugger.error(r),(0,T.sendExceptionLog)({message:r})},a=async(e,r)=>{await r;let a=(0,G.userLoginSelector)(t.getState());d.Debugger.log(`${e} loaded for ${a}`)},o=e.getInstance().getPersonalData().then(e=>{t.dispatch((0,p.loadStoredPersonalData)(e))}).catch(r("loadPersonalData")),n=e.getInstance().getSharingData().then(e=>{t.dispatch((0,g.sharingDataUpdated)(e))}).catch(r("loadSharingDataPromise")),i=e.getInstance().getTeamAdminData().then(e=>{t.dispatch((0,D.teamAdminDataUpdated)(e))}).catch(r("loadTeamAdminDataPromise")),s=e.getInstance().getIcons().then(e=>{if(null!==e){let r=(0,z.IconsCacheLoaded)(e);t.dispatch(r)}}).catch(r("loadIconsDataPromise"));try{await Promise.all([a("personalData",o),a("sharingData",n),a("teamAdminData",i),a("iconsCacheData",s)])}catch(r){let e="Failed to load non resumable user session data",t=Error(e);(0,d.logError)({message:e,tag:["resume"],details:{error:JSON.stringify(r)}}),(0,T.sendExceptionLog)({error:t})}};t.hasTreatProblems=(e,t,r)=>{if(!e.summary)return{transactionsToDownload:[],transactionsToUpload:[]};let a=t.getPersonalData(),{missingLocally:o,missingRemotely:n}=(0,C.getMissingIdentifiers)(r,a,e.summary);return{transactionsToUpload:[...n],transactionsToDownload:[...o]}};let eO=e=>e.filter(e=>"SECURITYBREACH"===e.type).map(e=>e.identifier),eC=e=>e.filter(e=>"AUTHENTIFIANT"===e.type).map(e=>e.identifier),eb=e=>0===e.length?null:{type:"breachUpdates",breachesIds:e},eR=e=>0===e.length?null:{type:"credentialUpdates",credentialIds:e},eN=async e=>{let t=(0,H.getInstance)(),r=(0,x.getInstance)(),a=null;try{let{storeService:o,applicationModulesAccess:i}=e,s=await (0,y.sync)(e),u=s.clearTransactions||[];if(0!==u.length){a=r.lockTopic("iconsUpdates");let e=eC(u),s=eO(u),d=eR(e);null!==d&&await t.add("iconsUpdates",d);let p=eb(s);null!==p&&await t.add("iconsUpdates",p);let S=(0,l.applyTransactions)(u);o.dispatch(S),c.reportDataUpdate(o);try{if(i&&(e.length>0||s.length>0)){let{commands:e}=i.createClients().passwordHealth;e.recalculatePasswordHealth()}}catch(r){let e=`Password Health update - sync: ${r}`,t=Error(e);(0,T.sendExceptionLog)({error:t,code:n.ExceptionCriticality.WARNING})}}return s.uploadedTransactions.length>0&&o.dispatch((0,p.updateLastBackupTime)(s.uploadedTransactions,Math.floor(s.lastSyncTimestamp/1e3))),e.lastSyncTimestamp<y.MAX_SYNC_TIMESTAMP&&o.dispatch((0,E.registerLastSync)(s.lastSyncTimestamp)),s}catch(e){throw e}finally{a&&r.releaseTopic("iconsUpdates",a)}},ew=async e=>{let{announce:t,personalData:r}=e;try{t(R.announcements.chronologicalSyncStarted(r));let a=await eN(e);return t(R.announcements.chronologicalSyncFinished(a.summary,a.fullBackupFileSize)),a}catch(e){throw t(R.announcements.chronologicalSyncFailed(e)),e}},eL=async(e,r,a)=>{let{announce:o}=r;o(R.announcements.treatProblemStarted());let{transactionsToDownload:n,transactionsToUpload:i}=(0,t.hasTreatProblems)(a,e,o),s=n.length,c=i.length;if(o(R.announcements.treatProblemDiffComputed(s,c)),s<=0&&c<=0)return o(R.announcements.treatProblemFinished()),a;try{c>0&&e.dispatch((0,p.storeChangesToUpload)(i));let t=await eN({...eT(e,r.dataEncryptorService,r.ws,o),transactionIds:n}),s={...t,clearTransactions:[...t.clearTransactions,...a.clearTransactions]};return o(R.announcements.treatProblemFinished()),s}catch(e){throw o(R.announcements.treatProblemFailed(e)),e}},eU=async(e,t)=>{let r=await ew(t);return eL(e,t,r)};t.storeSync=eU;let eM=async(e,t,r,a)=>{try{r(R.announcements.teamAdminDataSyncStarted());let o=await (0,P.syncUserGroupManagement)(e,t,a);return r(R.announcements.teamAdminDataSyncFinished()),o}catch(e){throw r(R.announcements.teamAdminDataSyncFailed(e)),e}},eF=async({storeService:e,dataEncryptorService:r,wsService:o,applicationModulesAccess:n},s,c)=>{if(!c.sharing2||!(0,U.ukiSelector)(e.getState()))return c;let l=async t=>{let{getTeamAdminSharingData:r}=n.createClients().sharingSync.queries,{runSharingSync:c}=n.createClients().sharingSync.commands,{collections:l,itemGroups:u,items:d,userGroups:p}=t;await c({summary:{collections:l??[],itemGroups:u,items:d,userGroups:p}});let S=await (0,a.firstValueFrom)(r());if((0,i.isSuccess)(S)){let t=(0,i.getSuccess)(S);return await eM(e,o,s,t)}};if(await l(c.sharing2)===A.SyncUserGroupManagementStatus.NEEDS_FRESH_SHARING_DATA){let a=ev(e,r,o),{sharing2:i}=await (0,t.storeSync)(e,{...a,applicationModulesAccess:n,announce:s});await l(i)}return c};t.isSyncInProgress=e=>{let t=e.getState(),r=(0,G.syncIsInProgressSelector)(t),{startTime:a}=(0,G.syncSelector)(t);return!!r&&(Date.now()-(a||0)<6e5?(d.Debugger.log("[Sync] Already in progress, skipping trigger…"),!0):(e.dispatch((0,f.syncFailure)()),(0,T.sendExceptionLog)({message:'[Sync] "inProgress" for more than 10 minutes'}),!1))};let ek=async(e,r,a,o)=>{let{applicationModulesAccess:i,eventBusService:s,localStorageService:l,masterPasswordEncryptorService:u,remoteDataEncryptorService:p,storeService:S,wsService:g}=e,m=S.getState();if(!S.isAuthenticated())throw Error("Impossible to Sync - user not authenticated");if((0,t.isSyncInProgress)(S))return;eA();let y=(0,M.twoFactorAuthenticationInfoSelector)(m);if(y.status===n.TwoFactorAuthenticationInfoRequestStatus.READY){let{shouldEnforceTwoFactorAuthentication:e}=y;if(e)return}let E=(0,G.isRemoteKeyActivatedSelector)(m)?p:u,A=(0,w.setupProbe)((0,N.makeEventLoggerSyncMonitor)().monitor),h={...eT(S,E,g,A,o),applicationModulesAccess:i},{syncType:_}=h;try{A(R.announcements.syncStarted(o,_)),c.triggerSessionSyncStatus({status:"syncing"}),S.dispatch((0,f.syncStarted)());let e=await (0,t.storeSync)(S,h);return await (0,t.treatKeysResult)(E,S,r,g,A,e),await eF({storeService:S,dataEncryptorService:E,wsService:g,applicationModulesAccess:i},A,e),await E.getInstance().prepareCrypto(),A(R.announcements.saveStarted()),await ex(l,S),A(R.announcements.saveFinished()),s.syncSuccess({}),S.dispatch((0,f.syncSuccess)(e.isUploadEnabled)),c.triggerSessionSyncStatus({status:"success"}),A(R.announcements.syncFinished()),ef(),e.clearTransactions}catch(t){if(S.dispatch((0,f.syncFailure)()),c.triggerSessionSyncStatus({status:"error"}),A(R.announcements.syncFailed(t)),s.syncFailure({}),ef(),t.message===n.AuthenticationCode[n.AuthenticationCode.INVALID_UKI]){let t="[Sync] Device UKI is invalid, closing the session",r=Error(t);(0,d.logError)({message:t,details:{error:r}}),(0,T.sendExceptionLog)({error:r}),eS(e,a);return}throw t}},eK=async(e,r,a,o,n,i)=>{try{let n=async t=>{if(d.Debugger.log("[Sync] Extract Keys from Sync…"),!t)return null;d.Debugger.log("[Sync] Decipher  private key BEGIN");let r=await e.getInstance().decrypt(t),a=(0,s.deflatedUtf8ToUtf16)(r,{skipInflate:!0});return d.Debugger.log("[Sync] Decipher  private key SUCCESS"),a};if(i.keys&&i.keys.privateKey)try{let e=await n(i.keys.privateKey);r.dispatch((0,v.updateKeyPair)({privateKey:e,publicKey:i.keys.publicKey}))}catch(e){}if(!r.getUserSession().keyPair){let n=await (0,t.generateRsaKeys)(e,a),i=ev(r,e,o);i.needsKeys=!0,i.syncType=m.SyncType.FULL_SYNC,i.pushKeysToServer={private:n.encryptedPrivateKey,public:n.keys.publicKey},d.Debugger.log("SYNC RSA Keys - BEGIN"),await eN(i),d.Debugger.log("SYNC RSA Keys - END"),r.dispatch((0,v.updateKeyPair)({privateKey:n.keys.privateKey,publicKey:n.keys.publicKey}))}}catch(e){throw n(R.announcements.treatSharingKeysFailed(e)),e}};t.treatKeysResult=eK;let eB=async(e,t,r={})=>{try{let a=await t.asymmetricEncryption.generateRsaKeyPair();d.Debugger.log("Generating RSA Keys");let o=(0,s.utf16ToDeflatedUtf8)(a.privateKey,{skipDeflate:!0}),n=await e.getInstance().encrypt(o,r);return d.Debugger.log("Encrypt RSA Keys"),{keys:{publicKey:a.publicKey,privateKey:a.privateKey},encryptedPrivateKey:n}}catch(e){throw d.Debugger.log("Error while Generating RSA KEY: "+e),e}};t.generateRsaKeys=eB;let eG=e=>e.persistData===_.PersistData.PERSIST_DATA_NO,ej=(e,t)=>{let r=t.getLocalSettings(),a=t.getAccountInfo();return eG(a)||!a.isAuthenticated?Promise.resolve():e.getInstance().storeLocalSettings(r)},eV=async(e,t)=>{let r=t.getPersonalData(),a=t.getAccountInfo();return eG(a)||!a.isAuthenticated?Promise.resolve():e.getInstance().storePersonalData(r)},eW=async(e,t)=>{let r=t.getPersonalSettings(),a=t.getAccountInfo();return eG(a)||!a.isAuthenticated?Promise.resolve():e.getInstance().storePersonalSettings(r)},eH=(e,t)=>{let r=t.getTeamAdminData(),a=t.getAccountInfo();return eG(a)||!a.isAuthenticated?Promise.resolve():e.getInstance().storeTeamAdminData(r).then(()=>{})},ex=async(e,t)=>{let r=(0,B.userABTestsSelector)(t.getState()),a=t.getLocalSettings(),o=t.getPersonalSettings(),i=t.getSharingData(),s=t.getAccountInfo(),c=t.getNotificationStatus(),l=t.getTeamAdminData(),u=t.getState(),d=(0,U.sessionKeysSelector)(u),p=(0,G.analyticsIdsSelector)(u);if(eG(s)||!s.isAuthenticated)return Promise.resolve();isNaN(a.lastSync)&&(0,T.sendExceptionLog)({message:"Persisting localSettings with a NaN lastSyncTimestamp",code:n.ExceptionCriticality.WARNING});let S=Object.keys(l?.teams??{}).reduce((e,t)=>{let r=l.teams[t],a=r.specialItemGroup?(r.specialItemGroup.items||[]).map(e=>e.itemId):[];return e.concat(a)},[]),g={...i,items:i.items.map(e=>!e.content||S.includes(e.itemId)?e:{...e,content:""})};await Promise.all([eV(e,t),ej(e,t),e.getInstance().storePersonalSettings(o),e.getInstance().storeSharingData(g),e.getInstance().storeNotificationsStatus(c),d?e.getInstance().storeAuthenticationKeys(d):Promise.resolve(),e.getInstance().storeTeamAdminData(l),(0,F.persistUserAuthenticationData)(e,t),e.getInstance().storeUserABTests(r),e.getInstance().storeAnalyticsIds(p)])},eY=async(e,t)=>{try{let r=e.getAccountInfo().login,a=(0,U.ukiSelector)(e.getState()),{result:o,...n}=await t.contactInfo.getContactInfo({login:r,uki:a});e.dispatch((0,eu.accountContactInfoRefreshed)(n))}catch(r){let e="Failed to refreshContactInfo",t=es.CarbonError.fromAnyError(r).addContextInfo("session","refreshContactInfo").addAdditionalInfo({message:e,originalError:r});(0,d.logError)({message:e,details:{error:JSON.stringify(r)}}),(0,T.sendExceptionLog)({error:t})}};async function eq(e,t){let{localStorageService:r,storeService:a,wsService:o}=e,n=(0,ee.requestPairing)(a,t),i=(0,V.refreshUserABTest)(a,r.getInstance(),t),s=(0,U.ukiSelector)(a.getState()),c=(0,et.refreshPremiumStatus)(a,o,t,s),l=(0,ec.refreshCredentialsDedupView)(a,t);await Promise.all([c,n,i,l])}},72802:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.setupEncryptorServices=void 0;let a=r(93748),o=r(59565),n=(0,r(18040).getNoDerivationCryptoConfig)();t.setupEncryptorServices=function(e){let{storeService:t}=e,r=t.getState(),i=(0,a.sessionEncryptorKeysSelector)(r);!function(e,t,r){let{masterPassword:a,serverKey:o}=t;if(!a)return;let[i,s,c]=r?[a,"",n]:[a,o,void 0];e.masterPasswordEncryptorService.setInstance({raw:i},s,c)}(e,i,(0,o.isSSOUserSelector)(r)),function(e,t){let{masterPassword:r,remoteKey:a,serverKey:o}=t;if(!a&&!r)return;let[i,s,c]=a?[a,"",n]:[r,o,void 0];e.remoteDataEncryptorService.setInstance({raw:i},s,c)}(e,i),function(e,t){let{localKey:r,masterPassword:a,serverKey:o}=t;if(!r&&!a)return;let[i,s,c]=r?[r,"",n]:[a,o,void 0];e.localDataEncryptorService.setInstance({raw:i},s,c)}(e,i)}},98933:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.setupSubscriptions=void 0;let a=r(83533),o=r(28009),n=r(30111),i=r(98215);t.setupSubscriptions=function(e,t){e.appInitialized.on(async e=>{let{sessionService:r,storeService:s}=t;(0,i.isSyncInProgress)(s)&&(s.dispatch((0,n.syncFailure)()),e.initMode===o.InitMode.Resume&&await r.getInstance().user.attemptSync(a.Trigger.Wake))})}},63860:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.waitUntilSyncComplete=void 0;let a=r(98215),o=async e=>!1===(0,a.isSyncInProgress)(e)||new Promise(t=>{let r=Date.now(),o=setInterval(()=>!1===(0,a.isSyncInProgress)(e)?(clearInterval(o),t(!0)):Date.now()-r>6e4?t(!1):void 0,1e3)});t.waitUntilSyncComplete=o},62923:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.wipeOutLocalAccounts=t.deviceRemoteDeletion=void 0;let a=r(15535),o=r(6833),n=r(28323),i=r(80896),s=r(73547);async function c(e,t,r){try{let a=await u(e,t);await l(t,r,a)}catch(t){let e=Error(`[UserManagement]: deviceRemoteDeletion - ${t}`);(0,i.sendExceptionLog)({error:e})}}async function l(e,t,r){let n=r.map(r=>(0,o.deleteAllLocalUserData)(e,t,r)).concat((0,a.deleteUsersPublicSettings)(r));await Promise.all(n)}async function u(e,t){let{profiles:r,ghostProfiles:a}=await (0,s.getLocalProfiles)(e,t),o=a.map(e=>e.login).filter(Boolean);if(r.length>0){let t=await (0,n.getUnauthorizedProfiles)(e,{profiles:r});return(0,n.isApiError)(t)?o:[...o,...t.unauthorizedProfiles.map(e=>e.login)]}return o}t.deviceRemoteDeletion=c,t.wipeOutLocalAccounts=l},48169:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.isInternalTestUser=void 0,t.isInternalTestUser=function(e){let t=e.trim();return t.startsWith("{9a9b9c9d-")||t.startsWith("kw_test_")&&(t.endsWith("@mailinator.com")||t.endsWith("@yopmail.com")||t.endsWith(".kwtest.io"))}},60292:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.config=void 0;let a=r(96053),o=r(35106),n=r(39631),i=r(37848);t.config={commands:{dismissUserMessages:{handler:n.dismissUserMessagesHandler},addUserMessage:{handler:i.addUserMessageHandler}},queries:{getVisibleUserMessages:{selector:a.getVisibleUserMessagesSelector},getUserMessages:{selector:a.getUserMessagesSelector}},liveQueries:{liveVisibleUserMessages:{operator:o.liveVisibleUserMessages$},liveUserMessages:{operator:o.liveUserMessages$}}}},82189:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.userMessagesDismissed=t.userMessageAdded=t.USER_MESSAGES_DISMISSED=t.USER_MESSAGE_ADDED=void 0,t.USER_MESSAGE_ADDED="USER_MESSAGE_ADDED",t.USER_MESSAGES_DISMISSED="USER_MESSAGES_DISMISSED",t.userMessageAdded=e=>({type:t.USER_MESSAGE_ADDED,userMessage:e}),t.userMessagesDismissed=e=>({type:t.USER_MESSAGES_DISMISSED,predicate:e})},96053:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.getVisibleUserMessagesSelector=t.getUserMessagesByTypeSelector=t.getUserMessagesSelector=void 0;let a=r(49548);t.getUserMessagesSelector=e=>e.userSession.localSettings.userMessages,t.getUserMessagesByTypeSelector=(e,t)=>e.userSession.localSettings.userMessages.filter(e=>e.type===t),t.getVisibleUserMessagesSelector=(0,a.createSelector)(t.getUserMessagesSelector,e=>e.filter(({dismissedAt:e})=>!e))},79655:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.bootstrap=void 0;let a=r(60292);t.bootstrap=e=>{e.register(a.config)}},37848:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.addUserMessageHandler=void 0;let a=r(82189);t.addUserMessageHandler=(e,t)=>(e.storeService.dispatch((0,a.userMessageAdded)({type:t.type})),e.sessionService.getInstance().user.persistLocalSettings(),Promise.resolve())},39631:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.dismissUserMessagesHandler=void 0;let a=r(82189);t.dismissUserMessagesHandler=(e,t)=>(e.storeService.dispatch((0,a.userMessagesDismissed)(t)),e.sessionService.getInstance().user.persistLocalSettings(),Promise.resolve())},17062:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.createTrialExpiredUserMessage=t.isTrialExpired=void 0;let a=r(20648);t.isTrialExpired=function({premiumStatus:e,currentDate:t=Date.now()}){switch(e?.statusCode){case a.PremiumStatusCode.PREMIUM:case a.PremiumStatusCode.OLD_ACCOUNT:case a.PremiumStatusCode.NEW_USER:case a.PremiumStatusCode.GRACE_PERIOD:return!1;case a.PremiumStatusCode.PREMIUM_CANCELLED:{let r=(e.endDate??0)*1e3;return!!r&&r-t<0}case a.PremiumStatusCode.NO_PREMIUM:default:return!0}},t.createTrialExpiredUserMessage=function(){return{type:a.UserMessageTypes.TRIAL_EXPIRED}}},56594:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.bootstrap=void 0;var a=r(79655);Object.defineProperty(t,"bootstrap",{enumerable:!0,get:function(){return a.bootstrap}})},35106:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.liveUserMessages$=t.liveVisibleUserMessages$=void 0;let a=r(95121),o=r(15237),n=r(96053);t.liveVisibleUserMessages$=()=>(0,a.pipe)((0,o.map)(n.getVisibleUserMessagesSelector),(0,o.distinctUntilChanged)()),t.liveUserMessages$=()=>(0,a.pipe)((0,o.map)(n.getUserMessagesSelector),(0,o.distinctUntilChanged)())},43856:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.createUserSettingsLogContent=void 0;let a=r(29509),o=r(93748);t.createUserSettingsLogContent=e=>{let t=(0,a.webAuthnAuthenticationOptedInSelector)(e),r=(0,a.rememberMeFor14DaysOptedInSelector)(e);return{hasAuthenticationWithWebauthn:t,hasCredentialsProtectWithMasterPassword:(0,o.personalSettingsSelector)(e).SecuredDataShowPassword,hasAuthenticationWithRememberMe:r}}},30081:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.sendUserSettingsLog=void 0;let a=r(83533),o=r(12770),n=r(43856),i=async e=>{let t=(0,n.createUserSettingsLogContent)(e.storeService.getState());await (0,o.logEvent)(e,{event:new a.UserUserSettingsEvent({hasAuthenticationWithWebauthn:t.hasAuthenticationWithWebauthn,hasCredentialsProtectWithMasterPassword:t.hasCredentialsProtectWithMasterPassword,hasAuthenticationWithRememberMe:t.hasAuthenticationWithRememberMe})})};t.sendUserSettingsLog=i},17974:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.setupUserSettingsLogSubscriptions=void 0;let a=r(30081);t.setupUserSettingsLogSubscriptions=function(e,t){e._sessionOpened.on(()=>{(0,a.sendUserSettingsLog)(t)})}},92146:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.asyncMap=void 0,t.asyncMap=(e,t)=>Promise.all(e.map(e=>t(e)))},4745:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.canonizeText=void 0,t.canonizeText=function(e){if(!e)return"";let t=e.trim();return t.normalize&&(t=t.normalize("NFD").replace(/[\u0300-\u036f]/g,"")),(t=t.toLowerCase().replace(/[\+_\\\/\?\.\-_{}\[\]\(\)\*&!@#\$~`%\^=\|:,;"'<>]/g," ")).replace(/\s+/g," ")}},61681:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.generateItemUuid=void 0;let a=r(42387);t.generateItemUuid=function(){return`{${(0,a.v4)().toUpperCase()}}`}},98233:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){return Math.ceil(2e9*Math.random())}},67179:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.getUnixTimestamp=void 0,t.getUnixTimestamp=function(){return Math.round(Date.now()/1e3)}},36598:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.checkOrigin=t.removeNonDigitCharacters=t.looksLikeUuid=t.normalizeEmail=t.looksLikeEmail=t.isValidLogin=t.postDataToUrl=t.getClientAgentHeader=void 0;let a=r(90608),o=r(25903),n=r(74907),i=r(65559),s=e=>a.stringify(o.map(e=>Array.isArray(e)?JSON.stringify(e):e,e)),c=e=>atob(e),l=e=>e?e?.location?.origin:void 0;function u(e){return`version:${e.appVersion},platform:${e.platformName}}`}async function d(e,t,r){let a={headers:{"Client-Agent":u((0,i.getPlatformInfo)()),"Content-Type":"application/x-www-form-urlencoded",...r?.headers??{}},transformRequest:[s],responseType:r?.responseType??"json"};return(0,n.post)(e,t,a)}t.getClientAgentHeader=u,t.postDataToUrl=d,t.isValidLogin=e=>S(e)||m(e);let p=/^[^\s@]+@([^\s@])+\.([^\s@])+$/i;function S(e){return p.test(e)}t.looksLikeEmail=S;let g=/[<>]/g;function m(e){return RegExp("^{?[a-fA-F0-9]{8}-[a-fA-F0-9]{4}-[a-fA-F0-9]{4}-[a-fA-F0-9]{4}-[a-fA-F0-9]{12}}?$").test(e)}t.normalizeEmail=function(e){return e?e.trim().toLowerCase().replace(g,""):""},t.looksLikeUuid=m,t.removeNonDigitCharacters=function(e){return"string"==typeof e?e.replace(/\D/g,""):""},t.checkOrigin=e=>{let t=l(e);return!t||!t.endsWith(c("LmRhc2hsYW5lLmNvbQ=="))}},29138:function(e,t){Object.defineProperty(t,"__esModule",{value:!0});let r=Function.prototype.toString,a=r.call(Object),o=e=>"object"==typeof e&&null!==e,n=Object.prototype,i=n.hasOwnProperty,s=n.toString,c="undefined"!=typeof Symbol?Symbol.toStringTag:void 0;t.default=function(e){if(!o(e)||"[object Object]"!==function(e){if(null===e)return void 0===e?"[object Undefined]":"[object Null]";if(!(c&&c in Object(e)))return s.call(e);let t=i.call(e,c),r=e[c],a=!1;try{e[c]=void 0,a=!0}catch(e){}let o=s.call(e);return a&&(t?e[c]=r:delete e[c]),o}(e))return!1;let t=Object.getPrototypeOf(e);if(null===t)return!0;let n=i.call(t,"constructor")&&t.constructor;return"function"==typeof n&&n instanceof n&&r.call(n)===a}},53176:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.vpnApiConfig=void 0;let a=r(54998),o=r(83846),n=r(21526),i=r(76756),s=r(56605);t.vpnApiConfig={commands:{activateVpnAccount:{handler:a.activateVpnAccountHandler},clearVpnAccountErrors:{handler:o.clearVpnAccountErrorsHandler},completeVpnAccountActivation:{handler:n.completeVpnAccountActivationHandler}},queries:{getVpnAccount:{selector:s.vpnAccountStatusSelector},getVpnCapabilitySetting:{selector:s.vpnCapabilitySettingSelector}},liveQueries:{liveVpnAccount:{operator:i.vpnAccountStatus$}}}},33124:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.openDashlaneVpnAPI=void 0;let a=r(28323),o=r(20994);t.openDashlaneVpnAPI=e=>({generateCredential:async(t,r)=>{let n=await (0,a.generateCredential)(e,t,{email:r});return(0,a.isApiError)(n)?{success:!1,error:n.code===a.GetVpnCredentialBusinessErrors.USER_ALREADY_HAS_AN_ACCOUNT_FOR_PROVIDER?o.VpnErrorType.AccountAlreadyExistError:o.VpnErrorType.ServerError}:{success:!0,password:n.password}}})},20994:function(e,t){var r;Object.defineProperty(t,"__esModule",{value:!0}),t.VpnErrorType=void 0,(r=t.VpnErrorType||(t.VpnErrorType={})).AccountAlreadyExistError="AccountAlreadyExist",r.ServerError="ServerError"},92675:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.makeVpnLogger=void 0;let a=r(83533),o=r(12770),n=r(20994),i={[n.VpnErrorType.AccountAlreadyExistError]:a.ActivateVpnError.EmailAlreadyInUse,[n.VpnErrorType.ServerError]:a.ActivateVpnError.ServerError};t.makeVpnLogger=e=>({logComplete:async()=>{await (0,o.logEvent)(e,{event:new a.UserActivateVpnEvent({flowStep:a.FlowStep.Complete})})},logError:async t=>{await (0,o.logEvent)(e,{event:new a.UserActivateVpnEvent({flowStep:a.FlowStep.Error,errorName:i[t]})})},logStart:async()=>{await (0,o.logEvent)(e,{event:new a.UserActivateVpnEvent({flowStep:a.FlowStep.Start})})}})},18537:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.vpnAccountNotFoundAction=t.vpnAccountActivationCompleteAction=t.vpnAccountGenerationErrorAction=t.vpnAccountGenerationDoneAction=t.vpnAccountActivatingAction=t.VPN_ACCOUNT_NOT_FOUND=t.VPN_ACCOUNT_GENERATION_ERROR=t.VPN_ACCOUNT_ACTIVATION_COMPLETE=t.VPN_ACCOUNT_GENERATION_DONE=t.VPN_ACCOUNT_ACTIVATING=void 0,t.VPN_ACCOUNT_ACTIVATING="VPN_ACCOUNT_ACTIVATING",t.VPN_ACCOUNT_GENERATION_DONE="VPN_ACCOUNT_GENERATION_DONE",t.VPN_ACCOUNT_ACTIVATION_COMPLETE="VPN_ACCOUNT_ACTIVATION_COMPLETE",t.VPN_ACCOUNT_GENERATION_ERROR="VPN_ACCOUNT_GENERATION_ERROR",t.VPN_ACCOUNT_NOT_FOUND="VPN_ACCOUNT_NOT_FOUND",t.vpnAccountActivatingAction=()=>({type:t.VPN_ACCOUNT_ACTIVATING}),t.vpnAccountGenerationDoneAction=()=>({type:t.VPN_ACCOUNT_GENERATION_DONE}),t.vpnAccountGenerationErrorAction=e=>({type:t.VPN_ACCOUNT_GENERATION_ERROR,error:e}),t.vpnAccountActivationCompleteAction=()=>({type:t.VPN_ACCOUNT_ACTIVATION_COMPLETE}),t.vpnAccountNotFoundAction=()=>({type:t.VPN_ACCOUNT_NOT_FOUND})},90724:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.vpnApiBootstrap=void 0;let a=r(53176);t.vpnApiBootstrap=e=>{e.register(a.vpnApiConfig)}},50085:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.VPN_CREDENTIAL_NAME=t.VPN_CREDENTIAL_URL=t.VPN_DASHLANE_HOTSPOTSHIELD_SUBDOMAIN=t.VPN_HOTSPOTSHIELD_DOMAIN=void 0,t.VPN_HOTSPOTSHIELD_DOMAIN="hotspotshield.com",t.VPN_DASHLANE_HOTSPOTSHIELD_SUBDOMAIN="dashlane",t.VPN_CREDENTIAL_URL=`https://${t.VPN_DASHLANE_HOTSPOTSHIELD_SUBDOMAIN}.${t.VPN_HOTSPOTSHIELD_DOMAIN}`,t.VPN_CREDENTIAL_NAME="VPN Hotspot Shield"},54998:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.activateVpnAccountHandler=void 0;let a=r(92675),o=r(33124),n=r(62543),i=async(e,t)=>{let r=(0,n.CreateVpnService)({generator:(0,o.openDashlaneVpnAPI)(e.storeService),logger:(0,a.makeVpnLogger)(e)},e),{user:i}=e.sessionService.getInstance();await r.generateCredential(i,t.email)};t.activateVpnAccountHandler=i},83846:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.clearVpnAccountErrorsHandler=void 0;let a=r(18537);t.clearVpnAccountErrorsHandler=e=>(e.storeService.dispatch((0,a.vpnAccountNotFoundAction)()),Promise.resolve())},21526:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.completeVpnAccountActivationHandler=void 0;let a=r(18537);t.completeVpnAccountActivationHandler=e=>(e.storeService.dispatch((0,a.vpnAccountActivationCompleteAction)()),Promise.resolve())},18084:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.vpnCredentialMatcher=void 0;let a=r(12857),o=r(50085);t.vpnCredentialMatcher=e=>{let t=new a.ParsedURL(e.Url);return e.Password&&e.Email&&t&&t.getRootDomain()===o.VPN_HOTSPOTSHIELD_DOMAIN&&t.getSubdomain()===o.VPN_DASHLANE_HOTSPOTSHIELD_SUBDOMAIN}},76756:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.vpnAccountStatus$=void 0;let a=r(95121),o=r(15237),n=r(56605);t.vpnAccountStatus$=function(){let e=n.vpnAccountStatusSelector;return(0,a.pipe)((0,o.map)(e),(0,o.distinctUntilChanged)())}},38263:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.VPNReducers=void 0;let a=r(20648),o=r(18537);t.VPNReducers=(e,t)=>{switch(t.type){case o.VPN_ACCOUNT_ACTIVATING:return{accountStatus:{status:a.VpnAccountStatusType.Activating}};case o.VPN_ACCOUNT_GENERATION_DONE:return{accountStatus:{status:a.VpnAccountStatusType.Ready}};case o.VPN_ACCOUNT_GENERATION_ERROR:return{accountStatus:{status:a.VpnAccountStatusType.Error,error:t.error}};case o.VPN_ACCOUNT_ACTIVATION_COMPLETE:return{accountStatus:{status:a.VpnAccountStatusType.Activated}};case o.VPN_ACCOUNT_NOT_FOUND:return{accountStatus:{status:a.VpnAccountStatusType.NotFound}};default:return e??{accountStatus:{status:a.VpnAccountStatusType.NotFound}}}}},56605:function(e,t,r){var a,o;Object.defineProperty(t,"__esModule",{value:!0}),t.vpnCapabilitySettingSelector=t.getVpnCapabilitySetting=t.vpnAccountStatusSelector=t.vpnCredentialSelector=void 0;let n=r(20648),i=r(91966),s=r(49548),c=r(93748),l=r(18084),u=(e,t)=>(t.CreationDatetime??0)-(e.CreationDatetime??0);t.vpnCredentialSelector=e=>(0,i.credentialsSelector)(e).filter(e=>(0,l.vpnCredentialMatcher)(e)).sort(u)[0]??null,t.vpnAccountStatusSelector=(0,s.createSelector)(e=>{let{vpnData:t}=e.userSession;return t||{accountStatus:{status:n.VpnAccountStatusType.NotFound}}},t.vpnCredentialSelector,(e,t)=>{switch(e.accountStatus.status){case n.VpnAccountStatusType.Error:return{status:n.VpnAccountStatusType.Error,error:e.accountStatus.error};case n.VpnAccountStatusType.Activating:return{status:n.VpnAccountStatusType.Activating};case n.VpnAccountStatusType.Activated:case n.VpnAccountStatusType.NotFound:if(!t)return{status:n.VpnAccountStatusType.NotFound};return{status:n.VpnAccountStatusType.Activated,email:t.Email,password:t.Password,credentialId:t.Id};case n.VpnAccountStatusType.Ready:if(!t)return{status:n.VpnAccountStatusType.NotFound};return{status:n.VpnAccountStatusType.Ready,email:t.Email,password:t.Password,credentialId:t.Id}}}),(o=a||(a={})).IN_TEAM="in_team",o.NOT_PREMIUM="not_premium",o.NO_PAYMENT="no_payment";let d={in_team:n.VpnDisabledReason.InTeam,not_premium:n.VpnDisabledReason.NotPremium,no_payment:n.VpnDisabledReason.NoPayment};t.getVpnCapabilitySetting=e=>{let t=e?.capabilities?.secureWiFi;return t.enabled?{hasVpnEnabled:!0}:{hasVpnEnabled:!1,vpnDisabledReason:d[t.info.reason]||n.VpnDisabledReason.Other}},t.vpnCapabilitySettingSelector=(0,s.createSelector)(c.premiumStatusSelector,t.getVpnCapabilitySetting)},62543:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.CreateVpnService=void 0;let a=r(58003),o=r(20648),n=r(242),i=r(11369),s=r(21837),c=r(22560),l=r(80896),u=r(93748),d=r(18537),p=r(50085),S=r(20994),g=r(56605),m=({update:{title:e}})=>({Title:e}),y=({title:e})=>({Title:e});t.CreateVpnService=(e,t)=>{let r=async(e,r,a)=>{let o=(0,g.vpnCredentialSelector)(t.storeService.getState()),s={email:e,password:r,url:p.VPN_CREDENTIAL_URL,login:a,title:p.VPN_CREDENTIAL_NAME};if(o){let e={id:o.Id,update:{...s}};await (0,i.updateCredential)({storeService:t.storeService,sessionService:t.sessionService,eventLoggerService:t.eventLoggerService,applicationModulesAccess:t.applicationModulesAccess},e,m)}else await (0,n.createCredential)({storeService:t.storeService,sessionService:t.sessionService,eventLoggerService:t.eventLoggerService,applicationModulesAccess:t.applicationModulesAccess},s,y)},f=async r=>{t.storeService.dispatch((0,d.vpnAccountGenerationErrorAction)(r===S.VpnErrorType.AccountAlreadyExistError?o.VpnAccountActivationErrorType.AccountAlreadyExistError:o.VpnAccountActivationErrorType.ServerError)),await e.logger.logError(r??S.VpnErrorType.ServerError)};return{generateCredential:async(o,n)=>{await e.logger.logStart(),t.storeService.dispatch((0,d.vpnAccountActivatingAction)());try{await Promise.race([o.refreshContactInfo(),new Promise(e=>self.setTimeout(e,1e3))]);let i=(0,a.contactInfoSelector)(t.storeService.getState()),s=(0,u.userLoginSelector)(t.storeService.getState()),c=n??i.email??s,l=await e.generator.generateCredential(s,c);switch(l.success){case!0:await r(c,l.password,s),t.storeService.dispatch((0,d.vpnAccountGenerationDoneAction)()),await e.logger.logComplete();break;case!1:f(l.error)}}catch(t){f();let e=s.CarbonError.fromAnyError(t).addContextInfo("VPN","saveCredential");(0,c.logError)({tag:["VPN"],message:`${e}`,details:{error:t}}),(0,l.sendExceptionLog)({error:e})}}}}},12418:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.minAcceptablePasswordStrength=void 0,t.minAcceptablePasswordStrength=2},30519:function(e,t,r){var a=this&&this.__decorate||function(e,t,r,a){var o,n=arguments.length,i=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(i=(n<3?o(i):n>3?o(t,r,i):o(t,r))||i);return n>3&&i&&Object.defineProperty(t,r,i),i};Object.defineProperty(t,"__esModule",{value:!0}),t.CarbonEventEmitter=void 0;let o=r(35648),n=class extends o.ContextlessBaseEventEmitter{};n=a([(0,o.Injectable)()],n),t.CarbonEventEmitter=n},82117:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.LEGACY_LEELOO_SLOTS_TO_IGNORE=void 0;let a=r(20648),o=r(77323),n=r(52819),i=r(16673);t.LEGACY_LEELOO_SLOTS_TO_IGNORE=(0,o.safeCast)(i.LEGACY_LEELOO_SLOTS_ALL.filter(e=>!n.LEGACY_LEELOO_EVENTS_TO_SUBSCRIBE.includes(e)&&!(0,o.safeCast)(a.LEGACY_CARBON_LEELOO_USED_COMMANDS).includes(e)))},52819:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.relayLeelooLegacyEvents=t.LEGACY_LEELOO_EVENTS_TO_SUBSCRIBE=void 0,t.LEGACY_LEELOO_EVENTS_TO_SUBSCRIBE=["carbonLoginStatusChanged","openSessionTokenSent","openSessionAskMasterPassword","openSessionDashlaneAuthenticator","openSessionOTPSent","openSessionOTPForNewDeviceRequired","openSessionFailed","openSessionSsoRedirectionToIdpRequired","openSessionMasterPasswordLess","ssoSolutionChanged"],t.relayLeelooLegacyEvents=function(e,r){let a=t.LEGACY_LEELOO_EVENTS_TO_SUBSCRIBE.map(t=>e[t].on(async e=>{await r.sendEvent("carbonLegacy",{eventData:e,eventName:t})}));return()=>{a.forEach(e=>{e()})}}},16673:function(e,t,r){var a=this&&this.__decorate||function(e,t,r,a){var o,n=arguments.length,i=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(i=(n<3?o(i):n>3?o(t,r,i):o(t,r))||i);return n>3&&i&&Object.defineProperty(t,r,i),i};Object.defineProperty(t,"__esModule",{value:!0}),t.LEGACY_LEELOO_SLOTS_ALL=t.CarbonLegacyInfrastructure=void 0;let o=r(95121),n=r(20648),i=r(35648),s=class{constructor(){this.carbon$=new o.ReplaySubject(1),this.carbonState$=this.carbon$.pipe((0,o.switchMap)(e=>e.coreServices.storeService.getState$()))}ready(e){this.carbon$.next(e)}initFailed(e){this.carbon$.error(e)}getCarbon(){return(0,o.firstValueFrom)(this.carbon$)}};s=a([(0,i.Injectable)()],s),t.CarbonLegacyInfrastructure=s,t.LEGACY_LEELOO_SLOTS_ALL=Object.keys(n.CarbonLeelooConnector)},34459:function(e,t,r){var a=this&&this.__decorate||function(e,t,r,a){var o,n=arguments.length,i=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(i=(n<3?o(i):n>3?o(t,r,i):o(t,r))||i);return n>3&&i&&Object.defineProperty(t,r,i),i},o=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0}),t.CarbonLegacyBootstrap=void 0;let n=r(35648),i=r(39960),s=r(95121),c=r(30519),l=r(52819),u=r(16673),d=r(44198),p=e=>!!e&&"object"==typeof e&&"account"in e&&!!e.account&&"object"==typeof e.account&&"login"in e.account&&!!e.account.login&&"string"==typeof e.account.login&&"isAuthenticated"in e.account&&!!e.account.isAuthenticated||!1,S=class{constructor(e,t,r,a){this.infra=t,this.lifeCycle=r,this.eventEmitter=a;let{setActiveUser:o}=e.getClient(i.requestContextApi).commands;this.setActiveUser=o}onFrameworkInit(){this.lifeCycle.addExternalComponentReadyCondition(async()=>await this.infra.getCarbon()),this.lifeCycle.addAppReadyHook(async()=>{let e=this.infra.carbonState$.pipe((0,s.map)(e=>({account:(0,d.getCarbonLegacyStateSelector)(e,"userSession.account")})),(0,s.map)(e=>{if(p(e))return e.account.login}),(0,s.distinctUntilChanged)(),(0,s.switchMap)(async e=>{await this.setActiveUser({userName:e})})).subscribe(),t=await this.infra.getCarbon(),r=(0,l.relayLeelooLegacyEvents)(t.leelooEvents,this.eventEmitter);return()=>{e.unsubscribe(),r()}})}};S=a([(0,n.FrameworkInit)(),o("design:paramtypes",[n.CqrsClient,u.CarbonLegacyInfrastructure,n.AppLifeCycle,c.CarbonEventEmitter])],S),t.CarbonLegacyBootstrap=S},68909:function(e,t,r){var a=this&&this.__decorate||function(e,t,r,a){var o,n=arguments.length,i=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(i=(n<3?o(i):n>3?o(t,r,i):o(t,r))||i);return n>3&&i&&Object.defineProperty(t,r,i),i};Object.defineProperty(t,"__esModule",{value:!0}),t.CarbonLegacyModule=void 0;let o=r(20648),n=r(35648),i=r(27976),s=r(79066),c=r(30519),l=r(16673),u=r(34459),d=r(86888),p=r(59919),S=r(10881),g=r(43481),m=r(30514),y=r(70990),f=r(60274),E=class{};E=a([(0,n.Module)({api:o.carbonLegacyApi,handlers:{commands:{carbon:i.CarbonCommandHandler,carbonLegacyLeeloo:s.CarbonLegacyLeelooCommandHandler,mitigationDeleteGrapheneUserData:S.DeleteGrapheneUserDataCommandHandler,...(0,m.createHandlersConfigForConnectorCommands)(o.carbonCommandsSlots,m.CarbonApiCommandsHandler)},events:{...(0,n.useEventsOfModule)(y.sessionApi,{sessionOpened:f.SessionOpenedEventHandler})},queries:{carbonState:d.CarbonGetStateQueryHandler,carbonStateList:p.CarbonStateListQueryHandler,...(0,g.createHandlersConfigForCarbonApiQueries)(o.carbonQueriesSlots,o.carbonLiveQueriesSlots)}},configurations:{infrastructure:{token:l.CarbonLegacyInfrastructure}},onFrameworkInit:u.CarbonLegacyBootstrap,providers:[c.CarbonEventEmitter],requiredFeatureFlips:["audit_logs_vault","autofill_web_linkedWebsites","autofill_web_linkedWebsites_dev","breachesFetchWeb","masterPasswordLeakCheckLog","ptu_web_MPprotect_phase3","SAEXAccountRecoveryv3","sharing_web_invalidSignatureAutoRevoke_prod"]})],E),t.CarbonLegacyModule=E},44198:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.getCarbonLegacyStateSelector=void 0;let r=(e,t)=>"object"==typeof e&&!!e&&t in e;t.getCarbonLegacyStateSelector=(e,t)=>t?t.split(".").reduce((e,t)=>r(e,t)?e[t]:e,e):e},30514:function(e,t,r){var a=this&&this.__decorate||function(e,t,r,a){var o,n=arguments.length,i=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(i=(n<3?o(i):n>3?o(t,r,i):o(t,r))||i);return n>3&&i&&Object.defineProperty(t,r,i),i},o=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0}),t.createHandlersConfigForConnectorCommands=t.CarbonApiCommandsHandler=void 0;let n=r(20648),i=r(77323),s=r(35648),c=r(16673),l=class{constructor(e){this.infrastructure=e}async execute(e,{name:t}){let{apiEvents:r}=await this.infrastructure.getCarbon(),{body:a}=e,o=await r[t](a);return(0,i.success)(o)}};l=a([(0,s.Injectable)(),o("design:paramtypes",[c.CarbonLegacyInfrastructure])],l),t.CarbonApiCommandsHandler=l,Object.values(n.commandsFromCarbonAPI).forEach(e=>(0,s.CommandHandler)(e)(l)),t.createHandlersConfigForConnectorCommands=function(e,t){return Object.keys(e).reduce((e,r)=>({...e,[r]:t}),{})}},43481:function(e,t,r){var a=this&&this.__decorate||function(e,t,r,a){var o,n=arguments.length,i=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(i=(n<3?o(i):n>3?o(t,r,i):o(t,r))||i);return n>3&&i&&Object.defineProperty(t,r,i),i},o=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0}),t.createHandlersConfigForCarbonApiQueries=t.CarbonApiQueriesHandler=void 0;let n=r(95121),i=r(12791),s=r(77323),c=r(35648),l=r(20648),u=r(16673),d=class{constructor(e){this.infrastructure=e}execute(e,{name:t}){let{carbonQueryName:r,carbonLiveQueryName:a}=this.getMaybeCarbonQueryNames(t);return(0,n.from)(this.infrastructure.getCarbon()).pipe((0,n.concatMap)(({apiEvents:t})=>(0,n.concat)((0,n.iif)(()=>!!r&&r in t,(0,n.from)(t[r](e.body)),n.EMPTY),(0,n.iif)(()=>!!a&&a in t,new n.Observable(r=>{let o=t[a].on(void 0===e.body?i.DEFAULT_PARAM:e.body,e=>r.next(e));return()=>{o()}}),n.EMPTY))),(0,n.distinctUntilChanged)(),(0,n.map)(s.success))}getMaybeCarbonQueryNames(e){let t,r;return e.startsWith("live")?(r=e,t=`get${e.substring(4)}`):t=e,{carbonQueryName:t,carbonLiveQueryName:r}}};d=a([(0,c.Injectable)(),o("design:paramtypes",[u.CarbonLegacyInfrastructure])],d),t.CarbonApiQueriesHandler=d,Object.values(l.queriesFromCarbonAPI).forEach(e=>(0,c.QueryHandler)(e)(d)),t.createHandlersConfigForCarbonApiQueries=function(e,t){return[...Object.keys(e),...Object.keys(t)].reduce((e,t)=>({...e,[t]:d}),{})}},27976:function(e,t,r){var a=this&&this.__decorate||function(e,t,r,a){var o,n=arguments.length,i=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(i=(n<3?o(i):n>3?o(t,r,i):o(t,r))||i);return n>3&&i&&Object.defineProperty(t,r,i),i},o=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0}),t.CarbonCommandHandler=void 0;let n=r(20648),i=r(35648),s=r(16673),c=r(30519),l=r(51661),u=class{constructor(e,t,r){this.infra=e,this.eventsEmitter=t,this.context=r}async execute({body:{args:e,name:t,fireEvent:r}}){let a=(await this.infra.getCarbon()).apiEvents[t],o=await a(...e),n=(0,l.carbonResultToModuleResult)(o);return r&&await this.eventsEmitter.sendEvent("carbonCommandResult",{result:o},this.context),n}};u=a([(0,i.CommandHandler)(n.CarbonCommand),o("design:paramtypes",[s.CarbonLegacyInfrastructure,c.CarbonEventEmitter,i.RequestContext])],u),t.CarbonCommandHandler=u},79066:function(e,t,r){var a=this&&this.__decorate||function(e,t,r,a){var o,n=arguments.length,i=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(i=(n<3?o(i):n>3?o(t,r,i):o(t,r))||i);return n>3&&i&&Object.defineProperty(t,r,i),i},o=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0}),t.CarbonLegacyLeelooCommandHandler=void 0;let n=r(20648),i=r(35648),s=r(16673),c=r(30519),l=r(51661),u=class{constructor(e,t){this.infra=e,this.eventsEmitter=t}async execute({body:{arg:e,name:t,fireEvent:r}}){let a=(await this.infra.getCarbon()).leelooEventsCommands[t],o=await a(...e),n=(0,l.carbonResultToModuleResult)(o);return r&&await this.eventsEmitter.sendEvent("carbonCommandResult",{result:o}),n}};u=a([(0,i.CommandHandler)(n.CarbonLegacyLeelooCommand),o("design:paramtypes",[s.CarbonLegacyInfrastructure,c.CarbonEventEmitter])],u),t.CarbonLegacyLeelooCommandHandler=u},86888:function(e,t,r){var a=this&&this.__decorate||function(e,t,r,a){var o,n=arguments.length,i=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(i=(n<3?o(i):n>3?o(t,r,i):o(t,r))||i);return n>3&&i&&Object.defineProperty(t,r,i),i},o=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0}),t.CarbonGetStateQueryHandler=void 0;let n=r(45991),i=r(95121),s=r(20648),c=r(35648),l=r(77323),u=r(16673),d=r(44198),p=class{constructor(e){this.infrastructure=e}execute({body:{path:e}}){let{carbonState$:t}=this.infrastructure;return t.pipe((0,i.map)(t=>(0,d.getCarbonLegacyStateSelector)(t,e)),(0,i.distinctUntilChanged)((e,t)=>(0,l.isObject)(e)&&(0,l.isObject)(t)?(0,n.shallowEqual)(e,t):Object.is(e,t)),(0,i.map)(l.success))}};p=a([(0,c.QueryHandler)(s.CarbonStateQuery),o("design:paramtypes",[u.CarbonLegacyInfrastructure])],p),t.CarbonGetStateQueryHandler=p},59919:function(e,t,r){var a=this&&this.__decorate||function(e,t,r,a){var o,n=arguments.length,i=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(i=(n<3?o(i):n>3?o(t,r,i):o(t,r))||i);return n>3&&i&&Object.defineProperty(t,r,i),i},o=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0}),t.CarbonStateListQueryHandler=void 0;let n=r(95121),i=r(45991),s=r(20648),c=r(35648),l=r(77323),u=r(16673),d=r(44198),p=class{constructor(e){this.infrastructure=e}execute({body:{paths:e}}){let{carbonState$:t}=this.infrastructure;return t.pipe((0,n.map)(t=>e.map(e=>(0,d.getCarbonLegacyStateSelector)(t,e))),(0,n.distinctUntilChanged)(i.shallowEqual),(0,n.map)(l.success))}};p=a([(0,c.QueryHandler)(s.CarbonStateListQuery),o("design:paramtypes",[u.CarbonLegacyInfrastructure])],p),t.CarbonStateListQueryHandler=p},10881:function(e,t,r){var a=this&&this.__decorate||function(e,t,r,a){var o,n=arguments.length,i=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(i=(n<3?o(i):n>3?o(t,r,i):o(t,r))||i);return n>3&&i&&Object.defineProperty(t,r,i),i},o=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0}),t.DeleteGrapheneUserDataCommandHandler=void 0;let n=r(20648),i=r(35648),s=r(77323),c=r(30519),l=class{constructor(e,t){this.infra=e,this.emitter=t}async execute({body:{login:e}}){await this.emitter.sendEvent("CarbonLegacyDeviceRemotelyDeleted",{user:e});let t=await this.infra.getAllKeys(),r=`.${e}`,a=t.filter(e=>e.endsWith(r)).map(async e=>await this.infra.remove(e));return await Promise.allSettled(a),(0,s.success)(null)}};l=a([(0,i.CommandHandler)(n.MitigationDeleteGrapheneUserDataCommand),o("design:paramtypes",[i.KeyValueStorageInfrastructure,c.CarbonEventEmitter])],l),t.DeleteGrapheneUserDataCommandHandler=l},51661:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.carbonResultToModuleResult=void 0;let a=r(77323),o=e=>!!e&&"object"==typeof e&&"success"in e&&!1===e.success,n=e=>{if("error"in e)return e.error;let{success:t,...r}=e;return r};t.carbonResultToModuleResult=e=>o(e)?(0,a.failure)({tag:"",error:n(e)}):(0,a.success)({id:"",carbonResult:e})},60274:function(e,t,r){var a=this&&this.__decorate||function(e,t,r,a){var o,n=arguments.length,i=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(i=(n<3?o(i):n>3?o(t,r,i):o(t,r))||i);return n>3&&i&&Object.defineProperty(t,r,i),i},o=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0}),t.SessionOpenedEventHandler=void 0;let n=r(35648),i=r(70990),s=r(16673),c=class{constructor(e){this.infra=e}async handle({body:{login:e}}){(await this.infra.getCarbon()).coreServices.eventBusService._sessionOpened({login:e})}};c=a([(0,n.EventHandler)(i.SessionOpenedEvent),o("design:paramtypes",[s.CarbonLegacyInfrastructure])],c),t.SessionOpenedEventHandler=c},57690:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.LEGACY_LEELOO_SLOTS_TO_IGNORE=t.CarbonLegacyInfrastructure=t.CarbonLegacyModule=void 0;var a=r(68909);Object.defineProperty(t,"CarbonLegacyModule",{enumerable:!0,get:function(){return a.CarbonLegacyModule}});var o=r(16673);Object.defineProperty(t,"CarbonLegacyInfrastructure",{enumerable:!0,get:function(){return o.CarbonLegacyInfrastructure}});var n=r(82117);Object.defineProperty(t,"LEGACY_LEELOO_SLOTS_TO_IGNORE",{enumerable:!0,get:function(){return n.LEGACY_LEELOO_SLOTS_TO_IGNORE}})},3314:function(e,t,r){var a,o;Object.defineProperty(t,"__esModule",{value:!0}),t.setConfig=t.config=t.DashlaneAPISchemesNames=void 0;let n=r(77550);(o=a=t.DashlaneAPISchemesNames||(t.DashlaneAPISchemesNames={})).DASHLANE_API_HOST_WITH_SCHEME="DASHLANE_API_HOST_WITH_SCHEME",o.DASHLANE_WS_HOST_WITH_SCHEME="DASHLANE_WS_HOST_WITH_SCHEME";let i={LOG_LEVEL:n.Silent,LOG_TAGS:[],DASHLANE_API_HOST_WITH_SCHEME:"https://api.dashlane.com",DASHLANE_WS_HOST_WITH_SCHEME:"https://ws1.dashlane.com",DASHLANE_STYX_HOST_WITH_SCHEME:"https://styx.data.dashlane.com",CODE_NAME:null,MANIFEST_VERSION:null};t.config=i;let s=e=>(Object.values(a).forEach(t=>{t in e&&!e[t]&&(e[t]=i[t])}),e);t.setConfig=e=>{t.config={...t.config,...s(e)}}},36388:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.createAccount=t.getCreateAccountRequest=t.defaultCreateAccountRequestParams=t.AUTOMATION_MP_GRACE_PERIOD=t.DEFAULT_E2E_ACCOUNT_PASSWORD=void 0;let a=r(61681),o=r(76969),n=r(89413);function i(e,r,a){return{login:e,anonymousUserId:a,password:r,...t.defaultCreateAccountRequestParams}}async function s(e,r,s){let c={...i((0,o.getLogin)(),t.DEFAULT_E2E_ACCOUNT_PASSWORD,(0,a.generateItemUuid)()),...r??{}},l={createAccountResult:await e.createAccountStep1(c),options:{flowIndicator:"webAccount"},isStandAlone:!0,...s??{}},u=await e.createAccountStep2(l);return await (0,n.sync)(e),u}t.DEFAULT_E2E_ACCOUNT_PASSWORD="Azerty12",t.AUTOMATION_MP_GRACE_PERIOD=5e3,t.defaultCreateAccountRequestParams={format:"US",language:"en",subscribe:!1,deviceName:"INTEGRATION_TEST"},t.getCreateAccountRequest=i,t.createAccount=s},76969:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.getLogin=t.defaultTestAccountOptions=void 0;let a=r(42387),o=r(94947);t.defaultTestAccountOptions={abTests:{},automationAccount:!1,featureFlips:[],throttling:o.TestAccountThrottlingBehaviour.Unthrottled,type:o.TestAccountType.FreePremiumTrial},t.getLogin=function(e=t.defaultTestAccountOptions){let{abTests:r=t.defaultTestAccountOptions.abTests,featureFlips:n=t.defaultTestAccountOptions.featureFlips,throttling:i=t.defaultTestAccountOptions.throttling,type:s=t.defaultTestAccountOptions.type,automationAccount:c=t.defaultTestAccountOptions.automationAccount}=e,l=(0,a.v4)(),u=l.substr(0,l.indexOf("-")),d=function(e){switch(e){case o.TestAccountThrottlingBehaviour.Unthrottled:return"ut_";case o.TestAccountThrottlingBehaviour.Normal:default:return""}}(i),p=function(e){switch(e){case o.TestAccountType.Free:return"freefree_";case o.TestAccountType.PremiumPaid:return"premiumpaid_";case o.TestAccountType.Family:return"family_";case o.TestAccountType.FreePremiumTrial:default:return""}}(s),S=!1===r?"noabtest_":Object.keys(r).reduce((e,t)=>{let a=`${t}_${r[t]}_`;return e.concat(a)},"");return("kw_test_"+(c?"auto_":"")+d+p+"carbon_e2e_"+S+n.reduce((e,t)=>{let r=`${t}_`;return e.concat(r)},"")+u+"@mailinator.com").toLocaleLowerCase()}},94947:function(e,t){var r,a;Object.defineProperty(t,"__esModule",{value:!0}),t.TestAccountThrottlingBehaviour=t.TestAccountType=void 0,(r=t.TestAccountType||(t.TestAccountType={}))[r.Free=0]="Free",r[r.FreePremiumTrial=1]="FreePremiumTrial",r[r.Legacy=2]="Legacy",r[r.PremiumPaid=3]="PremiumPaid",r[r.PremiumPlus=4]="PremiumPlus",r[r.Family=5]="Family",(a=t.TestAccountThrottlingBehaviour||(t.TestAccountThrottlingBehaviour={}))[a.Normal=0]="Normal",a[a.Unthrottled=1]="Unthrottled"},37705:function(e,t,r){var a=this&&this.__createBinding||(Object.create?function(e,t,r,a){void 0===a&&(a=r);var o=Object.getOwnPropertyDescriptor(t,r);(!o||("get"in o?!t.__esModule:o.writable||o.configurable))&&(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,a,o)}:function(e,t,r,a){void 0===a&&(a=r),e[a]=t[r]}),o=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||a(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),o(r(36388),t),o(r(76969),t),o(r(94947),t)},86336:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e=2e3){return new Promise(t=>setTimeout(t,e))}},916:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.getServiceProviderToken=void 0;let a=r(57758),o=r(28323),n=r(24416),i=r(4455),s=async(e,t)=>{let{storeService:r}=e;!function(e,t){e.dispatch((0,a.deviceRegistered)((0,a.makeDeviceRegistrationKeys)(t.deviceAccessKey,t.deviceSecretKey),i.PersistData.PERSIST_DATA_YES,t.login))}(r,t);let{login:s,teamUuid:c,deviceAccessKey:l,deviceSecretKey:u}=t,d=`${c}%${t.userServiceProviderKey}`,p=await (0,n.getUserSSOInfo)(r,{login:s,teamUuid:c,teamDeviceAccessKey:l,teamDeviceSecretKey:u,userServiceProviderKey:d});if((0,o.isApiError)(p))throw Error(`Error: ${p.code}`);return p};t.getServiceProviderToken=s},52013:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.forceBreachRefreshHandler=void 0;let a=r(5485),o=async({applicationModulesAccess:e,storeService:t,wsService:r})=>{let o=(0,a.getInstance)(e,t,r);await o.refresh({forceRefresh:!0})};t.forceBreachRefreshHandler=o},28738:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.createPublicBreachHelper=t.addPrivateBreachHelper=t.createOrUpdateDarkWebBreachHelper=t.saveBankAccount=t.updateCredential=t.getCredentials=t.saveCredential=void 0;let a=r(42387),o=r(20648),n=r(28323),i=r(60249),s=r(90464),c=r(2409),l=r(86336),u=r(37705);async function d(e,t,r={}){let a=function({title:e,email:t,password:r,url:a,...n}){return{kwType:"KWAuthentifiant",origin:o.SaveOrigin.MANUAL,content:{category:"",email:t,login:t,onlyForThisSubdomain:!1,password:r,protectWithMasterPassword:!1,secondaryLogin:"",url:a??"",title:e,autoLogin:!1,note:"",spaceId:"",linkedWebsites:{addedByDashlane:[],addedByUser:[]},...n}}}({title:"title",email:"email@domain.com",password:u.DEFAULT_E2E_ACCOUNT_PASSWORD,...r});await e.savePersonalDataItem(t??a),await (0,l.default)(100)}async function p(e){return e.getCredentials({filterToken:{filterCriteria:[]},sortToken:{sortCriteria:[],uniqField:"id"}})}async function S(e,t,r={}){let a={kwType:"KWBankStatement",origin:o.SaveOrigin.MANUAL,content:{name:"name",owner:"owner",IBAN:"",BIC:"",bank:"",...r,...t}};await e.savePersonalDataItem(t??a),await (0,l.default)(100)}t.saveCredential=d,t.getCredentials=p,t.updateCredential=function(e,{id:t,title:r,email:a,url:o,password:n},i){return d(e,void 0,{id:t,title:r,email:a,password:n,url:o,...i})},t.saveBankAccount=S;let g=async({storeService:e},t)=>{t.databreach.uuid||(t.databreach.uuid=(0,a.v4)());let r=await (0,i.createOrUpdateDarkWebBreach)(e,t);if(!(0,n.isApiError)(r))return t.databreach.uuid;throw Error(`Error when creating / updating test data breach: ${r.message}`)};t.createOrUpdateDarkWebBreachHelper=g;let m=async({storeService:e},t)=>await (0,s.addPrivateBreach)(e,t);t.addPrivateBreachHelper=m;let y=async({storeService:e},t)=>{let r=await (0,c.createPublicBreach)(e,t);if((0,n.isApiError)(r))throw Error(`Error when creating test breach: ${r.code}, ${r.message}`);return r};t.createPublicBreachHelper=y},89413:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.sync=t.waitForSync=void 0;let a=r(86336);function o(e,t={timeout:3e4}){let r,a;let n=setTimeout(()=>{a(Error("Sync timed out"))},t.timeout),i=new Promise((e,t)=>{r=e,a=t}),s=e.sessionSyncStatus.on(({status:e})=>{"syncing"!==e&&(clearTimeout(n),s(),"success"===e?r():"error"===e&&a(Error("Sync failed")))});return i}async function n(e){await e.sessionForceSync({}),await o(e),await (0,a.default)()}t.waitForSync=o,t.sync=n},48855:function(e,t,r){var a=this&&this.__createBinding||(Object.create?function(e,t,r,a){void 0===a&&(a=r);var o=Object.getOwnPropertyDescriptor(t,r);(!o||("get"in o?!t.__esModule:o.writable||o.configurable))&&(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,a,o)}:function(e,t,r,a){void 0===a&&(a=r),e[a]=t[r]}),o=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||a(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),t.DashlaneAPISchemesNames=t.HttpErrorCode=t.init=t.CarbonStorage=t.decipherDatabaseRules=t.interfaces=void 0,t.interfaces=r(5727);var n=r(86590);Object.defineProperty(t,"decipherDatabaseRules",{enumerable:!0,get:function(){return n.decipherDatabaseRules}}),o(r(73386),t);var i=r(2068);Object.defineProperty(t,"CarbonStorage",{enumerable:!0,get:function(){return i.CarbonLocalStorage}});var s=r(18201);Object.defineProperty(t,"init",{enumerable:!0,get:function(){return s.init}});var c=r(74907);Object.defineProperty(t,"HttpErrorCode",{enumerable:!0,get:function(){return c.HttpErrorCode}});var l=r(3314);Object.defineProperty(t,"DashlaneAPISchemesNames",{enumerable:!0,get:function(){return l.DashlaneAPISchemesNames}}),o(r(57690),t)},18201:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.init=void 0;let a=r(47674),o=r(6076);async function n(e){let t=await (0,o.initCarbon)(e);return(0,a.getCoreServices)(t)}t.init=n},26159:function(e,t,r){r.d(t,{KV:()=>s,co:()=>i,td:()=>n});var a=r(12791),o=r(56787);let n={participateToUserABTest:(0,a.slot)()},i={getUserABTestVariant:(0,a.slot)()},s={liveUserABTestVariant:(0,o.H)()}},19005:function(e,t,r){r.d(t,{PG:()=>i,PO:()=>n,cN:()=>s});var a=r(12791),o=r(56787);let n={editContactInfo:(0,a.slot)(),refreshContactInfo:(0,a.slot)()},i={getContactInfo:(0,a.slot)()},s={liveContactInfo:(0,o.H)()}},44245:function(e,t,r){r.d(t,{f:()=>a});let a={livePhishingURLList:(0,r(56787).H)()}},23768:function(e,t,r){r.d(t,{KM:()=>n,b6:()=>i,ud:()=>s});var a=r(12791),o=r(56787);let n={refreshU2FDevicesList:(0,a.slot)(),removeU2FAuthenticator:(0,a.slot)(),refreshTwoFactorAuthenticationInfo:(0,a.slot)(),startTwoFactorAuthenticationEnableFlow:(0,a.slot)(),stopTwoFactorAuthenticationEnableFlow:(0,a.slot)(),continueTwoFactorAuthenticationEnableFlow:(0,a.slot)(),backTwoFactorAuthenticationEnableFlow:(0,a.slot)(),startTwoFactorAuthenticationDisableFlow:(0,a.slot)(),stopTwoFactorAuthenticationDisableFlow:(0,a.slot)(),continueTwoFactorAuthenticationDisableFlow:(0,a.slot)(),backTwoFactorAuthenticationDisableFlow:(0,a.slot)()},i={getU2FDevicesList:(0,a.slot)(),getTwoFactorAuthenticationEnableStage:(0,a.slot)(),getTwoFactorAuthenticationDisableStage:(0,a.slot)()},s={liveU2FDevicesList:(0,o.H)(),liveTwoFactorAuthenticationEnableStage:(0,o.H)(),liveTwoFactorAuthenticationDisableStage:(0,o.H)()}},38466:function(e,t,r){r.d(t,{M2:()=>h,O6:()=>I,Ok:()=>v,Oq:()=>E,Pb:()=>m,Rr:()=>A,bL:()=>_,dc:()=>y,fl:()=>f,tv:()=>D,vW:()=>T,vz:()=>a});let a=Object.freeze({CREATE:"webauthn.create",GET:"webauthn.get"});var o,n,i,s,c,l,u,d,p,S,g,m=((o={}).UNKNOWN_ERROR="UNKNOWN_ERROR",o),y=((n={}).UNKNOWN_ERROR="UNKNOWN_ERROR",n.USER_HAS_OTP="USER_HAS_OTP",n.WEBAUTHN_SERVICE_INIT_FAILED="WEBAUTHN_SERVICE_INIT_FAILED",n),f=((i={}).UNKNOWN_ERROR="UNKNOWN_ERROR",i),E=((s={}).USER_HAS_OTP="USER_HAS_OTP",s.UNKNOWN_ERROR="UNKNOWN_ERROR",s),A=((c={}).UNKNOWN_ERROR="UNKNOWN_ERROR",c),h=((l={}).UNKNOWN_ERROR="UNKNOWN_ERROR",l.MISSING_SESSION_KEYS_IN_STORE="MISSING_SESSION_KEYS_IN_STORE",l),_=((u={}).UNKNOWN_ERROR="UNKNOWN_ERROR",u.UNAVAILABLE_AUTHENTICATORS="UNAVAILABLE_AUTHENTICATORS",u.CANNOT_TRIGGER_WEBAUTHN_AUTHENTICATION="CANNOT_TRIGGER_WEBAUTHN_AUTHENTICATION",u),T=((d={}).UNKNOWN_ERROR="UNKNOWN_ERROR",d.MP_MISSING_IN_SESSION_ERROR="MP_MISSING_IN_SESSION_ERROR",d),v=((p={}).UNKNOWN_ERROR="UNKNOWN_ERROR",p.WEBAUTHN_SERVICE_DEACTIVATE_FAILED="WEBAUTHN_SERVICE_DEACTIVATE_FAILED",p.MISSING_LOGIN="MISSING_LOGIN",p),I=((S={}).UNKNOWN_ERROR="UNKNOWN_ERROR",S.CANNOT_REMOVE_WEBAUTHN_AUTHENTICATOR="CANNOT_REMOVE_WEBAUTHN_AUTHENTICATOR",S),D=((g={}).UNKNOWN_ERROR="UNKNOWN_ERROR",g.LOGGED_OUT="LOGGED_OUT",g.CANNOT_REFRESH_WEBAUTHN_AUTHENTICATORS="CANNOT_REFRESH_WEBAUTHN_AUTHENTICATORS",g.CANNOT_FETCH_WEBAUTHN_CHALLENGE="CANNOT_FETCH_WEBAUTHN_CHALLENGE",g)},62571:function(e,t,r){r.d(t,{Ui:()=>i,jF:()=>s,qM:()=>n});var a=r(12791),o=r(56787);let n={enableWebAuthnAuthentication:(0,a.slot)(),initEnableWebAuthnAuthentication:(0,a.slot)(),refreshAvailableWebAuthnAuthenticators:(0,a.slot)(),refreshWebAuthnAuthenticators:(0,a.slot)(),initRegisterWebAuthnAuthenticator:(0,a.slot)(),registerWebAuthnAuthenticator:(0,a.slot)(),initOpenSessionWithWebAuthnAuthenticator:(0,a.slot)(),openSessionWithWebAuthnAuthenticator:(0,a.slot)(),disableWebAuthnAuthentication:(0,a.slot)(),removeWebAuthnAuthenticator:(0,a.slot)(),initUserVerificationWithWebAuthn:(0,a.slot)()},i={getWebAuthnAuthenticators:(0,a.slot)(),getWebAuthnAuthenticationOptedIn:(0,a.slot)()},s={liveWebAuthnAuthenticators:(0,o.H)(),liveWebAuthnAuthenticationOptedIn:(0,o.H)()}},85548:function(e,t,r){r.d(t,{QR:()=>l,ke:()=>c,zR:()=>s});var a=r(12791),o=r(62571),n=r(23768),i=r(56787);let s=(0,a.combineEvents)({openSessionWithMasterPassword:(0,a.slot)(),registerDevice:(0,a.slot)(),requestEmailToken:(0,a.slot)(),requestPaymentUpdateAuthenticationToken:(0,a.slot)(),setReactivationStatus:(0,a.slot)(),disableAutologin:(0,a.slot)()},o.qM,n.KM),c=(0,a.combineEvents)({getHasOtp2Type:(0,a.slot)(),getUserOtpType:(0,a.slot)(),getReactivationStatus:(0,a.slot)(),getAvailableUserVerificationMethods:(0,a.slot)()},o.Ui,n.b6),l=(0,a.combineEvents)({liveReactivationStatus:(0,i.H)()},o.jF,n.ud)},86518:function(e,t,r){r.d(t,{WQ:()=>u,Yp:()=>a,_V:()=>p,_g:()=>c,jP:()=>l,mE:()=>d});let a="SEND_TOKEN_FAILED";var o,n,i,s,c=((o={}).DISABLED="DISABLED",o.CLASSIC="CLASSIC",o.WEBAUTHN="WEBAUTHN",o),l=((n={})[n.PERSIST_DATA_YES=0]="PERSIST_DATA_YES",n[n.PERSIST_DATA_NO=1]="PERSIST_DATA_NO",n);let u=Object.freeze({MasterPassword:"masterPassword",Webauthn:"webauthn"});var d=((i={})[i.NO_OTP=0]="NO_OTP",i[i.OTP_NEW_DEVICE=1]="OTP_NEW_DEVICE",i[i.OTP_LOGIN=2]="OTP_LOGIN",i),p=((s={})[s.INVALID_LOGIN=0]="INVALID_LOGIN",s[s.EMPTY_LOGIN=1]="EMPTY_LOGIN",s[s.EMPTY_MASTER_PASSWORD=2]="EMPTY_MASTER_PASSWORD",s[s.EMPTY_ENCRYPTED_KEY=3]="EMPTY_ENCRYPTED_KEY",s[s.INVALID_ENCRYPTED_KEY=4]="INVALID_ENCRYPTED_KEY",s[s.EMPTY_TOKEN=5]="EMPTY_TOKEN",s[s.EMPTY_OTP=6]="EMPTY_OTP",s[s.SEND_TOKEN_FAILED=7]="SEND_TOKEN_FAILED",s[s.UKI_REGISTRATION_FAILED=8]="UKI_REGISTRATION_FAILED",s[s.REGISTER_DEVICE_FAILED=9]="REGISTER_DEVICE_FAILED",s[s.BUSINESS_ERROR=10]="BUSINESS_ERROR",s[s.USER_DOESNT_EXIST=11]="USER_DOESNT_EXIST",s[s.USER_DOESNT_EXIST_UNLIKELY_MX=12]="USER_DOESNT_EXIST_UNLIKELY_MX",s[s.USER_DOESNT_EXIST_INVALID_MX=13]="USER_DOESNT_EXIST_INVALID_MX",s[s.USER_UNAUTHORIZED=14]="USER_UNAUTHORIZED",s[s.WRONG_PASSWORD=15]="WRONG_PASSWORD",s[s.DATA_TAMPERED_ERROR=16]="DATA_TAMPERED_ERROR",s[s.LOGGEDIN=17]="LOGGEDIN",s[s.ASK_TOKEN=18]="ASK_TOKEN",s[s.ASK_OTP=19]="ASK_OTP",s[s.ASK_MASTER_PASSWORD=20]="ASK_MASTER_PASSWORD",s[s.USE_LOCAL_UKI=21]="USE_LOCAL_UKI",s[s.ASK_DASHLANE_AUTHENTICATOR=22]="ASK_DASHLANE_AUTHENTICATOR",s[s.OTP_NOT_VALID=23]="OTP_NOT_VALID",s[s.OTP_TOO_MANY_ATTEMPTS=24]="OTP_TOO_MANY_ATTEMPTS",s[s.OTP_ALREADY_USED=25]="OTP_ALREADY_USED",s[s.BACKUP_CODE_NOT_VALID=26]="BACKUP_CODE_NOT_VALID",s[s.TOKEN_NOT_VALID=27]="TOKEN_NOT_VALID",s[s.DASHLANE_AUTHENTICATOR_PUSH_NOTIFICATION_DENIED=28]="DASHLANE_AUTHENTICATOR_PUSH_NOTIFICATION_DENIED",s[s.SERVER_KEY_MISSING=29]="SERVER_KEY_MISSING",s[s.TOKEN_LOCKED=30]="TOKEN_LOCKED",s[s.TOKEN_TOO_MANY_ATTEMPTS=31]="TOKEN_TOO_MANY_ATTEMPTS",s[s.TOKEN_ACCOUNT_LOCKED=32]="TOKEN_ACCOUNT_LOCKED",s[s.TOKEN_EXPIRED=33]="TOKEN_EXPIRED",s[s.NO_ACTIVE_AUTHENTICATOR=34]="NO_ACTIVE_AUTHENTICATOR",s[s.FAILED_TO_CONTACT_AUTHENTICATOR_DEVICE=35]="FAILED_TO_CONTACT_AUTHENTICATOR_DEVICE",s[s.DASHLANE_AUTHENTICATOR_ASKED_FOR_LOCAL_SESSION=36]="DASHLANE_AUTHENTICATOR_ASKED_FOR_LOCAL_SESSION",s[s.DASHLANE_AUTHENTICATOR_LOGIN_CANCELLED=37]="DASHLANE_AUTHENTICATOR_LOGIN_CANCELLED",s[s.TOKEN_PROVIDED_FOR_LOCAL_SESSION=38]="TOKEN_PROVIDED_FOR_LOCAL_SESSION",s[s.DEVICE_ALREADY_REGISTERED=39]="DEVICE_ALREADY_REGISTERED",s[s.OTP_PROVIDED_FOR_LOCAL_NON_OTP_SESSION=40]="OTP_PROVIDED_FOR_LOCAL_NON_OTP_SESSION",s[s.DIFFERENT_LOGIN_PROVIDED_WITH_TOKEN_OR_OTP=41]="DIFFERENT_LOGIN_PROVIDED_WITH_TOKEN_OR_OTP",s[s.UNKNOWN_SYNC_ERROR=42]="UNKNOWN_SYNC_ERROR",s[s.INVALID_UKI=43]="INVALID_UKI",s[s.UNKNOWN_UKI=44]="UNKNOWN_UKI",s[s.UNKNOWN_ERROR=45]="UNKNOWN_ERROR",s[s.UNEXPECTED_OTP_TYPE=46]="UNEXPECTED_OTP_TYPE",s[s.UNAUTHORIZED=47]="UNAUTHORIZED",s[s.UNAUTHORIZED_NOT_VALID_CONTENT=48]="UNAUTHORIZED_NOT_VALID_CONTENT",s[s.NETWORK_ERROR=49]="NETWORK_ERROR",s[s.THROTTLED=50]="THROTTLED",s[s.SESSION_ALREADY_OPENED=51]="SESSION_ALREADY_OPENED",s[s.INVALID_SESSION=52]="INVALID_SESSION",s[s.DEVICE_NOT_REGISTERED=53]="DEVICE_NOT_REGISTERED",s[s.MISSING_APP_KEYS=54]="MISSING_APP_KEYS",s[s.PROVIDE_EXTRA_DEVICE_TOKEN=55]="PROVIDE_EXTRA_DEVICE_TOKEN",s[s.PROVIDE_MASTER_PASSWORD_FOR_EXTRA_DEVICE=56]="PROVIDE_MASTER_PASSWORD_FOR_EXTRA_DEVICE",s[s.PROVIDE_MASTER_PASSWORD_AND_SERVER_KEY_FOR_EXTRA_DEVICE=57]="PROVIDE_MASTER_PASSWORD_AND_SERVER_KEY_FOR_EXTRA_DEVICE",s[s.ASK_OTP_FOR_NEW_DEVICE=58]="ASK_OTP_FOR_NEW_DEVICE",s[s.TEAM_GENERIC_ERROR=59]="TEAM_GENERIC_ERROR",s[s.SSO_LOGIN_BYPASS=60]="SSO_LOGIN_BYPASS",s[s.SSO_VERIFICATION_FAILED=61]="SSO_VERIFICATION_FAILED",s[s.SSO_BLOCKED=62]="SSO_BLOCKED",s[s.CLIENT_VERSION_DOES_NOT_SUPPORT_SSO_MIGRATION=63]="CLIENT_VERSION_DOES_NOT_SUPPORT_SSO_MIGRATION",s[s.USER_DOESNT_EXIST_SSO=64]="USER_DOESNT_EXIST_SSO",s[s.EOL_UPDATE_REQUIRED=65]="EOL_UPDATE_REQUIRED",s)},30412:function(e,t,r){r.d(t,{c:()=>o});var a=r(12791);let o={getSingleCompanyForAutofill:(0,a.slot)(),getMultipleCompaniesForAutofill:(0,a.slot)(),getSingleCredentialForAutofill:(0,a.slot)(),getMultipleCredentialsForAutofill:(0,a.slot)(),getSingleDriverLicenseForAutofill:(0,a.slot)(),getMultipleDriverLicensesForAutofill:(0,a.slot)(),getSingleEmailForAutofill:(0,a.slot)(),getMultipleEmailsForAutofill:(0,a.slot)(),getSingleFiscalIdForAutofill:(0,a.slot)(),getMultipleFiscalIdsForAutofill:(0,a.slot)(),getSingleGeneratedPasswordForAutofill:(0,a.slot)(),getMultipleGeneratedPasswordsForAutofill:(0,a.slot)(),getSingleIdCardForAutofill:(0,a.slot)(),getMultipleIdCardsForAutofill:(0,a.slot)(),getSingleIdentityForAutofill:(0,a.slot)(),getMultipleIdentitiesForAutofill:(0,a.slot)(),getSingleNoteForAutofill:(0,a.slot)(),getSinglePasskeyForAutofill:(0,a.slot)(),getSinglePassportForAutofill:(0,a.slot)(),getMultiplePassportsForAutofill:(0,a.slot)(),getSinglePaymentCardForAutofill:(0,a.slot)(),getMultiplePaymentCardsForAutofill:(0,a.slot)(),getSinglePersonalWebsiteForAutofill:(0,a.slot)(),getMultiplePersonalWebsitesForAutofill:(0,a.slot)(),getSinglePhoneForAutofill:(0,a.slot)(),getMultiplePhonesForAutofill:(0,a.slot)(),getSingleSocialSecurityIdForAutofill:(0,a.slot)(),getMultipleSocialSecurityIdsForAutofill:(0,a.slot)(),getAutofillSettingOnUrlForAutofill:(0,a.slot)()}},19015:function(e,t,r){r.d(t,{Z:()=>n});var a=r(52031),o=r(66407);let n={[a.k.Address]:o.dJ.KWAddress,[a.k.BankAccount]:o.dJ.KWBankStatement,[a.k.Company]:o.dJ.KWCompany,[a.k.Credential]:o.dJ.KWAuthentifiant,[a.k.DriverLicense]:o.dJ.KWDriverLicence,[a.k.Email]:o.dJ.KWEmail,[a.k.FiscalId]:o.dJ.KWFiscalStatement,[a.k.GeneratedPassword]:o.dJ.KWGeneratedPassword,[a.k.IdCard]:o.dJ.KWIDCard,[a.k.Identity]:o.dJ.KWIdentity,[a.k.Note]:o.dJ.KWSecureNote,[a.k.Passkey]:o.dJ.KWPasskey,[a.k.Passport]:o.dJ.KWPassport,[a.k.PaymentCard]:o.dJ.KWPaymentMean_creditCard,[a.k.PersonalWebsite]:o.dJ.KWPersonalWebsite,[a.k.Phone]:o.dJ.KWPhone,[a.k.SocialSecurityId]:o.dJ.KWSocialSecurityStatement,[a.k.Secret]:o.dJ.KWSecret}},90960:function(e,t,r){r.d(t,{X:()=>s});var a=r(12791),o=r(97647),n=r(22989),i=r(84695);let s=(0,a.combineEvents)(o.z,n.r,i.z)},97647:function(e,t,r){r.d(t,{z:()=>N});var a=r(12791),o=r(26159),n=r(85548),i=r(93704),s=r(19005),c=r(46684),l=r(3959),u=r(83252),d=r(49068),p=r(52742),S=r(79853),g=r(4409),m=r(851),y=r(87534),f=r(36792),E=r(58852),A=r(76950),h=r(90416),_=r(74190),T=r(27188),v=r(71614),I=r(20770),D=r(58415),P=r(75053),O=r(88323),C=r(2328),b=r(7131),R=r(7572);let N=(0,a.combineEvents)(o.td,n.zR,i.v,s.PO,c.rU,l.I,u.fv,d.c,p.e,S.a,g.M,m.x,y._m,f.vq,E.U$,A.of,h.r,_._,T.gQ,v.$k,I.H9,D.u,P.b,O.hO,C.Kr,b.lp,R.n)},84695:function(e,t,r){r.d(t,{z:()=>T});var a=r(12791),o=r(26159),n=r(44245),i=r(85548),s=r(93704),c=r(19005),l=r(46684),u=r(83252),d=r(65175),p=r(87534),S=r(36792),g=r(58852),m=r(76950),y=r(27188),f=r(71614),E=r(20770),A=r(88323),h=r(2328),_=r(7131);let T=(0,a.combineEvents)(o.KV,n.f,i.QR,s.F,c.cN,l.vF,u.QX,d.b,p.Rj,S._1,g.iX,m.K1,y.qN,f.EX,E.YW,A.dN,h.kh,_.fD)},22989:function(e,t,r){r.d(t,{r:()=>P});var a=r(12791),o=r(26159),n=r(85548),i=r(30412),s=r(19005),c=r(46684),l=r(83252),u=r(7572),d=r(36371),p=r(65175),S=r(87534),g=r(36792),m=r(58852),y=r(76950),f=r(90416),E=r(74190),A=r(27188),h=r(71614),_=r(20770),T=r(75053),v=r(88323),I=r(2328),D=r(7131);let P=(0,a.combineEvents)(o.co,n.ke,i.c,s.PG,c.kQ,l.pz,u.C,d.i,p.c,S.Xz,g.xP,m.Ie,y.A2,f.H,E.P,A.UW,h.q9,_.JQ,T.N,v.XJ,I.Vz,D.T4)},56787:function(e,t,r){r.d(t,{H:()=>n});var a=r(12791);let o={noBuffer:!0},n=()=>(0,a.slot)(o)},7917:function(e,t,r){r.d(t,{o:()=>o});var a=r(12791);let o={log:(0,a.slot)(),info:(0,a.slot)(),warning:(0,a.slot)(),error:(0,a.slot)()}},93704:function(e,t,r){r.d(t,{F:()=>i,v:()=>n});var a=r(12791),o=r(56787);let n={changeMasterPassword:(0,a.slot)()},i={liveChangeMasterPasswordStatus:(0,o.H)()}},42758:function(e,t,r){r.d(t,{FD:()=>c,Ud:()=>s,pT:()=>i});var a,o,n,i=((a={}).USER_CHANGING_MP="USER_CHANGING_MP",a.MP_TO_SSO="MP_TO_SSO",a.SSO_TO_MP="SSO_TO_MP",a.TO_EMAIL_TOKEN="EMAIL_TOKEN",a.ADMIN_ASSISTED_RECOVERY="ADMIN_ASSISTED_RECOVERY",a.ACCOUNT_RECOVERY_KEY="ACCOUNT_RECOVERY_KEY",a),s=((o={}).FEATURE_BLOCKED="feature_blocked",o.INNACTIVE_SESSION="inactive_session",o.INVALID_TOKEN="invalid_token",o.OTP_PROBLEM="otp_problem",o.MP_ERROR="mp_error",o.MP_STRENGTH_ERROR="mp_strength_error",o.SUCCESS="success",o.SYNC_PROGRESS="sync_in_progress",o.UNKNOWN_ERROR="unknown_error",o.WRONG_PASSWORD="wrong_password",o.UNEXPECTED_STATE="unexpected_state",o),c=((n={}).DOWNLOAD="download",n.DECRYPTING="decrypting",n.ENCRYPTING="encrypting",n.UPLOADING="uploading",n.DONE="done",n.ERROR="error",n)},46684:function(e,t,r){r.d(t,{kQ:()=>i,rU:()=>n,vF:()=>s});var a=r(12791),o=r(56787);let n={changeUserCrypto:(0,a.slot)()},i={getCanUserChangeCrypto:(0,a.slot)(),getUserDerivationMethod:(0,a.slot)()},s={liveUserDerivationMethod:(0,o.H)()}},3959:function(e,t,r){r.d(t,{I:()=>o});var a=r(12791);let o={getDarkWebInsightsReportResults:(0,a.slot)(),getDarkWebInsightsSummary:(0,a.slot)()}},66407:function(e,t,r){r.d(t,{Bm:()=>i,D7:()=>u,Sw:()=>m,Ww:()=>l,XM:()=>p,cH:()=>n,dJ:()=>s,gD:()=>d,iU:()=>c,mg:()=>g,pt:()=>y,s5:()=>S});var a,o=r(49204),n=((a={}).NO_TYPE="NO_TYPE",a.UNIVERSAL="UNIVERSAL",a.AD="AD",a.AE="AE",a.AF="AF",a.AG="AG",a.AI="AI",a.AL="AL",a.AM="AM",a.AO="AO",a.AR="AR",a.AS="AS",a.AT="AT",a.AU="AU",a.AW="AW",a.AZ="AZ",a.BA="BA",a.BB="BB",a.BD="BD",a.BE="BE",a.BF="BF",a.BG="BG",a.BH="BH",a.BI="BI",a.BJ="BJ",a.BL="BL",a.BM="BM",a.BN="BN",a.BO="BO",a.BR="BR",a.BS="BS",a.BT="BT",a.BW="BW",a.BY="BY",a.BZ="BZ",a.CA="CA",a.CD="CD",a.CF="CF",a.CG="CG",a.CH="CH",a.CI="CI",a.CK="CK",a.CL="CL",a.CM="CM",a.CN="CN",a.CO="CO",a.CR="CR",a.CU="CU",a.CV="CV",a.CY="CY",a.CZ="CZ",a.DE="DE",a.DJ="DJ",a.DK="DK",a.DM="DM",a.DO="DO",a.DZ="DZ",a.EC="EC",a.EE="EE",a.EG="EG",a.ER="ER",a.ES="ES",a.ET="ET",a.FI="FI",a.FJ="FJ",a.FK="FK",a.FM="FM",a.FO="FO",a.FR="FR",a.GA="GA",a.GB="GB",a.GD="GD",a.GE="GE",a.GF="GF",a.GG="GG",a.GH="GH",a.GI="GI",a.GL="GL",a.GM="GM",a.GN="GN",a.GP="GP",a.GQ="GQ",a.GR="GR",a.GT="GT",a.GU="GU",a.GW="GW",a.GY="GY",a.HK="HK",a.HN="HN",a.HR="HR",a.HT="HT",a.HU="HU",a.ID="ID",a.IE="IE",a.IL="IL",a.IM="IM",a.IN="IN",a.IO="IO",a.IQ="IQ",a.IR="IR",a.IS="IS",a.IT="IT",a.JE="JE",a.JM="JM",a.JO="JO",a.JP="JP",a.KE="KE",a.KG="KG",a.KH="KH",a.KI="KI",a.KM="KM",a.KN="KN",a.KP="KP",a.KR="KR",a.KW="KW",a.KY="KY",a.KZ="KZ",a.LA="LA",a.LB="LB",a.LC="LC",a.LI="LI",a.LK="LK",a.LR="LR",a.LS="LS",a.LT="LT",a.LU="LU",a.LV="LV",a.LY="LY",a.MA="MA",a.MC="MC",a.MD="MD",a.ME="ME",a.MF="MF",a.MG="MG",a.MH="MH",a.MK="MK",a.ML="ML",a.MM="MM",a.MN="MN",a.MO="MO",a.MP="MP",a.MQ="MQ",a.MR="MR",a.MS="MS",a.MT="MT",a.MU="MU",a.MV="MV",a.MW="MW",a.MX="MX",a.MY="MY",a.MZ="MZ",a.NA="NA",a.NC="NC",a.NE="NE",a.NF="NF",a.NG="NG",a.NI="NI",a.NL="NL",a.NO="NO",a.NP="NP",a.NR="NR",a.NU="NU",a.NZ="NZ",a.OM="OM",a.PA="PA",a.PE="PE",a.PF="PF",a.PG="PG",a.PH="PH",a.PK="PK",a.PL="PL",a.PM="PM",a.PR="PR",a.PS="PS",a.PT="PT",a.PW="PW",a.PY="PY",a.QA="QA",a.RE="RE",a.RO="RO",a.RS="RS",a.RU="RU",a.RW="RW",a.SA="SA",a.SB="SB",a.SC="SC",a.SD="SD",a.SE="SE",a.SG="SG",a.SH="SH",a.SI="SI",a.SK="SK",a.SL="SL",a.SM="SM",a.SN="SN",a.SO="SO",a.SR="SR",a.ST="ST",a.SV="SV",a.SY="SY",a.SZ="SZ",a.TC="TC",a.TD="TD",a.TF="TF",a.TG="TG",a.TH="TH",a.TJ="TJ",a.TK="TK",a.TL="TL",a.TM="TM",a.TN="TN",a.TO="TO",a.TR="TR",a.TT="TT",a.TV="TV",a.TW="TW",a.TZ="TZ",a.UA="UA",a.UG="UG",a.US="US",a.UY="UY",a.UZ="UZ",a.VA="VA",a.VC="VC",a.VE="VE",a.VG="VG",a.VI="VI",a.VN="VN",a.VU="VU",a.WF="WF",a.WS="WS",a.XK="XK",a.YE="YE",a.YT="YT",a.ZA="ZA",a.ZM="ZM",a.ZW="ZW",a.AQ="AQ",a.AX="AX",a.BV="BV",a.CC="CC",a.CX="CX",a.EH="EH",a.GS="GS",a.HM="HM",a.PN="PN",a.SJ="SJ",a.UM="UM",a);function i(e){return e.LocaleFormat}let s=(0,o.Enum)("KWAddress","KWAuthentifiant","KWBankStatement","KWCollection","KWCompany","KWDataChangeHistory","KWDriverLicence","KWEmail","KWFiscalStatement","KWGeneratedPassword","KWIDCard","KWIdentity","KWMerchand","KWMiscData","KWPasskey","KWPassport","KWPaymentMean_creditCard","KWPaymentMean_paypal","KWPersonalWebsite","KWPhone","KWPurchaseAccount","KWPurchaseCategory","KWPurchasePaidBasket","KWPurchaseTrueArticle","KWSecret","KWSecureFileInfo","KWSecureNote","KWSecurityBreach","KWSettingsManagerApp","KWSocialSecurityStatement","KWWebSite"),c=(0,o.Enum)("ADDRESS","AUTHENTIFIANT","BANKACCESS","BANKACCOUNT","BANKCATEGORY","BANKINSTITUTION","BANKSITE","BANKSTATEMENT","BANKTRANSACTION","COLLECTION","COMPANY","DATA_CHANGE_HISTORY","DATA_USAGE_HISTORY","DEFAULT_AUTHENTIFIANT","DEFAULT_CONFIDENTIAL","DEFAULT_IDENTITY","DEFAULT_MISC","DEFAULT_PAYMENTMEANS","DEFAULT_REWARDCARD","DRIVERLICENCE","EMAIL","EMERGENCY_BUNDLE_FULL","EMERGENCY_BUNDLE_LITE","FULLBACKUP","FISCALSTATEMENT","GENERATED_PASSWORD","IDCARD","IDENTITY","INVOICEACCESS","INVOICEELEMENT","INVOICEINSTITUTION","MERCHANT","MISCDATA","PASSKEY","PASSPORT","PAYMENTMEANS_CREDITCARD","PAYMENTMEAN_PAYPAL","PERSONALWEBSITE","PHONE","POINTS","PURCHASEABANDONNEDBASKET","PURCHASEACCOUNT","PURCHASEARTICLE","PURCHASEBASKET","PURCHASEDELIVERYARTICLE","PURCHASEOPTIONARTICLE","PURCHASEPAIDBASKET","PURCHASE_CATEGORY","REWARDCARD","SECRET","SECUREFILEINFO","SECURENOTE","SECURITYALERT","SECURITYALERTS","SECURITYBREACH","SETTINGS","SHARING_GROUP","SOCIALSECURITYSTATEMENT","WEBSITE"),l={KWAddress:c.ADDRESS,KWAuthentifiant:c.AUTHENTIFIANT,KWCollection:c.COLLECTION,KWBankStatement:c.BANKSTATEMENT,KWCompany:c.COMPANY,KWDataChangeHistory:c.DATA_CHANGE_HISTORY,KWDriverLicence:c.DRIVERLICENCE,KWEmail:c.EMAIL,KWFiscalStatement:c.FISCALSTATEMENT,KWGeneratedPassword:c.GENERATED_PASSWORD,KWIDCard:c.IDCARD,KWIdentity:c.IDENTITY,KWMerchand:c.MERCHANT,KWMiscData:c.MISCDATA,KWPasskey:c.PASSKEY,KWPassport:c.PASSPORT,KWPaymentMean_creditCard:c.PAYMENTMEANS_CREDITCARD,KWPaymentMean_paypal:c.PAYMENTMEAN_PAYPAL,KWPersonalWebsite:c.PERSONALWEBSITE,KWPhone:c.PHONE,KWPurchaseAccount:c.PURCHASEACCOUNT,KWPurchaseCategory:c.PURCHASE_CATEGORY,KWPurchasePaidBasket:c.PURCHASEPAIDBASKET,KWPurchaseTrueArticle:c.PURCHASEARTICLE,KWSecret:c.SECRET,KWSecureFileInfo:c.SECUREFILEINFO,KWSecureNote:c.SECURENOTE,KWSecurityBreach:c.SECURITYBREACH,KWSettingsManagerApp:c.SETTINGS,KWSocialSecurityStatement:c.SOCIALSECURITYSTATEMENT,KWWebSite:c.WEBSITE},u=Object.values(s).reduce((e,t)=>(e[l[t]]=t,e),{});function d(e){let t=u[e];if(!t)throw Error(`No DataModelType found for TransactionType '${e}'`);return t}function p(e){if(!l[e])throw Error(`No TransactionType found for DataModelType ${e}`);return l[e]}let S=o.Enum.keys(c),g=o.Enum.keys(s),m=e=>!!e.LocaleFormat&&"string"==typeof e.SpaceId;function y(e){return!!e&&("KWPhone"===e.kwType||"KWIdentity"===e.kwType||"KWAddress"===e.kwType||"KWBankStatement"===e.kwType)}},71749:function(e,t,r){r.d(t,{G:()=>a});function a(e){return!!e&&"KWAuthentifiant"===e.kwType}},13477:function(e,t,r){r.d(t,{k:()=>o});var a,o=((a={}).Manual="manual",a.Remember="remember",a)},70727:function(e,t,r){r.d(t,{Q:()=>a,g:()=>o});let a=["GRAY","PURPLE","GREEN","BLUE","YELLOW","ORANGE","PINK","BROWN","RED"];function o(e){return!!e&&"KWSecureNote"===e.kwType}},20394:function(e,t,r){r.d(t,{T5:()=>i,_u:()=>s,aG:()=>o,p3:()=>n});var a,o=((a={})[a.CloudPasskey=-65537]="CloudPasskey",a[a.ES256=-7]="ES256",a);function n(e){return!!e&&"KWPasskey"===e.kwType}function i(e){return n(e)&&-65537===e.KeyAlgorithm}function s(e){return n(e)&&-7===e.KeyAlgorithm}},17886:function(e,t,r){r.d(t,{HQ:()=>i,LR:()=>n,Vc:()=>o});var a=r(49204);let o=(0,a.Enum)("PAYMENT_TYPE_VISA","PAYMENT_TYPE_MASTERCARD","PAYMENT_TYPE_AMEX","PAYMENT_TYPE_DISCOVER","PAYMENT_TYPE_JCB","PAYMENT_TYPE_DINERSCLUB"),n=(0,a.Enum)("BLACK","SILVER","WHITE","RED","ORANGE","GOLD","BLUE_1","BLUE_2","GREEN_1","GREEN_2");function i(e){return!!e&&"KWPaymentMean_creditCard"===e.kwType}},52235:function(e,t,r){r.d(t,{M:()=>o,z:()=>a});let a=(0,r(49204).Enum)("PHONE_TYPE_ANY","PHONE_TYPE_MOBILE","PHONE_TYPE_LANDLINE","PHONE_TYPE_FAX","PHONE_TYPE_WORK_MOBILE","PHONE_TYPE_WORK_LANDLINE","PHONE_TYPE_WORK_FAX");function o(e){return!!e&&"KWPhone"===e.kwType}},51603:function(e,t,r){r.d(t,{k:()=>a});function a(e){return!!e&&"KWSecret"===e.kwType}},7572:function(e,t,r){r.d(t,{C:()=>o,n:()=>n});var a=r(12791);let o={getAnonymousComputerId:(0,a.slot)(),getPlatformInfo:(0,a.slot)()},n={cleanRemotelyRemovedProfiles:(0,a.slot)()}},17658:function(e,t,r){r.d(t,{D:()=>a});let a={deviceLimitCapabilityUpdated:(0,r(12791).slot)()}},92691:function(e,t,r){r.d(t,{z:()=>o});var a=r(12791);let o={carbonLoginStatusChanged:(0,a.slot)({noBuffer:!0}),localAccountsListUpdated:(0,a.slot)({noBuffer:!0}),openSessionProgressChanged:(0,a.slot)({noBuffer:!0}),openSessionTokenSent:(0,a.slot)({noBuffer:!0}),openSessionDashlaneAuthenticator:(0,a.slot)({noBuffer:!0}),openSessionOTPSent:(0,a.slot)({noBuffer:!0}),openSessionOTPForNewDeviceRequired:(0,a.slot)({noBuffer:!0}),openSessionAskMasterPassword:(0,a.slot)({noBuffer:!0}),openSessionTokenWarning:(0,a.slot)({noBuffer:!0}),openSessionExtraDeviceTokenRequired:(0,a.slot)({noBuffer:!0}),openSessionMasterPasswordLess:(0,a.slot)({noBuffer:!0}),openSessionSsoRedirectionToIdpRequired:(0,a.slot)({noBuffer:!0}),openSessionFailed:(0,a.slot)({noBuffer:!0}),sessionSyncStatus:(0,a.slot)({noBuffer:!0}),accountFeaturesChanged:(0,a.slot)({noBuffer:!0}),webOnboardingModeUpdated:(0,a.slot)({noBuffer:!0}),askWebsiteInfo:(0,a.slot)({noBuffer:!0}),getAccountInfo:(0,a.slot)({noBuffer:!0}),getAnonymousLogsMetadata:(0,a.slot)({noBuffer:!0}),checkIfMasterPasswordIsValid:(0,a.slot)({noBuffer:!0}),openSession:(0,a.slot)({noBuffer:!0}),openSessionWithToken:(0,a.slot)({noBuffer:!0}),openSessionWithDashlaneAuthenticator:(0,a.slot)({noBuffer:!0}),cancelDashlaneAuthenticatorRegistration:(0,a.slot)(),openSessionWithOTP:(0,a.slot)({noBuffer:!0}),openSessionWithOTPForNewDevice:(0,a.slot)({noBuffer:!0}),openSessionResendToken:(0,a.slot)({noBuffer:!0}),sessionForceSync:(0,a.slot)({noBuffer:!0}),closeSession:(0,a.slot)({noBuffer:!0}),lockSession:(0,a.slot)({noBuffer:!0}),exceptionLog:(0,a.slot)({noBuffer:!0}),getDevicesList:(0,a.slot)({noBuffer:!0}),getLocalAccountsList:(0,a.slot)({noBuffer:!0}),reloadExtension:(0,a.slot)({noBuffer:!0}),updateWebOnboardingMode:(0,a.slot)({noBuffer:!0})}},36371:function(e,t,r){r.d(t,{i:()=>o});var a=r(12791);let o={getHasFeature:(0,a.slot)(),getFeatures:(0,a.slot)()}},20770:function(e,t,r){r.d(t,{H9:()=>n,JQ:()=>i,YW:()=>s});var a=r(12791),o=r(56787);let n={decipherRemoteFile:(0,a.slot)()},i={getFileContent:(0,a.slot)()},s={liveFileMeta:(0,o.H)()}},79853:function(e,t,r){r.d(t,{a:()=>o});var a=r(12791);let o={setGlobalExtensionSettings:(0,a.slot)(),getGlobalExtensionSettings:(0,a.slot)()}},4409:function(e,t,r){r.d(t,{M:()=>a});let a={evaluatePassword:(0,r(12791).slot)()}},65175:function(e,t,r){r.d(t,{b:()=>i,c:()=>n});var a=r(12791),o=r(56787);let n={getIsBrazeContentDisabled:(0,a.slot)(),getIsLoginFlowMigrationDisabled:(0,a.slot)(),getIsAutoSSOLoginDisabled:(0,a.slot)(),getKillSwitch:(0,a.slot)()},i={liveIsBrazeContentDisabled:(0,o.H)(),liveIsLoginFlowMigrationDisabled:(0,o.H)(),liveIsAutoSSOLoginDisabled:(0,o.H)(),liveKillSwitch:(0,o.H)()}},10235:function(e,t,r){r.d(t,{N:()=>o});var a=r(12791);let o={abTestingChanged:(0,a.slot)(),carbonLoginStatusChanged:(0,a.slot)({noBuffer:!0}),openSessionProgressChanged:(0,a.slot)({noBuffer:!0}),openSessionTokenSent:(0,a.slot)({noBuffer:!0}),openSessionDashlaneAuthenticator:(0,a.slot)({noBuffer:!0}),openSessionOTPSent:(0,a.slot)({noBuffer:!0}),openSessionOTPForNewDeviceRequired:(0,a.slot)({noBuffer:!0}),openSessionAskMasterPassword:(0,a.slot)({noBuffer:!0}),openSessionTokenWarning:(0,a.slot)({noBuffer:!0}),openSessionExtraDeviceTokenRequired:(0,a.slot)({noBuffer:!0}),openSessionSsoRedirectionToIdpRequired:(0,a.slot)({noBuffer:!0}),openSessionMasterPasswordLess:(0,a.slot)({noBuffer:!0}),openSessionFailed:(0,a.slot)({noBuffer:!0}),sessionSyncStatus:(0,a.slot)({noBuffer:!0}),localAccountsListUpdated:(0,a.slot)(),spaceDataUpdated:(0,a.slot)(),teamAdminDataUpdated:(0,a.slot)(),accountFeaturesChanged:(0,a.slot)(),updatePaymentCardTokenResult:(0,a.slot)(),webOnboardingModeUpdated:(0,a.slot)(),currentLocationUpdated:(0,a.slot)(),checkDirectorySyncKeyRequest:(0,a.slot)(),serverSidePairingStatusChanged:(0,a.slot)(),ssoSolutionChanged:(0,a.slot)({noBuffer:!0}),getUki:(0,a.slot)(),getAccountInfo:(0,a.slot)(),getDevicesList:(0,a.slot)(),getLocalAccountsList:(0,a.slot)(),getInvoices:(0,a.slot)(),getPersonalSettings:(0,a.slot)(),openSession:(0,a.slot)({noBuffer:!0}),openSessionWithToken:(0,a.slot)({noBuffer:!0}),openSessionWithDashlaneAuthenticator:(0,a.slot)({noBuffer:!0}),cancelDashlaneAuthenticatorRegistration:(0,a.slot)(),openSessionWithOTP:(0,a.slot)({noBuffer:!0}),openSessionWithOTPForNewDevice:(0,a.slot)({noBuffer:!0}),openSessionResendToken:(0,a.slot)({noBuffer:!0}),sessionForceSync:(0,a.slot)(),closeSession:(0,a.slot)(),lockSession:(0,a.slot)({noBuffer:!0}),cancelPremiumSubscription:(0,a.slot)(),createUserGroup:(0,a.slot)(),deleteUserGroup:(0,a.slot)(),renameUserGroup:(0,a.slot)(),inviteUserGroupMembers:(0,a.slot)(),revokeUserGroupMembers:(0,a.slot)(),updateUserGroupMembers:(0,a.slot)(),teamUpdated:(0,a.slot)(),createAccountStep1:(0,a.slot)(),createAccountStep2:(0,a.slot)(),checkLogin:(0,a.slot)(),savePersonalDataItem:(0,a.slot)(),savePaymentCard:(0,a.slot)(),getMasterPasswordResetDemandList:(0,a.slot)(),acceptMasterPasswordResetDemand:(0,a.slot)(),checkIfMasterPasswordIsValid:(0,a.slot)(),declineMasterPasswordResetDemand:(0,a.slot)(),getMembers:(0,a.slot)(),addTeamAdmin:(0,a.slot)(),removeTeamAdmin:(0,a.slot)(),setTeamSettings:(0,a.slot)(),updateWebOnboardingMode:(0,a.slot)(),checkDirectorySyncKeyResponse:(0,a.slot)(),resumeSession:(0,a.slot)(),exceptionLog:(0,a.slot)({noBuffer:!0})}},78405:function(e,t,r){r.d(t,{M:()=>o});var a,o=((a={})[a.LEAVE_SHARING_FAILED=0]="LEAVE_SHARING_FAILED",a[a.FORBIDDEN_LAST_ADMIN=1]="FORBIDDEN_LAST_ADMIN",a[a.FORBIDDEN_GROUP_ITEM=2]="FORBIDDEN_GROUP_ITEM",a[a.NOT_AUTHORIZED=3]="NOT_AUTHORIZED",a[a.NOT_FOUND=4]="NOT_FOUND",a[a.INTERNAL_ERROR=5]="INTERNAL_ERROR",a)},49068:function(e,t,r){r.d(t,{c:()=>o});var a=r(12791);let o={logEvent:(0,a.slot)(),logPageView:(0,a.slot)()}},61226:function(e,t,r){r.d(t,{O:()=>o});var a,o=((a={})[a.AllBatchesSent=0]="AllBatchesSent",a[a.SomeBatchesSent=1]="SomeBatchesSent",a[a.NoBatchesSent=2]="NoBatchesSent",a)},52742:function(e,t,r){r.d(t,{e:()=>a});let a={logException:(0,r(12791).slot)()}},2652:function(e,t,r){r.d(t,{w:()=>o});var a,o=((a={})[a.UNKNOWN=0]="UNKNOWN",a[a.WARNING=1]="WARNING",a[a.ERROR=2]="ERROR",a)},851:function(e,t,r){r.d(t,{x:()=>o});var a=r(12791);let o={abortDeviceLimitFlow:(0,a.slot)(),loginViaSSO:(0,a.slot)(),unlinkPreviousDevice:(0,a.slot)(),unlinkMultipleDevices:(0,a.slot)()}},87534:function(e,t,r){r.d(t,{Rj:()=>s,Xz:()=>i,_m:()=>n});var a=r(12791),o=r(56787);let n={addLoginNotification:(0,a.slot)(),clearAllStoredLoginNotification:(0,a.slot)()},i={getLoginNotifications:(0,a.slot)()},s={liveLoginNotifications:(0,o.H)()}},36792:function(e,t,r){r.d(t,{_1:()=>s,vq:()=>n,xP:()=>i});var a=r(12791),o=r(56787);let n={updateLoginStepInfo:(0,a.slot)(),resetLoginStepInfo:(0,a.slot)()},i={getLoginStepInfo:(0,a.slot)()},s={liveLoginStepInfo:(0,o.H)()}},16484:function(e,t,r){r.d(t,{I:()=>o});var a=r(12791);let o={savePersonalDataItem:(0,a.slot)(),filledDataItem:(0,a.slot)(),updateWebOnboardingMode:(0,a.slot)()}},58852:function(e,t,r){r.d(t,{Ie:()=>i,U$:()=>n,iX:()=>s});var a=r(12791),o=r(56787);let n={markNotificationAsInteracted:(0,a.slot)(),markNotificationAsSeen:(0,a.slot)(),markNotificationAsUnseen:(0,a.slot)()},i={getNotificationStatus:(0,a.slot)()},s={liveNotificationStatus:(0,o.H)()}},26968:function(e,t,r){r.d(t,{H:()=>n,s:()=>o});var a=r(49204);let o=(0,a.Enum)("SHOW_LOGIN_USING_EXTENSION_NOTIFICATION","SHOW_SAVE_SITES_DIALOG","SHOW_PASSWORD_SAVE_SUCCESS","SHOW_WEB_SAVE_AND_AUTOLOGIN_COMPLETED","SHOW_PASSWORD_IMPORT","SHOW_GET_MOBILE_DIALOG"),n=(0,a.Enum)("SHOW_LOGIN_NOTIFICATION")},37797:function(e,t,r){r.d(t,{s:()=>o});var a,o=((a={}).OneDeviceLimitReached="OneDeviceLimitReached",a.MultipleDevicesLimitReached="MultipleDevicesLimitReached",a.UnlinkingAndOpeningSession="UnlinkingAndOpeningSession",a.UnlinkingMultipleDevicesError="UnlinkingMultipleDevicesError",a.RefreshingDeviceLimitStatus="RefreshingDeviceLimitStatus",a.OpeningSessionAfterDeviceLimitRemoval="OpeningSessionAfterDeviceLimitRemoval",a.DeviceLimitDone="DeviceLimitDone",a)},47038:function(e,t,r){r.d(t,{dN:()=>i,fr:()=>n,xX:()=>s});var a,o,n=((a={}).EMAIL_TOKEN="email_token",a.DEVICE_REGISTRATION="totp_device_registration",a.LOGIN="totp_login",a.SSO="sso",a),i=((o={})[o.UNKNOWN=0]="UNKNOWN",o[o.PENDING=1]="PENDING",o[o.ERROR=2]="ERROR",o[o.READY=3]="READY",o);let s=["login","newDevice"]},76950:function(e,t,r){r.d(t,{of:()=>d,K1:()=>u,A2:()=>l});var a=r(12791),o=r(56787);let n={getLoginDeviceLimitFlow:(0,a.slot)()},i={liveLoginDeviceLimitFlow:(0,o.H)()},s={getTwoFactorAuthenticationInfo:(0,a.slot)()},c={liveTwoFactorAuthenticationInfo:(0,o.H)()},l={getLoginStatus:(0,a.slot)(),getLocalAccounts:(0,a.slot)(),getIsSSOUser:(0,a.slot)(),getSSOMigrationInfo:(0,a.slot)(),getSessionInfo:(0,a.slot)(),getMasterPasswordAndServerKey:(0,a.slot)(),getUserCryptoSettings:(0,a.slot)(),getSyncInfo:(0,a.slot)(),getIsSyncInProgress:(0,a.slot)(),getPremiumStatus:(0,a.slot)(),getNodePremiumStatus:(0,a.slot)(),getSubscriptionInformation:(0,a.slot)(),getActiveSpaces:(0,a.slot)(),getSSOProviderInfo:(0,a.slot)(),getUserLogin:(0,a.slot)(),getPublicUserId:(0,a.slot)(),getAnalyticsInstallationId:(0,a.slot)(),getUserLoginStatus:(0,a.slot)(),getWebOnboardingMode:(0,a.slot)(),getIsPaymentFailureChurningDismissed:(0,a.slot)(),getCredentialSearchOrder:(0,a.slot)(),getDidOpen:(0,a.slot)(),getPlatformName:(0,a.slot)(),getAccountAuthenticationType:(0,a.slot)(),...n,...s},u={liveLoginStatus:(0,o.H)(),liveDidOpen:(0,o.H)(),liveIsSSOUser:(0,o.H)(),liveSSOMigrationInfo:(0,o.H)(),liveSessionInfo:(0,o.H)(),liveSyncInfo:(0,o.H)(),liveIsSyncInProgress:(0,o.H)(),livePremiumStatus:(0,o.H)(),liveServiceProviderUrl:(0,o.H)(),liveWebOnboardingMode:(0,o.H)(),liveSubscriptionInformation:(0,o.H)(),...i,...c},d={validateToken:(0,a.slot)(),validateMasterPassword:(0,a.slot)(),resetProtectedItemAutofillTimer:(0,a.slot)(),forceSync:(0,a.slot)(),updatePremiumChurningDismissDate:(0,a.slot)(),setCredentialSearchOrder:(0,a.slot)(),refreshSubscriptionInformation:(0,a.slot)(),updateAccountRecoveryKeyPersonalSettings:(0,a.slot)()}},90555:function(e,t,r){r.d(t,{Io:()=>S,LT:()=>m,LW:()=>y,Mr:()=>d,_B:()=>p,a1:()=>g,aX:()=>_,fE:()=>A,g3:()=>f,lU:()=>l,rR:()=>E,vV:()=>u,vX:()=>h});var a,o,n,i,s,c,l=((a={})[a.NO_PREMIUM=0]="NO_PREMIUM",a[a.PREMIUM=1]="PREMIUM",a[a.PREMIUM_CANCELLED=2]="PREMIUM_CANCELLED",a[a.OLD_ACCOUNT=3]="OLD_ACCOUNT",a[a.NEW_USER=4]="NEW_USER",a[a.GRACE_PERIOD=5]="GRACE_PERIOD",a);let u=["adminPolicies","autofillWithPhishingPrevention","collectionSharing","creditMonitoring","dataLeak","devicesLimit","identityRestoration","identityTheftProtection","inAppNudges","multipleAccounts","nudges","passwordsLimit","phoneSupport","riskDetection","secretManagement","secureFiles","secureNotes","secureWiFi","securityBreach","sharingLimit","scim","sso","sync","yubikey"],d=Object.freeze({freeTrialGranted:"free_trial_granted",premiumGranted:"premium_granted",renewed:"renewed",subscribed:"subscribed",crosssellPurchased:"crosssell_purchased",setAsLegacy:"set_as_legacy",familyCreated:"family_created",familyRenewed:"family_renewed"}),p=Object.freeze({Amazon:"amazon",FreeTrial:"free_trial",Invoice:"invoice",IOS:"ios",IOSRenewable:"ios_renewable",Legacy:"legacy",Mac:"mac",MacRenewable:"mac_renewable",Offer:"offer",Partner:"partner",Paypal:"paypal",PaypalRenewable:"paypal_renewable",Playstore:"playstore",PlaystoreRenewable:"playstore_renewable",Stripe:"stripe"}),S=["GROUP_CREATE","GROUP_DELETE","GROUP_EDIT","GROUP_READ"],g=["FULL","BILLING",...S];var m=((o={})[o.UNPAIRED=0]="UNPAIRED",o[o.PAIRED=1]="PAIRED",o),y=((n={}).READY="ready",n.IN_PROGRESS="in_progress",n.SUCCESS="success",n.FAILURE="failure",n);let f=Object.freeze({Premium:"premium",Essentials:"essentials",Premiumplus:"premiumplus",BackupForAll:"backup-for-all"}),E=Object.freeze({Team:"team",Business:"business",Legacy:"legacy",Entreprise:"entreprise",Free:"free",Starter:"starter",Standard:"standard",BusinessPlus:"businessplus"});var A=((i={}).Accepted="accepted",i.Pending="pending",i.Proposed="proposed",i.Refused="refused",i.Removed="removed",i.Revoked="revoked",i.Unproposed="unproposed",i),h=((s={})[s.MP_TO_SSO=0]="MP_TO_SSO",s[s.MP_TO_SSO_WITH_INFO=1]="MP_TO_SSO_WITH_INFO",s[s.SSO_TO_MP=2]="SSO_TO_MP",s),_=((c={}).NAME="name",c.DATE="date",c)},90416:function(e,t,r){r.d(t,{H:()=>n,r:()=>o});var a=r(12791);let o={generatePassword:(0,a.slot)(),generateAndSavePassword:(0,a.slot)(),savePasswordGenerationSettings:(0,a.slot)()},n={getPasswordGenerationSettings:(0,a.slot)()}},74190:function(e,t,r){r.d(t,{P:()=>n,_:()=>o});var a=r(12791);let o={cancelAutoRenew:(0,a.slot)(),fetchInvoiceList:(0,a.slot)()},n={getInvoicesCount:(0,a.slot)(),getInvoiceList:(0,a.slot)(),getInvoiceListYears:(0,a.slot)()}},27188:function(e,t,r){r.d(t,{UW:()=>i,gQ:()=>n,qN:()=>s});var a=r(12791),o=r(56787);let n={disableCredentialProtection:(0,a.slot)(),unlockProtectedItems:(0,a.slot)()},i={vaultLockDate:(0,a.slot)()},s={liveVaultLockDate:(0,o.H)()}},71614:function(e,t,r){r.d(t,{$k:()=>n,EX:()=>s,q9:()=>i});var a=r(12791),o=r(56787);let n={activateAccountRecovery:(0,a.slot)(),setupMasterPasswordForRecovery:(0,a.slot)(),deactivateAccountRecovery:(0,a.slot)(),registerDeviceForRecovery:(0,a.slot)(),startAccountRecovery:(0,a.slot)(),sendRecoveryRequest:(0,a.slot)(),cancelRecoveryRequest:(0,a.slot)(),checkRecoveryRequestStatus:(0,a.slot)(),recoverUserData:(0,a.slot)(),checkDoesLocalRecoveryKeyExist:(0,a.slot)(),isRecoveryRequestPending:(0,a.slot)()},i={getRecoveryOptInSetting:(0,a.slot)(),getAccountRecoveryRequestCount:(0,a.slot)()},s={liveAccountRecoveryRequestCount:(0,o.H)()}},48834:function(e,t,r){r.d(t,{LL:()=>i,Ou:()=>d,Up:()=>o,Zz:()=>u,bW:()=>c,ev:()=>l,ou:()=>n,yB:()=>s});var a,o=((a={}).MANUAL="MANUAL",a.MAV_DATACAPTURE="MAV_DATACAPTURE",a.MAV_SAVE_CREDENTIAL="MAV_SAVE_CREDENTIAL",a.IMPORT="IMPORT",a);function n(e){return["KWCompany","KWEmail","KWPersonalWebsite","KWIdentity","KWAddress","KWPhone"].some(t=>!!e&&e.kwType===t)}function i(e){return!!e&&"KWIdentity"===e.kwType}function s(e){return!!e&&"KWPhone"===e.kwType}function c(e){return!!e&&"KWAddress"===e.kwType}function l(e){return!!e&&"KWCompany"===e.kwType}function u(e){return!!e&&"KWEmail"===e.kwType}function d(e){return!!e&&"KWPersonalWebsite"===e.kwType}},58415:function(e,t,r){r.d(t,{u:()=>o});var a=r(12791);let o={convertItemToDashlaneXml:(0,a.slot)(),convertDashlaneXmlToItem:(0,a.slot)(),saveSharedItemsToVault:(0,a.slot)()}},75053:function(e,t,r){r.d(t,{N:()=>o,b:()=>n});var a=r(12791);let o={getIsRecoveryEnabled:(0,a.slot)()},n={getTeamInfo:(0,a.slot)(),computePlanPricing:(0,a.slot)()}},15524:function(e,t,r){r.d(t,{h:()=>o});var a,o=((a={}).SSO_CONNECTOR="sso_connector",a.ENCRYPTION_SERVICE="encryption_service",a.NITRO="nitro_encryption_service",a)},88323:function(e,t,r){r.d(t,{XJ:()=>n,dN:()=>i,hO:()=>s});var a=r(12791),o=r(56787);let n={getAdministrableUserGroup:(0,a.slot)(),getAdministrableUserGroups:(0,a.slot)(),getAdminProvisioningKey:(0,a.slot)(),getMassDeploymentTeamKey:(0,a.slot)()},i={liveMassDeploymentTeamKey:(0,o.H)()},s={registerTeamDomain:(0,a.slot)(),completeTeamDomainRegistration:(0,a.slot)(),deactivateTeamDomain:(0,a.slot)(),getTeamDomains:(0,a.slot)(),getTeamDevice:(0,a.slot)(),listTeamDevices:(0,a.slot)(),deactivateTeamDevice:(0,a.slot)(),registerTeamDevice:(0,a.slot)(),registerTeamDeviceAccount:(0,a.slot)(),getEncryptionServiceConfig:(0,a.slot)(),generateAndSaveEncryptionServiceConfig:(0,a.slot)(),clearSelfHostedESSettings:(0,a.slot)(),getTeamDeviceEncryptedConfig:(0,a.slot)(),updateTeamDeviceEncryptedConfig:(0,a.slot)(),updateTeamSettings:(0,a.slot)(),parseMetadataFields:(0,a.slot)(),persistAdminProvisioningKey:(0,a.slot)(),persistMassDeploymentTeamKey:(0,a.slot)(),removeAdminProvisioningKey:(0,a.slot)(),createSSOConnectorConfig:(0,a.slot)(),generateSSOConnectorKey:(0,a.slot)(),getRecoveryCodesAsTeamCaptain:(0,a.slot)(),createInviteLink:(0,a.slot)(),changeInviteLinkTeamKey:(0,a.slot)(),toggleInviteLink:(0,a.slot)(),getInviteLink:(0,a.slot)(),requestInviteLinkToken:(0,a.slot)(),getInviteLinkForAdmin:(0,a.slot)(),getLastADSyncDate:(0,a.slot)(),getSpecialUserGroupInviteValuesForMemberInTeam:(0,a.slot)(),getSpecialUserGroupRevision:(0,a.slot)()}},2328:function(e,t,r){r.d(t,{Kr:()=>s,Vz:()=>n,kh:()=>i});var a=r(12791),o=r(56787);let n={getVisibleUserMessages:(0,a.slot)(),getUserMessages:(0,a.slot)()},i={liveUserMessages:(0,o.H)(),liveVisibleUserMessages:(0,o.H)()},s={dismissUserMessages:(0,a.slot)(),addUserMessage:(0,a.slot)()}},7131:function(e,t,r){r.d(t,{T4:()=>n,fD:()=>i,lp:()=>s});var a=r(12791),o=r(56787);let n={getVpnAccount:(0,a.slot)(),getVpnCapabilitySetting:(0,a.slot)()},i={liveVpnAccount:(0,o.H)()},s={activateVpnAccount:(0,a.slot)(),clearVpnAccountErrors:(0,a.slot)(),completeVpnAccountActivation:(0,a.slot)()}},6223:function(e,t,r){r.d(t,{W:()=>s});var a=r(36503),o=r(93675),n=r(30424),i=r(45449);let s=(0,a.Q)({name:"carbon-legacy",commands:o.CN,queries:i.o$,events:n.U3})},49247:function(e,t,r){r.d(t,{_:()=>n});var a=r(46266),o=r(6223);class n extends(0,a.E)(o.W){}(0,a.K)(o.W,n)},93675:function(e,t,r){r.d(t,{CN:()=>d,Cc:()=>l,Ec:()=>s,wF:()=>u,y9:()=>c});var a=r(66122),o=r(15021),n=r(33671),i=r(97647);class s extends(0,a.A)({scope:o.F.Device}){}class c extends(0,a.A)({scope:o.F.Device}){}class l extends(0,a.g)({scope:o.F.Device}){}let u=(0,n.k)(i.z),d={...u,carbon:s,carbonLegacyLeeloo:c,mitigationDeleteGrapheneUserData:l}},30424:function(e,t,r){r.d(t,{Dj:()=>i,E1:()=>s,Pe:()=>n,U3:()=>c});var a=r(98037),o=r(15021);class n extends(0,a.d)({scope:o.F.Device}){}class i extends(0,a.d)({scope:o.F.Device}){}class s extends(0,a.d)({scope:o.F.Device}){}let c={carbonCommandResult:n,carbonLegacy:i,CarbonLegacyDeviceRemotelyDeleted:s}},45449:function(e,t,r){r.d(t,{QX:()=>c,Zh:()=>l,o$:()=>d,r$:()=>u});var a=r(45429),o=r(15021),n=r(33671),i=r(84695),s=r(22989);class c extends(0,a.k)({scope:o.F.Device,useCache:!0}){}class l extends(0,a.k)({scope:o.F.Device,useCache:!0}){}let u=(0,n.p)(s.r,i.z),d={...u,carbonState:c,carbonStateList:l}},33671:function(e,t,r){r.d(t,{k:()=>i,p:()=>s});var a=r(66122),o=r(15021),n=r(45429);function i(e){return Object.keys(e).reduce((e,t)=>({...e,[t]:(0,a.A)({scope:o.F.Device})}),{})}function s(e,t){let r=Object.keys(e),a=Object.keys(t),i=(e,t)=>[e,(0,n.k)({scope:o.F.Device,useCache:t})];return[...r.map(e=>i(e)),...a.map(e=>i(e,!0))].reduce((e,[t,r])=>({...e,[t]:r}),{})}},95449:function(e,t,r){r.d(t,{k:()=>s,lN:()=>n,o7:()=>i});var a=r(12791),o=r(56787);let n={getBreaches:(0,a.slot)(),getBreachesPage:(0,a.slot)(),getBreachesPaginationToken:(0,a.slot)()},i={liveBreaches:(0,o.H)(),liveBreachesBatch:(0,o.H)()},s={updateBreachStatus:(0,a.slot)()}},80889:function(e,t,r){r.d(t,{X:()=>o});var a=r(12791);let o={addCollection:(0,a.slot)(),deleteCollection:(0,a.slot)(),removeItemsFromCollections:(0,a.slot)(),updateCollection:(0,a.slot)()}},28960:function(e,t,r){r.d(t,{Nv:()=>n,bK:()=>i,ml:()=>s});var a=r(12791),o=r(56787);let n={addCredential:(0,a.slot)(),updateCredential:(0,a.slot)()},i={getCredential:(0,a.slot)(),getCredentials:(0,a.slot)(),getCredentialsByDomain:(0,a.slot)(),getCredentialsCount:(0,a.slot)(),getCredentialsPage:(0,a.slot)(),getCredentialsPaginationToken:(0,a.slot)(),getDashlaneDefinedLinkedWebsites:(0,a.slot)()},s={liveCredential:(0,o.H)(),liveCredentials:(0,o.H)(),liveCredentialsByDomain:(0,o.H)(),liveCredentialsBatch:(0,o.H)(),liveCredentialsCount:(0,o.H)()}},47628:function(e,t,r){r.d(t,{h:()=>a});let a={duplicateVaultItem:(0,r(12791).slot)()}},59249:function(e,t,r){r.d(t,{h:()=>o,z:()=>n});var a=r(12791);let o={getIsForcedDomainsEnabled:(0,a.slot)()},n={getPersonalDataExport:(0,a.slot)()}},8494:function(e,t,r){r.d(t,{Ob:()=>s,Rm:()=>n,nM:()=>i});var a=r(12791),o=r(56787);let n={getGeneratedPasswords:(0,a.slot)()},i={liveGeneratedPasswords:(0,o.H)()},s={saveGeneratedPassword:(0,a.slot)()}},46573:function(e,t,r){r.d(t,{M:()=>o});var a=r(12791);let o={addDriverLicense:(0,a.slot)(),editDriverLicense:(0,a.slot)()}},57108:function(e,t,r){r.d(t,{v:()=>o});var a=r(12791);let o={addFiscalId:(0,a.slot)(),editFiscalId:(0,a.slot)()}},76096:function(e,t,r){r.d(t,{S:()=>o});var a=r(12791);let o={addIdCard:(0,a.slot)(),editIdCard:(0,a.slot)()}},5047:function(e,t,r){r.d(t,{H:()=>o});var a=r(12791);let o={addPassport:(0,a.slot)(),editPassport:(0,a.slot)()}},25751:function(e,t,r){r.d(t,{i:()=>l});var a=r(12791),o=r(57108),n=r(46573),i=r(76096),s=r(5047),c=r(89643);let l=(0,a.combineEvents)(n.M,o.v,i.S,s.H,c.w)},89643:function(e,t,r){r.d(t,{w:()=>o});var a=r(12791);let o={addSocialSecurityId:(0,a.slot)(),editSocialSecurityId:(0,a.slot)()}},55168:function(e,t,r){r.d(t,{Qf:()=>i,WZ:()=>n,rW:()=>s});var a=r(12791),o=r(56787);let n={getImportPersonalDataStatus:(0,a.slot)()},i={liveImportPersonalDataStatus:(0,o.H)()},s={importPersonalData:(0,a.slot)(),previewPersonalData:(0,a.slot)(),dismissPersonalDataImportNotifications:(0,a.slot)()}},38750:function(e,t,r){r.d(t,{G8:()=>d,Q8:()=>u,RO:()=>l,V$:()=>p,qJ:()=>S,rp:()=>g});var a,o,n,i,s,c,l=((a={}).CREDENTIAL="credentials",a.NOTE="notes",a.PAYMENT_CARD="paymentCards",a.BANK_ACCOUNT="bankAccounts",a.COLLECTION="collections",a),u=((o={})["1Password"]="1password",o.Bitwarden="bitwarden",o.Chrome="chrome",o.Dash="dash",o.Edge="edge",o.Firefox="firefox",o.Keepass="keepass",o.Keeper="keeper",o.Lastpass="lastpass",o.Other="other",o.Safari="safari",o),d=((n={}).Csv="csv",n.Dash="dash",n),p=((i={}).Unavailable="unavailable",i.Unknown="unknown",i),S=((s={}).Idle="idle",s.Processing="processing",s.Success="success",s.Error="error",s),g=((c={}).BadPassword="bad_password",c.Unavailable="unavailable",c.InvalidFormat="invalid",c.Unknown="unknown",c)},3130:function(e,t,r){r.d(t,{K:()=>n,T:()=>o});var a=r(12791);let o={getPasskey:(0,a.slot)(),getPasskeys:(0,a.slot)(),getPasskeysForDomain:(0,a.slot)()},n={addPasskey:(0,a.slot)(),updatePasskey:(0,a.slot)()}},99222:function(e,t,r){r.d(t,{W:()=>a});let a={liveSecrets:(0,r(56787).H)()}},12569:function(e,t,r){r.d(t,{JX:()=>i,Wk:()=>s,q:()=>n});var a=r(12791),o=r(56787);let n={getFileUploadProgress:(0,a.slot)()},i={liveFileUploadProgress:(0,o.H)()},s={addSecureFile:(0,a.slot)(),validateSecureFile:(0,a.slot)(),commitSecureFile:(0,a.slot)(),clearSecureFileState:(0,a.slot)()}},42:function(e,t,r){r.d(t,{dF:()=>s,k3:()=>i,nD:()=>n});var a=r(12791),o=r(56787);let n={arePasswordsProtected:(0,a.slot)(),areRichIconsEnabled:(0,a.slot)()},i={liveArePasswordsProtected:(0,o.H)(),liveAreRichIconsEnabled:(0,o.H)()},s={toggleDashlane:(0,a.slot)(),updateProtectPasswordsSetting:(0,a.slot)(),updateAutofillSettings:(0,a.slot)(),updateRichIconsSetting:(0,a.slot)()}},83252:function(e,t,r){r.d(t,{QX:()=>A,fv:()=>h,pz:()=>E});var a=r(12791),o=r(47628),n=r(95449),i=r(28960),s=r(59249),c=r(8494),l=r(55168),u=r(3130),d=r(12569),p=r(42),S=r(56480),g=r(73137),m=r(99222),y=r(80889),f=r(25751);let E=(0,a.combineEvents)(n.lN,i.bK,s.h,c.Rm,l.WZ,u.T,d.q,p.nD,S.c,g.P),A=(0,a.combineEvents)(n.o7,i.ml,l.Qf,m.W,d.JX,p.k3),h=(0,a.combineEvents)(n.k,y.X,i.Nv,s.z,c.Ob,f.i,l.rW,u.K,d.Wk,p.dF,g.e,o.h)},56480:function(e,t,r){r.d(t,{c:()=>o});var a=r(12791);let o={getSpace:(0,a.slot)(),getSpaces:(0,a.slot)()}},63154:function(e,t,r){r.d(t,{MS:()=>o,kY:()=>i,zC:()=>n});var a,o=((a={})[a.CannotDisable=0]="CannotDisable",a[a.DisableSpecificVaultItem=1]="DisableSpecificVaultItem",a[a.DisableGeneralSetting=2]="DisableGeneralSetting",a);let n=Object.freeze({NOT_FOUND:"NOT_FOUND"}),i={KWAddress:"addresses",KWAuthentifiant:"credentials",KWBankStatement:"bankAccounts",KWCollection:"collections",KWCompany:"companies",KWDataChangeHistory:"changeHistories",KWDriverLicence:"driverLicenses",KWEmail:"emails",KWFiscalStatement:"fiscalIds",KWGeneratedPassword:"generatedPasswords",KWIDCard:"idCards",KWIdentity:"identities",KWPasskey:"passkeys",KWPassport:"passports",KWPaymentMean_creditCard:"paymentCards",KWPaymentMean_paypal:"paypalAccounts",KWPersonalWebsite:"personalWebsites",KWPhone:"phones",KWSecureNote:"notes",KWSecurityBreach:"securityBreaches",KWSocialSecurityStatement:"socialSecurityIds",KWSecureFileInfo:"secureFileInfo",KWSecret:"secrets"}},73137:function(e,t,r){r.d(t,{P:()=>o,e:()=>n});var a=r(12791);let o={},n={deleteVaultModuleItem:(0,a.slot)(),deleteVaultModuleItemsBulk:(0,a.slot)(),disableVaultItemProtection:(0,a.slot)()}},20648:function(e,t,r){r.r(t),r.d(t,{UserVerificationMethods:()=>ev.WQ,GetPersonalDataExportErrorMessage:()=>eJ,getLocalFormat:()=>rO.Bm,getTransactionTypeFromDataModelType:()=>rO.XM,FileUploadStatus:()=>to,ReactivationStatus:()=>ev._g,groupPermissions:()=>tY.Io,PlanTypes:()=>tY._B,PhoneType:()=>rH.z,PaymentCardColor:()=>rG.LR,settingsQueriesSlots:()=>ts.nD,ChangeMasterPasswordCode:()=>eF.Ud,featureQueriesSlots:()=>tE.i,CarbonLegacyDeviceRemotelyDeleted:()=>r2.E1,CarbonLeelooConnector:()=>ed.N,OtpType:()=>ev.mE,TransactionType:()=>rO.iU,isPhone:()=>rH.M,liveSlot:()=>en.H,TRANSACTION_TYPE_TO_DATAMODEL_TYPE:()=>rO.D7,loginStepInfoQueriesSlots:()=>tj.xP,dataManagementCommandsSlots:()=>eH.fv,teamAdminLiveQueriesSlots:()=>r_.dN,CarbonStateQuery:()=>r1.QX,isPIPersonalWebsiteEvent:()=>r$.Ou,IDPMetadataParseErrors:()=>rh,isPIIdentityEvent:()=>r$.LL,SupportedVaultTypes:()=>e9.RO,teamQueriesSlots:()=>ri.N,antiPhishingLiveQueriesSlots:()=>e_.f,ENFORCE_TWO_FACTOR_AUTHENTICATION_ENABLED_VALUES:()=>t1.xX,ImportPersonalDataStateType:()=>e9.qJ,CarbonStateListQuery:()=>r1.Zh,RefreshContactInfoErrorCode:()=>eh,CarbonMaverickConnector:()=>eS.I,isAddress:()=>rT,isPersonalInfoEvent:()=>r$.ou,CredentialSearchOrder:()=>tY.aX,SsoMigrationServerMethod:()=>tk,exceptionCommandsSlots:()=>tL.e,DeleteSecretErrorCode:()=>tt,ApiAuditLogsErrorType:()=>rd,TeamDeviceEncryptedConfigNotFound:()=>rl,WebOnboardingPopoverStep:()=>t2.H,cryptoMigrationLiveQueriesSlots:()=>ek.vF,InitOpenSessionWithWebAuthnAuthenticatorError:()=>eN.bL,generatedPasswordsQueriesSlots:()=>tp.Rm,passwordGeneratorCommandsSlots:()=>t3.r,DisableWebAuthnAuthenticationError:()=>eN.Ok,userMessagesCommandsSlots:()=>rz.Kr,webAuthnAuthenticationQueriesSlots:()=>eR.Ui,PlatformView:()=>tZ,ChangeMasterPasswordStepNeeded:()=>eF.FD,ChangeMPFlowPath:()=>eF.pT,B2CPlanFeatures:()=>tY.g3,CarbonCommandResultEvent:()=>r2.Pe,globalExtensionSettingsCommandsSlots:()=>tO.a,contactInfoLiveQueriesSlots:()=>eE.cN,RefreshAvailableWebAuthnAuthenticatorsError:()=>eN.M2,NO_CURRENT_UPDATE_HTTP_STATUS:()=>t_,abTestsQueriesSlots:()=>ro.co,isSocialSecurityId:()=>rq,recoveryQueriesSlots:()=>re.q9,vpnCommandsSlots:()=>r0.lp,CarbonCommand:()=>r3.Ec,queries:()=>r1.o$,TwoFactorAuthenticationType:()=>t1.fr,SaveOrigin:()=>r$.Up,cryptoMigrationQueriesSlots:()=>ek.kQ,dataModelTypes:()=>rO.mg,protectedItemsUnlockerLiveQueriesSlots:()=>t4.qN,DisableCredentialProtectionStatus:()=>t9,NoteTypes:()=>rk.Q,breachesLiveQueriesSlots:()=>ex.o7,EditContactInfoErrorCode:()=>eA,webAuthnAuthenticationLiveQueriesSlots:()=>eR.jF,WebAuthnKeyAlgorithm:()=>rK.aG,CarbonLegacyClient:()=>r4._,GetRecoveryCodesAsTeamCaptainErrorCode:()=>rE,twoFactorAuthenticationQueriesSlots:()=>eI.b6,EmailIncidentViewStatuses:()=>eW,RequestStatus:()=>rr,VpnAccountStatusType:()=>rX,secureFilesQueriesSlots:()=>tr.q,ComputePlanPricingErrorType:()=>rs,TeamDevicePlatform:()=>rS.h,recoveryLiveQueriesSlots:()=>re.EX,vaultQueriesSlots:()=>tg.P,SyncStatuses:()=>tY.LW,queriesFromCarbonAPI:()=>r1.r$,LoginResultEnum:()=>tF,twoFactorAuthenticationLiveQueriesSlots:()=>eI.ud,SecureFileResultErrorCode:()=>ta,carbonQueriesSlots:()=>ec.r,isEmail:()=>rN,AuthenticationCode:()=>ev._V,authenticationCommandsSlots:()=>eT.zR,abTestsCommandsSlots:()=>ro.td,isFiscalId:()=>rw,exportCommandsSlots:()=>eX.z,DarkWebInsightsApiErrorType:()=>ej,DeviceLimitCapabilityConnector:()=>tf.D,isIdCard:()=>rU,isPasskey:()=>rK.p3,USER_STILL_OVERFLOWING:()=>tQ,secureFilesLiveQueriesSlots:()=>tr.JX,BreachStatus:()=>rI,RecoveryApiErrorType:()=>rt,breachesQueriesSlots:()=>ex.lN,abTestsLiveQueriesSlots:()=>ro.KV,StyxApiResult:()=>tw.O,Platform:()=>t0,exportQueriesSlots:()=>eX.h,collectionsCommandsSlots:()=>e$.X,twoFactorAuthenticationCommandsSlots:()=>eI.KM,idCardsCommandsSlots:()=>e2.S,OrderDir:()=>t8,isCollection:()=>rP,settingsLiveQueriesSlots:()=>ts.k3,spacesQueriesSlots:()=>tc.c,UnlockProtectedItemsStatus:()=>t7,paymentsCommandsSlots:()=>t6._,PremiumStatusCode:()=>tY.lU,RequestTOTPActivationError:()=>eb,isPIPhoneEvent:()=>r$.yB,killswitchQueriesSlots:()=>tb.c,protectedItemsUnlockerQueriesSlots:()=>t4.UW,RemoveWebAuthnAuthenticatorError:()=>eN.O6,carbonLegacyApi:()=>r8.W,vaultCommandsSlots:()=>tg.e,loginStepInfoCommandsSlots:()=>tj.vq,authenticationLiveQueriesSlots:()=>eT.QR,deviceCommandsSlots:()=>ty.n,RemoveU2FAuthenticatorError:()=>eP,secretLiveQueriesSlots:()=>te.W,EncryptionServiceRestartStatusCodes:()=>ry,IDPXmlParseErrors:()=>rA,isCloudPasskey:()=>rK.T5,isGeneratedPassword:()=>rL,importLiveQueriesSlots:()=>e5.Qf,loginCommandsSlots:()=>tM.x,webAuthnAuthenticationCommandsSlots:()=>eR.qM,VaultItemDisableProtectionMode:()=>tS.MS,WebAuthnCallTypes:()=>eN.vz,BreachesUpdaterStatus:()=>eq,InitRegisterWebAuthnAuthenticatorError:()=>eN.fl,NotificationName:()=>tW,PaymentCardSaveResultErrorCode:()=>td,RefreshU2FErrorCode:()=>eD,teamAdminQueriesSlots:()=>r_.XJ,DeletePasskeyErrorCode:()=>tu,SpaceStatus:()=>tY.fE,generatedPasswordsCommandsSlots:()=>tp.Ob,getDataModelTypeFromTransactionType:()=>rO.gD,isNote:()=>rk.g,isSecret:()=>rx.k,importCommandsSlots:()=>e5.rW,secureFilesCommandsSlots:()=>tr.Wk,passkeyCommandsSlots:()=>tl.K,InitEnableWebAuthnAuthenticationError:()=>eN.Pb,RefreshWebAuthnAuthenticatorsError:()=>eN.Rr,isLegacyPasskey:()=>rK._u,GetAuditLogQueryResultsStates:()=>rp,driverLicensesCommandsSlots:()=>e0.M,FileNamesList:()=>tP,events:()=>r2.U3,LoginDeviceLimitFlowStage:()=>tJ.s,isCompany:()=>rC,isObjectLocalized:()=>rO.pt,DataModelType:()=>rO.dJ,loginNotificationsQueriesSlots:()=>tG.Xz,teamAdminCommandsSlots:()=>r_.hO,DarkWebInsightsBreachType:()=>eV,dataManagementLiveQueriesSlots:()=>eH.QX,passwordGeneratorQueriesSlots:()=>t3.H,vpnLiveQueriesSlots:()=>r0.fD,PersistData:()=>ev.jP,carbonLiveQueriesSlots:()=>es.z,UPDATE_AVAILABLE_HTTP_STATUS:()=>th,notificationsQueriesSlots:()=>tx.Ie,isPaymentCard:()=>rG.HQ,userMessagesQueriesSlots:()=>rz.Vz,ExtensionDebugConnector:()=>ey,ImportFormats:()=>e9.G8,killswitchLiveQueriesSlots:()=>tb.b,sharingCommandsSlots:()=>ra.u,InitUserVerificationWithWebAuthnError:()=>eN.tv,UnknownTeamAdminError:()=>rc,vaultSourceTypeToDataModelTypeMap:()=>eU.Z,TwoFactorAuthenticationInfoRequestStatus:()=>t1.dN,UNEXPECTED_ERROR:()=>tz,CredentialLimitStatus:()=>ez,CarbonLegacyLeelooCommand:()=>r3.y9,CarbonLegacyEvent:()=>r2.Dj,BreachLeakedDataType:()=>eY,CarbonApiConnector:()=>el.X,EmailTokenApiError:()=>ev.Yp,ImportSource:()=>e9.Q8,carbonCommandsSlots:()=>ei.z,NotificationStatus:()=>tH,contactInfoCommandsSlots:()=>eE.PO,cryptoMigrationCommandsSlots:()=>ek.rU,commands:()=>r3.CN,ExtensionDebugEventType:()=>ef,isIdentity:()=>rM,loginNotificationsCommandsSlots:()=>tG._m,TwoFactorAuthenticationDisableStages:()=>eC,isBankAccount:()=>rv,passkeyQueriesSlots:()=>tl.T,recoveryCommandsSlots:()=>re.$k,vpnQueriesSlots:()=>r0.T4,CarbonDebugConnector:()=>eg.o,InviteLinkResponseErrorCode:()=>rf,Country:()=>rO.cH,isPICompanyEvent:()=>r$.ev,WebOnboardingLeelooStep:()=>t2.s,ApplicationBuildType:()=>tR.P,ExtensionCarbonConnector:()=>eu.z,SecureNoteSaveResultErrorCode:()=>tn,AbortDeviceLimitFlowError:()=>t$,SupportedDerivationMethods:()=>eB,VpnAccountActivationErrorType:()=>rJ,possibleAdminPermissions:()=>tY.a1,unlockProtectedItemsWrongPasswordError:()=>t5,autofillDataQueriesSlots:()=>ew.c,AccountCreationCode:()=>rn,MitigationDeleteGrapheneUserDataCommand:()=>r3.Cc,idsCommandsSlots:()=>eZ.i,ExceptionCriticality:()=>tU.w,LoggingEventType:()=>eo,VpnDisabledReason:()=>rZ,importQueriesSlots:()=>e5.WZ,notificationsLiveQueriesSlots:()=>tx.iX,protectedItemsUnlockerCommandsSlots:()=>t4.gQ,transactionTypes:()=>rO.s5,isCredential:()=>rb.G,generatedPasswordsLiveQueriesSlots:()=>tp.nM,FILE_NOT_FOUND_HTTP_STATUS:()=>tT,CapabilityKeys:()=>tY.vV,notificationsCommandsSlots:()=>tx.U$,ImportPersonalDataErrorType:()=>e9.V$,LoginNotificationType:()=>tB,changeMasterPasswordLiveQueriesSlots:()=>eM.F,isDataModelObject:()=>rO.Sw,loginNotificationsLiveQueriesSlots:()=>tG.Rj,DeleteSecureNoteErrorCode:()=>ti,changeMasterPasswordCommandsSlots:()=>eM.v,RegisterWebAuthnAuthenticatorError:()=>eN.Oq,remoteFileCommandsSlots:()=>tA.H9,EnableWebAuthnAuthenticationError:()=>eN.dc,teamCommandsSlots:()=>ri.b,UnlinkPreviousDeviceError:()=>tX,isPIEmailEvent:()=>r$.Zz,DomainStatus:()=>rm,fiscalsIdCommandsSlots:()=>e1.v,DATAMODELOBJECT_TYPE_TO_CARBON_STORE_KEY:()=>tS.kY,LoginViaSsoCode:()=>tK,eventLoggerCommandsSlots:()=>tN.c,isPassport:()=>rB,CryptoMigrationApiErrorType:()=>eK,AutofillOptions:()=>eL,DATAMODEL_TYPE_TO_TRANSACTION_TYPE:()=>rO.Ww,TeamMemberSSOStatuses:()=>ru,authenticationQueriesSlots:()=>eT.ke,settingsCommandsSlots:()=>ts.dF,contactInfoQueriesSlots:()=>eE.PG,credentialsQueriesSlots:()=>eQ.bK,LEGACY_CARBON_LEELOO_USED_COMMANDS:()=>r6,deviceQueriesSlots:()=>ty.C,isPIAddressEvent:()=>r$.bW,SSOMigrationType:()=>tY.vX,openSessionCommandsSlots:()=>tq.of,RemovePersonalDataItemFailureReason:()=>ep.M,LinkedWebsiteSource:()=>rF.k,OpenSessionWithWebAuthnAuthenticatorError:()=>eN.vW,PaymentCardType:()=>rG.Vc,deleteVaultModuleItemFailureReason:()=>tS.zC,isDriverLicense:()=>rR,openSessionQueriesSlots:()=>tq.A2,PremiumLogTypes:()=>tY.Mr,UserMessageTypes:()=>rQ,IdErrorCode:()=>e8,commandsFromCarbonAPI:()=>r3.wF,isPersonalWebsite:()=>rW,loginStepInfoLiveQueriesSlots:()=>tj._1,credentialsCommandsSlots:()=>eQ.Nv,AddIdResultErrorCode:()=>e4,FILE_NOT_UPDATED:()=>tv,darkWebInsightsCommandsSlots:()=>eG.I,isBreach:()=>rD,isPersonalSettings:()=>rV,isSecureFileInfo:()=>rY,ServerSidePairingStatus:()=>tY.LT,breachesCommandsSlots:()=>ex.k,isPaypalAccount:()=>rj,openSessionLiveQueriesSlots:()=>tq.K1,passportsCommandsSlots:()=>e3.H,UpdateIdResultErrorCode:()=>e7,paymentsQueriesSlots:()=>t6.P,UNSPECIFIED_ERROR:()=>tI,credentialsLiveQueriesSlots:()=>eQ.ml,TwoFactorAuthenticationEnableStages:()=>eO,PreviewPersonalDataErrorType:()=>e9.rp,dataManagementQueriesSlots:()=>eH.pz,remoteFilesQueriesSlots:()=>tA.JQ,SERVER_ERROR_HTTP_STATUS:()=>tD,SpaceTiers:()=>tY.rR,healthCommandsSlots:()=>tC.M,DomainStatusResponses:()=>rg,socialSecurityIdsCommandsSlots:()=>e6.w,LoginStep:()=>tV,userMessagesLiveQueriesSlots:()=>rz.kh,remoteFilesLiveQueriesSlots:()=>tA.YW,duplicationCommandsSlots:()=>tm.h});var a,o,n,i,s,c,l,u,d,p,S,g,m,y,f,E,A,h,_,T,v,I,D,P,O,C,b,R,N,w,L,U,M,F,k,K,B,G,j,V,W,H,x,Y,q,$,Q,z,X,J,Z,ee,et,er,ea=r(49204);let eo=(0,ea.Enum)("EXCEPTION_LOG");var en=r(56787),ei=r(97647),es=r(84695),ec=r(22989),el=r(90960),eu=r(92691),ed=r(10235),ep=r(78405),eS=r(16484),eg=r(7917),em=r(12791);let ey={getExtensionId:(0,em.slot)(),switchExtensionToStandalone:(0,em.slot)(),showInput:(0,em.slot)(),showFormOnPage:(0,em.slot)(),signalTti:(0,em.slot)(),signalDatabasesSent:(0,em.slot)()},ef=(0,ea.Enum)("GET_EXTENSION_ID","SIGNAL_TTI","DATABASES_SEND","SHOW_INPUT","SHOW_FORM_ON_PAGE","SWITCH_TO_STANDALONE");var eE=r(19005),eA=((a={})[a.EMPTY_EMAIL=0]="EMPTY_EMAIL",a[a.INVALID_EMAIL=1]="INVALID_EMAIL",a[a.UNKNOWN_ERROR=2]="UNKNOWN_ERROR",a),eh=((o={})[o.UNKNOWN_ERROR=0]="UNKNOWN_ERROR",o),e_=r(44245),eT=r(85548),ev=r(86518),eI=r(23768),eD=((n={})[n.UNKNOWN_ERROR=0]="UNKNOWN_ERROR",n),eP=((i={}).UNKNOWN_ERROR="UNKNOWN_ERROR",i.NO_KEYHANDLE_FOUND="NO_KEYHANDLE_FOUND",i.WRONG_AUTHENTICATION_CODE="WRONG_AUTHENTICATION_CODE",i),eO=((s={}).AUTHENTICATION_TYPE="AUTHENTICATION_TYPE",s.BACKUP_PHONE="BACKUP_PHONE",s.QR_CODE="QR_CODE",s.AUTHENTICATION_CODE="AUTHENTICATION_CODE",s.LOADING="LOADING",s.FINALIZING_CHANGES="FINALIZING_CHANGES",s.BACKUP_CODES="BACKUP_CODES",s.GENERIC_ERROR="GENERIC_ERROR",s.LOGOUT_REQUIRED="LOGOUT_REQUIRED",s.SUCCESS="SUCCESS",s),eC=((c={}).CONFIRMATION="CONFIRMATION",c.AUTHENTICATION_CODE="AUTHENTICATION_CODE",c.BACKUP_CODE="BACKUP_CODE",c.FINALIZING_CHANGES="FINALIZING_CHANGES",c.SUCCESS="SUCCESS",c.LOGOUT_REQUIRED="LOGOUT_REQUIRED",c.GENERIC_ERROR="GENERIC_ERROR",c),eb=((l={}).INTERNAL_ERROR="internal_error",l.CANNOT_SEED_FOR_USER_WITH_TOTP_ENABLED="cannot_seed_for_user_with_TOTP_enabled",l.OTP_FAILED="otp_failed",l.TOTP_TYPE_IS_NOT_SET_TO_EMAIL_TOKEN="totp_type_is_not_set_to_email_token",l.PHONE_VALIDATION_FAILED="phone_validation_failed",l),eR=r(62571),eN=r(38466),ew=r(30412),eL=((u={}).ANALYSIS_ENABLED_ON_ALL_FORMS="ANALYSIS_ENABLED_ON_ALL_FORMS",u.ANALYSIS_ENABLED_ONLY_ON_LOGINS_AND_PASSWORDS="ANALYSIS_ENABLED_ONLY_ON_LOGINS_AND_PASSWORDS",u),eU=r(19015),eM=r(93704),eF=r(42758),ek=r(46684),eK=((d={}).ChangeUserCryptoFailed="CHANGE_USER_CRYPTO_FAILED",d),eB=((p={}).ARGON2D="argon2d",p.PBKDF2="pbkdf2",p.KWC3="kwc3",p),eG=r(3959),ej=((S={}).GetDarkWebInsightsFailed="GET_DARK_WEB_INSIGHTS_FAILED",S.GetDarkWebInsightsSummaryFailed="GET_DARK_WEB_INSIGHTS_SUMMARY_FAILED",S),eV=((g={}).Password="password",g.CreditCard="creditcard",g.IPAddress="ip",g.MailingAddress="address",g.Phone="phone",g.Email="email",g.Social="social",g.GeoLocation="geolocation",g.UserName="username",g.PersonalInfo="personalinfo",g);let eW=Object.freeze({New:"new",Viewed:"viewed"});var eH=r(83252),ex=r(95449),eY=((m={}).Username="username",m.Password="password",m.Email="email",m.CreditCard="creditcard",m.Phone="phone",m.Address="address",m.SSN="ssn",m.IP="ip",m.Location="geolocation",m.PersonalInfo="personalinfo",m.SocialNetwork="social",m),eq=((y={}).UNKNOWN="unknown",y.SYNCING="syncing",y.SKIPPED="skipped",y.UNCHANGED="unchanged",y.UPDATED="updated",y.ERROR="error",y),e$=r(80889),eQ=r(28960),ez=((f={}).Unlimited="unlimited",f.UnderLimit="underLimit",f.NearLimit="nearLimit",f.AtOrAboveLimit="atOrAboveLimit",f),eX=r(59249),eJ=((E={}).UNSUPPORTED_DATATYPE_ERROR="Unsupported Data Export Type",E.UNDEFINED_PASSWORD_ERROR="Undefined Password",E),eZ=r(25751),e0=r(46573),e1=r(57108),e2=r(76096),e3=r(5047),e6=r(89643),e8=((A={}).INTERNAL_ERROR="INTERNAL_ERROR",A.NOT_AUTHENTICATED="NOT_AUTHENTICATED",A.NOT_FOUND="NOT_FOUND",A),e4=((h={}).MISSING_ID_NUMBER="MISSING_ID_NUMBER",h),e7=((_={}).MISSING_ID_NUMBER="MISSING_ID_NUMBER",_),e5=r(55168),e9=r(38750),te=r(99222),tt=((T={}).NOT_FOUND="NOT_FOUND",T.INTERNAL_ERROR="INTERNAL_ERROR",T.LEAVE_SHARING_FAILED="LEAVE_SHARING_FAILED",T.LEAVE_SHARING_FORBIDDEN_LAST_ADMIN="LEAVE_SHARING_FORBIDDEN_LAST_ADMIN",T.LEAVE_SHARING_FORBIDDEN_GROUP_ITEM="LEAVE_SHARING_FORBIDDEN_GROUP_ITEM",T),tr=r(12569),ta=((v={}).MAX_CONTENT_LENGTH_EXCEEDED="MAX_CONTENT_LENGTH_EXCEEDED",v.QUOTA_EXCEEDED="QUOTA_EXCEEDED",v.HARD_QUOTA_EXCEEDED="HARD_QUOTA_EXCEEDED",v.SOFT_QUOTA_EXCEEDED="SOFT_QUOTA_EXCEEDED",v.INVALID_FILE_TYPE="INVALID_FILE_TYPE",v.INTERNAL_ERROR="INTERNAL_ERROR",v.SERVER_ERROR="SERVER_ERROR",v.FILE_NOT_FOUND="FILE_NOT_FOUND",v),to=((I={}).None="None",I.Initial="Initial",I.Uploading="Uploading",I.Ciphering="Ciphering",I.Done="Done",I.Error="Error",I),tn=((D={}).NOT_FOUND="NOT_FOUND",D),ti=((P={}).NOT_FOUND="NOT_FOUND",P.INTERNAL_ERROR="INTERNAL_ERROR",P.LEAVE_SHARING_FAILED="LEAVE_SHARING_FAILED",P.LEAVE_SHARING_FORBIDDEN_LAST_ADMIN="LEAVE_SHARING_FORBIDDEN_LAST_ADMIN",P.LEAVE_SHARING_FORBIDDEN_GROUP_ITEM="LEAVE_SHARING_FORBIDDEN_GROUP_ITEM",P),ts=r(42),tc=r(56480),tl=r(3130),tu=((O={})[O.NOT_AUTHORIZED=0]="NOT_AUTHORIZED",O[O.NOT_FOUND=1]="NOT_FOUND",O[O.INTERNAL_ERROR=2]="INTERNAL_ERROR",O),td=((C={}).EMPTY_CARD_NUMBER_AND_SECURITY_CODE="EMPTY_CARD_NUMBER_AND_SECURITY_CODE",C.NOT_FOUND="NOT_FOUND",C),tp=r(8494),tS=r(63154),tg=r(73137),tm=r(47628),ty=r(7572),tf=r(17658),tE=r(36371),tA=r(20770);let th="update_available",t_="unknown_revision",tT="not_found",tv="not_updated",tI="unspecified_error",tD="error_server",tP=["phishing_urls_test.json"];var tO=r(79853),tC=r(4409),tb=r(65175),tR=r(544),tN=r(49068),tw=r(61226),tL=r(52742),tU=r(2652),tM=r(851),tF=((b={})[b.MasterPasswordMissing=0]="MasterPasswordMissing",b[b.DeviceAuthenticationMissing=1]="DeviceAuthenticationMissing",b[b.TokenMissing=2]="TokenMissing",b[b.OTPMissing=3]="OTPMissing",b[b.AskPersistData=4]="AskPersistData",b[b.LoggedIn=5]="LoggedIn",b[b.ExtraDeviceTokenMissing=6]="ExtraDeviceTokenMissing",b[b.SSOLogin=7]="SSOLogin",b[b.DeviceLimitFlow=8]="DeviceLimitFlow",b[b.DashlaneAuthenticatorApprovalMissing=9]="DashlaneAuthenticatorApprovalMissing",b[b.DashlaneAuthenticatorApprovalCancelled=10]="DashlaneAuthenticatorApprovalCancelled",b[b.MasterPasswordLess=11]="MasterPasswordLess",b),tk=((R={}).SSO="sso",R.MP="master_password",R),tK=((N={}).SUCCESS="SUCCESS",N.ASK_NEW_MP="ASK_NEW_MP",N.EMPTY_LOGIN="EMPTY_LOGIN",N.INNACTIVE_SESSION="INNACTIVE_SESSION",N.SSO_VERIFICATION_FAILED="SSO_VERIFICATION_FAILED",N.UNKNOWN_ERROR="UNKNOWN_ERROR",N.UNSUPPORTED_TRANSITION="UNSUPPORTED_TRANSITION",N.WRONG_PASSWORD="WRONG_PASSWORD",N.SSO_LOGIN_CORRUPT="SSO_LOGIN_CORRUPT",N),tB=((w={}).RELOGIN_NEEDED="RELOGIN_NEEDED",w.SSO_FEATURE_BLOCKED="SSO_FEATURE_BLOCKED",w.SSO_LOGIN_CORRUPT="SSO_LOGIN_CORRUPT",w.SSO_SETUP_ERROR="SSO_SETUP_ERROR",w.UNKNOWN_ERROR="UNKNOWN_ERROR",w.TEAM_ACCEPTANCE_SUCCESS="TEAM_ACCEPTANCE_SUCCESS",w.TEAM_ACCEPTANCE_ERROR="TEAM_ACCEPTANCE_ERROR",w),tG=r(87534),tj=r(36792),tV=((L={}).Email="email",L.Welcome="welcome",L.OTP1="OTP1",L.OTP2="OTP2",L.BackupCodeOTP1="backupCodeOTP1",L.BackupCodeOTP2="backupCodeOTP2",L.OTPToken="token",L.Password="password",L.SSO="SSO",L.ActivateSSO="activateSSO",L.WebAuthn="webAuthn",L.WebAuthnError="webAuthnError",L.DeviceLimitReached="deviceLimitReached",L.DashlaneAuthenticator="dashlaneAuthenticator",L.PasswordLess="passwordLess",L),tW=((U={}).PaymentFailureChurning="paymentFailureChurning",U.PaymentFailureChurned="paymentFailureChurned",U.SwitchToMlAnalysisEngine="switchToMlAnalysisEngine",U.DWMb2bAutoEnrollTooltip="dWMb2bAutoEnrollTooltip",U.TacGetTheExtensionBanner="tacGetTheExtensionBanner",U.TacEnableAccountRecoveryBanner="tacEnableAccountRecoveryBanner",U.TacOnlyOneAdminBanner="tacOnlyOneAdminBanner",U.TacDarkWebInsightsNewBadge="tacDarkWebInsightsNewBadge",U.PasswordHistoryBanner="passwordHistoryBanner",U.SharingCenterDisabledBanner="sharingCenterDisabledBanner",U.AccountRecoveryAvailableAdminTooltip="accountRecoveryAvailableAdminTooltip",U.ActivateInviteLink="activateInviteLink",U.MpToSsoMigrationDoneDialog="mpToSsoMigrationDoneDialog",U),tH=((M={}).Interacted="interacted",M.Seen="seen",M.Unseen="unseen",M),tx=r(58852),tY=r(90555),tq=r(76950),t$=((F={}).UnexpectedError="UNEXPECTED_ERROR",F);let tQ="USER_STILL_OVERFLOWING",tz="UNEXPECTED_ERROR";var tX=((k={}).UnexpectedError="UNEXPECTED_ERROR",k),tJ=r(37797),tZ=((K={}).Android="android",K.DesktopMacOS="macosx",K.DesktopWindows="windows",K.IPad="ipad",K.IPhone="iphone",K.IPod="ipod",K.Other="other",K.StandaloneExtension="saex",K.TeamAdminConsole="tac",K.WebApp="webapp",K),t0=((B={})[B.Android=0]="Android",B[B.CarbonTests=1]="CarbonTests",B[B.CarbonUnknown=2]="CarbonUnknown",B[B.DesktopLegacyMacOS=3]="DesktopLegacyMacOS",B[B.DesktopLegacyWindows=4]="DesktopLegacyWindows",B[B.DesktopUWP=5]="DesktopUWP",B[B.IPad=6]="IPad",B[B.IPhone=7]="IPhone",B[B.IPod=8]="IPod",B[B.StandaloneExtension=9]="StandaloneExtension",B[B.TeamAdminConsole=10]="TeamAdminConsole",B[B.WebApp=11]="WebApp",B[B.WebAppDev=12]="WebAppDev",B),t1=r(47038),t2=r(26968),t3=r(90416),t6=r(74190),t8=((G={}).ascending="ascending",G.descending="descending",G),t4=r(27188),t7=((j={}).SUCCESS="success",j.ERROR="error",j);let t5="WRONG PASSWORD";var t9=((V={}).SUCCESS="success",V.ERROR="error",V),re=r(71614),rt=((W={}).CheckRecoveryStatusFailed="CHECK_RECOVERY_STATUS_FAILED",W.RecoverySetupFailed="RECOVERY_SETUP_FAILED",W.RecoveryDeactivationFailed="RECOVERY_DEACTIVATION_FAILED",W.RecoveryRequestFailed="RECOVERY_REQUEST_FAILED",W.RegisterDeviceFailed="REGISTER_DEVICE_FAILED",W.SetupMasterPasswordForRecoveryFailed="SETUP_MASTERPASSWORD_FOR_RECOVERY_FAILED",W.CancelRecoveryRequestFailed="CANCEL_RECOVERY_REQUEST_FAILED",W.RecoverUserDataFailed="RECOVER_REQUEST_FAILED",W.CheckLocalRecoveryKeyFailed="CHECK_LOCAL_RECOVERY_KEY_FAILED",W.StartAccountRecoveryFailed="START_ACCOUNT_RECOVERY_FAILED",W.AccountRecoveryNotAvailableError="ACCOUNT_RECOVERY_NOT_AVAILABLE_ERROR",W.IsRecoveryRequestPendingFailed="IS_RECOVERY_REQUEST_PENDING_FAILED",W),rr=((H={}).PENDING="PENDING",H.APPROVED="APPROVED",H.REFUSED="REFUSED",H.OVERRIDDEN="OVERRIDDEN",H.CANCELED="CANCELED",H),ra=r(58415),ro=r(26159),rn=((x={})[x.USER_EXISTS=0]="USER_EXISTS",x[x.USER_DOESNT_EXIST=1]="USER_DOESNT_EXIST",x[x.USER_DOESNT_EXIST_UNLIKELY_MX=2]="USER_DOESNT_EXIST_UNLIKELY_MX",x[x.USER_DOESNT_EXIST_INVALID_MX=3]="USER_DOESNT_EXIST_INVALID_MX",x[x.USER_DOESNT_EXIST_SSO_NON_PROVISIONED=4]="USER_DOESNT_EXIST_SSO_NON_PROVISIONED",x[x.USER_SSO_PROVISIONED=5]="USER_SSO_PROVISIONED",x[x.USER_NITRO_SSO_PROVISIONED=6]="USER_NITRO_SSO_PROVISIONED",x[x.USER_NOT_PROPOSED=7]="USER_NOT_PROPOSED",x),ri=r(75053),rs=((Y={}).ComputePlanPricingFailed="COMPUTE_PLAN_PRICING_FAILED",Y.NotBillingAdmin="NOT_BILLING_ADMIN",Y);let rc="UNKNOWN_ERROR",rl="TEAM_DEVICE_CONFIGURATION_NOT_FOUND",ru=Object.freeze({Activated:"activated",PendingActivation:"pending_activation",PendingDeactivation:"pending_deactivation"});var rd=((q={}).StartAuditLogsQueryFailed="START_AUDIT_LOGS_QUERY_FAILED",q.GetAuditLogQueryResultsFailed="GET_AUDIT_LOG_QUERY_RESULTS_FAILED",q);let rp=Object.freeze({Queued:"QUEUED",Running:"RUNNING",Succeeded:"SUCCEEDED",Failed:"FAILED",Cancelled:"CANCELLED"});var rS=r(15524);let rg=Object.freeze({pending:"pending",valid:"valid",expired:"expired",invalid:"invalid"}),rm=rg,ry=Object.freeze({OK:"OK",ES_UNREACHABLE:"ES_UNREACHABLE",ES_CONFIG_RELOAD_FAILURE:"ES_CONFIG_RELOAD_FAILURE",ES_INTERNAL_NETWORK_ERROR:"ES_INTERNAL_NETWORK_ERROR"});var rf=(($={}).NotAdmin="not_admin",$.TeamKeyNotFound="TEAM_KEY_NOT_FOUND",$.InviteLinkNotFound="TEAM_INVITE_LINK_NOT_FOUND",$.UserInviteLinkNotFound="USER_TEAM_INVITE_TOKEN_NOT_FOUND",$),rE=((Q={}).NotAdmin="not_billing_admin",Q.InternalError="internal_error",Q.UnknownError="UNKNOWN_ERROR",Q),rA=((z={}).XML_PARSE_FAILED="xml_parse_failed",z),rh=((X={}).KEY_DESCRIPTOR_NOT_FOUND="key_descriptor_not_found",X.IDP_ENTRYPOINT_NOT_FOUND="idp_entrypoint_not_found",X.INVALID_IDP_SSO_DESCRIPTOR="invalid_idp_sso_descriptor",X.MISSING_CERTIFICATE="missing_certificate",X.CERTIFICATE_TOO_SHORT="certificate_too_short",X.CERTIFICATE_TOO_LONG="certificate_too_long ",X.CERTIFICATE_DECODE_FAILED="certificate_decode_failed",X.INVALID_ENTRYPOINT="invalid_entrypoint",X),r_=r(88323);function rT(e){return!!e&&"KWAddress"===e.kwType}function rv(e){return!!e&&"KWBankStatement"===e.kwType}var rI=((J={}).PENDING="PENDING",J.VIEWED="VIEWED",J.ACKNOWLEDGED="ACKNOWLEDGED",J);function rD(e){return!!e&&"KWSecurityBreach"===e.kwType}function rP(e){return!!e&&"KWCollection"===e.kwType}var rO=r(66407);function rC(e){return!!e&&"KWCompany"===e.kwType}var rb=r(71749);function rR(e){return!!e&&"KWDriverLicence"===e.kwType}function rN(e){return!!e&&"KWEmail"===e.kwType}function rw(e){return!!e&&"KWFiscalStatement"===e.kwType}function rL(e){return!!e&&"KWGeneratedPassword"===e.kwType}function rU(e){return!!e&&"KWIDCard"===e.kwType}function rM(e){return!!e&&"KWIdentity"===e.kwType}var rF=r(13477),rk=r(70727),rK=r(20394);function rB(e){return!!e&&"KWPassport"===e.kwType}var rG=r(17886);function rj(e){return!!e&&"KWPaymentMean_paypal"===e.kwType}function rV(e){return!!e&&"KWSettingsManagerApp"===e.kwType}function rW(e){return!!e&&"KWPersonalWebsite"===e.kwType}var rH=r(52235),rx=r(51603);function rY(e){return!!e&&"KWSecureFileInfo"===e.kwType}function rq(e){return!!e&&"KWSocialSecurityStatement"===e.kwType}var r$=r(48834),rQ=((Z={}).DEFAULT="default",Z.TRIAL_EXPIRED="trial_expired",Z.WEB_STORE="web_store",Z.DASHBOARD_UPRADE="dashboard_upgrade",Z.SHARING_CENTER_FAMILY="sharing_center_family",Z.SHARING_CENTER_WORK="sharing_center_work",Z),rz=r(2328),rX=((ee={}).Activated="Activated",ee.Activating="Activating",ee.Error="Error",ee.NotFound="NotFound",ee.Ready="Ready",ee),rJ=((et={}).ServerError="ServerError",et.AccountAlreadyExistError="AccountAlreadyExist",et),rZ=((er={}).InTeam="InTeam",er.NotPremium="NotPremium",er.NoPayment="NoPayment",er.Other="Other",er),r0=r(7131),r1=r(45449),r2=r(30424),r3=r(93675);let r6=["lockSession","closeSession","cancelDashlaneAuthenticatorRegistration","openSession","openSessionWithDashlaneAuthenticator","openSessionWithOTP","openSessionWithOTPForNewDevice","openSessionWithToken","openSessionResendToken","savePersonalDataItem","sessionForceSync","getLocalAccountsList"];var r8=r(6223),r4=r(49247)},79193:function(e,t,r){r.d(t,{y$:()=>s,PN:()=>c,Om:()=>o,Yg:()=>S,sh:()=>g});var a,o=((a={}).PopupCarbon="Popup",a.PopupCarbonLoader="PopupCarbonLoader",a.OptionsCarbon="OptionsCarbon",a.WebappCarbon="leeloo",a),n=r(55466),i=r(12791);class s extends i.GenericChannel{connect(e){this.onMessage=t=>{e.receive(t)},this.isConnected=!0,this._connected()}receive(e){this._messageReceived(e)}send(e){if(!this.isConnected)throw Error("Channel not connected");if(!this.onMessage)throw Error("onMessage handler not set");this.onMessage(e)}constructor(...e){super(...e),(0,n._)(this,"isConnected",!1),(0,n._)(this,"onMessage",null)}}let c=(e,t)=>{e.connect(t),t.connect(e)};var l=r(85500),u=r(80801);function d(e){return!!((e.sender?.id??"")===(0,u.z)()||function(e){let t=e.sender?.origin??new URL(e.sender?.url??e.sender?.tab?.url??"").origin;return new URL((0,l.A)("")).origin===t}(e))}var p=r(30788);class S extends i.GenericChannel{listen(){p.b.addListener(this.onConnectListener)}send(e){if(!this.currentPorts.size)throw Error("No port to send message");this.currentPorts.forEach(t=>t.postMessage(e))}setup(e){let t=this.currentPorts.get(e.name);t&&(t.disconnect(),this.onDisconnectListener(t)),e.onMessage.addListener(this.onMessageListener),e.onDisconnect.addListener(this.onDisconnectListener),this.currentPorts.set(e.name,e),this._connected()}constructor(e,t=5e3){super(t),(0,n._)(this,"name",void 0),(0,n._)(this,"currentPorts",void 0),(0,n._)(this,"onConnectListener",e=>{if(e.name.startsWith(this.name)){if(this.currentPorts.has(e.name))throw Error("Port already connected");if(!d(e))throw Error("Sender origin not trusted");this.setup(e)}}),(0,n._)(this,"onDisconnectListener",e=>{let t=this.currentPorts.get(e.name);if(t&&(t.onMessage.removeListener(this.onMessageListener),t.onDisconnect.removeListener(this.onDisconnectListener),this.currentPorts.delete(e.name)),this._disconnected(),chrome.runtime.lastError)throw Error(chrome.runtime.lastError.message??"Unknown chrome.runtime.lastError")}),(0,n._)(this,"onMessageListener",e=>{this._messageReceived(e)}),this.name=e,this.currentPorts=new Map}}class g extends i.GenericChannel{listen(){this.port&&(this.port.disconnect(),this.onDisconnectListener()),p.b.addListener(this.onConnectListener)}send(e){if(!this.port)throw Error("No port to send message");this.port.postMessage(e)}setup(e){this.port=e,this.port.onMessage.addListener(this.onMessageListener),this.port.onDisconnect.addListener(this.onDisconnectListener),this._connected()}constructor(e,t=5e3){super(t),(0,n._)(this,"name",void 0),(0,n._)(this,"port",void 0),(0,n._)(this,"onConnectListener",e=>{if(e.name===this.name){if(!d(e))throw Error("Sender origin not trusted");this.setup(e)}}),(0,n._)(this,"onDisconnectListener",()=>{if(this.port&&(this.port.onMessage.removeListener(this.onMessageListener),this.port.onDisconnect.removeListener(this.onDisconnectListener),this.port=void 0),this._disconnected(),chrome.runtime.lastError)throw Error(chrome.runtime.lastError.message??"Unknown chrome.runtime.lastError")}),(0,n._)(this,"onMessageListener",e=>{this._messageReceived(e)}),this.name=e}}r(65885),i.GenericChannel,i.GenericChannel}}]);