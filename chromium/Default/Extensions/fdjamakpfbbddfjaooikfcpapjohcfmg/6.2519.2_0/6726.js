"use strict";(globalThis.webpackChunk_dashlane_leeloo=globalThis.webpackChunk_dashlane_leeloo||[]).push([[6726],{66490:(e,t,a)=>{a.r(t),a.d(t,{NoteAddPanel:()=>k});var s=a(96832),n=a(51031),o=a(73704),c=a(48038),i=a(8180),l=a(78346),r=a(14900),u=a(14877),d=a(39431),S=a(45272),h=a(92077),p=a(8403),g=a(14943),m=a(42670),y=a(76376),b=a(32021),C=a(63520),N=a(86541),I=a(53189),T=a(13368),A=a(30743),f=a(19122),v=a(86498),w=a(88203),D=a(85163),E=a(69909),_=a(36351);const{CONTENT:O,DOCUMENT_STORAGE:U}=N.SecureNoteTabs,R=({activeSpaces:e})=>{var t;const{routes:a}=(0,y.Xo)(),n=(0,g.Y)(),{openPaywall:N}=(0,p.nL)(),R=(0,h.k6)(),{openDialog:V,shouldShowFrozenStateDialog:k}=(0,m.Ub)(),[P,Z]=(0,s.useState)(O),[M,L]=(0,s.useState)(!1),[q,B]=(0,s.useState)(!1),{attachments:G,isUploading:Y,removeAttachment:z,removeAllAttachments:F}=(0,E.P)(),{currentSpaceId:H}=(0,f.fV)(),Q=(0,v.V)(),{translate:W}=(0,w.Z)(),{addNoteToCollections:X}=(0,D.Q)(),[x,K]=(0,s.useState)(""),[j,J]=(0,s.useState)(""),[$,ee]=(0,s.useState)("GRAY"),[te,ae]=(0,s.useState)(e?.length>0&&!e[0].info?.personalSpaceEnabled?e[0].teamId:null!=H?H:""),[se,ne]=(0,s.useState)(!1),[oe,ce]=(0,s.useState)(!1),{createVaultItem:ie}=(0,i.u)(u.L),[le,re]=(0,s.useState)([]),[ue,de]=(0,s.useState)(!1),Se=(0,s.useMemo)((()=>({id:"",content:x,title:j,category:"noCategory",type:"GRAY",spaceId:te,secured:!1})),[x,te,j]);(0,s.useEffect)((()=>{(0,S.Nc)(o.PageView.ItemSecureNoteCreate)}),[]),(0,s.useEffect)((()=>{k&&V()}),[k]);const he=()=>Q.showAlert(W("_common_generic_error"),r.BLW.ERROR);if(n.status!==c.rq.Success||!n?.data)return null;const pe=(0,T.n6)(T.Co.SecureNotes,n.data?.capabilities),ge=()=>{(0,S.Nc)(o.PageView.ItemSecureNoteList),(0,h.uX)(a.userSecureNotes)},me=()=>L(!0),ye=e=>t=>{me(),e(t)},be=ye(ae),Ce=ye(ee),Ne=ye(J),Ie=ye(K),Te=ye(ce);return pe&&(N(T.qd.SecureNote),R.push("/secure-notes")),(0,_.tZ)(C.zI,{isViewingExistingItem:!1,itemHasBeenEdited:M,submitPending:q,submitDisabled:se,onSubmit:async()=>{if(!q){B(!0);try{await(async()=>{const e={spaceId:null!=te?te:"",type:$,category:"noCategory",secured:oe};try{const t=await ie({vaultItemType:d.U.SecureNote,content:{...e,content:x,title:j,attachments:G}});if(!(0,l.d6)(t))return void he();const a=(0,l.db)(t).id;await X(a,le)}catch(e){he()}})()}catch{B(!1)}ge()}},secondaryActions:P===U?[t||(t=(0,_.tZ)(I.d,{isQuotaReached:!1,isShared:!1,dataType:"KWSecureNote",isUploading:Y},"uploadAction"))]:[],primaryActions:[],onNavigateOut:()=>{F(),ge()},isUsingNewDesign:!0,isSomeDialogOpen:ue,formId:"add_securenote_panel",header:(0,_.tZ)(A.h,{backgroundColor:Se.type,displayDocumentStorage:!le.length,displaySharedAccess:!1,displayMoreOptions:!1,isSecured:oe,setActiveTab:Z,title:j,setTitle:e=>{me(),J(e)}}),children:(0,_.tZ)(b.T,{activeTab:P,secureNoteValues:Se,attachments:G,content:x,title:j,color:$,spaceId:null!=te?te:"",onSpaceIdChange:be,onColorChange:Ce,onTitleChange:Ne,onContentChange:Ie,onIsSecuredChange:Te,onIsSubmitDisabled:ne,handleFileInfoDetached:z,hasAttachment:!!G.length,isSecured:oe,canEdit:!0,canManageAccess:!1,isDisabled:!!k,isShared:!1,isUploading:Y,onModifyData:me,onCollectionsToUpdate:re,setHasDialogsOpenedByChildren:de})})};var V=a(18108);const k=()=>{const e=(0,V.E)();return e.status!==n.rq.Success?null:(0,_.tZ)(R,{activeSpaces:e.data})}}}]);