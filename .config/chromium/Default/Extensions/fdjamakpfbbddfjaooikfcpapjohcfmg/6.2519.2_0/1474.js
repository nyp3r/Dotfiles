"use strict";(globalThis.webpackChunk_dashlane_leeloo=globalThis.webpackChunk_dashlane_leeloo||[]).push([[1474],{82994:(e,t,a)=>{a.d(t,{s:()=>m}),a(96832);var i=a(62264),n=a(8180),s=a(51031),r=a(14877),c=a(88203);let o=function(e){return e.LastAdmin="LastAdmin",e.GroupSharing="GroupSharing",e.CollectionSharing="CollectionSharing",e.Generic="Generic",e}({});var l=a(78956),d=a(24731),u=a(36351);const p=({reason:e,translations:t,goToSharingAccess:a,closeCantDeleteDialog:i})=>{const{translate:n}=(0,c.Z)(),s=((e,t)=>{const{groupSharingTitle:a,lastAdminTitle:i,collectionSharingTitle:n,genericErrorTitle:s}=e;switch(t){case o.LastAdmin:return i;case o.GroupSharing:return a;case o.CollectionSharing:return n;case o.Generic:return s;default:return(0,d.U)(t)}})(t,e),r=((e,t)=>{const{groupSharingSubtitle:a,lastAdminSubtitle:i,collectionSharingSubtitle:n,genericErrorSubtitle:s}=e;switch(t){case o.LastAdmin:return i;case o.GroupSharing:return a;case o.CollectionSharing:return n;case o.Generic:return s;default:return(0,d.U)(t)}})(t,e);return(0,u.tZ)(l.Vq,{isOpen:!0,onClose:i,title:null!=s?s:"",closeActionLabel:n("_common_dialog_dismiss_button"),actions:e===o.LastAdmin||o.GroupSharing||o.CollectionSharing?{primary:{children:t.lastAdminActionLabel,onClick:()=>{a(),i()}}}:void 0,children:r})};var _=a(37527);const h=({closeConfirmDeleteDialog:e,onDeleteConfirm:t,translations:a})=>{const{translate:i}=(0,c.Z)(),{confirmDeleteSubtitle:n,confirmDeleteTitle:s,confirmDeleteDismiss:r,confirmDeleteConfirm:o}=a;return(0,u.tZ)(l.Vq,{title:s,onClose:e,isOpen:!0,dialogClassName:_.Ht,closeActionLabel:i("_common_dialog_dismiss_button"),isDestructive:!0,actions:{primary:{children:o,onClick:t,id:"deletion-dialog-confirm-button"},secondary:{children:r,onClick:e,autoFocus:!0,id:"deletion-dialog-dismiss-button"}},children:n})},m=({closeConfirmDeleteDialog:e,goToSharingAccess:t,isVisible:a,itemId:l,onDeletionSuccess:d,sharingStatus:_,translations:m,vaultItemType:g,isShared:S,isSharedViaUserGroup:b,isItemInCollection:C,isLastAdmin:f})=>{const{showToast:I}=(0,i.p)(),{translate:D}=(0,c.Z)(),{deleteVaultItem:T}=(0,n.u)(r.L);if(!a)return null;let w;return(S||_?.isShared)&&(b&&(w=o.GroupSharing),f&&(w=o.LastAdmin),C&&(w=o.CollectionSharing)),w&&t?(0,u.tZ)(p,{reason:w,translations:m,goToSharingAccess:t,closeCantDeleteDialog:e}):(0,u.tZ)(h,{closeConfirmDeleteDialog:e,onDeleteConfirm:async()=>{try{var e;(await T({id:l,vaultItemType:g})).tag===s.rq.Success?(I({description:null!=(e=m.deleteSuccessToast)?e:D("webapp_personal_info_edition_delete_success_toast")}),d()):I({description:D("_common_generic_error"),mood:"danger",isManualDismiss:!0})}catch(e){I({description:D("_common_generic_error"),mood:"danger",isManualDismiss:!0})}},translations:m})}},62042:(e,t,a)=>{a.d(t,{_:()=>o});var i=a(73704),n=a(88203),s=a(1639),r=a(36351);const c=({sharing:e})=>{const{translate:t}=(0,n.Z)();return(0,r.tZ)(s.Z,{tooltipPlacement:"top-start",sharing:e,text:t("webapp_sharing_invite_share"),origin:i.Origin.ItemDetailView})},o=({id:e,canShare:t,getSharing:a})=>t?(0,r.tZ)(c,{sharing:a(e)}):null},16009:(e,t,a)=>{a.d(t,{r:()=>n});let i=function(e){return e.CredentialsList="credentialsList",e.SecureNotesList="secureNotesList",e.UserList="user",e.GroupList="userGroup",e.CollectionList="collection",e}({});const n=(e,t)=>{switch(e?.previousPage?.type){case i.CredentialsList:return t.userCredentials;case i.SecureNotesList:return t.userSecureNotes;case i.UserList:return e.previousPage.alias?t.userSharingUserInfo(e.previousPage.alias):t.userCredentials;case i.GroupList:{const a=e.previousPage.groupId?.match(/{(.*)}/)?.[1];return a?t.userSharingGroupInfo(a):t.userCredentials}case i.CollectionList:{const a=e.previousPage.collectionId?.match(/{(.*)}/)?.[1];return a?t.userCollection(a):t.userCredentials}default:return t.userCredentials}}},68636:(e,t,a)=>{a.r(t),a.d(t,{SecretEditPanel:()=>x});var i=a(96832),n=a(15192),s=a(14877),r=a(39431),c=a(89078),o=a(51031),l=a(24507),d=a(84925),u=a(73704),p=a(30894),_=a(45272),h=a(92077),m=a(40577),g=a(14900),S=a(42670),b=a(86498),C=a(88203),f=a(53189),I=a(82994),D=a(69909),T=a(79808),w=a(62042),y=a(92730),A=a(99822),v=a(96057),L=a(63520),E=a(8180),Z=a(78047),U=a(66098),O=a(15940),P=a(36351);const{CONTENT:N,SHARED_ACCESS:R,DOCUMENT_STORAGE:G}=O.SecretsTabs,k=({secret:e,isShared:t,sharingCapabilities:a,isSharedViaUserGroup:n,isLastAdmin:c})=>{var l,d;const{translate:p}=(0,C.Z)(),{routes:_}=(0,h.Xo)(),{navigateBack:k}=(0,y.u)(),{showAlert:V}=(0,b.V)(),[F,x]=(0,i.useState)(N),[B,q]=(0,i.useState)(!1),[M,z]=(0,i.useState)(!1),[H,X]=(0,i.useState)(!1),[K,W]=(0,i.useState)(!1),[Y,$]=(0,i.useState)({id:e.id,title:e.title,content:e.content,spaceId:null!=(l=e.spaceId)?l:"",secured:null!=(d=e.isSecured)&&d}),{attachments:j,isUploading:Q}=(0,D.P)(e.attachments),{data:J,status:ee}=(0,T.r)(e.id),te=function(){const{translate:e}=(0,C.Z)(),{showAlert:t}=(0,b.V)(),{updateVaultItem:a}=(0,E.u)(s.L);return async(i,n)=>{try{await a({vaultItemType:r.U.Secret,content:i,id:n})}catch{t(e("_common_generic_error"),g.BLW.ERROR)}}}(),{shouldShowFrozenStateDialog:ae}=(0,S.Ub)(),ie=(0,m.o)("ace_secrets_vault_attachment")||!!e.attachments&&e.attachments.length>0,ne=t&&ee===o.rq.Success&&null!=(se=J?.count)?se:0;var se;const re=(0,v.vN)(u.ItemType.Secret,(()=>V(p("_common_generic_error"),g.BLW.ERROR))),ce=()=>{k(_.userSecrets)};if(!e)return ce(),null;const oe=async(t,a=!0)=>{var i;W(!0),await te({title:Y.title,content:Y.content,spaceId:null!=(i=Y.spaceId)?i:"",isSecured:Y.secured,attachments:t},e.id),W(!1),a&&ce()},le={confirmDeleteConfirm:p("webapp_secrets_edition_delete_confirm"),confirmDeleteDismiss:p("webapp_credential_edition_delete_dismiss"),confirmDeleteSubtitle:p("webapp_credential_edition_confirm_delete_subtitle"),confirmDeleteTitle:p("webapp_secrets_edition_delete_title"),lastAdminActionLabel:p("webapp_credential_edition_change_permissions"),lastAdminTitle:p("webapp_credential_edition_last_admin_title"),lastAdminSubtitle:p("webapp_credential_edition_last_admin_subtitle"),groupSharingTitle:p("webapp_secrets_edition_group_sharing_title"),groupSharingSubtitle:p("webapp_credential_edition_group_sharing_subtitle"),genericErrorTitle:"webapp_account_recovery_generic_error_title",genericErrorSubtitle:"webapp_account_recovery_generic_error_subtitle"};if(null===ae)return null;const de=t||ie?[{id:"tab-secret-detail",contentId:"content-secret-detail",title:p("webapp_secrets_edition_field_tab_title_details"),onSelect:()=>x(N)}]:[];return t?de.push({id:"tab-secret-shared-access",contentId:"content-secret-shared-access",title:`${p("webapp_secure_notes_edition_field_tab_title_shared_access")} (${ne})`,onSelect:()=>x(R)}):ie&&de.push({id:"tab-secret-attachments",contentId:"content-secret-attachments",title:p("webapp_secrets_edition_field_tab_title_attachments"),onSelect:()=>x(G)}),(0,P.BX)(L.zI,{isUsingNewDesign:!0,isViewingExistingItem:!0,itemHasBeenEdited:B,onSubmit:()=>oe(j),submitPending:K,secondaryActions:(()=>{switch(F){case N:return[(i=e,!i||t&&!a.canShare||i.attachments?.length?null:(0,P.tZ)(w._,{id:e.id,canShare:a.canShare&&!ae,getSharing:A.fl},"shareaction"))];case G:return[(0,P.tZ)(f.d,{isQuotaReached:!1,isShared:t,itemId:e.id,dataType:"KWSecret",disabled:!!ae,isUploading:Q},"uploadAction")];default:return[]}var i})(),onNavigateOut:ce,onClickDelete:()=>z(!0),ignoreCloseOnEscape:M||H,isSomeDialogOpen:M,formId:"edit_secret_panel",header:(0,P.tZ)(U.h,{title:Y.title,tabs:de}),children:[(0,P.tZ)(Z.e,{activeTab:F,sharingCapabilities:a,isSecured:e.isSecured,isAttachmentUploading:Q,isNewItem:!1,secretValues:Y,attachments:j,handleChange:(t,a)=>{if("spaceId"===t&&a===Y.spaceId)return;const i={...Y,[t]:a},n=e.title!==i.title||e.content!==i.content||e.spaceId!==i.spaceId||e.isSecured!==i.secured;n!==B&&q(n),$(i)},handleFileInfoDetached:e=>{const t=j.filter((t=>t.id!==e));oe(t,!1)},onModalDisplayStateChange:X}),(0,P.tZ)(I.s,{isVisible:M,itemId:e.id,closeConfirmDeleteDialog:()=>z(!1),goToSharingAccess:()=>{x(O.SecretsTabs.SHARED_ACCESS)},onDeletionSuccess:()=>{j?.forEach((e=>{const{id:t}=e;re(t)})),ce()},translations:le,vaultItemType:r.U.Secret,isShared:t,isLastAdmin:c,isSharedViaUserGroup:n})]})};var V=a(16009);const F=e=>{const{secret:t}=e,a=(0,p.tY)();(0,i.useEffect)((()=>{(0,_.Nc)(u.PageView.ItemSecretDetails)}),[t]);const{getPermissionForItem:n,getSharingStatusForItem:s,getIsLastAdminForItem:r}=(0,c.Y)(d.X,{getPermissionForItem:{queryParam:{itemId:t.id}},getSharingStatusForItem:{queryParam:{itemId:t.id}},getIsLastAdminForItem:{queryParam:{itemId:t.id}}},[]);if(n.status!==o.rq.Success||s.status!==o.rq.Success||r.status!==o.rq.Success)return null;const{isShared:l,isSharedViaUserGroup:h}=s.data,{isLastAdmin:m}=r.data;return(0,P.tZ)(k,{...e,...a,isShared:l,sharingCapabilities:n.data?.capabilities,isSharedViaUserGroup:h,isLastAdmin:m})},x=e=>{const{routes:t}=(0,h.Xo)(),{data:a,status:i}=(0,l.k)(s.L,"query",{vaultItemTypes:[r.U.Secret],ids:[`{${e.match.params.uuid}}`]});return i===o.rq.Loading?null:a?.secretsResult.items.length?(0,P.tZ)(F,{...e,secret:a.secretsResult.items[0]}):e.location?.state?(0,P.tZ)(n.l_,{to:(0,V.r)(e.location.state,t)}):(0,P.tZ)(n.l_,{to:t.userSecrets})}},15940:(e,t,a)=>{a.d(t,{SecretsTabs:()=>i});let i=function(e){return e[e.CONTENT=0]="CONTENT",e[e.SHARED_ACCESS=1]="SHARED_ACCESS",e[e.DOCUMENT_STORAGE=2]="DOCUMENT_STORAGE",e}({})},66098:(e,t,a)=>{a.d(t,{h:()=>c});var i,n=a(94138),s=a(63520),r=a(36351);const c=({title:e,tabs:t})=>(0,r.tZ)(s.V9,{icon:i||(i=(0,r.tZ)(n.A,{type:"secret",size:"xlarge"})),title:e,tabs:t})},78047:(e,t,a)=>{a.d(t,{e:()=>R});var i=a(96832),n=a(63847),s=a(93853),r=a(51409),c=a(68999),o=a(80610),l=a(51031),d=a(80936),u=a(88203),p=a(24294),_=a(33988),h=a(54350),m=a(68037),g=a(67406),S=a(15940),b=a(42670),C=a(47595),f=a(73704),I=a(30894),D=a(68819),T=a(82207),w=a(45272),y=a(79432),A=a(13252),v=a(36351);const{CONTENT:L,SHARED_ACCESS:E,DOCUMENT_STORAGE:Z}=S.SecretsTabs,U="webapp_secure_notes_edition_field_text_max_size_reached",O="webapp_secret_edition_action_show_secret_content",P="webapp_secret_edition_action_hide_secret_content",N=1e4,R=({activeTab:e,sharingCapabilities:t,isSecured:a,isAttachmentUploading:S,isNewItem:R,secretValues:G,attachments:k,handleChange:V,handleFileInfoDetached:F,onModalDisplayStateChange:x})=>{const{translate:B}=(0,u.Z)(),[q,M]=(0,i.useState)(""),{shouldShowFrozenStateDialog:z}=(0,b.Ub)(),H=(0,_.F)(),{isMPLessUser:X}=(0,h.Z)(),K=!H&&!X,{areProtectedItemsUnlocked:W,openProtectedItemsUnlocker:Y}=(0,I.tY)(),{logRevealSecretContent:$,logCopiedSecretContent:j}=(0,y.D)(),Q=(0,d.I)(),J=Q.status===l.rq.Success&&!Q.isDisabled,{id:ee,title:te,content:ae,spaceId:ie,secured:ne}=G,[se,re]=(0,i.useState)(""===ae),ce=a&&!W,oe=Boolean(ae.length),le=Boolean(ie),de=(0,i.useCallback)(((e,t)=>new Promise(((a,i)=>{if(e||!ce||!K)return t(),a();Y({action:D.P.Show,itemType:D.R.Secret,successCallback:()=>(t(),a()),cancelCallback:i})}))),[ce,Y]),ue=()=>{re((e=>!e)),!se&&le&&$(te)};return null===z?null:(0,v.BX)(i.Fragment,{children:[e===L&&(0,v.BX)(n.k,{"aria-labelledby":"tab-secret-detail",id:"content-secret-detail",flexDirection:"column",gap:"16px",children:[(0,v.BX)(m.u,{title:B("webapp_secrets_box_title_details"),children:[(0,v.tZ)(s.n,{"data-name":"title",label:B("webapp_secrets_title_field"),value:te,onChange:e=>V("title",e.target.value),disabled:!t.canEdit,readOnly:z,sx:{marginBottom:"8px"}}),(0,v.tZ)(r.K,{"data-name":"content",label:B("webapp_secrets_content_field"),placeholder:B("webapp_secrets_content_field_placeholder"),value:se||!oe?ae:"••••••••",onBeforeInput:e=>{const t=e.currentTarget.value;t.length>N&&(M(B(U,{charLeft:N-(t.length-1)})),e.preventDefault())},onPaste:e=>{const t=e.clipboardData.getData("text/plain");e.currentTarget.value.length+t.length>N&&(M(B(U,{charLeft:N-e.currentTarget.value.length})),e.preventDefault())},onChange:e=>{q&&M(""),V("content",e.target.value)},readOnly:!se&&oe||z||!t.canEdit,feedback:q?{text:q}:void 0,error:!!q,actions:[(0,v.tZ)(c.z,{layout:"iconOnly",icon:se?"ActionHideOutlined":"ActionRevealOutlined",mood:"brand",intensity:"supershy",sx:{marginRight:"16px"},onClick:()=>{de(se,ue).catch((()=>{re(!1)}))},"aria-label":B(se?P:O),tooltip:B(se?P:O)},"secret-content-visibility"),...oe?[(0,v.tZ)(T.m,{data:ae,checkProtected:()=>ce,copyLabel:B("webapp_secret_edition_action_copy_secret_content"),onCopy:()=>{(0,w.Kz)(new f.UserCopyVaultItemFieldEvent({itemId:ee,itemType:f.ItemType.Secret,field:f.Field.Secret,isProtected:a})),le&&j(te)},itemType:D.R.Secret,tooltipLocation:"right"},"copy-secret-content")]:[]]})]}),J?(0,v.tZ)(g.M,{disabled:z,contentCardLabel:B("webapp_secrets_box_title_organization"),wrapInContentCard:!0,isUsingNewDesign:!0,defaultSpaceId:null!=ie?ie:"",spaceId:null!=ie?ie:"",onChange:e=>V("spaceId",e)}):null,K?(0,v.tZ)(m.u,{title:B("webapp_secrets_box_title_preferences"),children:(0,v.tZ)(o.X,{readOnly:z,label:B("webapp_secrets_preferences_mp_title"),description:B("webapp_secrets_preferences_mp_description"),checked:Boolean(ne),onChange:()=>{W||R?V("secured",Boolean(!ne)):((0,I.jF)(),Y({action:D.P.Show,itemType:D.R.Secret,successCallback:()=>V("secured",Boolean(!ne))}))}})}):null]}),e===Z&&(0,v.tZ)("div",{"aria-labelledby":"tab-secret-attachments",id:"content-secret-attachments",children:(0,v.tZ)(C.P,{attachments:k,additionalProps:{itemId:ee,itemType:f.ItemType.Secret,handleFileInfoDetached:e=>{F(e)},onModalDisplayStateChange:x,isUploading:S}})}),e===E&&(0,v.tZ)("div",{"aria-labelledby":"tab-secret-shared-access",id:"content-secret-shared-access",children:(0,v.tZ)(p.u,{canManageAccess:t.canManageAccess,type:A.y2.Secret,id:ee})})]})}}}]);