"use strict";(globalThis.webpackChunk_dashlane_leeloo=globalThis.webpackChunk_dashlane_leeloo||[]).push([[610],{15400:(e,t,i)=>{i.r(t),i.d(t,{IdCardEditPanel:()=>d,IdGroupTab:()=>l});var a=i(39431),n=i(62428),s=i(29967),o=i(36351);const r={HEADER_DESCRIPTION:"webapp_id_edition_idcard_header_description",DIALOG_DELETE_TITLE:"webapp_id_edition_idcard_dialog_delete_title",ALERT_DELETE:"webapp_id_edition_idcard_alert_delete",ALERT_EDIT:"webapp_id_edition_idcard_alert_edit",COPY_SUCCESS:"webapp_id_copy_success_id_card_number"};let l=function(e){return e[e.DETAILS=0]="DETAILS",e[e.ATTACHMENTS=1]="ATTACHMENTS",e}({});const d=({listRoute:e,id:t,setDialogActive:i,lee:l,hasUnsavedData:d,setHasUnsavedData:c})=>t?(0,o.tZ)(s.y,{listRoute:e,id:`{${t}}`,setDialogActive:i,lee:l,hasUnsavedData:d,setHasUnsavedData:c,ID_TYPE:a.U.IdCard,I18N_KEYS:r,children:({handleCopy:e,values:t})=>(0,o.tZ)(n.P,{variant:"edit",handleCopy:e,country:t.country})}):null},29967:(e,t,i)=>{i.d(t,{y:()=>P});var a=i(96832),n=i(48038),s=i(88203),o=i(66219),r=i(24507),l=i(39431),d=i(14877);const c={[l.U.DriversLicense]:"driversLicensesResult",[l.U.FiscalId]:"fiscalIdsResult",[l.U.IdCard]:"idCardsResult",[l.U.Passport]:"passportsResult",[l.U.SocialSecurityId]:"socialSecurityIdsResult"};var u=i(73704),m=i(92077),_=i(45272),p=i(74910),D=i(82994),h=i(15400),b=i(55139),g=i(77377);const T=e=>`id-edit-panel-${e}`;var I=i(62264),S=i(78346),f=i(8180),E=i(58363),C=i(63847),A=i(68999),L=i(36351);const y={backgroundColor:"ds.container.agnostic.neutral.supershy",borderTopWidth:"1px",borderTopStyle:"solid",borderTopColor:"ds.border.neutral.quiet.idle",padding:"16px 24px",gap:"8px"},v=({formId:e,handleCancel:t,handleDelete:i,hasDataBeenModified:a,isSubmitting:n,focusAttachmentTab:o})=>{const{translate:r}=(0,s.Z)();return(0,L.BX)(C.k,{className:"actions",sx:y,as:"footer",justifyContent:"flex-start",flexWrap:"nowrap",children:[(0,L.tZ)(A.z,{"aria-label":r("webapp_panel_edition_generic_delete"),onClick:i,mood:"danger",intensity:"supershy",layout:"iconOnly",icon:"ActionDeleteOutlined",disabled:n}),!!o&&(0,L.tZ)(A.z,{mood:"neutral",intensity:"supershy",onClick:o,layout:"iconLeading",icon:"AttachmentOutlined",children:r("webapp_secure_notes_add_attachment_action_name")},"attach"),a?(0,L.BX)(C.k,{flexWrap:"nowrap",sx:{marginLeft:"auto"},children:[(0,L.tZ)(A.z,{type:"submit",form:e,disabled:n,children:r("webapp_panel_edition_generic_save_changes")}),(0,L.tZ)(A.z,{mood:"neutral",intensity:"quiet",sx:{marginLeft:"16px"},onClick:t,children:r("webapp_panel_edition_generic_cancel_changes")})]}):(0,L.tZ)(A.z,{onClick:t,mood:"neutral",intensity:"quiet",sx:{marginLeft:"auto"},children:r("webapp_panel_edition_generic_close")})]})};var w=i(55752);const U="id-edit-form",N=({itemId:e,type:t,openConfirmDeleteDialog:i,editAlertTranslation:n,reportError:o,initialValues:r,hasUnsavedData:c,setHasUnsavedData:m,setCurrentCountry:p,copySuccessKey:D,hasTabs:h,focusAttachment:b,children:g,showListView:T})=>{const{translate:C}=(0,s.Z)(),[A,y]=(0,a.useState)(!1),{updateVaultItem:N}=(0,f.u)(d.L),Z=(0,a.useRef)((e=>{if(null!==e){const{dirty:t,isSubmitting:i,values:a}=e;m(t),y(i),p(a.country)}})),{showToast:R}=(0,I.p)(),P=(i,a)=>{(0,_.Kz)(new u.UserCopyVaultItemFieldEvent({itemType:E.L[t],field:E.H[t],itemId:e,isProtected:!1})),i&&R({description:C(D)}),a&&"function"==typeof o&&o(a,"[id-form] Unable to copy to clipboard")},O=()=>{R({description:C("_common_generic_error"),mood:"danger",isManualDismiss:!0})};return(0,L.BX)(a.Fragment,{children:[(0,L.tZ)("div",{"aria-labelledby":"tab-ids-detail",id:"content-ids-detail",sx:{display:"flex",flex:"1"},children:(0,L.tZ)(w.P,{formId:U,formRef:Z.current,handleSubmit:async(i,{setSubmitting:a,setFieldError:s})=>{const r=t===l.U.FiscalId?"fiscalNumber":"idNumber";if(!i[r])return s(r,"");try{a(!0);const s=await N({vaultItemType:t,content:i,id:e});(0,S.d6)(s)?(R({description:C(n)}),T()):(a(!1),O(),o(new Error("[ids][edit] Unable to update id"),s.error?.errorMessage))}catch(e){a(!1),O(),o(e,"[ids][edit] Unexpected exception while updating id")}},initialValues:r,variant:"edit",children:e=>g({handleCopy:P,values:e})})}),(0,L.tZ)(v,{formId:U,handleCancel:()=>{T()},handleDelete:i,hasDataBeenModified:c,isSubmitting:A,focusAttachmentTab:h?b:void 0})]})},Z=({getDescription:e,title:t,...i})=>{const{translate:n}=(0,s.Z)(),{item:o,initialValues:r,type:d,children:c,showConfirmDelete:I,closeConfirmDeleteDialog:S,deleteDialogTitle:f,deleteAlertTranslation:E,listRoute:C}=i,{hasTabs:A,activeTab:y,tabs:v,focusAttachment:w,cleanActiveTab:U}=function(e){var t;const i=(0,g.w)(b.w.TechweekWebAttachmentsForIdsV1),n=(0,a.useRef)(null),[o,r]=(0,a.useState)(null!=(t=(e=>{const t=window.sessionStorage.getItem(T(e));return t?parseInt(t,10):null})(e))?t:h.IdGroupTab.DETAILS),l=(0,a.useCallback)((t=>{window.sessionStorage.setItem(T(e),t.toString()),r(t)}),[e]),d=(0,a.useCallback)((()=>{window.sessionStorage.removeItem(T(e))}),[e]),c=(0,a.useCallback)((()=>l(h.IdGroupTab.ATTACHMENTS)),[l]),{translate:u}=(0,s.Z)(),m=(0,a.useMemo)((()=>[{id:"tab-ids-detail",contentId:"content-ids-detail",title:u("webapp_secure_notes_addition_tab_title_details"),onSelect:()=>l(h.IdGroupTab.DETAILS)},{id:"tab-ids-attachments",contentId:"content-ids-attachments",title:u("webapp_secure_notes_edition_field_tab_title_attachments"),onSelect:c}]),[c,u,l]);return(0,a.useEffect)((()=>{const e=e=>{n.current&&!n.current.contains(e.target)&&d()};return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}}),[d,n]),{editPanelRef:n,hasTabs:i,activeTab:o,tabs:m,focusAttachment:c,cleanActiveTab:d}}(o.id),[Z,R]=a.useState(r.country);a.useEffect((()=>{const e={[l.U.DriversLicense]:u.PageView.ItemDriverLicenceDetails,[l.U.FiscalId]:u.PageView.ItemFiscalStatementDetails,[l.U.IdCard]:u.PageView.ItemIdCardDetails,[l.U.Passport]:u.PageView.ItemPassportDetails,[l.U.SocialSecurityId]:u.PageView.ItemSocialSecurityStatementDetails};(0,_.Nc)(e[d])}),[d]);const P=a.useMemo((()=>({confirmDeleteConfirm:n("webapp_id_edition_dialog_delete_confirm"),confirmDeleteDismiss:n("webapp_id_edition_dialog_delete_dismiss"),confirmDeleteSubtitle:n("webapp_id_edition_dialog_delete_subtitle"),confirmDeleteTitle:n(f),deleteSuccessToast:n(E)})),[f,E,n]),O=()=>{U(),(0,_.Nc)(u.PageView.ItemIdList),(0,m.uX)(C)},x=!A||h.IdGroupTab.DETAILS===y;return(0,L.BX)(a.Fragment,{children:[(0,L.tZ)(p.h,{description:e(Z),title:t,type:d,tabs:A?v:void 0}),x?(0,L.tZ)(N,{...i,setCurrentCountry:R,hasTabs:A,focusAttachment:w,cleanActiveTab:U,showListView:O,children:c}):null,(0,L.tZ)(D.s,{isVisible:I,itemId:o.id,closeConfirmDeleteDialog:S,onDeletionSuccess:O,translations:P,vaultItemType:d})]})};function R(e,t){return e.hasOwnProperty(t)}const P=({ID_TYPE:e,I18N_KEYS:t,listRoute:i,id:l,setDialogActive:u,lee:m,hasUnsavedData:_,setHasUnsavedData:p,children:D})=>{const{translate:h}=(0,s.Z)(),{status:b,item:g}=function(e,t){const{status:i,data:a}=(0,r.k)(d.L,"query",{vaultItemTypes:[e],ids:[t]});return{status:i,item:a?.[c[e]].items[0]}}(e,l),{showConfirmDelete:T,openConfirmDeleteDialog:I,closeConfirmDeleteDialog:S}=function(e){const[t,i]=a.useState(!1);return{showConfirmDelete:t,openConfirmDeleteDialog:()=>{i(!0),e(!0)},closeConfirmDeleteDialog:()=>{i(!1),e(!1)}}}(u);return b===n.rq.Success&&void 0!==g?(0,L.tZ)(Z,{itemId:l,item:g,copySuccessKey:t.COPY_SUCCESS,deleteAlertTranslation:t.ALERT_DELETE,deleteDialogTitle:t.DIALOG_DELETE_TITLE,editAlertTranslation:t.ALERT_EDIT,initialValues:g,listRoute:i,reportError:m.reportError,showConfirmDelete:T,openConfirmDeleteDialog:I,closeConfirmDeleteDialog:S,hasUnsavedData:_,setHasUnsavedData:p,type:e,getDescription:e=>(0,o.Il)(h(t.HEADER_DESCRIPTION),h.getLocale(),e),title:(f=g,R(f,"idName")?f.idName:R(f,"idNumber")?f.idNumber:f.fiscalNumber),children:D}):null;var f}},72055:(e,t,i)=>{i.d(t,{a:()=>n});var a=i(30309);const n=new Set([a.cH.AU,a.cH.GB,a.cH.IE,a.cH.NZ])},62428:(e,t,i)=>{i.d(t,{P:()=>h});var a=i(96832),n=i(88355),s=i(88203),o=i(49023),r=i(42670),l=i(68037),d=i(72055),c=i(16792),u=i(87773),m=i(82207),_=i(36351);const p={...c.k,DETAILS_CONTENT_LABEL:"webapp_id_form_id_card_content_details_label"},D=({variant:e,handleCopy:t,country:i})=>{const{translate:c}=(0,s.Z)(),{shouldShowFrozenStateDialog:D}=(0,r.Ub)(),{values:h}=(0,n.u6)(),b=a.useRef(null);return a.useEffect("add"===e?()=>{const e=setTimeout((()=>{b.current?.focus()}),o.sc);return()=>clearTimeout(e)}:()=>{},[]),(0,_.BX)(a.Fragment,{children:[(0,_.BX)(l.u,{title:c(p.DETAILS_CONTENT_LABEL),additionalSx:{display:"flex",flexDirection:"column",gap:"8px"},children:[(0,_.tZ)(u.YI,{name:"idName",label:c(p.NAME_LABEL),placeholder:c(p.NAME_PLACEHOLDER),ref:b,disabled:!!D}),(0,_.tZ)(u.YI,{name:"idNumber",label:c(p.ID_NUMBER_LABEL),placeholder:c(p.ID_NUMBER_PLACEHOLDER),actions:"edit"===e?[(0,_.tZ)(m.m,{data:h.idNumber,onCopy:t},"copy")]:void 0,disabled:!!D}),(0,_.tZ)(u.Nn,{name:"issueDate",label:c(p.ISSUE_DATE_LABEL),disabled:!!D,calendarButtonLabel:c(p.ISSUE_DATE_PICK)}),(0,_.tZ)(u.Nn,{name:"expirationDate",label:c(d.a.has(i)?p.EXPIRATION_DATE_LABEL_UK:p.EXPIRATION_DATE_LABEL_US),calendarButtonLabel:c(d.a.has(i)?p.EXPIRATION_DATE_PICK_UK:p.EXPIRATION_DATE_PICK_US),disabled:!!D}),(0,_.tZ)(u.Dz,{name:"country",label:c(p.COUNTRY_LABEL),disabled:!!D})]}),(0,_.tZ)(u.A0,{name:"spaceId",disabled:!!D,wrapInContentCard:!0,contentCardLabel:c(p.ORGANIZATION_CONTENT_LABEL)})]})},h=a.memo(D)},82994:(e,t,i)=>{i.d(t,{s:()=>D}),i(96832);var a=i(62264),n=i(8180),s=i(51031),o=i(14877),r=i(88203);let l=function(e){return e.LastAdmin="LastAdmin",e.GroupSharing="GroupSharing",e.CollectionSharing="CollectionSharing",e.Generic="Generic",e}({});var d=i(78956),c=i(24731),u=i(36351);const m=({reason:e,translations:t,goToSharingAccess:i,closeCantDeleteDialog:a})=>{const{translate:n}=(0,r.Z)(),s=((e,t)=>{const{groupSharingTitle:i,lastAdminTitle:a,collectionSharingTitle:n,genericErrorTitle:s}=e;switch(t){case l.LastAdmin:return a;case l.GroupSharing:return i;case l.CollectionSharing:return n;case l.Generic:return s;default:return(0,c.U)(t)}})(t,e),o=((e,t)=>{const{groupSharingSubtitle:i,lastAdminSubtitle:a,collectionSharingSubtitle:n,genericErrorSubtitle:s}=e;switch(t){case l.LastAdmin:return a;case l.GroupSharing:return i;case l.CollectionSharing:return n;case l.Generic:return s;default:return(0,c.U)(t)}})(t,e);return(0,u.tZ)(d.Vq,{isOpen:!0,onClose:a,title:null!=s?s:"",closeActionLabel:n("_common_dialog_dismiss_button"),actions:e===l.LastAdmin||l.GroupSharing||l.CollectionSharing?{primary:{children:t.lastAdminActionLabel,onClick:()=>{i(),a()}}}:void 0,children:o})};var _=i(37527);const p=({closeConfirmDeleteDialog:e,onDeleteConfirm:t,translations:i})=>{const{translate:a}=(0,r.Z)(),{confirmDeleteSubtitle:n,confirmDeleteTitle:s,confirmDeleteDismiss:o,confirmDeleteConfirm:l}=i;return(0,u.tZ)(d.Vq,{title:s,onClose:e,isOpen:!0,dialogClassName:_.Ht,closeActionLabel:a("_common_dialog_dismiss_button"),isDestructive:!0,actions:{primary:{children:l,onClick:t,id:"deletion-dialog-confirm-button"},secondary:{children:o,onClick:e,autoFocus:!0,id:"deletion-dialog-dismiss-button"}},children:n})},D=({closeConfirmDeleteDialog:e,goToSharingAccess:t,isVisible:i,itemId:d,onDeletionSuccess:c,sharingStatus:_,translations:D,vaultItemType:h,isShared:b,isSharedViaUserGroup:g,isItemInCollection:T,isLastAdmin:I})=>{const{showToast:S}=(0,a.p)(),{translate:f}=(0,r.Z)(),{deleteVaultItem:E}=(0,n.u)(o.L);if(!i)return null;let C;return(b||_?.isShared)&&(g&&(C=l.GroupSharing),I&&(C=l.LastAdmin),T&&(C=l.CollectionSharing)),C&&t?(0,u.tZ)(m,{reason:C,translations:D,goToSharingAccess:t,closeCantDeleteDialog:e}):(0,u.tZ)(p,{closeConfirmDeleteDialog:e,onDeleteConfirm:async()=>{try{var e;(await E({id:d,vaultItemType:h})).tag===s.rq.Success?(S({description:null!=(e=D.deleteSuccessToast)?e:f("webapp_personal_info_edition_delete_success_toast")}),c()):S({description:f("_common_generic_error"),mood:"danger",isManualDismiss:!0})}catch(e){S({description:f("_common_generic_error"),mood:"danger",isManualDismiss:!0})}},translations:D})}}}]);