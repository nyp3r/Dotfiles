"use strict";(globalThis.webpackChunk_dashlane_leeloo=globalThis.webpackChunk_dashlane_leeloo||[]).push([[5463],{10896:(e,t,i)=>{i.d(t,{y:()=>o});var n=i(5063),s=i(68999),a=i(88203),r=i(36351);const o=({onClickDelete:e,onClickMove:t})=>{const{translate:i}=(0,a.Z)();return(0,r.tZ)(n.k,{title:i("webapp_personal_item_in_b2b_space_warning_title"),description:i("webapp_personal_item_in_b2b_space_warning_description"),mood:"warning",size:"large",sx:{marginBottom:"16px"},actions:[(0,r.tZ)(s.z,{mood:"warning",intensity:"quiet",size:"small",onClick:e,children:i("webapp_personal_item_in_b2b_space_warning_delete_button")},"personalItemInB2bSpace-deleteButton"),(0,r.tZ)(s.z,{mood:"warning",size:"small",onClick:t,children:i("webapp_personal_item_in_b2b_space_warning_convert_button")},"personalItemInB2bSpace-moveButton")]})}},82994:(e,t,i)=>{i.d(t,{s:()=>m}),i(96832);var n=i(62264),s=i(8180),a=i(51031),r=i(14877),o=i(88203);let c=function(e){return e.LastAdmin="LastAdmin",e.GroupSharing="GroupSharing",e.CollectionSharing="CollectionSharing",e.Generic="Generic",e}({});var l=i(78956),u=i(24731),d=i(36351);const p=({reason:e,translations:t,goToSharingAccess:i,closeCantDeleteDialog:n})=>{const{translate:s}=(0,o.Z)(),a=((e,t)=>{const{groupSharingTitle:i,lastAdminTitle:n,collectionSharingTitle:s,genericErrorTitle:a}=e;switch(t){case c.LastAdmin:return n;case c.GroupSharing:return i;case c.CollectionSharing:return s;case c.Generic:return a;default:return(0,u.U)(t)}})(t,e),r=((e,t)=>{const{groupSharingSubtitle:i,lastAdminSubtitle:n,collectionSharingSubtitle:s,genericErrorSubtitle:a}=e;switch(t){case c.LastAdmin:return n;case c.GroupSharing:return i;case c.CollectionSharing:return s;case c.Generic:return a;default:return(0,u.U)(t)}})(t,e);return(0,d.tZ)(l.Vq,{isOpen:!0,onClose:n,title:null!=a?a:"",closeActionLabel:s("_common_dialog_dismiss_button"),actions:e===c.LastAdmin||c.GroupSharing||c.CollectionSharing?{primary:{children:t.lastAdminActionLabel,onClick:()=>{i(),n()}}}:void 0,children:r})};var _=i(37527);const g=({closeConfirmDeleteDialog:e,onDeleteConfirm:t,translations:i})=>{const{translate:n}=(0,o.Z)(),{confirmDeleteSubtitle:s,confirmDeleteTitle:a,confirmDeleteDismiss:r,confirmDeleteConfirm:c}=i;return(0,d.tZ)(l.Vq,{title:a,onClose:e,isOpen:!0,dialogClassName:_.Ht,closeActionLabel:n("_common_dialog_dismiss_button"),isDestructive:!0,actions:{primary:{children:c,onClick:t,id:"deletion-dialog-confirm-button"},secondary:{children:r,onClick:e,autoFocus:!0,id:"deletion-dialog-dismiss-button"}},children:s})},m=({closeConfirmDeleteDialog:e,goToSharingAccess:t,isVisible:i,itemId:l,onDeletionSuccess:u,sharingStatus:_,translations:m,vaultItemType:S,isShared:h,isSharedViaUserGroup:b,isItemInCollection:C,isLastAdmin:I})=>{const{showToast:D}=(0,n.p)(),{translate:y}=(0,o.Z)(),{deleteVaultItem:w}=(0,s.u)(r.L);if(!i)return null;let A;return(h||_?.isShared)&&(b&&(A=c.GroupSharing),I&&(A=c.LastAdmin),C&&(A=c.CollectionSharing)),A&&t?(0,d.tZ)(p,{reason:A,translations:m,goToSharingAccess:t,closeCantDeleteDialog:e}):(0,d.tZ)(g,{closeConfirmDeleteDialog:e,onDeleteConfirm:async()=>{try{var e;(await w({id:l,vaultItemType:S})).tag===a.rq.Success?(D({description:null!=(e=m.deleteSuccessToast)?e:y("webapp_personal_info_edition_delete_success_toast")}),u()):D({description:y("_common_generic_error"),mood:"danger",isManualDismiss:!0})}catch(e){D({description:y("_common_generic_error"),mood:"danger",isManualDismiss:!0})}},translations:m})}},16009:(e,t,i)=>{i.d(t,{r:()=>s});let n=function(e){return e.CredentialsList="credentialsList",e.SecureNotesList="secureNotesList",e.UserList="user",e.GroupList="userGroup",e.CollectionList="collection",e}({});const s=(e,t)=>{switch(e?.previousPage?.type){case n.CredentialsList:return t.userCredentials;case n.SecureNotesList:return t.userSecureNotes;case n.UserList:return e.previousPage.alias?t.userSharingUserInfo(e.previousPage.alias):t.userCredentials;case n.GroupList:{const i=e.previousPage.groupId?.match(/{(.*)}/)?.[1];return i?t.userSharingGroupInfo(i):t.userCredentials}case n.CollectionList:{const i=e.previousPage.collectionId?.match(/{(.*)}/)?.[1];return i?t.userCollection(i):t.userCredentials}default:return t.userCredentials}}},64676:(e,t,i)=>{i.r(t),i.d(t,{SecureNotesEdit:()=>X});var n=i(96832),s=i(15192),a=i(24507),r=i(51031),o=i(14877),c=i(39431),l=i(92077),u=i(89078),d=i(84925),p=i(8180),_=i(73704),g=i(14900),m=i(62264),S=i(78346),h=i(88203),b=i(45272),C=i(42670),I=i(86498),D=i(63520),y=i(82994),w=i(86541),A=i(30743),T=i(32021),f=i(99822),v=i(30894),L=i(53189),N=i(79808),Z=i(1639),E=i(85163),G=i(95727),U=i(96057),k=i(80936),V=i(10896),P=i(19122),O=i(69909),q=i(36351);const{CONTENT:M,DOCUMENT_STORAGE:R,MORE_OPTIONS:B,SHARED_ACCESS:F}=w.SecureNoteTabs,z=(0,v.DP)((({note:e,isShared:t,canManageAccess:i,canEdit:s,canShare:a,isSharedViaUserGroup:u,isLastAdmin:d,onClose:v})=>{const{translate:z}=(0,h.Z)(),{routes:H}=(0,l.Xo)(),x=(0,l.TH)(),X=(0,n.useRef)(!1),{updateVaultItem:Q}=(0,p.u)(o.L),{showAlert:W}=(0,I.V)(),{shouldShowFrozenStateDialog:K}=(0,C.Ub)(),{addNoteToCollections:Y}=(0,E.Q)(),{allCollections:$}=(0,G.bA)(),[j,J]=(0,n.useState)(M),[ee,te]=(0,n.useState)(!1),[ie,ne]=(0,n.useState)(!1),[se,ae]=(0,n.useState)(!1),[re,oe]=(0,n.useState)(!1),[ce,le]=(0,n.useState)(e.isSecured),[ue,de]=(0,n.useState)(e.content),[pe,_e]=(0,n.useState)(e.title),[ge,me]=(0,n.useState)(e.color),[Se,he]=(0,n.useState)(e.spaceId),[be,Ce]=(0,n.useState)(!1),[Ie,De]=(0,n.useState)([]),[ye,we]=(0,n.useState)(!1),{data:Ae,status:Te}=(0,N.r)(e.id),{teamId:fe}=(0,P.fV)(),{showToast:ve}=(0,m.p)(),Le=(0,k.I)(),Ne=Le.status===r.rq.Success&&Le.isDisabled&&!e.spaceId,{attachments:Ze,isUploading:Ee}=(0,O.P)(e.attachments),Ge=()=>W(z("_common_generic_error"),g.BLW.ERROR),Ue=()=>{X.current||(X.current=!0,x.pathname.includes(H.userSecureNotes)&&(0,b.Nc)(_.PageView.ItemSecureNoteList),v())},ke=async(t,i=!0,n)=>{oe(!0);const s=null!=n?n:{spaceId:Se,type:ge,category:e.categoryId,secured:ce};try{const i=await Q({vaultItemType:c.U.SecureNote,content:{content:ue,title:pe,id:e.id,attachments:t,...s},id:e.id});Y(e.id,Ie),(0,S.hx)(i)&&Ge()}catch(e){Ge()}oe(!1),i?Ue():te(!1)},Ve=()=>te(!0),Pe=(0,U.vN)(_.ItemType.SecureNote,Ge),Oe=$.filter((t=>t.vaultItems.some((t=>t.id===e.id)))),qe=Oe.length||Ie.length,Me=Ze.length>0,Re=!qe,Be=[M];t?Be.push(F):Re&&Be.push(R);const Fe={confirmDeleteConfirm:z("webapp_secure_notes_edition_delete_confirm"),confirmDeleteDismiss:z("webapp_credential_edition_delete_dismiss"),confirmDeleteSubtitle:z("webapp_credential_edition_confirm_delete_subtitle"),confirmDeleteTitle:z("webapp_secure_notes_edition_delete_title"),lastAdminActionLabel:z("webapp_credential_edition_change_permissions"),lastAdminTitle:z("webapp_credential_edition_last_admin_title"),lastAdminSubtitle:z("webapp_credential_edition_last_admin_subtitle"),groupSharingTitle:z("webapp_secure_notes_edition_group_sharing_title"),groupSharingSubtitle:z("webapp_credential_edition_group_sharing_subtitle"),collectionSharingTitle:z("webapp_credential_edition_collection_sharing_title"),collectionSharingSubtitle:z("webapp_credential_edition_collection_sharing_subtitle"),genericErrorTitle:"webapp_account_recovery_generic_error_title",genericErrorSubtitle:"webapp_account_recovery_generic_error_subtitle"},ze=(0,n.useMemo)((()=>({category:e.categoryId?e.categoryId:"noCategory",content:e.content,id:e.id,secured:e.isSecured,spaceId:e.spaceId,title:e.title,type:e.color})),[e.categoryId,e.color,e.content,e.id,e.isSecured,e.spaceId,e.title]),He=e=>t=>{Ve(),e(t)},xe=He(he),Xe=He(me),Qe=He(_e),We=He(de),Ke=He(le),Ye=t&&Te===r.rq.Success&&null!=($e=Ae?.count)?$e:0;var $e;const je=Oe.filter((e=>e.isShared)).length>0;return(0,q.BX)(D.zI,{isViewingExistingItem:!0,submitDisabled:be,itemHasBeenEdited:ee,onSubmit:()=>ke(Ze),isUsingNewDesign:!0,submitPending:re,secondaryActions:(()=>{switch(j){case M:return[(n=e,s=Ze,!n||t&&!a||s.length||Ne?null:(0,q.tZ)(Z.Z,{tooltipPlacement:"top-start",sharing:(i=e.id,(0,f.A1)(i)),text:z("webapp_sharing_invite_share"),origin:_.Origin.ItemDetailView},"shareaction"))];case R:return[(0,q.tZ)(L.d,{isUploading:Ee,isQuotaReached:!1,isShared:t,itemId:e.id,dataType:"KWSecureNote",disabled:!!K},"uploadAction")];default:return[]}var i,n,s})(),onNavigateOut:Ue,onClickDelete:()=>ne(!0),ignoreCloseOnEscape:ie||se,isSomeDialogOpen:ie||ye,formId:"edit_securenote_panel",header:(0,q.tZ)(A.h,{backgroundColor:ze.type,displayDocumentStorage:Be.includes(R),displaySharedAccess:Be.includes(F),displayMoreOptions:Be.includes(B),isSecured:ce,recipientsCount:Ye,attachmentsCount:Ze.length,setActiveTab:J,disabled:t&&!s,title:pe,setTitle:Qe}),children:[Ne?(0,q.tZ)(V.y,{onClickDelete:()=>ne(!0),onClickMove:async()=>{try{var t;await ke(Ze,!1,{spaceId:null!=(t=fe?.toString())?t:Se,type:ge,secured:ce,category:e.categoryId})}catch(e){Ge()}ve({description:z("webapp_personal_item_in_b2b_space_warning_convert_success")})}}):null,(0,q.tZ)(T.T,{activeTab:j,secureNoteValues:ze,content:null!=ue?ue:"",title:pe,color:ge,spaceId:Se,isDisabled:!!K,isSecured:ce,attachments:Ze,onSpaceIdChange:xe,onColorChange:Xe,onTitleChange:Qe,onContentChange:We,onIsSecuredChange:Ke,onIsSubmitDisabled:Ce,handleFileInfoDetached:e=>{const t=Ze.filter((t=>t.id!==e));ke(t,!1)},hasAttachment:Me,canEdit:s,canManageAccess:i,isShared:t,isUploading:Ee,onModifyData:Ve,onModalDisplayStateChange:ae,onCollectionsToUpdate:De,setHasDialogsOpenedByChildren:we,isAddToCollectionDisabled:Ne}),(0,q.tZ)(y.s,{isVisible:ie,itemId:e.id,closeConfirmDeleteDialog:()=>ne(!1),goToSharingAccess:()=>{J(w.SecureNoteTabs.SHARED_ACCESS)},onDeletionSuccess:()=>{Ze?.forEach((e=>{const{id:t}=e;Pe(t)})),Ue()},isLastAdmin:d,isShared:t,isSharedViaUserGroup:u,isItemInCollection:je,translations:Fe,vaultItemType:c.U.SecureNote})]})})),H=({note:e,onClose:t})=>{const{getPermissionForItem:i,getSharingStatusForItem:n,getIsLastAdminForItem:s}=(0,u.Y)(d.X,{getPermissionForItem:{queryParam:{itemId:e.id}},getSharingStatusForItem:{queryParam:{itemId:e.id}},getIsLastAdminForItem:{queryParam:{itemId:e.id}}},[]);if(i.status!==r.rq.Success||n.status!==r.rq.Success||s.status!==r.rq.Success)return null;const{isShared:a,isSharedViaUserGroup:o}=n.data,c=i.data?.capabilities.canEdit,l=i.data?.capabilities.canManageAccess,p=i.data?.capabilities.canShare,{isLastAdmin:_}=s.data;return(0,q.tZ)(z,{onClose:t,note:e,isShared:a,canManageAccess:l,canEdit:c,canShare:p,isSharedViaUserGroup:o,isLastAdmin:_})};var x=i(16009);const X=e=>{const t=(0,a.k)(o.L,"query",{vaultItemTypes:[c.U.SecureNote],ids:[`{${e.match.params.uuid}}`]}),{routes:i}=(0,l.Xo)();if(t.status===r.rq.Loading)return null;if(!t.data?.secureNotesResult.items.length)return e.location?.state?(0,q.tZ)(s.l_,{to:(0,x.r)(e.location?.state,i)}):(0,q.tZ)(s.l_,{to:i.userSecureNotes});const n=t.data.secureNotesResult.items[0];return(0,q.tZ)(H,{...e,note:n})}}}]);