"use strict";(globalThis.webpackChunk_dashlane_amphora=globalThis.webpackChunk_dashlane_amphora||[]).push([["72"],{54022:function(e,t,a){let r,i,n;a.d(t,{Ps:()=>X,B5:()=>ls,sr:()=>lh});var s,o,l,d,c,u,p,m,g,h,w,y,b,f,S,C,A,I,M,T,k,P,E,v,R,N=a(55466),F=a(49492),_=a(65885),D=a(85500),L=a(30788),G=a(15636),U=a(57195),x=a(26906),B=a(18656),O=a(29109),V=a(68136),W=a(82161),Y=a(5825),K=a(3863),H=a(48102),q=a(55295),z=a(13455),j=a(93193),Z=a(65376),J=a(41094),$=a(3532),Q=a(39210);class X{getBrowserApi(){return this.browserApi}constructor(){(0,N._)(this,"browserApi",void 0),this.browserApi={action:{openPopup:F.M},runtime:{connect:_.$,getURL:D.A,onConnect:L.b,onMessage:G.p,sendMessage:U.b},storage:{local:{get:x.U,set:B.t}},tabs:{update:O.V,create:V.U,sendMessage:W.b,onHighlighted:Y.r,onRemoved:K.$,query:H.I,remove:q.O},webRequest:{onAuthRequired:z.E,onCompleted:j.x,onErrorOccurred:Z.z},contextMenus:{onClicked:J.a,create:$.U,removeAll:Q.x},crypto}}}var ee=a(91241),et=a(42961),ea=a(53554);let er=(e,t,a,r,i)=>{let n=e instanceof Error?e.message:String(e),s=e instanceof Error?e.stack:i.precisions,o=[i.message,n].filter(e=>void 0!==e).join(" - ");a.carbon.logException({exceptionType:t,log:{...i,message:o,precisions:s}})},ei=e=>Object.getOwnPropertyNames(Object.getPrototypeOf(e)).filter(e=>"constructor"!==e);var en=((s={}).Action="autofill-engine-action",s.Command="autofill-engine-command",s),es=((o={}).SenderFrame="SenderFrame",o.MainFrame="MainFrame",o.AllFrames="AllFrames",o);let eo=ei(new class{showWebcard(e){}updateWebcard(e){}updateWebcardItems(e,t){}updateWebcardItemDetails(e,t,a){}updateWebcardCredentialsAtRisk(e){}closeWebcard(e){}updateAutofillRecipes(e){}updateUnrecognizedElements(e){}computeContextMenuTargetInfo(e){}updateClientFrameId(e){}updateDomainAnalysisStatus(e){}applyAutofillOperations(e){}applyAutofillOperationsAndTriggerDataCapture(e){}setMasterPasswordValidationResult(e){}setPinCodeValidationResult(e){}updateTabActiveInfo(e){}updateUserLoginStatus(e){}updateUserFeatureFlips(e){}updateNewPassword(e,t){}updateSavePasswordTargetCredential(e,t){}updateSavePasswordCapturedData(e,t,a,r){}disableDashlaneOnField(e){}subscribeLiveValuesUpdate(e,t){}updateUserSubscriptionCode(e){}updateWebAuthnChallenge(e){}updateWebAuthnStatus(e){}updatePaymentUpdateAuthenticationToken(e){}webauthnCreateResponse(e,t){}webauthnGetResponse(e,t){}webauthnUseFallback(e){}webauthnStoreConditionalUiRequest(e){}webauthnConditionalUiSupported(e){}dataCopiedAlert(e,t,a,r){}copyValueToClipboard(e){}resendAnalysisResults(){}permissionToPaste(e){}storeFollowUpNotificationItemId(e){}}),el=e=>{let t={};for(let a of eo)t[a]=(t,...r)=>e({messageType:en.Action,action:a,parameters:r},t);return t};var ed=((l={}).Success="success",l.Failure="failure",l);let ec=ei(new class{analysisResultsAvailable(e){}phishingResultsAvailable(e){}documentComplete(){}userFocusOnElement(e){}userRightClickOnElement(e){}applyAutofillRecipe(e){}applyAutofillRecipeForOtherDataSource(e){}logAutofillPerformedEvent(e){}disableReactivationWebcards(){}startWebAuthnLoginFlow(){}completeWebAuthnLoginFlow(e,t){}startWebAuthnUserVerificationFlow(){}validateWebAuthnUserVerificationFlow(e){}generateNewPassword(e){}validateMasterPassword(e){}validatePinCode(e){}resetProtectedItemsTimerAndApplyRecipe(e){}disableAccessProtectionForVaultItem(e){}userVerificationComplete(e,t,a,r){}webcardClosed(e){}saveCredential(e,t){}updateCredential(e,t){}savePersonalData(e){}cancelSaveCredential(){}findSavePasswordTargetCredential(e,t){}captureDataFromPage(e,t){}checkExistingCredentialRisk(e){}applySelfCorrectingAutofill(e,t){}disableDashlaneOnField(e,t){}notifyLiveValuesUpdate(e,t){}logEvent(e){}logPageView(e){}logException(e,t){}getUserSubscriptionCode(){}getUserFeatureFlips(){}openNewTabWithUrl(e){}openWebapp(e){}openPopup(e){}closeAndReopenTab(){}logFormSubmit(e,t){}requestPaymentUpdateAuthenticationToken(){}webauthnCreate(e){}webauthnCreateUserConfirmed(e,t){}webauthnGet(e){}webauthnGetUserConfirmed(e,t,a){}webauthnUseOtherAuthenticator(e){}webauthnUserCanceled(e){}webauthnIsConditionalUiSupported(){}logRightClickMenu(e){}queryVaultItems(e,t){}getVaultItemDetails(e,t){}getCredentialsAtRiskByIds(e){}dataCopiedToClipboardDetected(e,t,a){}dataPasteDetected(e,t,a){}copyToClipboard(e,t,a,r){}signalPasteDecision(e,t){}webcardItemSelected(e,t,a){}removeLinkedWebsite(e,t){}sendPropertyCopiedActivityLog(e){}}),eu=e=>"object"==typeof e&&null!==e&&"messageType"in e&&"cmd"in e&&"parameters"in e&&e.messageType===en.Command&&"string"==typeof e.cmd&&Array.prototype.includes.call(ec,e.cmd);class ep{storePort(e){this._ports.push(e)}removePort(e){this._ports=this._ports.filter(t=>t!==e)}getPorts(e,t){return this._ports.filter(a=>a.sender?.tab?.id===e&&(!t||t===a.sender.frameId))}constructor(){(0,N._)(this,"_ports",[])}}var em=a(54454);let eg={openNewTabWithUrl:async(e,t,a,r)=>{await e.browserApi.tabs.create({url:r})},openWebapp:async(e,t,a,r)=>{await (0,em.b)(r)},openPopup:async(e,t,a,r)=>{try{await e.browserApi.action.openPopup(r)}catch(e){await (0,em.b)({})}},closeAndReopenTab:async(e,t,a)=>{let r=a.tab?.id;r&&(e.browserApi.tabs.remove([r]),e.browserApi.tabs.create({}))}};var eh=((d={}).Injected="injected",d.Webcards="webcards",d.Popup="popup",d),ew=a(83533);let ey=async(e,t,a,r,i)=>{if(!a.tab?.url||!a.url||!(await e.connectors.carbon.getUserLoginStatus()).loggedIn)return;let n=new ew.UserAutofillSubmitFormEvent({...r,fieldsFilledBy:{...r.fieldsFilledBy,manually_typed_count:r.fieldsFilledBy.manually_typed_count}}),s=new ew.AnonymousAutofillSubmitFormEvent({...n,domain:{type:ew.DomainType.Web,id:await (0,ew.hashDomain)(i.domain)}});await e.connectors.carbon.logEvent({event:n}),await e.connectors.carbon.logEvent({event:s})},eb=async(e,t,a,r)=>{if(!a.tab?.url||!a.url)return;let{isRightClickMenuLive:i}=await e.state.global.get();if(!i)return;let{isFieldDetectedByAnalysisEngine:n,domain:s}=r,o={isFieldDetectedByAnalysisEngine:n,rightClickMenuFlowStep:ew.RightClickMenuFlowStep.DisplayMenu},l=new ew.UserRightClickMenuActionEvent(o),d=new ew.AnonymousRightClickMenuActionEvent({...o,domain:{type:ew.DomainType.Web,id:await (0,ew.hashDomain)(s)},isNativeApp:!1});await e.connectors.carbon.logEvent({event:l}),await e.connectors.carbon.logEvent({event:d}),await e.connectors.carbon.logPageView({pageView:ew.PageView.RightClickMenu,browseComponent:void 0})};var ef=a(70410),eS=a(32755),eC=a(52031),eA=a(82541),eI=a(306),eM=a(69393),eT=a(44577),ek=a(32028);async function eP(e){let t=await (0,eT.z)(e.grapheneClient.featureFlips.queries.userFeatureFlips());if((0,eI.hx)(t))throw Error("error in `fetchFeatureFlips`: "+t.error);return(0,eI.db)(t)}async function eE(e,t){let a=await (0,eT.z)(e.grapheneClient.featureFlips.queries.userFeatureFlip({featureFlip:t}));if((0,eI.hx)(a))throw Error("error in `hasFeatureFlip`: "+a.error);return(0,eI.db)(a)??!1}async function ev(e){return await eE(e,eA.S.PasskeySupport)}async function eR(e){return await eE(e,eA.S.AutofillWebAskBeforeAutologin)}async function eN(e){return await eE(e,eA.S.DisableEmailPasswordWarning)||await eE(e,eA.S.DisableEmailPasswordWarningDev)}async function eF(e){return await eE(e,eM.t.B2CFreeUserFrozenState)}let e_=async e=>await eE(e,eA.S.SharedCollectionInSaveWebcard);async function eD(e){return await eE(e,eA.S.FunAuditLogs)}let eL=async e=>await eE(e,eA.S.EnableVortex);async function eG(e){let t=new ek.e;return await eE(e,eA.S.CloudPasskeyGA)||await eE(e,eA.S.CloudPasskeyBeta)&&await t.get("passkey.saveInCloudBeta")==="true"}let eU=async e=>await eE(e,eA.S.MLPhishingPreventionWebcard);var ex=a(32208),eB=a(83463),eO=a(57178),eV=a(23791);let eW={aol:["aim"],att:["bellsouth","sbcglobal"],google:["gmail","googlemail"],live:["hotmail","outlook","msn"],orange:["wanadoo"],rediff:["rediffmail"],spectrum:["charter"],xfinity:["comcast"],yahoo:["ymail"]},eY=["frama.site","free.fr","over-blog.com","spreadshirt.com","tumblr.com","weebly.com","wordpress.com"],eK=["netlify.app"],eH=(e,t)=>{let a=e.addressFull.split("\n");return a.length>t?a[t]:""},eq=e=>eH(e,0),ez=e=>["GB","IE"].includes(e.localeFormat),ej={AL:{partsPattern:/^(\w{4})(\w{4})(\w{4})(\w{4})(\w{4})(\w{4})(\w{4})$/},AD:{partsPattern:/^(\w{4})(\w{4})(\w{4})(\w{4})(\w{4})(\w{4})$/},AT:{partsPattern:/^(\w{4})(\w{4})(\w{4})(\w{4})(\w{4})$/},AZ:{partsPattern:/^(\w{4})(\w{4})(\w{4})(\w{4})(\w{4})(\w{4})(\w{4})$/},BE:{partsPattern:/^(\w{4})(\w{4})(\w{4})(\w{4})$/},BH:{partsPattern:/^(\w{4})(\w{4})(\w{4})(\w{4})(\w{4})(\w{2})$/},BA:{partsPattern:/^(\w{4})(\w{4})(\w{4})(\w{4})(\w{4})$/},BG:{partsPattern:/^(\w{4})(\w{4})(\w{4})(\w{4})(\w{4})(\w{2})$/},CR:{partsPattern:/^(\w{4})(\w{4})(\w{4})(\w{4})(\w{4})(\w{1})$/},HR:{partsPattern:/^(\w{4})(\w{4})(\w{4})(\w{4})(\w{4})(\w{1})$/},CY:{partsPattern:/^(\w{4})(\w{4})(\w{4})(\w{4})(\w{4})(\w{4})(\w{4})$/},CZ:{partsPattern:/^(\w{4})(\w{4})(\w{4})(\w{4})(\w{4})(\w{4})$/},DK:{partsPattern:/^(\w{4})(\w{4})(\w{4})(\w{4})(\w{2})$/},DO:{partsPattern:/^(\w{4})(\w{4})(\w{4})(\w{4})(\w{4})(\w{4})(\w{4})$/},EE:{partsPattern:/^(\w{4})(\w{4})(\w{4})(\w{4})(\w{4})$/},FO:{partsPattern:/^(\w{4})(\w{4})(\w{4})(\w{4})(\w{2})$/},FI:{partsPattern:/^(\w{4})(\w{4})(\w{4})(\w{4})(\w{2})$/},FR:{partsPattern:/^(\w{4})(\w{4})(\w{4})(\w{4})(\w{4})(\w{4})(\w{3})$/},GE:{partsPattern:/^(\w{4})(\w{4})(\w{4})(\w{4})(\w{4})(\w{2})$/},DE:{partsPattern:/^(\w{4})(\w{4})(\w{4})(\w{4})(\w{4})(\w{2})$/},GI:{partsPattern:/^(\w{4})(\w{4})(\w{4})(\w{4})(\w{4})(\w{3})$/},GR:{partsPattern:/^(\w{4})(\w{4})(\w{4})(\w{4})(\w{4})(\w{4})(\w{3})$/},GL:{partsPattern:/^(\w{4})(\w{4})(\w{4})(\w{4})(\w{2})$/},HU:{partsPattern:/^(\w{4})(\w{4})(\w{4})(\w{4})(\w{4})(\w{4})(\w{4})$/},IS:{partsPattern:/^(\w{4})(\w{4})(\w{4})(\w{4})(\w{4})(\w{4})(\w{2})$/},IE:{partsPattern:/^(\w{4})(\w{4})(\w{4})(\w{4})(\w{4})(\w{2})$/},IL:{partsPattern:/^(\w{4})(\w{4})(\w{4})(\w{4})(\w{4})(\w{3})$/},IT:{partsPattern:/^(\w{4})(\w{4})(\w{4})(\w{4})(\w{4})(\w{4})(\w{3})$/},KZ:{partsPattern:/^(\w{4})(\w{4})(\w{4})(\w{4})(\w{4})$/},KW:{partsPattern:/^(\w{4})(\w{4})(\w{4})(\w{4})(\w{4})(\w{4})(\w{4})(\w{2})$/},LV:{partsPattern:/^(\w{4})(\w{4})(\w{4})(\w{4})(\w{4})(\w{1})$/},LB:{partsPattern:/^(\w{4})(\w{4})(\w{4})(\w{4})(\w{4})(\w{4})(\w{4})$/},LI:{partsPattern:/^(\w{4})(\w{4})(\w{4})(\w{4})(\w{4})(\w{1})$/},LT:{partsPattern:/^(\w{4})(\w{4})(\w{4})(\w{4})(\w{4})$/},LU:{partsPattern:/^(\w{4})(\w{4})(\w{4})(\w{4})(\w{4})$/},MK:{partsPattern:/^(\w{4})(\w{4})(\w{4})(\w{4})(\w{3})$/},MT:{partsPattern:/^(\w{4})(\w{4})(\w{4})(\w{4})(\w{4})(\w{4})(\w{4})(\w{3})$/},MR:{partsPattern:/^(\w{4})(\w{4})(\w{4})(\w{4})(\w{4})(\w{4})(\w{3})$/},MU:{partsPattern:/^(\w{4})(\w{4})(\w{4})(\w{4})(\w{4})(\w{4})(\w{4})(\w{2})$/},MC:{partsPattern:/^(\w{4})(\w{4})(\w{4})(\w{4})(\w{4})(\w{4})(\w{3})$/},MD:{partsPattern:/^(\w{4})(\w{4})(\w{4})(\w{4})(\w{4})(\w{4})$/},ME:{partsPattern:/^(\w{4})(\w{4})(\w{4})(\w{4})(\w{4})(\w{2})$/},NL:{partsPattern:/^(\w{4})(\w{4})(\w{4})(\w{4})(\w{2})$/},NO:{partsPattern:/^(\w{4})(\w{4})(\w{4})(\w{3})$/},PK:{partsPattern:/^(\w{4})(\w{4})(\w{4})(\w{4})(\w{4})(\w{4})$/},PL:{partsPattern:/^(\w{4})(\w{4})(\w{4})(\w{4})(\w{4})(\w{4})(\w{4})$/},PT:{partsPattern:/^(\w{4})(\w{4})(\w{4})(\w{4})(\w{4})(\w{4})(\w{1})$/},RO:{partsPattern:/^(\w{4})(\w{4})(\w{4})(\w{4})(\w{4})(\w{4})$/},SM:{partsPattern:/^(\w{4})(\w{4})(\w{4})(\w{4})(\w{4})(\w{4})(\w{3})$/},SA:{partsPattern:/^(\w{4})(\w{4})(\w{4})(\w{4})(\w{4})(\w{4})$/},RS:{partsPattern:/^(\w{4})(\w{4})(\w{4})(\w{4})(\w{4})(\w{2})$/},SK:{partsPattern:/^(\w{4})(\w{4})(\w{4})(\w{4})(\w{4})(\w{4})$/},SI:{partsPattern:/^(\w{4})(\w{4})(\w{4})(\w{4})(\w{3})$/},ES:{partsPattern:/^(\w{4})(\w{4})(\w{4})(\w{4})(\w{4})(\w{4})$/},SE:{partsPattern:/^(\w{4})(\w{4})(\w{4})(\w{4})(\w{4})(\w{4})$/},CH:{partsPattern:/^(\w{4})(\w{4})(\w{4})(\w{4})(\w{4})(\w{1})$/},TN:{partsPattern:/^(\w{4})(\w{4})(\w{4})(\w{4})(\w{4})(\w{4})$/},TR:{partsPattern:/^(\w{4})(\w{4})(\w{4})(\w{4})(\w{4})(\w{4})(\w{2})$/},AE:{partsPattern:/^(\w{4})(\w{4})(\w{4})(\w{4})(\w{4})(\w{3})$/},GB:{partsPattern:/^(\w{4})(\w{4})(\w{4})(\w{4})(\w{4})(\w{2})$/},US:{partsPattern:/^(\w+)$/},VG:{partsPattern:/^(\w{4})(\w{4})(\w{4})(\w{4})(\w{4})(\w{4})$/},NO_TYPE:{partsPattern:null}},eZ=(e,t)=>{let a=e.replace(/\s+/g,"").toUpperCase(),r={full:e,compact:a,parts:[]},i=ej[t];if(i?.partsPattern){let e=a.match(i.partsPattern);r.parts=e?.slice(1)??[]}return r};var eJ=a(54391),e$=a(91192);let eQ={de:{AF:"Afghanistan",EG:"\xc4gypten",AX:"\xc5land-Inseln",AL:"Albanien",DZ:"Algerien",UM:"Amerikanisch-Ozeanien",AS:"Amerikanisch-Samoa",VI:"Amerikanische Jungferninseln",AD:"Andorra",AO:"Angola",AI:"Anguilla",AQ:"Antarktis",AG:"Antigua und Barbuda",GQ:"\xc4quatorialguinea",AR:"Argentinien",AM:"Armenien",AW:"Aruba",AC:"Ascension",AZ:"Aserbaidschan",ET:"\xc4thiopien",AU:"Australien",BS:"Bahamas",BH:"Bahrain",BD:"Bangladesch",BB:"Barbados",BY:"Belarus",BE:"Belgien",BZ:"Belize",BJ:"Benin",BM:"Bermuda",BT:"Bhutan",BO:"Bolivien",BA:"Bosnien und Herzegowina",BW:"Botsuana",BR:"Brasilien",VG:"Britische Jungferninseln",IO:"Britisches Territorium im Indischen Ozean",BN:"Brunei Darussalam",BG:"Bulgarien",BF:"Burkina Faso",BI:"Burundi",EA:"Ceuta und Melilla",CL:"Chile",CN:"China",CK:"Cookinseln",CR:"Costa Rica",CI:"C\xf4te d’Ivoire",CW:"Cura\xe7ao",DK:"D\xe4nemark",KP:"Demokratische Volksrepublik Korea",DE:"Deutschland",DG:"Diego Garcia",DM:"Dominica",DO:"Dominikanische Republik",DJ:"Dschibuti",EC:"Ecuador",SV:"El Salvador",ER:"Eritrea",EE:"Estland",FK:"Falklandinseln",FO:"F\xe4r\xf6er",FJ:"Fidschi",FI:"Finnland",FR:"Frankreich",GF:"Franz\xf6sisch-Guayana",PF:"Franz\xf6sisch-Polynesien",TF:"Franz\xf6sische S\xfcd- und Antarktisgebiete",GA:"Gabun",GM:"Gambia",GE:"Georgien",GH:"Ghana",GI:"Gibraltar",GD:"Grenada",GR:"Griechenland",GL:"Gr\xf6nland",GP:"Guadeloupe",GU:"Guam",GT:"Guatemala",GG:"Guernsey",GN:"Guinea",GW:"Guinea-Bissau",GY:"Guyana",HT:"Haiti",HN:"Honduras",IN:"Indien",ID:"Indonesien",IQ:"Irak",IR:"Iran",IE:"Irland",IS:"Island",IM:"Isle of Man",IL:"Israel",IT:"Italien",JM:"Jamaika",JP:"Japan",YE:"Jemen",JE:"Jersey",JO:"Jordanien",KY:"Kaimaninseln",KH:"Kambodscha",CM:"Kamerun",CA:"Kanada",IC:"Kanarische Inseln",CV:"Kap Verde",BQ:"Karibische Niederlande",KZ:"Kasachstan",QA:"Katar",KE:"Kenia",KG:"Kirgisistan",KI:"Kiribati",CC:"Kokosinseln",CO:"Kolumbien",KM:"Komoren",CG:"Kongo-Brazzaville",CD:"Kongo-Kinshasa",XK:"Kosovo",HR:"Kroatien",CU:"Kuba",KW:"Kuwait",LA:"Laos",LS:"Lesotho",LV:"Lettland",LB:"Libanon",LR:"Liberia",LY:"Libyen",LI:"Liechtenstein",LT:"Litauen",LU:"Luxemburg",MG:"Madagaskar",MW:"Malawi",MY:"Malaysia",MV:"Malediven",ML:"Mali",MT:"Malta",MA:"Marokko",MH:"Marshallinseln",MQ:"Martinique",MR:"Mauretanien",MU:"Mauritius",YT:"Mayotte",MK:"Mazedonien",MX:"Mexiko",FM:"Mikronesien",MC:"Monaco",MN:"Mongolei",ME:"Montenegro",MS:"Montserrat",MZ:"Mosambik",MM:"Myanmar",NA:"Namibia",NR:"Nauru",NP:"Nepal",NC:"Neukaledonien",NZ:"Neuseeland",NI:"Nicaragua",NL:"Niederlande",NE:"Niger",NG:"Nigeria",NU:"Niue",MP:"N\xf6rdliche Marianen",NF:"Norfolkinsel",NO:"Norwegen",OM:"Oman",AT:"\xd6sterreich",PK:"Pakistan",PS:"Pal\xe4stinensische Autonomiegebiete",PW:"Palau",PA:"Panama",PG:"Papua-Neuguinea",PY:"Paraguay",PE:"Peru",PH:"Philippinen",PN:"Pitcairninseln",PL:"Polen",PT:"Portugal",PR:"Puerto Rico",KR:"Republik Korea",MD:"Republik Moldau",RE:"R\xe9union",RW:"Ruanda",RO:"Rum\xe4nien",RU:"Russische F\xf6deration",SB:"Salomonen",ZM:"Sambia",WS:"Samoa",SM:"San Marino",ST:"S\xe3o Tom\xe9 und Pr\xedncipe",SA:"Saudi-Arabien",SE:"Schweden",CH:"Schweiz",SN:"Senegal",RS:"Serbien",SC:"Seychellen",SL:"Sierra Leone",ZW:"Simbabwe",SG:"Singapur",SX:"Sint Maarten",SK:"Slowakei",SI:"Slowenien",SO:"Somalia",MO:"Sonderverwaltungsregion Macau",HK:"Sonderverwaltungszone Hongkong",ES:"Spanien",LK:"Sri Lanka",BL:"St. Barth\xe9lemy",SH:"St. Helena",KN:"St. Kitts und Nevis",LC:"St. Lucia",MF:"St. Martin",PM:"St. Pierre und Miquelon",VC:"St. Vincent und die Grenadinen",ZA:"S\xfcdafrika",SD:"Sudan",GS:"S\xfcdgeorgien und die S\xfcdlichen Sandwichinseln",SS:"S\xfcdsudan",SR:"Suriname",SJ:"Svalbard und Jan Mayen",SZ:"Swasiland",SY:"Syrien",TJ:"Tadschikistan",TW:"Taiwan",TZ:"Tansania",TH:"Thailand",TL:"Timor-Leste",TG:"Togo",TK:"Tokelau",TO:"Tonga",TT:"Trinidad und Tobago",TA:"Tristan da Cunha",TD:"Tschad",CZ:"Tschechische Republik",TN:"Tunesien",TR:"T\xfcrkei",TM:"Turkmenistan",TC:"Turks- und Caicosinseln",TV:"Tuvalu",UG:"Uganda",UA:"Ukraine",HU:"Ungarn",UY:"Uruguay",UZ:"Usbekistan",VU:"Vanuatu",VA:"Vatikanstadt",VE:"Venezuela",AE:"Vereinigte Arabische Emirate",US:"Vereinigte Staaten",GB:"Vereinigtes K\xf6nigreich",VN:"Vietnam",WF:"Wallis und Futuna",CX:"Weihnachtsinsel",EH:"Westsahara",CF:"Zentralafrikanische Republik",CY:"Zypern"},en:{AF:"Afghanistan",AX:"\xc5land Islands",AL:"Albania",DZ:"Algeria",AS:"American Samoa",AD:"Andorra",AO:"Angola",AI:"Anguilla",AQ:"Antarctica",AG:"Antigua & Barbuda",AR:"Argentina",AM:"Armenia",AW:"Aruba",AC:"Ascension Island",AU:"Australia",AT:"Austria",AZ:"Azerbaijan",BS:"Bahamas",BH:"Bahrain",BD:"Bangladesh",BB:"Barbados",BY:"Belarus",BE:"Belgium",BZ:"Belize",BJ:"Benin",BM:"Bermuda",BT:"Bhutan",BO:"Bolivia",BA:"Bosnia & Herzegovina",BW:"Botswana",BR:"Brazil",IO:"British Indian Ocean Territory",VG:"British Virgin Islands",BN:"Brunei",BG:"Bulgaria",BF:"Burkina Faso",BI:"Burundi",KH:"Cambodia",CM:"Cameroon",CA:"Canada",IC:"Canary Islands",CV:"Cape Verde",BQ:"Caribbean Netherlands",KY:"Cayman Islands",CF:"Central African Republic",EA:"Ceuta & Melilla",TD:"Chad",CL:"Chile",CN:"China",CX:"Christmas Island",CC:"Cocos (Keeling) Islands",CO:"Colombia",KM:"Comoros",CG:"Congo - Brazzaville",CD:"Congo - Kinshasa",CK:"Cook Islands",CR:"Costa Rica",CI:"C\xf4te d’Ivoire",HR:"Croatia",CU:"Cuba",CW:"Cura\xe7ao",CY:"Cyprus",CZ:"Czech Republic",DK:"Denmark",DG:"Diego Garcia",DJ:"Djibouti",DM:"Dominica",DO:"Dominican Republic",EC:"Ecuador",EG:"Egypt",SV:"El Salvador",GQ:"Equatorial Guinea",ER:"Eritrea",EE:"Estonia",ET:"Ethiopia",FK:"Falkland Islands",FO:"Faroe Islands",FJ:"Fiji",FI:"Finland",FR:"France",GF:"French Guiana",PF:"French Polynesia",TF:"French Southern Territories",GA:"Gabon",GM:"Gambia",GE:"Georgia",DE:"Germany",GH:"Ghana",GI:"Gibraltar",GR:"Greece",GL:"Greenland",GD:"Grenada",GP:"Guadeloupe",GU:"Guam",GT:"Guatemala",GG:"Guernsey",GN:"Guinea",GW:"Guinea-Bissau",GY:"Guyana",HT:"Haiti",HN:"Honduras",HK:"Hong Kong SAR China",HU:"Hungary",IS:"Iceland",IN:"India",ID:"Indonesia",IR:"Iran",IQ:"Iraq",IE:"Ireland",IM:"Isle of Man",IL:"Israel",IT:"Italy",JM:"Jamaica",JP:"Japan",JE:"Jersey",JO:"Jordan",KZ:"Kazakhstan",KE:"Kenya",KI:"Kiribati",XK:"Kosovo",KW:"Kuwait",KG:"Kyrgyzstan",LA:"Laos",LV:"Latvia",LB:"Lebanon",LS:"Lesotho",LR:"Liberia",LY:"Libya",LI:"Liechtenstein",LT:"Lithuania",LU:"Luxembourg",MO:"Macau SAR China",MK:"Macedonia",MG:"Madagascar",MW:"Malawi",MY:"Malaysia",MV:"Maldives",ML:"Mali",MT:"Malta",MH:"Marshall Islands",MQ:"Martinique",MR:"Mauritania",MU:"Mauritius",YT:"Mayotte",MX:"Mexico",FM:"Micronesia",MD:"Moldova",MC:"Monaco",MN:"Mongolia",ME:"Montenegro",MS:"Montserrat",MA:"Morocco",MZ:"Mozambique",MM:"Myanmar (Burma)",NA:"Namibia",NR:"Nauru",NP:"Nepal",NL:"Netherlands",NC:"New Caledonia",NZ:"New Zealand",NI:"Nicaragua",NE:"Niger",NG:"Nigeria",NU:"Niue",NF:"Norfolk Island",KP:"North Korea",MP:"Northern Mariana Islands",NO:"Norway",OM:"Oman",PK:"Pakistan",PW:"Palau",PS:"Palestinian Territories",PA:"Panama",PG:"Papua New Guinea",PY:"Paraguay",PE:"Peru",PH:"Philippines",PN:"Pitcairn Islands",PL:"Poland",PT:"Portugal",PR:"Puerto Rico",QA:"Qatar",RE:"R\xe9union",RO:"Romania",RU:"Russia",RW:"Rwanda",WS:"Samoa",SM:"San Marino",ST:"S\xe3o Tom\xe9 & Pr\xedncipe",SA:"Saudi Arabia",SN:"Senegal",RS:"Serbia",SC:"Seychelles",SL:"Sierra Leone",SG:"Singapore",SX:"Sint Maarten",SK:"Slovakia",SI:"Slovenia",SB:"Solomon Islands",SO:"Somalia",ZA:"South Africa",GS:"South Georgia & South Sandwich Islands",KR:"South Korea",SS:"South Sudan",ES:"Spain",LK:"Sri Lanka",BL:"St. Barth\xe9lemy",SH:"St. Helena",KN:"St. Kitts & Nevis",LC:"St. Lucia",MF:"St. Martin",PM:"St. Pierre & Miquelon",VC:"St. Vincent & Grenadines",SD:"Sudan",SR:"Suriname",SJ:"Svalbard & Jan Mayen",SZ:"Swaziland",SE:"Sweden",CH:"Switzerland",SY:"Syria",TW:"Taiwan",TJ:"Tajikistan",TZ:"Tanzania",TH:"Thailand",TL:"Timor-Leste",TG:"Togo",TK:"Tokelau",TO:"Tonga",TT:"Trinidad & Tobago",TA:"Tristan da Cunha",TN:"Tunisia",TR:"Turkey",TM:"Turkmenistan",TC:"Turks & Caicos Islands",TV:"Tuvalu",UM:"U.S. Outlying Islands",VI:"U.S. Virgin Islands",UG:"Uganda",UA:"Ukraine",AE:"United Arab Emirates",GB:"United Kingdom",US:"United States",UY:"Uruguay",UZ:"Uzbekistan",VU:"Vanuatu",VA:"Vatican City",VE:"Venezuela",VN:"Vietnam",WF:"Wallis & Futuna",EH:"Western Sahara",YE:"Yemen",ZM:"Zambia",ZW:"Zimbabwe"},es:{AF:"Afganist\xe1n",AL:"Albania",DE:"Alemania",AD:"Andorra",AO:"Angola",AI:"Anguila",AQ:"Ant\xe1rtida",AG:"Antigua y Barbuda",SA:"Arabia Saud\xed",DZ:"Argelia",AR:"Argentina",AM:"Armenia",AW:"Aruba",AU:"Australia",AT:"Austria",AZ:"Azerbaiy\xe1n",BS:"Bahamas",BD:"Banglad\xe9s",BB:"Barbados",BH:"Bar\xe9in",BE:"B\xe9lgica",BZ:"Belice",BJ:"Ben\xedn",BM:"Bermudas",BY:"Bielorrusia",BO:"Bolivia",BA:"Bosnia-Herzegovina",BW:"Botsuana",BR:"Brasil",BN:"Brun\xe9i",BG:"Bulgaria",BF:"Burkina Faso",BI:"Burundi",BT:"But\xe1n",CV:"Cabo Verde",KH:"Camboya",CM:"Camer\xfan",CA:"Canad\xe1",BQ:"Caribe neerland\xe9s",QA:"Catar",EA:"Ceuta y Melilla",TD:"Chad",CL:"Chile",CN:"China",CY:"Chipre",VA:"Ciudad del Vaticano",CO:"Colombia",KM:"Comoras",KP:"Corea del Norte",KR:"Corea del Sur",CI:"Costa de Marfil",CR:"Costa Rica",HR:"Croacia",CU:"Cuba",CW:"Curazao",DG:"Diego Garc\xeda",DK:"Dinamarca",DM:"Dominica",EC:"Ecuador",EG:"Egipto",SV:"El Salvador",AE:"Emiratos \xc1rabes Unidos",ER:"Eritrea",SK:"Eslovaquia",SI:"Eslovenia",ES:"Espa\xf1a",US:"Estados Unidos",EE:"Estonia",ET:"Etiop\xeda",PH:"Filipinas",FI:"Finlandia",FJ:"Fiyi",FR:"Francia",GA:"Gab\xf3n",GM:"Gambia",GE:"Georgia",GH:"Ghana",GI:"Gibraltar",GD:"Granada",GR:"Grecia",GL:"Groenlandia",GP:"Guadalupe",GU:"Guam",GT:"Guatemala",GF:"Guayana Francesa",GG:"Guernesey",GN:"Guinea",GQ:"Guinea Ecuatorial",GW:"Guinea-Bis\xe1u",GY:"Guyana",HT:"Hait\xed",HN:"Honduras",HU:"Hungr\xeda",IN:"India",ID:"Indonesia",IR:"Ir\xe1n",IQ:"Iraq",IE:"Irlanda",CX:"Isla Christmas",AC:"Isla de la Ascensi\xf3n",IM:"Isla de Man",NU:"Isla Niue",NF:"Isla Norfolk",IS:"Islandia",AX:"Islas \xc5land",KY:"Islas Caim\xe1n",IC:"islas Canarias",CC:"Islas Cocos",CK:"Islas Cook",FO:"Islas Feroe",GS:"Islas Georgia del Sur y Sandwich del Sur",FK:"Islas Malvinas",MP:"Islas Marianas del Norte",MH:"Islas Marshall",UM:"Islas menores alejadas de EE. UU.",PN:"Islas Pitcairn",SB:"Islas Salom\xf3n",TC:"Islas Turcas y Caicos",VG:"Islas V\xedrgenes Brit\xe1nicas",VI:"Islas V\xedrgenes de EE. UU.",IL:"Israel",IT:"Italia",JM:"Jamaica",JP:"Jap\xf3n",JE:"Jersey",JO:"Jordania",KZ:"Kazajist\xe1n",KE:"Kenia",KG:"Kirguist\xe1n",KI:"Kiribati",XK:"Kosovo",KW:"Kuwait",LA:"Laos",LS:"Lesoto",LV:"Letonia",LB:"L\xedbano",LR:"Liberia",LY:"Libia",LI:"Liechtenstein",LT:"Lituania",LU:"Luxemburgo",MK:"Macedonia",MG:"Madagascar",MY:"Malasia",MW:"Malaui",MV:"Maldivas",ML:"Mali",MT:"Malta",MA:"Marruecos",MQ:"Martinica",MU:"Mauricio",MR:"Mauritania",YT:"Mayotte",MX:"M\xe9xico",FM:"Micronesia",MD:"Moldavia",MC:"M\xf3naco",MN:"Mongolia",ME:"Montenegro",MS:"Montserrat",MZ:"Mozambique",MM:"Myanmar (Birmania)",NA:"Namibia",NR:"Nauru",NP:"Nepal",NI:"Nicaragua",NE:"N\xedger",NG:"Nigeria",NO:"Noruega",NC:"Nueva Caledonia",NZ:"Nueva Zelanda",OM:"Om\xe1n",NL:"Pa\xedses Bajos",PK:"Pakist\xe1n",PW:"Palau",PA:"Panam\xe1",PG:"Pap\xfaa Nueva Guinea",PY:"Paraguay",PE:"Per\xfa",PF:"Polinesia Francesa",PL:"Polonia",PT:"Portugal",PR:"Puerto Rico",HK:"RAE de Hong Kong (China)",MO:"RAE de Macao (China)",GB:"Reino Unido",CF:"Rep\xfablica Centroafricana",CZ:"Rep\xfablica Checa",CG:"Rep\xfablica del Congo",CD:"Rep\xfablica Democr\xe1tica del Congo",DO:"Rep\xfablica Dominicana",RE:"Reuni\xf3n",RW:"Ruanda",RO:"Ruman\xeda",RU:"Rusia",EH:"S\xe1hara Occidental",WS:"Samoa",AS:"Samoa Americana",BL:"San Bartolom\xe9",KN:"San Crist\xf3bal y Nieves",SM:"San Marino",MF:"San Mart\xedn",PM:"San Pedro y Miquel\xf3n",VC:"San Vicente y las Granadinas",SH:"Santa Elena",LC:"Santa Luc\xeda",ST:"Santo Tom\xe9 y Pr\xedncipe",SN:"Senegal",RS:"Serbia",SC:"Seychelles",SL:"Sierra Leona",SG:"Singapur",SX:"Sint Maarten",SY:"Siria",SO:"Somalia",LK:"Sri Lanka",SZ:"Suazilandia",ZA:"Sud\xe1frica",SD:"Sud\xe1n",SS:"Sud\xe1n del Sur",SE:"Suecia",CH:"Suiza",SR:"Surinam",SJ:"Svalbard y Jan Mayen",TH:"Tailandia",TW:"Taiw\xe1n",TZ:"Tanzania",TJ:"Tayikist\xe1n",IO:"Territorio Brit\xe1nico del Oc\xe9ano \xcdndico",TF:"Territorios Australes Franceses",PS:"Territorios Palestinos",TL:"Timor Oriental",TG:"Togo",TK:"Tokelau",TO:"Tonga",TT:"Trinidad y Tobago",TA:"Trist\xe1n da Cunha",TN:"T\xfanez",TM:"Turkmenist\xe1n",TR:"Turqu\xeda",TV:"Tuvalu",UA:"Ucrania",UG:"Uganda",UY:"Uruguay",UZ:"Uzbekist\xe1n",VU:"Vanuatu",VE:"Venezuela",VN:"Vietnam",WF:"Wallis y Futuna",YE:"Yemen",DJ:"Yibuti",ZM:"Zambia",ZW:"Zimbabue"},fr:{AF:"Afghanistan",ZA:"Afrique du Sud",AL:"Albanie",DZ:"Alg\xe9rie",DE:"Allemagne",AD:"Andorre",AO:"Angola",AI:"Anguilla",AQ:"Antarctique",AG:"Antigua-et-Barbuda",SA:"Arabie saoudite",AR:"Argentine",AM:"Arm\xe9nie",AW:"Aruba",AU:"Australie",AT:"Autriche",AZ:"Azerba\xefdjan",BS:"Bahamas",BH:"Bahre\xefn",BD:"Bangladesh",BB:"Barbade",BE:"Belgique",BZ:"Belize",BJ:"B\xe9nin",BM:"Bermudes",BT:"Bhoutan",BY:"Bi\xe9lorussie",BO:"Bolivie",BA:"Bosnie-Herz\xe9govine",BW:"Botswana",BR:"Br\xe9sil",BN:"Brun\xe9i Darussalam",BG:"Bulgarie",BF:"Burkina Faso",BI:"Burundi",KH:"Cambodge",CM:"Cameroun",CA:"Canada",CV:"Cap-Vert",EA:"Ceuta et Melilla",CL:"Chili",CN:"Chine",CY:"Chypre",CO:"Colombie",KM:"Comores",CG:"Congo-Brazzaville",CD:"Congo-Kinshasa",KP:"Cor\xe9e du Nord",KR:"Cor\xe9e du Sud",CR:"Costa Rica",CI:"C\xf4te d’Ivoire",HR:"Croatie",CU:"Cuba",CW:"Cura\xe7ao",DK:"Danemark",DG:"Diego Garcia",DJ:"Djibouti",DM:"Dominique",EG:"\xc9gypte",SV:"El Salvador",AE:"\xc9mirats arabes unis",EC:"\xc9quateur",ER:"\xc9rythr\xe9e",ES:"Espagne",EE:"Estonie",VA:"\xc9tat de la Cit\xe9 du Vatican",FM:"\xc9tats f\xe9d\xe9r\xe9s de Micron\xe9sie",US:"\xc9tats-Unis",ET:"\xc9thiopie",FJ:"Fidji",FI:"Finlande",FR:"France",GA:"Gabon",GM:"Gambie",GE:"G\xe9orgie",GH:"Ghana",GI:"Gibraltar",GR:"Gr\xe8ce",GD:"Grenade",GL:"Groenland",GP:"Guadeloupe",GU:"Guam",GT:"Guatemala",GG:"Guernesey",GN:"Guin\xe9e",GQ:"Guin\xe9e \xe9quatoriale",GW:"Guin\xe9e-Bissau",GY:"Guyana",GF:"Guyane fran\xe7aise",HT:"Ha\xefti",HN:"Honduras",HU:"Hongrie",CX:"\xcele Christmas",AC:"\xcele de l’Ascension",IM:"\xcele de Man",NF:"\xcele Norfolk",AX:"\xceles \xc5land",KY:"\xceles Ca\xefmans",IC:"\xceles Canaries",CC:"\xceles Cocos",CK:"\xceles Cook",FO:"\xceles F\xe9ro\xe9",GS:"\xceles G\xe9orgie du Sud et Sandwich du Sud",FK:"\xceles Malouines",MP:"\xceles Mariannes du Nord",MH:"\xceles Marshall",UM:"\xceles mineures \xe9loign\xe9es des \xc9tats-Unis",SB:"\xceles Salomon",TC:"\xceles Turques-et-Ca\xefques",VG:"\xceles Vierges britanniques",VI:"\xceles Vierges des \xc9tats-Unis",IN:"Inde",ID:"Indon\xe9sie",IQ:"Irak",IR:"Iran",IE:"Irlande",IS:"Islande",IL:"Isra\xebl",IT:"Italie",JM:"Jama\xefque",JP:"Japon",JE:"Jersey",JO:"Jordanie",KZ:"Kazakhstan",KE:"Kenya",KG:"Kirghizistan",KI:"Kiribati",XK:"Kosovo",KW:"Kowe\xeft",RE:"La R\xe9union",LA:"Laos",LS:"Lesotho",LV:"Lettonie",LB:"Liban",LR:"Lib\xe9ria",LY:"Libye",LI:"Liechtenstein",LT:"Lituanie",LU:"Luxembourg",MK:"Mac\xe9doine",MG:"Madagascar",MY:"Malaisie",MW:"Malawi",MV:"Maldives",ML:"Mali",MT:"Malte",MA:"Maroc",MQ:"Martinique",MU:"Maurice",MR:"Mauritanie",YT:"Mayotte",MX:"Mexique",MD:"Moldavie",MC:"Monaco",MN:"Mongolie",ME:"Mont\xe9n\xe9gro",MS:"Montserrat",MZ:"Mozambique",MM:"Myanmar",NA:"Namibie",NR:"Nauru",NP:"N\xe9pal",NI:"Nicaragua",NE:"Niger",NG:"Nig\xe9ria",NU:"Niue",NO:"Norv\xe8ge",NC:"Nouvelle-Cal\xe9donie",NZ:"Nouvelle-Z\xe9lande",OM:"Oman",UG:"Ouganda",UZ:"Ouzb\xe9kistan",PK:"Pakistan",PW:"Palaos",PA:"Panama",PG:"Papouasie-Nouvelle-Guin\xe9e",PY:"Paraguay",NL:"Pays-Bas",BQ:"Pays-Bas carib\xe9ens",PE:"P\xe9rou",PH:"Philippines",PN:"Pitcairn",PL:"Pologne",PF:"Polyn\xe9sie fran\xe7aise",PR:"Porto Rico",PT:"Portugal",QA:"Qatar",HK:"R.A.S. chinoise de Hong Kong",MO:"R.A.S. chinoise de Macao",CF:"R\xe9publique centrafricaine",DO:"R\xe9publique dominicaine",CZ:"R\xe9publique tch\xe8que",RO:"Roumanie",GB:"Royaume-Uni",RU:"Russie",RW:"Rwanda",EH:"Sahara occidental",BL:"Saint-Barth\xe9lemy",KN:"Saint-Christophe-et-Ni\xe9v\xe8s",SM:"Saint-Marin",MF:"Saint-Martin (partie fran\xe7aise)",SX:"Saint-Martin (partie n\xe9erlandaise)",PM:"Saint-Pierre-et-Miquelon",VC:"Saint-Vincent-et-les-Grenadines",SH:"Sainte-H\xe9l\xe8ne",LC:"Sainte-Lucie",WS:"Samoa",AS:"Samoa am\xe9ricaines",ST:"Sao Tom\xe9-et-Principe",SN:"S\xe9n\xe9gal",RS:"Serbie",SC:"Seychelles",SL:"Sierra Leone",SG:"Singapour",SK:"Slovaquie",SI:"Slov\xe9nie",SO:"Somalie",SD:"Soudan",SS:"Soudan du Sud",LK:"Sri Lanka",SE:"Su\xe8de",CH:"Suisse",SR:"Suriname",SJ:"Svalbard et Jan Mayen",SZ:"Swaziland",SY:"Syrie",TJ:"Tadjikistan",TW:"Ta\xefwan",TZ:"Tanzanie",TD:"Tchad",TF:"Terres australes fran\xe7aises",IO:"Territoire britannique de l’oc\xe9an Indien",PS:"Territoires palestiniens",TH:"Tha\xeflande",TL:"Timor oriental",TG:"Togo",TK:"Tokelau",TO:"Tonga",TT:"Trinit\xe9-et-Tobago",TA:"Tristan da Cunha",TN:"Tunisie",TM:"Turkm\xe9nistan",TR:"Turquie",TV:"Tuvalu",UA:"Ukraine",UY:"Uruguay",VU:"Vanuatu",VE:"Venezuela",VN:"Vietnam",WF:"Wallis-et-Futuna",YE:"Y\xe9men",ZM:"Zambie",ZW:"Zimbabwe"},it:{AF:"Afghanistan",AL:"Albania",DZ:"Algeria",AD:"Andorra",AO:"Angola",AI:"Anguilla",AQ:"Antartide",AG:"Antigua e Barbuda",SA:"Arabia Saudita",AR:"Argentina",AM:"Armenia",AW:"Aruba",AU:"Australia",AT:"Austria",AZ:"Azerbaigian",BS:"Bahamas",BH:"Bahrein",BD:"Bangladesh",BB:"Barbados",BE:"Belgio",BZ:"Belize",BJ:"Benin",BM:"Bermuda",BT:"Bhutan",BY:"Bielorussia",BO:"Bolivia",BA:"Bosnia-Erzegovina",BW:"Botswana",BR:"Brasile",BN:"Brunei",BG:"Bulgaria",BF:"Burkina Faso",BI:"Burundi",KH:"Cambogia",CM:"Camerun",CA:"Canada",CV:"Capo Verde",BQ:"Caraibi Olandesi",EA:"Ceuta e Melilla",TD:"Ciad",CL:"Cile",CN:"Cina",CY:"Cipro",VA:"Citt\xe0 del Vaticano",CO:"Colombia",KM:"Comore",CD:"Congo - Kinshasa",CG:"Congo-Brazzaville",KP:"Corea del Nord",KR:"Corea del Sud",CI:"Costa d’Avorio",CR:"Costa Rica",HR:"Croazia",CU:"Cuba",CW:"Cura\xe7ao",DK:"Danimarca",DG:"Diego Garcia",DM:"Dominica",EC:"Ecuador",EG:"Egitto",SV:"El Salvador",AE:"Emirati Arabi Uniti",ER:"Eritrea",EE:"Estonia",ET:"Etiopia",RU:"Federazione Russa",FJ:"Figi",PH:"Filippine",FI:"Finlandia",FR:"Francia",GA:"Gabon",GM:"Gambia",GE:"Georgia",GS:"Georgia del Sud e isole Sandwich meridionali",DE:"Germania",GH:"Ghana",JM:"Giamaica",JP:"Giappone",GI:"Gibilterra",DJ:"Gibuti",JO:"Giordania",GR:"Grecia",GD:"Grenada",GL:"Groenlandia",GP:"Guadalupa",GU:"Guam",GT:"Guatemala",GG:"Guernsey",GF:"Guiana Francese",GN:"Guinea",GQ:"Guinea Equatoriale",GW:"Guinea-Bissau",GY:"Guyana",HT:"Haiti",HN:"Honduras",IN:"India",ID:"Indonesia",IR:"Iran",IQ:"Iraq",IE:"Irlanda",IS:"Islanda",AC:"Isola di Ascensione",CX:"Isola di Christmas",IM:"Isola di Man",NF:"Isola Norfolk",AX:"Isole Aland",IC:"Isole Canarie",KY:"Isole Cayman",CC:"Isole Cocos",CK:"Isole Cook",FK:"Isole Falkland",FO:"Isole Faroe",MP:"Isole Marianne Settentrionali",MH:"Isole Marshall",UM:"Isole minori lontane dagli USA",PN:"Isole Pitcairn",SB:"Isole Solomon",TC:"Isole Turks e Caicos",VI:"Isole Vergini Americane",VG:"Isole Vergini Britanniche",IL:"Israele",IT:"Italia",JE:"Jersey",KZ:"Kazakistan",KE:"Kenya",KG:"Kirghizistan",KI:"Kiribati",XK:"Kosovo",KW:"Kuwait",LA:"Laos",LS:"Lesotho",LV:"Lettonia",LB:"Libano",LR:"Liberia",LY:"Libia",LI:"Liechtenstein",LT:"Lituania",LU:"Lussemburgo",MG:"Madagascar",MW:"Malawi",MV:"Maldive",MY:"Malesia",ML:"Mali",MT:"Malta",MA:"Marocco",MQ:"Martinica",MR:"Mauritania",MU:"Mauritius",YT:"Mayotte",MX:"Messico",FM:"Micronesia",MD:"Moldavia",MC:"Monaco",MN:"Mongolia",ME:"Montenegro",MS:"Montserrat",MZ:"Mozambico",MM:"Myanmar (Birmania)",NA:"Namibia",NR:"Nauru",NP:"Nepal",NI:"Nicaragua",NE:"Niger",NG:"Nigeria",NU:"Niue",NO:"Norvegia",NC:"Nuova Caledonia",NZ:"Nuova Zelanda",OM:"Oman",NL:"Paesi Bassi",PK:"Pakistan",PW:"Palau",PA:"Panam\xe1",PG:"Papua Nuova Guinea",PY:"Paraguay",PE:"Per\xf9",PF:"Polinesia Francese",PL:"Polonia",PT:"Portogallo",PR:"Portorico",QA:"Qatar",HK:"RAS di Hong Kong",MO:"RAS di Macao",GB:"Regno Unito",CZ:"Repubblica Ceca",CF:"Repubblica Centrafricana",MK:"Repubblica di Macedonia",DO:"Repubblica Dominicana",RE:"R\xe9union",RO:"Romania",RW:"Ruanda",EH:"Sahara Occidentale",KN:"Saint Kitts e Nevis",LC:"Saint Lucia",MF:"Saint Martin",PM:"Saint Pierre e Miquelon",VC:"Saint Vincent e Grenadines",BL:"Saint-Barth\xe9lemy",WS:"Samoa",AS:"Samoa Americane",SM:"San Marino",SH:"Sant’Elena",ST:"S\xe3o Tom\xe9 e Pr\xedncipe",SN:"Senegal",RS:"Serbia",SC:"Seychelles",SL:"Sierra Leone",SG:"Singapore",SX:"Sint Maarten",SY:"Siria",SK:"Slovacchia",SI:"Slovenia",SO:"Somalia",ES:"Spagna",LK:"Sri Lanka",US:"Stati Uniti",ZA:"Sudafrica",SD:"Sudan",SS:"Sudan del Sud",SR:"Suriname",SJ:"Svalbard e Jan Mayen",SE:"Svezia",CH:"Svizzera",SZ:"Swaziland",TJ:"Tagikistan",TH:"Tailandia",TW:"Taiwan",TZ:"Tanzania",TF:"Territori australi francesi",PS:"Territori palestinesi",IO:"Territorio Britannico dell’Oceano Indiano",TL:"Timor Est",TG:"Togo",TK:"Tokelau",TO:"Tonga",TT:"Trinidad e Tobago",TA:"Tristan da Cunha",TN:"Tunisia",TR:"Turchia",TM:"Turkmenistan",TV:"Tuvalu",UA:"Ucraina",UG:"Uganda",HU:"Ungheria",UY:"Uruguay",UZ:"Uzbekistan",VU:"Vanuatu",VE:"Venezuela",VN:"Vietnam",WF:"Wallis e Futuna",YE:"Yemen",ZM:"Zambia",ZW:"Zimbabwe"},ja:{IS:"アイスランド",IE:"アイルランド",AZ:"アゼルバイジャン",AC:"アセンション島",AF:"アフガニスタン",US:"アメリカ合衆国",AE:"アラブ首長国連邦",DZ:"アルジェリア",AR:"アルゼンチン",AW:"アルバ",AL:"アルバニア",AM:"アルメニア",AI:"アンギラ",AO:"アンゴラ",AG:"アンティグア・バーブーダ",AD:"アンドラ",YE:"イエメン",GB:"イギリス",IL:"イスラエル",IT:"イタリア",IQ:"イラク",IR:"イラン",IN:"インド",ID:"インドネシア",WF:"ウォリス・フツナ",UG:"ウガンダ",UA:"ウクライナ",UZ:"ウズベキスタン",UY:"ウルグアイ",EC:"エクアドル",EG:"エジプト",EE:"エストニア",ET:"エチオピア",ER:"エリトリア",SV:"エルサルバドル",AU:"オーストラリア",AT:"オーストリア",AX:"オーランド諸島",OM:"オマーン",NL:"オランダ",BQ:"オランダ領カリブ",GH:"ガーナ",CV:"カーボベルデ",GG:"ガーンジー",GY:"ガイアナ",KZ:"カザフスタン",QA:"カタール",CA:"カナダ",IC:"カナリア諸島",GA:"ガボン",CM:"カメルーン",GM:"ガンビア",KH:"カンボジア",GN:"ギニア",GW:"ギニアビサウ",CY:"キプロス",CU:"キューバ",CW:"キュラソー",GR:"ギリシャ",KI:"キリバス",KG:"キルギス",GT:"グアテマラ",GP:"グアドループ",GU:"グアム",KW:"クウェート",CK:"クック諸島",GL:"グリーンランド",CX:"クリスマス島",GE:"グルジア",GD:"グレナダ",HR:"クロアチア",KY:"ケイマン諸島",KE:"ケニア",CI:"コートジボワール",CC:"ココス(キーリング)諸島",CR:"コスタリカ",XK:"コソボ",KM:"コモロ",CO:"コロンビア",CG:"コンゴ共和国(ブラザビル)",CD:"コンゴ民主共和国(キンシャサ)",SA:"サウジアラビア",WS:"サモア",BL:"サン・バルテルミー島",MF:"サン・マルタン",ST:"サントメ・プリンシペ",ZM:"ザンビア",PM:"サンピエール島・ミクロン島",SM:"サンマリノ",SL:"シエラレオネ",DJ:"ジブチ",GI:"ジブラルタル",JE:"ジャージー",JM:"ジャマイカ",SY:"シリア",SG:"シンガポール",SX:"シント・マールテン",ZW:"ジンバブエ",CH:"スイス",SE:"スウェーデン",SD:"スーダン",SJ:"スバールバル諸島・ヤンマイエン島",ES:"スペイン",SR:"スリナム",LK:"スリランカ",SK:"スロバキア",SI:"スロベニア",SZ:"スワジランド",EA:"セウタ・メリリャ",SC:"セーシェル",SN:"セネガル",RS:"セルビア",KN:"セントクリストファー・ネイビス",VC:"セントビンセント・グレナディーン諸島",SH:"セントヘレナ",LC:"セントルシア",SO:"ソマリア",SB:"ソロモン諸島",TC:"タークス・カイコス諸島",TH:"タイ",TJ:"タジキスタン",TZ:"タンザニア",CZ:"チェコ共和国",TD:"チャド",TN:"チュニジア",CL:"チリ",TV:"ツバル",DG:"ディエゴガルシア島",DK:"デンマーク",DE:"ドイツ",TG:"トーゴ",TK:"トケラウ",DO:"ドミニカ共和国",DM:"ドミニカ国",TA:"トリスタン・ダ・クーニャ",TT:"トリニダード・トバゴ",TM:"トルクメニスタン",TR:"トルコ",TO:"トンガ",NG:"ナイジェリア",NR:"ナウル",NA:"ナミビア",NU:"ニウエ島",NI:"ニカラグア",NE:"ニジェール",NC:"ニューカレドニア",NZ:"ニュージーランド",NP:"ネパール",NF:"ノーフォーク島",NO:"ノルウェー",BH:"バーレーン",HT:"ハイチ",PK:"パキスタン",VA:"バチカン市国",PA:"パナマ",VU:"バヌアツ",BS:"バハマ",PG:"パプアニューギニア",BM:"バミューダ",PW:"パラオ",PY:"パラグアイ",BB:"バルバドス",PS:"パレスチナ",HU:"ハンガリー",BD:"バングラデシュ",PN:"ピトケアン諸島",FJ:"フィジー",PH:"フィリピン",FI:"フィンランド",BT:"ブータン",PR:"プエルトリコ",FO:"フェロー諸島",FK:"フォークランド諸島",BR:"ブラジル",FR:"フランス",BG:"ブルガリア",BF:"ブルキナファソ",BN:"ブルネイ",BI:"ブルンジ",VN:"ベトナム",BJ:"ベナン",VE:"ベネズエラ",BY:"ベラルーシ",BZ:"ベリーズ",PE:"ペルー",BE:"ベルギー",PL:"ポーランド",BA:"ボスニア・ヘルツェゴビナ",BW:"ボツワナ",BO:"ボリビア",PT:"ポルトガル",HN:"ホンジュラス",MH:"マーシャル諸島",MK:"マケドニア",MG:"マダガスカル",YT:"マヨット島",MW:"マラウイ",ML:"マリ",MT:"マルタ",MQ:"マルティニーク",MY:"マレーシア",IM:"マン島",FM:"ミクロネシア連邦",MM:"ミャンマー",MX:"メキシコ",MU:"モーリシャス",MR:"モーリタニア",MZ:"モザンビーク",MC:"モナコ",MV:"モルディブ",MD:"モルドバ",MA:"モロッコ",MN:"モンゴル",ME:"モンテネグロ",MS:"モントセラト",JO:"ヨルダン",LA:"ラオス",LV:"ラトビア",LT:"リトアニア",LY:"リビア",LI:"リヒテンシュタイン",LR:"リベリア",RO:"ルーマニア",LU:"ルクセンブルグ",RW:"ルワンダ",LS:"レソト",LB:"レバノン",RE:"レユニオン島",RU:"ロシア",IO:"英領インド洋地域",VG:"英領ヴァージン諸島",EH:"西サハラ",GQ:"赤道ギニア",TW:"台湾",KR:"大韓民国",CF:"中央アフリカ共和国",MO:"中華人民共和国マカオ特別行政区",HK:"中華人民共和国香港特別行政区",CN:"中国",KP:"朝鮮民主主義人民共和国",TL:"東ティモール",ZA:"南アフリカ",GS:"南ジョージア島・南サンドイッチ諸島",SS:"南スーダン",AQ:"南極",JP:"日本",GF:"仏領ギアナ",PF:"仏領ポリネシア",TF:"仏領極南諸島",VI:"米領ヴァージン諸島",AS:"米領サモア",UM:"米領太平洋諸島",MP:"北マリアナ諸島"},ko:{GH:"가나",GA:"가봉",GY:"가이아나",GM:"감비아",GG:"건지",GP:"과들루프",GT:"과테말라",GU:"괌",GD:"그레나다",GR:"그리스",GL:"그린란드",GW:"기네비쏘",GN:"기니",CV:"까뽀베르데",NA:"나미비아",NR:"나우루",NG:"나이지리아",AQ:"남극 대륙",SS:"남수단",ZA:"남아프리카",NL:"네덜란드",BQ:"네덜란드령 카리브",NP:"네팔",NO:"노르웨이",NF:"노퍽섬",NC:"뉴 칼레도니아",NZ:"뉴질랜드",NU:"니우에",NE:"니제르",NI:"니카라과",TW:"대만",KR:"대한민국",DK:"덴마크",DM:"도미니카",DO:"도미니카 공화국",DE:"독일",TL:"동티모르",DG:"디에고 가르시아",LA:"라오스",LR:"라이베리아",LV:"라트비아",RU:"러시아",LB:"레바논",LS:"레소토",RO:"루마니아",LU:"룩셈부르크",RW:"르완다",LY:"리비아",RE:"리유니온",LT:"리투아니아",LI:"리히텐슈타인",MG:"마다가스카르",MH:"마샬 군도",YT:"마요티",MO:"마카오, 중국 특별행정구",MK:"마케도니아",MW:"말라위",MY:"말레이시아",ML:"말리",MQ:"말티니크",IM:"맨 섬",MX:"멕시코",MC:"모나코",MA:"모로코",MU:"모리셔스",MR:"모리타니",MZ:"모잠비크",ME:"몬테네그로",MS:"몬트세라트",MD:"몰도바",MV:"몰디브",MT:"몰타",MN:"몽골",US:"미국",VI:"미국령 버진 아일랜드",UM:"미국령 해외 제도",MM:"미얀마",FM:"미크로네시아",VU:"바누아투",BH:"바레인",BB:"바베이도스",VA:"바티칸",BS:"바하마",BD:"방글라데시",BM:"버뮤다",BJ:"베냉",VE:"베네수엘라",VN:"베트남",BE:"벨기에",BY:"벨라루스",BZ:"벨리즈",BA:"보스니아 헤르체고비나",BW:"보츠와나",BO:"볼리비아",BI:"부룬디",BF:"부르키나파소",BT:"부탄",MP:"북마리아나제도",BG:"불가리아",BR:"브라질",BN:"브루나이",WS:"사모아",SA:"사우디아라비아",GS:"사우스조지아 사우스샌드위치 제도",CY:"사이프러스",SM:"산마리노",ST:"상투메 프린시페",MF:"생 마르탱",BL:"생 바르텔르미",PM:"생피에르 미클롱",EH:"서사하라",SN:"세네갈",RS:"세르비아",EA:"세우타 및 멜리야",KN:"세인트 키츠 네비스",LC:"세인트루시아",VC:"세인트빈센트그레나딘",SH:"세인트헬레나",SO:"소말리아",SB:"솔로몬 제도",SD:"수단",SR:"수리남",SC:"쉐이쉘",LK:"스리랑카",SJ:"스발바르제도-얀마웬섬",SZ:"스와질랜드",SE:"스웨덴",CH:"스위스",ES:"스페인",SK:"슬로바키아",SI:"슬로베니아",SY:"시리아",SL:"시에라리온",SX:"신트마르턴",SG:"싱가포르",AE:"아랍에미리트 연합",AW:"아루바",AM:"아르메니아",AR:"아르헨티나",AS:"아메리칸 사모아",IS:"아이슬란드",HT:"아이티",IE:"아일랜드",AZ:"아제르바이잔",AF:"아프가니스탄",AI:"안길라",AD:"안도라",AL:"알바니아",DZ:"알제리",AO:"앙골라",AG:"앤티가 바부다",AC:"어센션 섬",ER:"에리트리아",EE:"에스토니아",EC:"에콰도르",SV:"엘살바도르",GB:"영국",VG:"영국령 버진 아일랜드",IO:"영국령인도양식민지",YE:"예멘",OM:"오만",AU:"오스트레일리아",AT:"오스트리아",HN:"온두라스",AX:"올란드 제도",WF:"왈리스-푸투나 제도",JO:"요르단",UG:"우간다",UY:"우루과이",UZ:"우즈베키스탄",UA:"우크라이나",ET:"이디오피아",IQ:"이라크",IR:"이란",IL:"이스라엘",EG:"이집트",IT:"이탈리아",IN:"인도",ID:"인도네시아",JP:"일본",JM:"자메이카",ZM:"잠비아",JE:"저지",GQ:"적도 기니",KP:"조선 민주주의 인민 공화국",GE:"조지아",CN:"중국",CF:"중앙 아프리카 공화국",DJ:"지부티",GI:"지브롤터",ZW:"짐바브웨",TD:"차드",CZ:"체코",CL:"칠레",IC:"카나리아 제도",CM:"카메룬",KZ:"카자흐스탄",QA:"카타르",KH:"캄보디아",CA:"캐나다",KE:"케냐",KY:"케이맨제도",KM:"코모로스",XK:"코소보",CR:"코스타리카",CC:"코코스제도",CI:"코트디부아르",CO:"콜롬비아",CG:"콩고",CD:"콩고-킨샤사",CU:"쿠바",KW:"쿠웨이트",CK:"쿡제도",CW:"퀴라소",HR:"크로아티아",CX:"크리스마스섬",KG:"키르기스스탄",KI:"키리바시",TJ:"타지키스탄",TZ:"탄자니아",TH:"태국",TC:"터크스케이커스제도",TR:"터키",TG:"토고",TK:"토켈라우",TO:"통가",TM:"투르크메니스탄",TV:"투발루",TN:"튀니지",TT:"트리니다드 토바고",TA:"트리스탄다쿠나",PA:"파나마",PY:"파라과이",PK:"파키스탄",PG:"파푸아뉴기니",PW:"팔라우",PS:"팔레스타인 지구",FO:"페로제도",PE:"페루",PT:"포르투갈",FK:"포클랜드 제도",PL:"폴란드",PR:"푸에르토리코",FR:"프랑스",TF:"프랑스 남부 지방",GF:"프랑스령 기아나",PF:"프랑스령 폴리네시아",FJ:"피지",FI:"핀란드",PH:"필리핀",PN:"핏케언 섬",HU:"헝가리",HK:"홍콩, 중국 특별행정구"},pt:{AF:"Afeganist\xe3o",ZA:"\xc1frica do Sul",AL:"Alb\xe2nia",DE:"Alemanha",AD:"Andorra",AO:"Angola",AI:"Anguilla",AQ:"Ant\xe1rtida",AG:"Ant\xedgua e Barbuda",SA:"Ar\xe1bia Saudita",DZ:"Arg\xe9lia",AR:"Argentina",AM:"Arm\xeania",AW:"Aruba",AU:"Austr\xe1lia",AT:"\xc1ustria",AZ:"Azerbaij\xe3o",BS:"Bahamas",BH:"Bahrein",BD:"Bangladesh",BB:"Barbados",BE:"B\xe9lgica",BZ:"Belize",BJ:"Benin",BM:"Bermudas",BY:"Bielorr\xfassia",BO:"Bol\xedvia",BA:"B\xf3snia e Herzegovina",BW:"Botsuana",BR:"Brasil",BN:"Brunei",BG:"Bulg\xe1ria",BF:"Burquina Faso",BI:"Burundi",BT:"But\xe3o",CV:"Cabo Verde",KH:"Camboja",CA:"Canad\xe1",QA:"Catar",KZ:"Cazaquist\xe3o",EA:"Ceuta e Melilha",TD:"Chade",CL:"Chile",CN:"China",CY:"Chipre",VA:"Cidade do Vaticano",SG:"Cingapura",CO:"Col\xf4mbia",KM:"Comores",CG:"Congo - Brazzaville",CD:"Congo - Kinshasa",KP:"Coreia do Norte",KR:"Coreia do Sul",CI:"Costa do Marfim",CR:"Costa Rica",HR:"Cro\xe1cia",CU:"Cuba",CW:"Cura\xe7ao",DG:"Diego Garcia",DK:"Dinamarca",DJ:"Djibuti",DM:"Dominica",EG:"Egito",SV:"El Salvador",AE:"Emirados \xc1rabes Unidos",EC:"Equador",ER:"Eritreia",SK:"Eslov\xe1quia",SI:"Eslov\xeania",ES:"Espanha",US:"Estados Unidos",EE:"Est\xf4nia",ET:"Eti\xf3pia",FJ:"Fiji",PH:"Filipinas",FI:"Finl\xe2ndia",FR:"Fran\xe7a",GA:"Gab\xe3o",GM:"G\xe2mbia",GH:"Gana",GE:"Ge\xf3rgia",GS:"Ge\xf3rgia do Sul e Ilhas Sandwich do Sul",GI:"Gibraltar",GD:"Granada",GR:"Gr\xe9cia",GL:"Groenl\xe2ndia",GP:"Guadalupe",GU:"Guam",GT:"Guatemala",GG:"Guernsey",GY:"Guiana",GF:"Guiana Francesa",GN:"Guin\xe9",GW:"Guin\xe9 Bissau",GQ:"Guin\xe9 Equatorial",HT:"Haiti",NL:"Holanda",HN:"Honduras",HK:"Hong Kong, RAE da China",HU:"Hungria",YE:"I\xeamen",CX:"Ilha Christmas",AC:"Ilha de Ascens\xe3o",IM:"Ilha de Man",NF:"Ilha Norfolk",AX:"Ilhas \xc5land",KY:"Ilhas Caiman",IC:"Ilhas Can\xe1rias",CC:"Ilhas Cocos (Keeling)",CK:"Ilhas Cook",UM:"Ilhas Distantes dos EUA",FO:"Ilhas Faroe",FK:"Ilhas Malvinas",MP:"Ilhas Marianas do Norte",MH:"Ilhas Marshall",PN:"Ilhas Pitcairn",SB:"Ilhas Salom\xe3o",TC:"Ilhas Turks e Caicos",VG:"Ilhas Virgens Brit\xe2nicas",VI:"Ilhas Virgens dos EUA",IN:"\xcdndia",ID:"Indon\xe9sia",IR:"Ir\xe3",IQ:"Iraque",IE:"Irlanda",IS:"Isl\xe2ndia",IL:"Israel",IT:"It\xe1lia",JM:"Jamaica",JP:"Jap\xe3o",JE:"Jersey",JO:"Jord\xe2nia",XK:"Kosovo",KW:"Kuwait",LA:"Laos",LS:"Lesoto",LV:"Let\xf4nia",LB:"L\xedbano",LR:"Lib\xe9ria",LY:"L\xedbia",LI:"Liechtenstein",LT:"Litu\xe2nia",LU:"Luxemburgo",MO:"Macau, RAE da China",MK:"Maced\xf4nia",MG:"Madagascar",MY:"Mal\xe1sia",MW:"Malawi",MV:"Maldivas",ML:"Mali",MT:"Malta",MA:"Marrocos",MQ:"Martinica",MU:"Maur\xedcio",MR:"Maurit\xe2nia",YT:"Mayotte",MX:"M\xe9xico",MM:"Mianmar (Birm\xe2nia)",FM:"Micron\xe9sia",MZ:"Mo\xe7ambique",MD:"Mold\xe1via",MC:"M\xf4naco",MN:"Mong\xf3lia",ME:"Montenegro",MS:"Montserrat",NA:"Nam\xedbia",NR:"Nauru",NP:"Nepal",NI:"Nicar\xe1gua",NE:"N\xedger",NG:"Nig\xe9ria",NU:"Niue",NO:"Noruega",NC:"Nova Caled\xf4nia",NZ:"Nova Zel\xe2ndia",OM:"Om\xe3",BQ:"Pa\xedses Baixos Caribenhos",PW:"Palau",PA:"Panam\xe1",PG:"Papua-Nova Guin\xe9",PK:"Paquist\xe3o",PY:"Paraguai",PE:"Peru",PF:"Polin\xe9sia Francesa",PL:"Pol\xf4nia",PR:"Porto Rico",PT:"Portugal",KE:"Qu\xeania",KG:"Quirguist\xe3o",KI:"Quiribati",GB:"Reino Unido",CF:"Rep\xfablica Centro-Africana",DO:"Rep\xfablica Dominicana",CM:"Rep\xfablica dos Camar\xf5es",CZ:"Rep\xfablica Tcheca",RE:"Reuni\xe3o",RO:"Rom\xeania",RW:"Ruanda",RU:"R\xfassia",EH:"Saara Ocidental",PM:"Saint Pierre e Miquelon",WS:"Samoa",AS:"Samoa Americana",SM:"San Marino",SH:"Santa Helena",LC:"Santa L\xfacia",BL:"S\xe3o Bartolomeu",KN:"S\xe3o Crist\xf3v\xe3o e Nevis",MF:"S\xe3o Martinho",ST:"S\xe3o Tom\xe9 e Pr\xedncipe",VC:"S\xe3o Vicente e Granadinas",SN:"Senegal",SL:"Serra Leoa",RS:"S\xe9rvia",SC:"Seychelles",SX:"Sint Maarten",SY:"S\xedria",SO:"Som\xe1lia",LK:"Sri Lanka",SZ:"Suazil\xe2ndia",SD:"Sud\xe3o",SS:"Sud\xe3o do Sul",SE:"Su\xe9cia",CH:"Su\xed\xe7a",SR:"Suriname",SJ:"Svalbard e Jan Mayen",TH:"Tail\xe2ndia",TW:"Taiwan",TJ:"Tajiquist\xe3o",TZ:"Tanz\xe2nia",IO:"Territ\xf3rio Brit\xe2nico do Oceano \xcdndico",TF:"Territ\xf3rios Franceses do Sul",PS:"Territ\xf3rios palestinos",TL:"Timor-Leste",TG:"Togo",TK:"Tokelau",TO:"Tonga",TT:"Trinidad e Tobago",TA:"Trist\xe3o da Cunha",TN:"Tun\xedsia",TM:"Turcomenist\xe3o",TR:"Turquia",TV:"Tuvalu",UA:"Ucr\xe2nia",UG:"Uganda",UY:"Uruguai",UZ:"Uzbequist\xe3o",VU:"Vanuatu",VE:"Venezuela",VN:"Vietn\xe3",WF:"Wallis e Futuna",ZM:"Z\xe2mbia",ZW:"Zimb\xe1bue"},zh:{AL:"阿尔巴尼亚",DZ:"阿尔及利亚",AF:"阿富汗",AR:"阿根廷",AE:"阿拉伯联合酋长国",AW:"阿鲁巴",OM:"阿曼",AZ:"阿塞拜疆",AC:"阿森松岛",EG:"埃及",ET:"埃塞俄比亚",IE:"爱尔兰",EE:"爱沙尼亚",AD:"安道尔",AO:"安哥拉",AI:"安圭拉",AG:"安提瓜和巴布达",AT:"奥地利",AX:"奥兰群岛",AU:"澳大利亚",BB:"巴巴多斯",PG:"巴布亚新几内亚",BS:"巴哈马",PK:"巴基斯坦",PY:"巴拉圭",PS:"巴勒斯坦领土",BH:"巴林",PA:"巴拿马",BR:"巴西",BY:"白俄罗斯",BM:"百慕大",BG:"保加利亚",MP:"北马里亚纳群岛",BJ:"贝宁",BE:"比利时",IS:"冰岛",PR:"波多黎各",PL:"波兰",BA:"波斯尼亚和黑塞哥维那",BO:"玻利维亚",BZ:"伯利兹",BW:"博茨瓦纳",BT:"不丹",BF:"布基纳法索",BI:"布隆迪",KP:"朝鲜",GQ:"赤道几内亚",DK:"丹麦",DE:"德国",DG:"迪戈加西亚岛",TL:"东帝汶",TG:"多哥",DO:"多米尼加共和国",DM:"多米尼克",RU:"俄罗斯",EC:"厄瓜多尔",ER:"厄立特里亚",FR:"法国",FO:"法罗群岛",PF:"法属波利尼西亚",GF:"法属圭亚那",TF:"法属南部领地",MF:"法属圣马丁",VA:"梵蒂冈",PH:"菲律宾",FJ:"斐济",FI:"芬兰",CV:"佛得角",FK:"福克兰群岛",GM:"冈比亚",CG:"刚果（布）",CD:"刚果（金）",CO:"哥伦比亚",CR:"哥斯达黎加",GD:"格林纳达",GL:"格陵兰",GE:"格鲁吉亚",GG:"根西岛",CU:"古巴",GP:"瓜德罗普",GU:"关岛",GY:"圭亚那",KZ:"哈萨克斯坦",HT:"海地",KR:"韩国",NL:"荷兰",BQ:"荷兰加勒比区",SX:"荷属圣马丁",ME:"黑山共和国",HN:"洪都拉斯",KI:"基里巴斯",DJ:"吉布提",KG:"吉尔吉斯斯坦",GN:"几内亚",GW:"几内亚比绍",CA:"加拿大",GH:"加纳",IC:"加纳利群岛",GA:"加蓬",KH:"柬埔寨",CZ:"捷克共和国",ZW:"津巴布韦",CM:"喀麦隆",QA:"卡塔尔",KY:"开曼群岛",CC:"科科斯（基林）群岛",KM:"科摩罗",XK:"科索沃",CI:"科特迪瓦",KW:"科威特",HR:"克罗地亚",KE:"肯尼亚",CK:"库克群岛",CW:"库拉索",LV:"拉脱维亚",LS:"莱索托",LA:"老挝",LB:"黎巴嫩",LT:"立陶宛",LR:"利比里亚",LY:"利比亚",LI:"列支敦士登",RE:"留尼汪",LU:"卢森堡",RW:"卢旺达",RO:"罗马尼亚",MG:"马达加斯加",MV:"马尔代夫",MT:"马耳他",MW:"马拉维",MY:"马来西亚",ML:"马里",MK:"马其顿",MH:"马绍尔群岛",MQ:"马提尼克",YT:"马约特",IM:"曼岛",MU:"毛里求斯",MR:"毛里塔尼亚",US:"美国",UM:"美国本土外小岛屿",AS:"美属萨摩亚",VI:"美属维京群岛",MN:"蒙古",MS:"蒙特塞拉特",BD:"孟加拉国",PE:"秘鲁",FM:"密克罗尼西亚",MM:"缅甸",MD:"摩尔多瓦",MA:"摩洛哥",MC:"摩纳哥",MZ:"莫桑比克",MX:"墨西哥",NA:"纳米比亚",ZA:"南非",AQ:"南极洲",GS:"南乔治亚岛和南桑威齐群岛",SS:"南苏丹",NR:"瑙鲁",NI:"尼加拉瓜",NP:"尼泊尔",NE:"尼日尔",NG:"尼日利亚",NU:"纽埃",NO:"挪威",NF:"诺福克岛",PW:"帕劳",PN:"皮特凯恩群岛",PT:"葡萄牙",JP:"日本",SE:"瑞典",CH:"瑞士",SV:"萨尔瓦多",WS:"萨摩亚",RS:"塞尔维亚",SL:"塞拉利昂",SN:"塞内加尔",CY:"塞浦路斯",SC:"塞舌尔",SA:"沙特阿拉伯",BL:"圣巴泰勒米",CX:"圣诞岛",ST:"圣多美和普林西比",SH:"圣赫勒拿",KN:"圣基茨和尼维斯",LC:"圣卢西亚",SM:"圣马力诺",PM:"圣皮埃尔和密克隆群岛",VC:"圣文森特和格林纳丁斯",LK:"斯里兰卡",SK:"斯洛伐克",SI:"斯洛文尼亚",SJ:"斯瓦尔巴特和扬马延",SZ:"斯威士兰",SD:"苏丹",SR:"苏里南",SB:"所罗门群岛",SO:"索马里",TJ:"塔吉克斯坦",TW:"台湾",TH:"泰国",TZ:"坦桑尼亚",TO:"汤加",TC:"特克斯和凯科斯群岛",TA:"特里斯坦-达库尼亚群岛",TT:"特立尼达和多巴哥",TN:"突尼斯",TV:"图瓦卢",TR:"土耳其",TM:"土库曼斯坦",TK:"托克劳",WF:"瓦利斯和富图纳",VU:"瓦努阿图",GT:"危地马拉",VE:"委内瑞拉",BN:"文莱",UG:"乌干达",UA:"乌克兰",UY:"乌拉圭",UZ:"乌兹别克斯坦",GR:"希腊",ES:"西班牙",EH:"西撒哈拉",SG:"新加坡",NC:"新喀里多尼亚",NZ:"新西兰",HU:"匈牙利",EA:"休达及梅利利亚",SY:"叙利亚",JM:"牙买加",AM:"亚美尼亚",YE:"也门",IQ:"伊拉克",IR:"伊朗",IL:"以色列",IT:"意大利",IN:"印度",ID:"印度尼西亚",GB:"英国",VG:"英属维京群岛",IO:"英属印度洋领地",JO:"约旦",VN:"越南",ZM:"赞比亚",JE:"泽西岛",TD:"乍得",GI:"直布罗陀",CL:"智利",CF:"中非共和国",CN:"中国",MO:"中国澳门特别行政区",HK:"中国香港特别行政区"}},eX=e=>{switch(e){case e$.f.GB:return"UK";case e$.f.IE:return"IRL";case e$.f.LU:return"L";case e$.f.BE:return"B";case e$.f.DE:return"D";case e$.f.ES:return"E";case e$.f.IT:return"I";case e$.f.AT:return"A";default:return e}},e0=["FR","GB","IE","LU","BE","DE","ES","IT","NL","AT","DK"],e1=e=>{if(!e)return e$.f.NO_TYPE;if(2===e.length&&e.toLocaleUpperCase()in e$.f)return e.toLocaleUpperCase();let t=new Set,a=e.toLowerCase();for(let e in eQ){let r=eQ[e];for(let e in r)r[e].toLowerCase()===a&&t.add(e)}return 1===t.size?[...t][0]:e$.f.NO_TYPE},e4=e=>{if(e){let t=(0,eJ.G3)();return(t in eQ?eQ[t]:eQ.en)[e.toLocaleUpperCase()]??e}return""};var e2=((c={}).FORMAT_DD="FORMAT_DD",c.FORMAT_MM="FORMAT_MM",c.FORMAT_YY="FORMAT_YY",c.FORMAT_YYYY="FORMAT_YYYY",c.FORMAT_DD_MM="FORMAT_DD_MM",c.FORMAT_MM_DD="FORMAT_MM_DD",c.FORMAT_MM_YY="FORMAT_MM_YY",c.FORMAT_MM_YYYY="FORMAT_MM_YYYY",c.FORMAT_YY_MM="FORMAT_YY_MM",c.FORMAT_YYYY_MM="FORMAT_YYYY_MM",c.FORMAT_DD_MM_YY="FORMAT_DD_MM_YY",c.FORMAT_DD_MM_YYYY="FORMAT_DD_MM_YYYY",c.FORMAT_MM_DD_YY="FORMAT_MM_DD_YY",c.FORMAT_MM_DD_YYYY="FORMAT_MM_DD_YYYY",c.FORMAT_YYYY_MM_DD="FORMAT_YYYY_MM_DD",c.FORMAT_YY_MM_DD="FORMAT_YY_MM_DD",c),e6=((u={}).SEPARATOR_NOTHING=" ",u.SEPARATOR_DOT=".",u.SEPARATOR_TIRET="-",u.SEPARATOR_SLASH="/",u);let e3=e=>({day:String(e.expirationDay),month:String(e.expirationMonth),year:String(e.expirationYear)}),e5=e=>({day:String(e.issueDay),month:String(e.issueMonth),year:String(e.issueYear)}),e8=e=>({day:String(e.issueDay),month:String(e.issueMonth),year:String(e.issueYear)}),e9=e=>({day:String(e.issueDay),month:String(e.issueMonth),year:String(e.issueYear)});var e7=a(51748);let te={1:"01",2:"02",3:"03",4:"04",5:"05",6:"06",7:"07",8:"08",9:"09","1er":"1","1st":"1",jour:"none"},tt={1:"01",2:"02",3:"03",4:"04",5:"05",6:"06",7:"07",8:"08",9:"09",10:"10",11:"11",12:"12",janvier:"01",january:"01",januar:"01",gennaio:"01",janeiro:"01",janv:"01",jan:"01",gen:"01","1月":"01",一月:"01","01 janvier":"01","01 january":"01","01 januar":"01","01 gennaio":"01","01 janeiro":"01","01 janv":"01","01 jan":"01","01 gen":"01","01　1月":"01","01　一月":"01","janvier 01":"01","january 01":"01","januar 01":"01","gennaio 01":"01","janeiro 01":"01","janv 01":"01","jan 01":"01","gen 01":"01","1月　01":"01","一月 01":"01","1 janvier":"01","1 january":"01","1 januar":"01","1 gennaio":"01","1　1月":"01","1 一月":"01","1 janeiro":"01","1 de janeiro":"01","1 janv":"01","1 jan":"01","janvier 1":"01","january 1":"01","januar 1":"01","gennaio 1":"01","janeiro 1":"01","janv 1":"01","jan 1":"01","gen 1":"01","1月　1":"01","一月 1":"01",enero:"01","enero 1":"01","enero 01":"01","01 enero":"01","de enero":"01","de enero de":"01","de ene":"01",fevrier:"02",february:"02",februar:"02",febbraio:"02",fevereiro:"02",fevr:"02",fev:"02",feb:"02","2月":"02",二月:"02","02 fevrier":"02","02 february":"02","02 februar":"02","02 febbraio":"02","02 fevereiro":"02","02 fevr":"02","02 feb":"02","02　2月":"02","02 二月":"02","02 fev":"02","fevrier 02":"02","february 02":"02","februar 02":"02","febbraio 02":"02","fevereiro 02":"02","fevr 02":"02","feb 02":"02","2月　02":"02","二月 02":"02","fev 02":"02","2 fevrier":"02","2 february":"02","2 februar":"02","2 febbraio":"02","2 fevereiro":"02","2 fevr":"02","2 feb":"02","2　2月":"02","2 二月":"02","2 fev":"02","fevrier 2":"02","february 2":"02","februar 2":"02","febbraio 2":"02","fevereiro 2":"02","fevr 2":"02","feb 2":"02","2月　2":"02","二月 2":"02","fev 2":"02",febrero:"02","febrero 2":"02","febrero 02":"02","2 febrero":"02","de febrero":"02","de febrero de":"02","de feb":"02",mars:"03",marsa:"03",march:"03",marz:"03",marzo:"03",marco:"03",mar:"03",mrz:"03","3月":"03",三月:"03","03 mars":"03","03 marsa":"03","03 march":"03","03 marz":"03","03 marzo":"03","03 marco":"03","03 mar":"03","03　3月":"03","03 三月":"03","mars 03":"03","marsa 03":"03","march 03":"03","marz 03":"03","marzo 03":"03","marco 03":"03","mar 03":"03","mrz 03":"03","3月　03":"03","三月 03":"03","3 mars":"03","3 marsa":"03","3 march":"03","3 marz":"03","3 marzo":"03","3　3月":"03","3 三月":"03","3 marco":"03","3 mar":"03","mars 3":"03","marsa 3":"03","march 3":"03","marz 3":"03","marzo 3":"03","3月　3":"03","三月 3":"03","marco 3":"03","mar 3":"03","de marzo":"03","de marzo de":"03","de mar":"03",avril:"04",april:"04",aprile:"04",abril:"04",apr:"04","4月":"04",四月:"04",abr:"04",avr:"04","04 avril":"04","04 april":"04","04 aprile":"04","04 abril":"04","04 apr":"04","04　4月":"04","04 四月":"04","04 abr":"04","04 avr":"04","avril 04":"04","april 04":"04","aprile 04":"04","abril 04":"04","apr 04":"04","4月　04":"04","四月 04":"04","abr 04":"04","avr 04":"04","4 avril":"04","4 april":"04","4 aprile":"04","4 abril":"04","4 apr":"04","4　4月":"04","4 四月":"04","4 abr":"04","4 avr":"04","avril 4":"04","april 4":"04","abril 4":"04","apr 4":"04","4月　4":"04","四月 4":"04","abr 4":"04","avr 4":"04","de abril":"04","de abril de":"04","de abr":"04",may:"05",mai:"05",maggio:"05","5月":"05",五月:"05",maio:"05",mayo:"05","05 may":"05","05 mai":"05","05 maggio":"05","05　5月":"05","05 五月":"05","05 maio":"05","05 mayo":"05","5 mai":"05","may 05":"05","mai 05":"05","maggio 05":"05","magg 05":"05","mag 05":"05","5月　05":"05","五月 05":"05","maio 05":"05","mayo 05":"05","may 5":"05","mai 5":"05","maggio 5":"05","magg 5":"05","5月　5":"05","五月 5":"05","maio 5":"05","mayo 5":"05","5 may":"05","5 maggio":"05","5　5月":"05","5 五月":"05","5 maio":"05","5 mayo":"05","de mayo":"05","de mayo de":"05",june:"06",juni:"06",giugno:"06",junho:"06",jun:"06",juin:"06",junio:"06","6月":"06",六月:"06","06 june":"06","06 juni":"06","06 giugno":"06","06　6月":"06","06 六月":"06","06 junho":"06","06 jun":"06","06 giu":"06","06 juin":"06","06 junio":"06","june 06":"06","juni 06":"06","giugno 06":"06","6月　06":"06","六月 06":"06","junho 06":"06","jun 06":"06","giu 06":"06","6月　6":"06","六月 6":"06","juin 06":"06","junio 06":"06","6 june":"06","6 juni":"06","6 giugno":"06","6 junho":"06","6 jun":"06","6 giu":"06","6　6月":"06","6 六月":"06","6 juin":"06","6 junio":"06","june 6":"06","juni 6":"06","giugno 6":"06","junho 6":"06","jun 6":"06","giu 6":"06","juin 6":"06","junio 6":"06","de junio":"06","de junio de":"06","de jun":"06",juillet:"07",july:"07",juli:"07",luglio:"07",julho:"07",jul:"07",lug:"07","7月":"07",七月:"07",juil:"07",julio:"07","07 juillet":"07","07 july":"07","07 juli":"07","07 luglio":"07","07 julho":"07","07 jul":"07","07 lug":"07","07　7月":"07","07 七月":"07","jul 07":"07","07 juil":"07","07 julio":"07","juillet 07":"07","july 07":"07","juli 07":"07","luglio 07":"07","julho 07":"07","lug 07":"07","7月　07":"07","七月 07":"07","juil 07":"07","julio 07":"07","7 juillet":"07","7 july":"07","7 juli":"07","7 luglio":"07","7 julho":"07","7 jul":"07","7 lug":"07","7　7月":"07","7 七月":"07","7 juil":"07","7 jului":"07","juillet 7":"07","july 7":"07","juli 7":"07","luglio 7":"07","julho 7":"07","jul 7":"07","lug 7":"07","7月　7":"07","七月 7":"07","juil 7":"07","julio 7":"07","de julio":"07","de julio de":"07","de jul":"07",august:"08",agosto:"08",aug:"08",ago:"08","8月":"08",八月:"08",aout:"08",aou:"08","08 august":"08","08 agosto":"08","08 aug":"08","08 ago":"08","08　8月":"08","08 八月":"08","08 aout":"08","08 aou":"08","august 08":"08","agosto 08":"08","aug 08":"08","ago 08":"08","8月　08":"08","八月 08":"08","aout 08":"08","aou 08":"08","8 august":"08","8 agosto":"08","8 aug":"08","8 ago":"08","8　8月":"08","8 八月":"08","8 aout":"08","8 aou":"08","august 8":"08","agosto 8":"08","aug 8":"08","8月　8":"08","八月 8":"08","ago 8":"08","aout 8":"08","aou 8":"08","de agosto":"08","de agosto de":"08","de ag":"08",septembre:"09",sep:"09",sett:"09",set:"09",september:"09",settembre:"09",setembro:"09",sept:"09","9月":"09",九月:"09",septiembre:"09","09 septembre":"09","09 sep":"09","09 set":"09","09　9月":"09","09 九月":"09","09 september":"09","09 settembre":"09","09 setembro":"09","09 sept":"09","09 sett":"09","09 septiembre":"09","septembre 09":"09","sep 09":"09","sett 09":"09","set 09":"09","9月　09":"09","九月 09":"09","september 09":"09","settembre 09":"09","setembro 09":"09","sept 09":"09","septiembre 09":"09","9 septembre":"09","9 sep":"09","9 set":"09","9　9月":"09","9 九月":"09","9 september":"09","9 settembre":"09","9 setembro":"09","9 sept":"09","9 sett":"09","9 septiembre":"09","septembre 9":"09","sep 9":"09","sett 9":"09","set 9":"09","9月　9":"09","九月 9":"09","september 9":"09","settembre 9":"09","setembro 9":"09","sept 9":"09","septiembre 9":"09","de septiembre":"09","de septiembre de":"09","de sept":"09","de set":"09",octobre:"10",october:"10",oktober:"10",ottobre:"10",outubro:"10",octubre:"10",oct:"10",okt:"10",ott:"10","10月":"10",十月:"10",out:"10","10 octobre":"10","10 october":"10","10 oktober":"10","10 ottobre":"10","10 outubro":"10","10 octubre":"10","10 oct":"10","10 okt":"10","10 ott":"10","10　10月":"10","10 十月":"10","10 out":"10","octobre 10":"10","october 10":"10","oktober 10":"10","ottobre 10":"10","outubro 10":"10","octubre 10":"10","oct 10":"10","okt 10":"10","10月　10":"10","十月 10":"10","out 10":"10","de octubre":"10","de octubre de":"10","de oct":"10",november:"11",novembre:"11",novembro:"11",noviembre:"11",nov:"11","11月":"11",十一月:"11","11 november":"11","11 novembre":"11","11 novembro":"11","11 nov":"11","11　11月":"11","11 十一月":"11","11 noviembre":"11","november 11":"11","novembre 11":"11","novembro 11":"11","noviembre 11":"11","nov 11":"11","11月　11":"11","十一月 11":"11","de noviembre":"11","de noviembre de":"11","de nov":"11",decembre:"12",december:"12",dezember:"12",dicembre:"12",dezembro:"12",dec:"12",dez:"12",dic:"12","12月":"12",十二月:"12",diciembre:"12","12 decembre":"12","12 december":"12","12 dezember":"12","12 dicembre":"12","12 dezembro":"12","12 dec":"12","12 dez":"12","12 dic":"12","12　12月":"12","12 十二月":"12","12 diciembre":"12","decembre 12":"12","december 12":"12","dezember 12":"12","dicembre 12":"12","dezembro 12":"12","dec 12":"12","dez 12":"12","dic 12":"12","12月　12":"12","十二月 12":"12","diciembre 12":"12","de diciembre":"12","de diciembre de":"12","de dic":"12"},ta=e=>{if(!e)return null;let t=(0,e7.Z)(e,"yyyy-MM-dd",new Date);return"Invalid Date"!==t.toString()?t:new Date(e)},tr=(e,t=e2.FORMAT_DD_MM_YYYY)=>e&&Object.keys(e2).includes(e)?e2[e]:t,ti=(e,t=e6.SEPARATOR_SLASH)=>e&&Object.keys(e6).includes(e)?e6[e]:t,tn=(e,t,a={day:"",month:"",year:""})=>a.day||a.month||a.year?e.split("_").slice(1).map(e=>{switch(e){case"DD":return a.day?.padStart(2,"0");case"MM":return a.month?.padStart(2,"0");case"YY":return a.year?.slice(2);case"YYYY":return a.year;default:return""}}).join(t):"",ts=(e,t)=>{let a={day:"",month:"",year:""};if(!t)return a;let r=RegExp("[^A-Za-z0-9_]"),i=e.split(r),n=t.split("_").slice(1);if(i.length===n.length){let e=n.indexOf("DD"),t=n.indexOf("MM"),r=n.findIndex(e=>e.includes("YY"));a.day=e>-1?i[e]:"",a.month=t>-1?i[t]:"",a.year=r>-1?i[r]:""}return a},to=e=>e.toLowerCase().replace(/é/g,"e").replace(/û/g,"u").replace(/ä/g,"a").replace(/[&/\\#,+()$~%.'":*?<>{}!@]/g,""),tl=(e,t,a)=>{let r=t=>t===e||tt[to(t)]===e,i=t.findIndex(r);return i>-1?a[i]:a.find(r)??e},td=(e,t,a)=>{let r=t=>t===e||te[t]===e,i=t.findIndex(r);return i>-1?a[i]:a.find(r)??e},tc=e=>{let t=new Date().getFullYear(),a=t.toString().slice(2),r=t.toString().slice(0,2),i=`${r}${e}`;return Number(e)<Number(a)&&(i=`${Number(r)+1}${e}`),i},tu={day:1,month:1,year:1970},tp=(e,t,a)=>!!e&&!!t&&!!a&&e===tu.day&&t===tu.month&&a===tu.year;function tm(e){let t="",a="";return t=e.middleName?`${e.middleName} ${e.lastName}`:e.lastName2?`${e.lastName} ${e.lastName2}`:`${e.lastName}`,`${e.firstName} ${t}`}let tg=e=>{let t=ta(e.birthDate);if(t)return{day:t.getDate().toString().padStart(2,"0"),month:(t.getMonth()+1).toString().padStart(2,"0"),year:t.getFullYear().toString().padStart(4,"0")}},th=(e,t)=>{let a=tg(e);return a?tn(tr(t?.dateFormat,e2.FORMAT_MM_DD_YYYY),ti(t?.dateSeparator,e6.SEPARATOR_SLASH),a):""},tw=(e,t)=>(t.includes("expiration")?tp(e.expirationDay,e.expirationMonth,e.expirationYear):tp(e.issueDay,e.issueMonth,e.issueYear))?"":e[t].toString(),ty=e=>({day:String(e.issueDay),month:String(e.issueMonth),year:String(e.issueYear)}),tb=e=>({day:String(e.issueDay),month:String(e.issueMonth),year:String(e.issueYear)}),tf=e=>({month:e.expireMonth,year:e.expireYear}),tS=(e,t)=>{let a=tf(e);return tn(tr(t?.dateFormat,e2.FORMAT_MM_YY),ti(t?.dateSeparator,e6.SEPARATOR_SLASH),a)};async function tC(e,t,a,r=""){let i=r?new eB.Y(r).getRootDomain():void 0;if(t===eC.k.GeneratedPassword)return e.connectors.carbon.getSingleGeneratedPasswordForAutofill(a);try{let r=await (0,eT.z)(e.connectors.grapheneClient.autofillData.queries.getSingleAutofillData({itemId:a,itemType:t,rootDomain:i}));if((0,eI.hx)(r))throw Error(r.error);return r.data}catch(e){throw e instanceof Error&&(e.message="error in get single autofill data query: "+e.message),e}}async function tA({context:e,vaultType:t,queryOptions:a,url:r="",limit:i,needDashlaneLinkedWebsites:n}){if(t===eC.k.GeneratedPassword){let t={sortToken:{sortCriteria:a?.sortCriteria??[],uniqField:"id"},filterToken:{filterCriteria:a?.filterCriteria??[]},limit:a?.maxNumberOfItems};return e.connectors.carbon.getMultipleGeneratedPasswordsForAutofill(t).then(e=>e.items)}try{let s=new eB.Y(r),o=s.getETLD(),l=eK.includes(o)?o:s.getRootDomain();t===eC.k.Passkey&&(l=s.getHostname());let d=t===eC.k.Credential||t===eC.k.Passkey,c=a?.sortCriteria[0],u=await (0,eT.z)(e.connectors.grapheneClient.autofillData.queries.searchAutofillData({searchQuery:d?l:"",itemTypes:[t],domain:l,sorting:c?{property:c.field,direction:c.direction}:void 0,pagination:i?{pageSize:i,pageNumber:1}:void 0,needDashlaneLinkedWebsites:n}));if((0,eI.hx)(u))throw Error(u.error);return u.data.items}catch(e){throw e instanceof Error&&(e.message="error in get all autofill data query: "+e.message),e}}async function tI({context:e,searchQuery:t,itemTypes:a,domain:r,sorting:i,limit:n,needDashlaneLinkedWebsites:s}){try{let o=await (0,eT.z)(e.connectors.grapheneClient.autofillData.queries.searchAutofillData({searchQuery:t,itemTypes:a,domain:r,sorting:i,pagination:n?{pageSize:n,pageNumber:1}:void 0,needDashlaneLinkedWebsites:s}));if((0,eI.hx)(o))throw Error(o.tag);return o.data}catch(e){throw Error("error in search autofill data query: "+e)}}let tM={[eC.k.Address]:eO.U.Address,[eC.k.BankAccount]:eO.U.BankAccount,[eC.k.Company]:eO.U.Company,[eC.k.Credential]:eO.U.Credential,[eC.k.DriverLicense]:eO.U.DriversLicense,[eC.k.Email]:eO.U.Email,[eC.k.FiscalId]:eO.U.FiscalId,[eC.k.GeneratedPassword]:null,[eC.k.IdCard]:eO.U.IdCard,[eC.k.Identity]:eO.U.Identity,[eC.k.Note]:eO.U.SecureNote,[eC.k.Passkey]:eO.U.Passkey,[eC.k.Passport]:eO.U.Passport,[eC.k.PaymentCard]:eO.U.PaymentCard,[eC.k.PersonalWebsite]:eO.U.Website,[eC.k.Phone]:eO.U.Phone,[eC.k.SocialSecurityId]:eO.U.SocialSecurityId,[eC.k.Secret]:eO.U.Secret};async function tT({context:e,vaultType:t}){try{let a=tM[t];if(a){let t=eV.N[a],r=await (0,eT.z)(e.connectors.grapheneClient.vaultItemsCrud.queries.query({vaultItemTypes:[a]}));if((0,eI.hx)(r))throw Error(r.tag);return r.data[t].matchCount}throw Error("bad vault item type")}catch(e){throw Error("error in the `getNumberOfItemsFromVault` function of the `get.ts` file: "+e)}}let tk={[eC.k.Address]:{addressFull:function(e,t){return"number"==typeof t?.partNumber?eH(e,t.partNumber):eq(e)},country:e=>e4(e.country)},[eC.k.BankAccount]:{IBAN:(e,t)=>{let a=eZ(e.IBAN,e.country);return"number"==typeof t?.partNumber?a.parts[t.partNumber]??"":a.compact}},[eC.k.Identity]:{birthDay:(e,t)=>{let a=th(e,{dateFormat:e2.FORMAT_DD,dateSeparator:e6.SEPARATOR_NOTHING});return t?.optionLabels&&t.optionValues?td(a,t.optionLabels,t.optionValues):a},birthMonth:(e,t)=>{let a=th(e,{dateFormat:e2.FORMAT_MM,dateSeparator:e6.SEPARATOR_NOTHING});return t?.optionLabels&&t.optionValues?tl(a,t.optionLabels,t.optionValues):a},middleNameInitial:function(e){let t=e.middleName.split(" ").map(e=>e.charAt(0)).join(". ");return`${t}.`},fullName:tm},[eC.k.PaymentCard]:{expireMonth:(e,t)=>tS(e,{dateFormat:t?.dateFormat??e2.FORMAT_MM,dateSeparator:e6.SEPARATOR_NOTHING}),cardNumber:(e,t)=>{let{cardNumber:a}=e;return"number"==typeof t?.partNumber?a.substr(4*t.partNumber,4):a}},[eC.k.Credential]:{otpSecret:function(e,t){let a=e.otpSecret;return"number"==typeof t?.partNumber&&a.length>t.partNumber?a[t.partNumber]:a},password:function(e,t){let a=e.password;return"number"==typeof t?.partNumber&&a.length>t.partNumber?a[t.partNumber]:a}},[eC.k.Passport]:{expirationDay:e=>tw(e,"expirationDay"),expirationMonth:e=>tw(e,"expirationMonth"),issueDay:e=>tw(e,"issueDay"),issueMonth:e=>tw(e,"issueMonth")}},tP=e=>{if(e.type in tk){let t=tk[e.type];if(t&&e.property in t)return t[e.property]}},tE=(e,t)=>{if(e.type===t.vaultType)switch(t.vaultType){case eC.k.Identity:switch(e.property){case"birthDate":return{date:tg(t),defaultFormat:e2.FORMAT_MM_DD_YYYY,defaultSeparator:e6.SEPARATOR_SLASH};case"birthYear":return{date:{year:t.birthYear},defaultFormat:e2.FORMAT_YYYY,defaultSeparator:e6.SEPARATOR_NOTHING}}break;case eC.k.PaymentCard:switch(e.property){case"expireDate":return{date:tf(t),defaultFormat:e2.FORMAT_MM_YY,defaultSeparator:e6.SEPARATOR_SLASH};case"expireYear":return{date:{year:t.expireYear},defaultFormat:e2.FORMAT_YYYY,defaultSeparator:e6.SEPARATOR_NOTHING}}break;case eC.k.DriverLicense:switch(e.property){case"expirationDateFull":return{date:e3(t),defaultFormat:e2.FORMAT_DD_MM_YYYY,defaultSeparator:e6.SEPARATOR_SLASH};case"expirationYear":return{date:{year:String(t.expirationYear)},defaultFormat:e2.FORMAT_YYYY,defaultSeparator:e6.SEPARATOR_NOTHING};case"issueDateFull":return{date:e5(t),defaultFormat:e2.FORMAT_DD_MM_YYYY,defaultSeparator:e6.SEPARATOR_SLASH};case"issueYear":return{date:{year:String(t.issueYear)},defaultFormat:e2.FORMAT_YYYY,defaultSeparator:e6.SEPARATOR_NOTHING}}break;case eC.k.IdCard:switch(e.property){case"expirationDateFull":return{date:e8(t),defaultFormat:e2.FORMAT_DD_MM_YYYY,defaultSeparator:e6.SEPARATOR_SLASH};case"expirationYear":return{date:{year:String(t.expirationYear)},defaultFormat:e2.FORMAT_YYYY,defaultSeparator:e6.SEPARATOR_NOTHING};case"issueDateFull":return{date:e9(t),defaultFormat:e2.FORMAT_DD_MM_YYYY,defaultSeparator:e6.SEPARATOR_SLASH};case"issueYear":return{date:{year:String(t.issueYear)},defaultFormat:e2.FORMAT_YYYY,defaultSeparator:e6.SEPARATOR_NOTHING}}break;case eC.k.Passport:switch(e.property){case"expirationDateFull":return{date:ty(t),defaultFormat:e2.FORMAT_DD_MM_YYYY,defaultSeparator:e6.SEPARATOR_SLASH};case"expirationYear":return{date:{year:String(t.expirationYear)},defaultFormat:e2.FORMAT_YYYY,defaultSeparator:e6.SEPARATOR_NOTHING};case"issueDateFull":return{date:tb(t),defaultFormat:e2.FORMAT_DD_MM_YYYY,defaultSeparator:e6.SEPARATOR_SLASH};case"issueYear":return{date:{year:String(t.issueYear)},defaultFormat:e2.FORMAT_YYYY,defaultSeparator:e6.SEPARATOR_NOTHING}}}},tv=async(e,t)=>{if((await e.connectors.carbon.getUserLoginStatus()).loggedIn){let a=await (0,ex.O)(e.connectors.grapheneClient.linkedWebsites.queries.getDashlaneDefinedLinkedWebsites({url:t}));if((0,eI.d6)(a))return a.data}return[]},tR=async(e,t,a)=>{try{let r=await (0,eT.z)(e.connectors.grapheneClient.autofillSecurity.queries.isPhishingPreventionDisabledForUrl({credentialUrl:t,pasteDestinationUrl:a}));if((0,eI.d6)(r))return r.data;return!1}catch(t){return e.logException(t,{message:"Error when checking phishing prevention for url",fileName:"get.ts",funcName:"getPhishingPreventionDisabledForUrl"}),!1}},tN=async e=>{let t={hasLimit:!1},a=await (0,ex.O)(e.connectors.grapheneClient.passwordLimit.queries.getPasswordLimitStatus());return(0,eI.d6)(a)&&(t=(0,eI.db)(a)),{shouldShowPasswordLimitReached:t.hasLimit&&t.passwordsLeft<1,shouldShowNearPasswordLimit:t.hasLimit&&t.passwordsLeft>0&&t.passwordsLeft<=5,passwordsLeft:t.hasLimit?t.passwordsLeft:void 0,limit:t.hasLimit?t.limit:void 0}},tF=async e=>{let t=!1,a=!1;try{let r=await eF(e.connectors),i=await e.connectors.carbon.getNodePremiumStatus(),n=i.b2bStatus?.currentTeam;if(n&&(t=n.isSoftDiscontinued&&!!n.isTrial&&(n.teamMembership.isBillingAdmin||n.teamMembership.isTeamAdmin)),r){let t=await (0,eT.z)(e.connectors.grapheneClient.passwordLimit.queries.isFreeUserFrozen());a=(0,eI.d6)(t)&&t.data}}catch(t){e.logException(t,{message:"Error when gathering frozen account infos",fileName:"get.ts",funcName:"checkIsAccountFrozen"})}return{isB2BDiscontinued:t,isB2CFrozen:a,isAccountFrozen:t||a}},t_=(e,t,a,r)=>({log_type:e,category:t,date_time:new Date().getTime(),schema_version:"1.0.0",is_sensitive:r,uuid:(0,ef.Z)().toUpperCase(),properties:a}),tD=(e,t,a=!0)=>t_(e,eS.s.ItemUsage,t,a),tL={[eC.k.Credential]:eS.b.UserCopiedCredentialField,[eC.k.BankAccount]:eS.b.UserCopiedBankAccountField,[eC.k.PaymentCard]:eS.b.UserCopiedCreditCardField},tG=async(e,t,a,r)=>{let i=await eD(e.connectors),n=await e.connectors.carbon.getNodePremiumStatus();if(i&&n.b2bStatus?.currentTeam&&""!==r.itemSpaceId){let t;let a=tL[r.itemType];switch(a){case eS.b.UserCopiedCredentialField:t=tD(a,{field:r.field,credential_domain:r.title,credential_login:r.login??""});break;case eS.b.UserCopiedBankAccountField:case eS.b.UserCopiedCreditCardField:t=tD(a,{field:r.field,name:r.title});break;default:throw Error("sendPropertyCopiedActivityLogHandler: unknown log type")}await e.connectors.grapheneClient.activityLogs.commands.storeActivityLogs({activityLogs:[t]})}},tU=e=>{if(!e.message.includes("TIMED_OUT"))throw e},tx=async e=>Object.keys((await e.state.tab.get()).persistentWebcards??{}).length>0,tB=async(e,t)=>{let a=(await e.state.tab.get()).persistentWebcards??{};return!Object.keys(a).some(e=>a[e].webcardType===t)},tO=async(e,t,a)=>{let r=await e.state.tab.get();return!!await tB(e,a.webcardType)&&(await e.state.tab.set({...r,persistentWebcards:{...r.persistentWebcards,[a.webcardId]:a}}),t.showWebcard(es.MainFrame,a),!0)},tV=async(e,t)=>{let a=await e.state.tab.get();if(a.persistentWebcards){let{persistentWebcards:r,...i}=a;if((await e.connectors.carbon.getUserLoginStatus()).loggedIn)for(let e in r)r[e].isRestoredWebcard=!0,t.showWebcard(es.MainFrame,r[e]);else await e.state.tab.set({...i})}},tW=async(e,t)=>{let a=await e.state.tab.get();if(a.persistentWebcards){let{persistentWebcards:r,...i}=a,{[t]:n,...s}=r;n&&await e.state.tab.set({...i,persistentWebcards:{...s}})}},tY=async(e,t)=>{let{[t]:a}=(await e.state.tab.get()).persistentWebcards??{};return a},tK=async(e,t)=>{let a=await e.state.tab.get();a.persistentWebcards&&t.webcardId in a.persistentWebcards&&await e.state.tab.set({...a,persistentWebcards:{...a.persistentWebcards,[t.webcardId]:t}})};var tH=a(95871),tq=a(74791),tz=a(19015),tj=a(66407);let tZ=e=>(0,tH.Wm)(e.type),tJ=e=>(0,tH.$b)(e.type),t$=e=>(0,tH.Wm)(e.type);var tQ=((p={}).Fill="fill",p.Click="click",p),tX=((m={}).Automatic="automatic",m.Webcard="webcard",m.UserAppliedAutofillCorrection="autofillCorrection",m);let t0=e=>tZ(e.dataSource),t1=e=>tJ(e.dataSource);var t4=((g={}).TemporarilyDisable="temporarilyDisable",g.PermanentlyDisable="permanentlyDisable",g);let t2={password:[{extraValues:[],source:{[eC.k.Credential]:"password"}},{extraValues:["new"],source:{[tH.JV.NewPassword]:tH.JV.NewPassword}},{extraValues:["confirmation"],source:{[tH.JV.NewPassword]:tH.JV.NewPassword}}],otp:[{extraValues:[],source:{[eC.k.Credential]:"otpSecret"}}]},t6={email:[{extraValues:[],source:{[eC.k.Credential]:"email",[eC.k.Email]:"email"}}]},t3={address:[{extraValues:[],source:{[eC.k.Address]:"addressFull"}},{extraValues:["extra"],source:{}},{extraValues:["zip"],source:{[eC.k.Address]:"zipCode"}},{extraValues:["city"],source:{[eC.k.Address]:"city"}},{extraValues:["country"],source:{[eC.k.Address]:"country"}},{extraValues:["region"],source:{[eC.k.Address]:"state"}},{extraValues:["department"],source:{[eC.k.Address]:"stateLevel2"}},{extraValues:["street"],source:{[eC.k.Address]:"addressFull"}},{extraValues:["street_number"],source:{[eC.k.Address]:"streetNumber"}},{extraValues:["door"],source:{[eC.k.Address]:"door"}},{extraValues:["building"],source:{[eC.k.Address]:"building"}},{extraValues:["code"],source:{[eC.k.Address]:"digitCode"}},{extraValues:["floor"],source:{[eC.k.Address]:"floor"}},{extraValues:["street_type"],source:{[eC.k.Address]:"streetTitle"}},{extraValues:["stairway"],source:{[eC.k.Address]:"stairs"}},{extraValues:["address_name"],source:{[eC.k.Address]:"addressName"}}],company:[{extraValues:[],source:{[eC.k.Company]:"name"}},{extraValues:["company_name"],source:{[eC.k.Company]:"name"}},{extraValues:["job"],source:{[eC.k.Company]:"jobTitle"}}],date:[{extraValues:[],source:{}},{extraValues:["day"],source:{}},{extraValues:["month"],source:{}},{extraValues:["year"],source:{}},{extraValues:["birth"],source:{[eC.k.Identity]:"birthDate"}},{extraValues:["birth","day"],source:{[eC.k.Identity]:"birthDay"}},{extraValues:["birth","month"],source:{[eC.k.Identity]:"birthMonth"}},{extraValues:["birth","year"],source:{[eC.k.Identity]:"birthYear"}},{extraValues:["birth","month","day"],source:{[eC.k.Identity]:"birthMonth"}},{extraValues:["birth","year","day"],source:{[eC.k.Identity]:"birthYear"}}],email:[{extraValues:[],source:{[eC.k.Email]:"email"}},{extraValues:["confirmation"],source:{[eC.k.Email]:"email"}}],id_document:[{extraValues:[],source:{}},{extraValues:["ssn"],source:{[eC.k.SocialSecurityId]:"idNumber"}},{extraValues:["tax"],source:{[eC.k.FiscalId]:"idNumber"}},{extraValues:["ssn","tax"],source:{[eC.k.SocialSecurityId]:"idNumber",[eC.k.FiscalId]:"idNumber"}}],name:[{extraValues:[],source:{[eC.k.Identity]:"fullName"}},{extraValues:["first"],source:{[eC.k.Identity]:"firstName"}},{extraValues:["last"],source:{[eC.k.Identity]:"lastName"}},{extraValues:["middle"],source:{[eC.k.Identity]:"middleName"}},{extraValues:["middle","middle_initials"],source:{[eC.k.Identity]:"middleNameInitial"}},{extraValues:["bank_account"],source:{[eC.k.BankAccount]:"owner"}},{extraValues:["credit_card"],source:{[eC.k.PaymentCard]:"ownerName"}},{extraValues:["drivers_license"],source:{[eC.k.DriverLicense]:"name"}},{extraValues:["id_card"],source:{[eC.k.IdCard]:"name"}},{extraValues:["ssn"],source:{[eC.k.SocialSecurityId]:"name"}}],phone:[{extraValues:[],source:{[eC.k.Phone]:"number"}},{extraValues:["type"],source:{[eC.k.Phone]:"type"}}],title:[{extraValues:["gender"],source:{[eC.k.Identity]:"title"}},{extraValues:["job"],source:{[eC.k.Company]:"jobTitle"}}],username:[{extraValues:[],source:{[eC.k.Identity]:"pseudo"}}]},t5={otp:[{extraValues:[],source:{[eC.k.Credential]:"otpSecret"}}]},t8={address:[{extraValues:[],source:{[eC.k.Address]:"addressFull"}},{extraValues:["extra"],source:{}},{extraValues:["birth"],source:{[eC.k.Identity]:"birthPlace"}},{extraValues:["zip"],source:{[eC.k.Address]:"zipCode"}},{extraValues:["city"],source:{[eC.k.Address]:"city"}},{extraValues:["country"],source:{[eC.k.Address]:"country"}},{extraValues:["region"],source:{[eC.k.Address]:"state"}},{extraValues:["department"],source:{[eC.k.Address]:"stateLevel2"}},{extraValues:["street"],source:{[eC.k.Address]:"addressFull"}},{extraValues:["street_number"],source:{[eC.k.Address]:"streetNumber"}},{extraValues:["door"],source:{[eC.k.Address]:"door"}},{extraValues:["building"],source:{[eC.k.Address]:"building"}},{extraValues:["code"],source:{[eC.k.Address]:"digitCode"}},{extraValues:["floor"],source:{[eC.k.Address]:"floor"}},{extraValues:["street_type"],source:{[eC.k.Address]:"streetTitle"}},{extraValues:["stairway"],source:{[eC.k.Address]:"stairs"}},{extraValues:["address_name"],source:{[eC.k.Address]:"addressName"}}],date:[{extraValues:[],source:{}},{extraValues:["day"],source:{}},{extraValues:["month"],source:{}},{extraValues:["year"],source:{}},{extraValues:["birth"],source:{[eC.k.Identity]:"birthDate"}},{extraValues:["birth","day"],source:{[eC.k.Identity]:"birthDay"}},{extraValues:["birth","month"],source:{[eC.k.Identity]:"birthMonth"}},{extraValues:["birth","year"],source:{[eC.k.Identity]:"birthYear"}},{extraValues:["birth","month","day"],source:{[eC.k.Identity]:"birthMonth"}},{extraValues:["birth","year","day"],source:{[eC.k.Identity]:"birthYear"}},{extraValues:["issue","drivers_license","day"],source:{[eC.k.DriverLicense]:"issueDay"}},{extraValues:["issue","drivers_license","month"],source:{[eC.k.DriverLicense]:"issueMonth"}},{extraValues:["issue","drivers_license","year"],source:{[eC.k.DriverLicense]:"issueYear"}},{extraValues:["issue","id_card","day"],source:{[eC.k.IdCard]:"issueDay"}},{extraValues:["issue","id_card","month"],source:{[eC.k.IdCard]:"issueMonth"}},{extraValues:["issue","id_card","year"],source:{[eC.k.IdCard]:"issueYear"}},{extraValues:["issue","passport","day"],source:{[eC.k.Passport]:"issueDay"}},{extraValues:["issue","passport","month"],source:{[eC.k.Passport]:"issueMonth"}},{extraValues:["issue","passport","year"],source:{[eC.k.Passport]:"issueYear"}},{extraValues:["expiration","drivers_license","day"],source:{[eC.k.DriverLicense]:"expirationDay"}},{extraValues:["expiration","drivers_license","month"],source:{[eC.k.DriverLicense]:"expirationMonth"}},{extraValues:["expiration","drivers_license","year"],source:{[eC.k.DriverLicense]:"expirationYear"}},{extraValues:["expiration","id_card","day"],source:{[eC.k.IdCard]:"expirationDay"}},{extraValues:["expiration","id_card","month"],source:{[eC.k.IdCard]:"expirationMonth"}},{extraValues:["expiration","id_card","year"],source:{[eC.k.IdCard]:"expirationYear"}},{extraValues:["expiration","passport","day"],source:{[eC.k.Passport]:"expirationDay"}},{extraValues:["expiration","passport","month"],source:{[eC.k.Passport]:"expirationMonth"}},{extraValues:["expiration","passport","year"],source:{[eC.k.Passport]:"expirationYear"}}],id_document:[{extraValues:[],source:{}},{extraValues:["drivers_license"],source:{[eC.k.DriverLicense]:"idNumber"}},{extraValues:["drivers_license","citizenship"],source:{[eC.k.DriverLicense]:"country"}},{extraValues:["id_card"],source:{[eC.k.IdCard]:"idNumber"}},{extraValues:["id_card","citizenship"],source:{[eC.k.IdCard]:"country"}},{extraValues:["passport"],source:{[eC.k.Passport]:"idNumber"}},{extraValues:["passport","citizenship"],source:{[eC.k.Passport]:"country"}},{extraValues:["ssn"],source:{[eC.k.SocialSecurityId]:"idNumber"}},{extraValues:["ssn","citizenship"],source:{[eC.k.SocialSecurityId]:"country"}},{extraValues:["tax"],source:{[eC.k.FiscalId]:"idNumber"}},{extraValues:["tax","citizenship"],source:{[eC.k.FiscalId]:"country"}}],otp:[{extraValues:[],source:{[eC.k.Credential]:"otpSecret"}}],website:[{extraValues:[],source:{[eC.k.PersonalWebsite]:"website"}}]},t9={action:[{extraValues:[],source:{}},{extraValues:["forgot_password"],source:{}},{extraValues:["login"],source:{[tH.JV.SubmitButton]:tH.JV.SubmitButton}},{extraValues:["next"],source:{[tH.JV.SubmitButton]:tH.JV.SubmitButton}}],email:[{extraValues:[],source:{[eC.k.Credential]:"email",[eC.k.Email]:"email"}}],otp:[{extraValues:[],source:{[eC.k.Credential]:"otpSecret"}}],password:[{extraValues:[],source:{[eC.k.Credential]:"password",[eC.k.GeneratedPassword]:"password"}}],username:[{extraValues:[],source:{[eC.k.Credential]:"login"}},{extraValues:["secondary"],source:{[eC.k.Credential]:"secondaryLogin"}}],id_document:[{extraValues:["ssn"],source:{[eC.k.Credential]:"login",[eC.k.SocialSecurityId]:"idNumber"}},{extraValues:["tax"],source:{[eC.k.Credential]:"login",[eC.k.FiscalId]:"idNumber"}},{extraValues:["ssn","tax"],source:{[eC.k.Credential]:"login",[eC.k.SocialSecurityId]:"idNumber",[eC.k.FiscalId]:"idNumber"}}]},t7={email:[{extraValues:[],source:{[eC.k.Credential]:"email",[eC.k.Email]:"email"}}],password:[{extraValues:[],source:{[eC.k.Credential]:"password",[tH.JV.NewPassword]:tH.JV.NewPassword}}],otp:[{extraValues:[],source:{[eC.k.Credential]:"otpSecret"}}],username:[{extraValues:[],source:{[eC.k.Passkey]:"userDisplayName",[eC.k.Identity]:"pseudo"}}]},ae={date:[{extraValues:[],source:{}},{extraValues:["credit_card","expiration"],source:{[eC.k.PaymentCard]:"expireDate"}},{extraValues:["credit_card","expiration","month"],source:{[eC.k.PaymentCard]:"expireMonth"}},{extraValues:["credit_card","expiration","year"],source:{[eC.k.PaymentCard]:"expireYear"}}],name:[{extraValues:[],source:{}},{extraValues:["first"],source:{[eC.k.Identity]:"firstName"}},{extraValues:["last"],source:{[eC.k.Identity]:"lastName"}},{extraValues:["bank_account"],source:{[eC.k.BankAccount]:"owner"}},{extraValues:["credit_card"],source:{[eC.k.PaymentCard]:"ownerName"}}],payment:[{extraValues:[],source:{}},{extraValues:["bank_account"],source:{[eC.k.BankAccount]:"name"}},{extraValues:["bank_account","bank_name"],source:{[eC.k.BankAccount]:"bankCode"}},{extraValues:["bank_account","bic"],source:{[eC.k.BankAccount]:"BIC"}},{extraValues:["bank_account","iban"],source:{[eC.k.BankAccount]:"IBAN"}},{extraValues:["bank_account","bank_code"],source:{[eC.k.BankAccount]:"BIC"}},{extraValues:["bank_account","number"],source:{[eC.k.BankAccount]:"IBAN"}},{extraValues:["credit_card"],source:{}},{extraValues:["credit_card","expiration"],source:{[eC.k.PaymentCard]:"expireDate"}},{extraValues:["credit_card","number"],source:{[eC.k.PaymentCard]:"cardNumber"}},{extraValues:["credit_card","cvv"],source:{[eC.k.PaymentCard]:"securityCode"}},{extraValues:["credit_card","type"],source:{[eC.k.PaymentCard]:"type"}}],otp:[{extraValues:[],source:{[eC.k.Credential]:"otpSecret"}}]},at={billing:{},change_password:t2,contact:t6,default:t3,forgot_password:t5,identity:t8,login:t9,newsletter:{},other:t7,payment:ae,register:{password:[{extraValues:[],source:{[tH.JV.NewPassword]:tH.JV.NewPassword}},{extraValues:["new"],source:{[tH.JV.NewPassword]:tH.JV.NewPassword}}],date:[{extraValues:[],source:{}},{extraValues:["day"],source:{}},{extraValues:["month"],source:{}},{extraValues:["year"],source:{}},{extraValues:["birth"],source:{[eC.k.Identity]:"birthDate"}},{extraValues:["birth","day"],source:{[eC.k.Identity]:"birthDay"}},{extraValues:["birth","month"],source:{[eC.k.Identity]:"birthMonth"}},{extraValues:["birth","year"],source:{[eC.k.Identity]:"birthYear"}},{extraValues:["birth","month","day"],source:{[eC.k.Identity]:"birthMonth"}},{extraValues:["birth","year","day"],source:{[eC.k.Identity]:"birthYear"}},{extraValues:["credit_card","expiration"],source:{[eC.k.PaymentCard]:"expireDate"}},{extraValues:["credit_card","expiration","month"],source:{[eC.k.PaymentCard]:"expireMonth"}},{extraValues:["credit_card","expiration","year"],source:{[eC.k.PaymentCard]:"expireYear"}}],otp:[{extraValues:[],source:{[eC.k.Credential]:"otpSecret"}}],payment:[{extraValues:[],source:{}},{extraValues:["bank_account"],source:{[eC.k.BankAccount]:"name"}},{extraValues:["bank_account","bank_name"],source:{[eC.k.BankAccount]:"bankCode"}},{extraValues:["bank_account","bic"],source:{[eC.k.BankAccount]:"BIC"}},{extraValues:["bank_account","iban"],source:{[eC.k.BankAccount]:"IBAN"}},{extraValues:["bank_account","bank_code"],source:{[eC.k.BankAccount]:"BIC"}},{extraValues:["bank_account","number"],source:{[eC.k.BankAccount]:"IBAN"}},{extraValues:["credit_card"],source:{}},{extraValues:["credit_card","expiration"],source:{[eC.k.PaymentCard]:"expireDate"}},{extraValues:["credit_card","number"],source:{[eC.k.PaymentCard]:"cardNumber"}},{extraValues:["credit_card","cvv"],source:{[eC.k.PaymentCard]:"securityCode"}},{extraValues:["credit_card","type"],source:{[eC.k.PaymentCard]:"type"}}]},search:{},shipping:{},shopping_basket:{}},aa=["login","register","identity","change_password","payment","billing","shipping","forgot_password","contact","newsletter","search","shopping_basket","other","default"],ar=["action","address","age","captcha","company","consent","date","email","id_document","name","other","otp","password","payment","phone","query","title","username","website","webauthn"],ai=["birth","day","expiration","issue","month","year"],an=["citizenship","drivers_license","id_card","passport","ssn","tax"],as=["billing","shipping"],ao=["part","extra"],al=["bank_account","bank_code","bank_name","bic","credit_card","cvv","iban","number","swift","type"],ad=["confirmation","new","secondary"],ac=["job","gender"],au={action:["change_password","forgot_login","forgot_password","login","logout","my_account","next","register","search","subscribe"],address:["address_name","birth","box","building","city","country","department","door","floor","region","stairway","street","street_number","street_type","zip","code",...an,...al,...as,...ao],age:[],captcha:[],company:["company_name",...ac,...ao],consent:["newsletter","privacy_policy","rememberme","terms"],date:[...ai,...an,...al],email:[...ad,"local_part","domain_part"],name:["first","last","maiden","middle","middle_initials",...an,...ac,...al,...as,...ao],id_document:[...an,...ao],other:[],otp:ao,password:[...ad,...ao],payment:[...al,...as,...ao,...ai],phone:["country","mobile","prefix","type","suffix",...ao],query:[],username:[...ad,...ao],title:ac,website:ao,webauthn:[]},ap=e=>{let t=e.toLowerCase().split(","),a=t.filter(e=>ar.includes(e)),r=t.filter(e=>!ar.includes(e));return a.map(e=>({main:e,extra:r.filter(t=>au[e].includes(t))}))},am=e=>e.toLowerCase().split(",").filter(e=>aa.includes(e));var ag=a(82219),ah=((h={}).STEP="step",h.FINAL="final",h);let aw={isRightClickMenuLive:!1};var ay=((w={}).Success="Success",w.Error="Error",w),ab=((y={}).NotSupportedError="NotSupportedError",y.SecurityError="SecurityError",y.NotAllowedError="NotAllowedError",y.InvalidStateError="InvalidStateError",y.UnknownError="UnknownError",y),af=((b={}).Create="create",b.Get="get",b),aS=((f={}).AutofillConfirmationPasswordLess="autofill-confirmation",f.AutofillDropdown="autofill-dropdown",f.AutologinSelection="autologin-selection",f.B2CFrozenDialog="b2c-frozen-dialog",f.DataCapture="data-capture",f.FeedbackNotification="feedback-notification",f.FollowUpNotification="follow-up-notification",f.LinkedWebsiteUpdateConfirmation="linked-website-update-confirmation",f.OnboardingNotification="notification",f.PhishingPrevention="phishing-prevention",f.SavePassword="save-password",f.SecurityNudge="security-nudge",f.UserVerification="user-verification",f.WarnGeneratedPassword="warn-generated-password",f.WebauthnCreateConfirmation="webauthn-create-confirmation",f.WebauthnGetConfirmation="webauthn-get-confirmation",f.WebauthnPasskeySelection="webauthn-passkey-selection",f),aC=((S={}).WebauthnRequest="webauthnRequest",S.PhishingPrevention="phishingPrevention",S.PendingOperation="pendingOperation",S),aA=((C={}).Classic="classic",C.FixAutofillIssue="fixAutofillIssue",C.GeneratePassword="pwdGenerator",C.Reactivation="reactivation",C.WebAuthnReactivation="webAuthnReactivation",C.FieldDisabledNotification="fieldDisabledNotification",C.SelfCorrecting="selfCorrecting",C.AccountFrozen="accountFrozen",C);let aI=e=>e.webcardType===aS.AutofillDropdown,aM=e=>aI(e)&&"classic"===e.configuration;var aT=((A={}).PasswordGenerationDashlaneLogin="generation",A.PossibleDuplicateRegistration="registration",A.UnsecureProtocol="unsecure",A.UnsecureIframe="unsecureIframe",A.SandboxedIframe="sandboxedIframe",A.B2BDiscontinued="b2BDiscontinued",A.NearPasswordLimit="nearPasswordLimit",A.PasswordLimitReached="passwordLimitReached",A.None="",A),ak=a(61506);function aP(e,t){return void 0!==e?t[e]:void 0}eC.k.Address,ew.ItemType.Address,eC.k.BankAccount,ew.ItemType.BankStatement,eC.k.Company,ew.ItemType.Company,eC.k.Credential,ew.ItemType.Credential,eC.k.DriverLicense,ew.ItemType.DriverLicense,eC.k.Email,ew.ItemType.Email,eC.k.FiscalId,ew.ItemType.FiscalStatement,eC.k.GeneratedPassword,ew.ItemType.GeneratedPassword,eC.k.IdCard,ew.ItemType.IdCard,eC.k.Identity,ew.ItemType.Identity,eC.k.Passkey,ew.ItemType.Passkey,eC.k.Passport,ew.ItemType.Passport,eC.k.PaymentCard,ew.ItemType.CreditCard,eC.k.PersonalWebsite,ew.ItemType.Website,eC.k.Phone,ew.ItemType.Phone,eC.k.SocialSecurityId,ew.ItemType.SocialSecurity;let aE={login:ew.FormType.Login,register:ew.FormType.Register,identity:ew.FormType.Identity,change_password:ew.FormType.ChangePassword,payment:ew.FormType.Payment,billing:ew.FormType.Billing,shipping:ew.FormType.Shipping,forgot_password:ew.FormType.ForgotPassword,contact:ew.FormType.Contact,newsletter:ew.FormType.Newsletter,search:ew.FormType.Search,shopping_basket:ew.FormType.ShoppingBasket,other:ew.FormType.Other};aT.PasswordGenerationDashlaneLogin,ew.AutofillMessageType.LoginAccountPasswordGeneration,aT.PossibleDuplicateRegistration,ew.AutofillMessageType.DuplicateRisk,aT.UnsecureProtocol,ew.AutofillMessageType.HttpUnsecureWebsite,aT.UnsecureIframe,ew.AutofillMessageType.UnsecureIframe,aT.SandboxedIframe,ew.AutofillMessageType.UnsecureIframeSandbox,aT.PasswordLimitReached,ew.AutofillMessageType.FreeAccountPasswordLimitReached,aT.None,ew.AutofillMessageType.HttpUnsecureWebsite;let av={"cross-platform":ew.AuthenticatorAttachment.CrossPlatform,platform:ew.AuthenticatorAttachment.Platform},aR={discouraged:ew.AuthenticatorResidentKey.Discouraged,preferred:ew.AuthenticatorResidentKey.Preferred,required:ew.AuthenticatorResidentKey.Required},aN={discouraged:ew.AuthenticatorUserVerification.Discouraged,preferred:ew.AuthenticatorUserVerification.Preferred,required:ew.AuthenticatorUserVerification.Required},aF={[ab.InvalidStateError]:ew.PasskeyRegistrationErrorType.InvalidState,[ab.NotAllowedError]:ew.PasskeyRegistrationErrorType.NotAllowed,[ab.NotSupportedError]:ew.PasskeyRegistrationErrorType.NotSupported,[ab.SecurityError]:ew.PasskeyRegistrationErrorType.Security,[ab.UnknownError]:ew.PasskeyRegistrationErrorType.Unknown},a_={[ab.InvalidStateError]:ew.PasskeyAuthenticationErrorType.InvalidState,[ab.NotAllowedError]:ew.PasskeyAuthenticationErrorType.NotAllowed,[ab.NotSupportedError]:ew.PasskeyAuthenticationErrorType.NotSupported,[ab.SecurityError]:ew.PasskeyAuthenticationErrorType.Security,[ab.UnknownError]:ew.PasskeyAuthenticationErrorType.Unknown},aD={conditional:ew.AuthenticationMediationType.Conditional,optional:ew.AuthenticationMediationType.Optional,required:ew.AuthenticationMediationType.Required,silent:ew.AuthenticationMediationType.Silent},aL={1:ew.AlgorithmsSupported.A128Gcm,[-3]:ew.AlgorithmsSupported.A128Kw,2:ew.AlgorithmsSupported.A192Gcm,[-4]:ew.AlgorithmsSupported.A192Kw,3:ew.AlgorithmsSupported.A256Gcm,[-5]:ew.AlgorithmsSupported.A256Kw,30:ew.AlgorithmsSupported.AesCcm16128128,31:ew.AlgorithmsSupported.AesCcm16128256,10:ew.AlgorithmsSupported.AesCcm1664128,11:ew.AlgorithmsSupported.AesCcm1664256,32:ew.AlgorithmsSupported.AesCcm64128128,33:ew.AlgorithmsSupported.AesCcm64128256,12:ew.AlgorithmsSupported.AesCcm6464128,13:ew.AlgorithmsSupported.AesCcm6464256,14:ew.AlgorithmsSupported.AesMac128128,15:ew.AlgorithmsSupported.AesMac12864,25:ew.AlgorithmsSupported.AesMac256128,26:ew.AlgorithmsSupported.AesMac25664,24:ew.AlgorithmsSupported.ChaCha20Poly1305,[-6]:ew.AlgorithmsSupported.Direct,[-12]:ew.AlgorithmsSupported.DirectHkdfAes128,[-13]:ew.AlgorithmsSupported.DirectHkdfAes256,[-10]:ew.AlgorithmsSupported.DirectHkdfSha256,[-11]:ew.AlgorithmsSupported.DirectHkdfSha512,[-32]:ew.AlgorithmsSupported.EcdhEsA128Kw,[-30]:ew.AlgorithmsSupported.EcdhEsA192Kw,[-34]:ew.AlgorithmsSupported.EcdhEsA256Kw,[-31]:ew.AlgorithmsSupported.EcdhEsHkdf256,[-26]:ew.AlgorithmsSupported.EcdhEsHkdf512,[-29]:ew.AlgorithmsSupported.EcdhSsA128Kw,[-33]:ew.AlgorithmsSupported.EcdhSsA192Kw,[-25]:ew.AlgorithmsSupported.EcdhSsA256Kw,[-27]:ew.AlgorithmsSupported.EcdhSsHkdf256,[-28]:ew.AlgorithmsSupported.EcdhSsHkdf512,[-8]:ew.AlgorithmsSupported.EdDsa,[-7]:ew.AlgorithmsSupported.Es256,[-47]:ew.AlgorithmsSupported.Es256K,[-35]:ew.AlgorithmsSupported.Es384,[-36]:ew.AlgorithmsSupported.Es512,5:ew.AlgorithmsSupported.Hmac256256,4:ew.AlgorithmsSupported.Hmac25664,6:ew.AlgorithmsSupported.Hmac384384,7:ew.AlgorithmsSupported.Hmac512512,[-46]:ew.AlgorithmsSupported.HssLms,34:ew.AlgorithmsSupported.IvGeneration,[-37]:ew.AlgorithmsSupported.Ps256,[-38]:ew.AlgorithmsSupported.Ps384,[-39]:ew.AlgorithmsSupported.Ps512,0:ew.AlgorithmsSupported.Reserved,[-65535]:ew.AlgorithmsSupported.Rs1,[-257]:ew.AlgorithmsSupported.Rs256,[-258]:ew.AlgorithmsSupported.Rs384,[-259]:ew.AlgorithmsSupported.Rs512,[-40]:ew.AlgorithmsSupported.RsaesOaepWithRfc8017,[-41]:ew.AlgorithmsSupported.RsaesOaepWithSha256,[-42]:ew.AlgorithmsSupported.RsaesOaepWithSha512,[-14]:ew.AlgorithmsSupported.Sha1,[-16]:ew.AlgorithmsSupported.Sha256,[-15]:ew.AlgorithmsSupported.Sha25664,[-43]:ew.AlgorithmsSupported.Sha384,[-44]:ew.AlgorithmsSupported.Sha512,[-17]:ew.AlgorithmsSupported.Sha512256,[-18]:ew.AlgorithmsSupported.Shake128,[-45]:ew.AlgorithmsSupported.Shake256,8:ew.AlgorithmsSupported.Unassigned,[-260]:ew.AlgorithmsSupported.WalnutDsa},aG={[ak.gI.Compromised]:ew.NudgeType.CompromisedPasswords,[ak.gI.Reused]:ew.NudgeType.ReusedPasswords,[ak.gI.Weak]:ew.NudgeType.WeakPasswords};ak.gI.Compromised,ew.CallToAction.ChangeCompromisedPassword,ak.gI.Reused,ew.CallToAction.ChangeReusedPassword,ak.gI.Weak,ew.CallToAction.ChangeWeakPassword;var aU=a(63154),ax=((I={})[I.None=0]="None",I[I.VaultItem=1]="VaultItem",I[I.Global=2]="Global",I),aB=a(77326);async function aO(e){let t=await (0,eT.z)(e.connectors.grapheneClient.userVerification.queries.userVerificationMethods());if((0,eI.hx)(t))throw Error("Failure getting the user verification methods");return(0,eI.db)(t)}async function aV(e,t,a,r=(0,ef.Z)()){let i=await aO(e),n=[aB.W.Biometrics,aB.W.Pin,aB.W.MasterPassword].find(e=>i.includes(e)),s={type:aC.PendingOperation,operation:t};return{webcardType:aS.UserVerification,webcardId:r,formType:"login",neverAskAgainMode:ax.None,userLogin:await e.connectors.carbon.getUserLogin()??"",availableMethods:i,defaultMethod:n,usageLogDetails:a,metadata:{[aC.PendingOperation]:s}}}let aW={[aU.MS.CannotDisable]:ax.None,[aU.MS.DisableGeneralSetting]:ax.Global,[aU.MS.DisableSpecificVaultItem]:ax.VaultItem},aY=async(e,t,a)=>{let r=await (0,ex.O)(e.grapheneClient.autofillSecurity.queries.getAutofillProtectionContext({vaultType:a,vaultItemId:t}));return{isProtected:!!(0,eI.d6)(r)&&r.data.isProtected,neverAskAgainMode:aW[(0,eI.d6)(r)?r.data.disableMode:aU.MS.CannotDisable]}},aK=e=>({webcardId:(0,ef.Z)(),webcardType:aS.AutofillConfirmationPasswordLess,pendingOperation:e,formType:e.formClassification}),aH=async(e,t,a,r)=>{let i=await e.connectors.carbon.getIsSSOUser(),n=await e.connectors.carbon.getAccountAuthenticationType(),s={source:ew.AuthenticatorUserVerificationSource.Autofill},o=i||"masterPassword"!==n?aK(r.data):await aV(e,r,s);t.showWebcard(es.MainFrame,o)},aq=async(e,t,a,r)=>{await e.connectors.carbon.disableVaultItemProtection(r)};var az=((M={}).SimpleItem="SimpleItem",M.EnhancedItem="EnhancedItem",M);let aj=e=>{if(!e)return;let{color:t,letter:a,spaceId:r,displayName:i}=e;return{color:t,letter:a,spaceId:r,displayName:i}};function aZ(e){return e.type===aC.WebauthnRequest&&"request"in e}function aJ(e,t){return{...e,[t.type]:t}}var a$=((T={}).CopyValue="copyValue",T.ApplyAutofillDetails="applyAutofillDetails",T.Webauthn="webauthnRequest",T);let aQ=(e,t)=>{switch(e.vaultType){case eC.k.Credential:{if("password"!==t.property)return;let{id:a,email:r,login:i,url:n}=e;return{id:a,login:i||r,domain:new eB.Y(n).getHostname(),type:eC.k.Credential,spaceId:e.spaceId}}case eC.k.BankAccount:case eC.k.PaymentCard:{let{vaultType:t,name:a}=e;return{type:t,item_name:a,spaceId:e.spaceId}}default:return}},aX=async(e,t,a,r)=>{let i;let{temporaryEmitPasswordAutofillPerformedEvent:n}=e.connectors.grapheneClient.autofillTracking.commands;r.type===eC.k.Credential?(i=tD(eS.b.UserPerformedAutofillCredential,{credential_login:r.login,credential_domain:r.domain,autofilled_domain:new eB.Y(a.url).getHostname()}),await n({credentialId:r.id})):i=tD(eS.b.UserPerformedAutofillPayment,{item_name:r.item_name,item_type:r.type===eC.k.BankAccount?"bank_account":"credit_card",autofilled_domain:new eB.Y(a.url).getHostname()});let s=await e.connectors.carbon.getNodePremiumStatus();s.b2bStatus?.currentTeam&&""!==r.spaceId&&await e.connectors.grapheneClient.activityLogs.commands.storeActivityLogs({activityLogs:[i]})};var a0=a(26968),a1=((k={}).AfterLogin="webOnboardingAfterLogin",k.AfterSave="webOnboardingAfterSave",k.AfterCancel="webOnboardingAfterCancel",k);let a4=e=>({webcardId:(0,ef.Z)(),webcardType:aS.OnboardingNotification,configuration:e,formType:""}),a2=async(e,t,a)=>{let r=await e.connectors.carbon.getWebOnboardingMode();if(r.flowSaveCredentialOnWeb&&!r.completedSteps?.saveCredentialOnWeb){await tO(e,t,a4(a?a1.AfterSave:a1.AfterCancel));let i=r.completedSteps&&!r.completedSteps.saveCredentialOnWeb||r.leelooStep===a0.s.SHOW_PASSWORD_SAVE_SUCCESS?a0.s.SHOW_PASSWORD_SAVE_SUCCESS:null;return await e.connectors.legacyCarbon.updateWebOnboardingMode({flowCredentialInApp:!1,flowLoginCredentialOnWeb:!1,flowSaveCredentialOnWeb:!a,leelooStep:a?i:a0.s.SHOW_SAVE_SITES_DIALOG,popoverStep:null,completedSteps:{...r.completedSteps,...a?{saveCredentialOnWeb:a}:null}}),!0}return!1},a6=async e=>{let t=await e.connectors.carbon.getWebOnboardingMode();return!(t.flowSaveCredentialOnWeb&&!t.completedSteps?.saveCredentialOnWeb)},a3=async(e,t)=>{let a=await e.connectors.carbon.getWebOnboardingMode();a.flowLoginCredentialOnWeb&&!a.completedSteps?.loginCredentialOnWeb&&(await tO(e,t,a4(a1.AfterLogin)),await e.connectors.legacyCarbon.updateWebOnboardingMode({flowCredentialInApp:!1,flowLoginCredentialOnWeb:!1,flowSaveCredentialOnWeb:!1,leelooStep:a0.s.SHOW_WEB_SAVE_AND_AUTOLOGIN_COMPLETED,popoverStep:null,completedSteps:{...a.completedSteps,loginCredentialOnWeb:!0}}))},a5=e=>RegExp("https://(www\\.)?dashlane\\.com/([\\w-]+/)?try-autofill-demo").test(e),a8=async(e,t)=>{if(!a5(t))return;let a=await e.connectors.carbon.getWebOnboardingMode();a.flowTryAutofillOnWeb&&!a.completedSteps?.tryAutofillOnWeb&&await e.connectors.legacyCarbon.updateWebOnboardingMode({flowTryAutofillOnWeb:!1,completedSteps:{...a.completedSteps,tryAutofillOnWeb:!0}})},a9=e=>({webcardId:(0,ef.Z)(),webcardType:aS.WarnGeneratedPassword,formType:e.formClassification,pendingOperation:e}),a7=(e,t,a)=>{let r=a9(a);t.showWebcard(es.MainFrame,r)};var re=a(51376);let rt=e=>e.split("@").pop()??"",ra=e=>e.split(".").shift()??"",rr=(e,t)=>{let a=ra(t),r=eW[a]??[a],i=ra(rt(e));return r.includes(i)},ri=e=>e.startsWith("http://"),rn=(e,t)=>ap(e).some(e=>e.extra.includes(t)),rs=(e,t)=>am(e).includes(t),ro=(e,t)=>Promise.all(e.map(t)).then(t=>e.filter((e,a)=>t[a])),rl=(e,t)=>e.substring(e.indexOf(t)+t.length),rd=(e,t,a,r)=>{let i=/^:(\d+)/m,n=rl(e,t).match(i)??[],s=rl(a,r).match(i)??[];return!(n.length>0)||n[0]===s[0]},rc=(e,t)=>{let a=new eB.Y(e),r=new eB.Y(t),i=a.getRootDomain()===r.getRootDomain(),n=a.getSubdomainWithoutLeadingWww()===r.getSubdomainWithoutLeadingWww(),s=!0;r.getPathname()&&"/"!==r.getPathname()&&(s=a.getPathname()===r.getPathname());let o=rd(e,a.getRootDomain(),t,r.getRootDomain());return i&&n&&s&&o},ru=(e,t)=>{let a=new eB.Y(t),r=a.getETLD(),i=a.getRootDomain(),n=e.url,s=new eB.Y(n),o=s.getRootDomain(),l=s.getHostname();if(eK.includes(r)&&r!==l&&o!==i)return!1;let d=eY.includes(i);return e.subdomainOnly||d?rc(t,n)||e.userAddedLinkedWebsites.some(e=>rc(t,e)):e.matchType!==ew.MatchType.UserAssociatedWebsite||e.userAddedLinkedWebsites.some(e=>t.includes(new eB.Y(e).getHostname()))},rp=(e,t)=>"string"==typeof e&&e in t,rm=e=>e.ingredient.type===eC.k.Credential&&rp(e.ingredient.property,e.vaultItem),rg=e=>e.ingredient.type===eC.k.Address&&rp(e.ingredient.property,e.vaultItem),rh=e=>e.vaultType===eC.k.Credential?e.matchType:ew.MatchType.Regular,rw=async()=>{let e="silent_deploy";try{let t=await (0,re.U)();return"object"==typeof t&&null!==t&&e in t&&!0===t[e]}catch{return!1}},ry=async(e,t)=>{let a=await (0,ex.O)(e.grapheneClient.otp.queries.otpCode({credentialId:t}));return(0,eI.d6)(a)?a.data?.code:void 0},rb=async(e,t,a)=>{let r=a[t.property];if(("email"===t.property||"login"===t.property)&&(r||=a.email||a.login),"otpSecret"===t.property){r=a.hasOtp?await ry(e,a.id):void 0;let i=tP(t);if(i&&"string"==typeof r&&r.length)return i({...a,otpSecret:r},t.format)}return r?.toString()},rf=(e,t)=>{let a=t[e.property];return"addressFull"===e.property&&ez(t)&&(a=`${t.streetNumber} ${t.addressFull}`),a?.toString()},rS=async(e,t)=>{let a=tP(t.ingredient);if(a&&"otpSecret"!==t.ingredient.property)return a(t.vaultItem,t.ingredient.format);if(!rp(t.ingredient.property,t.vaultItem))return;if(rm(t))return await rb(e,t.ingredient,t.vaultItem);if(rg(t))return rf(t.ingredient,t.vaultItem);let r=t.vaultItem[t.ingredient.property];return r?r.toString():void 0},rC=async({context:e,operations:t,frameId:a,fieldId:r,ingredient:i,dataSource:n,focusedElement:s,selectedVaultItem:o})=>{if(i.type!==n.type)return;let l=await rS(e,{ingredient:i,vaultItem:o}),d=tE(i,o);(l||d?.date)&&(t.matchType===ew.MatchType.Regular&&(t.matchType=rh(o)),t.itemInfos=t.itemInfos??aQ(o,i),t[tQ.Fill].push({operationType:tQ.Fill,frameId:a,srcElementId:r,dataSource:d?.date?{type:n.type,date:d.date,format:tr(i.format?.dateFormat,d.defaultFormat),separator:ti(i.format?.dateSeparator,d.defaultSeparator)}:{type:n.type,value:l},forceAutofill:s?.elementId===r&&s.frameId===a||n.type===eC.k.Credential,canCopy:o.vaultType!==eC.k.Credential||!o.sharingStatus?.isShared||o.sharingStatus.canCopy,canEdit:o.vaultType!==eC.k.Credential||!o.sharingStatus?.isShared||o.sharingStatus.canEdit,canReveal:o.vaultType!==eC.k.Credential||!o.sharingStatus?.isShared||o.sharingStatus.canReveal}))},rA=async(e,t,a,r)=>{let i=await e.state.tab.get(),n=a.type===tX.Webcard&&a.webcardType===aS.AutologinSelection,s=a.type===tX.Automatic&&i.lastAutologin?.domain!==t.tabRootDomain,o=a.type===tX.Automatic&&i.lastAutologin?.domain===t.tabRootDomain&&!!i.lastAutologin.isMultiSteps&&!!i.lastAutologin.step&&i.lastAutologin.step!==ah.FINAL&&!t.formClassification.includes(ah.STEP)&&!t.formClassification.includes(i.lastAutologin.step);return!!r&&"autoLogin"in r&&r.autoLogin&&(n||s||o)},rI=async({context:e,operations:t,frameId:a,fieldId:r,ingredient:i,dataSource:n,focusedElement:s,selectedVaultItem:o,isAutologin:l,requestOrigin:d})=>{if(i.type===n.type){if(n.type===tH.JV.WebauthnConditionalUI)throw Error("Cannot build fill operation for webauthn conditional UI");if(n.type===tH.JV.NewPassword)t[tQ.Fill].push({operationType:tQ.Fill,frameId:a,srcElementId:r,dataSource:{type:eC.k.GeneratedPassword,value:n.value},forceAutofill:!0,canCopy:!1,canEdit:!1,canReveal:!1});else if(t$(i)&&o){if(l&&!await rA(e,t,d,o))return;await rC({context:e,operations:t,frameId:a,fieldId:r,ingredient:i,dataSource:n,focusedElement:s,selectedVaultItem:o})}}},rM=async({context:e,operations:t,frameId:a,fieldId:r,ingredient:i,dataSource:n,requestOrigin:s,selectedVaultItem:o})=>{await rA(e,t,s,o)&&i.type===tH.JV.SubmitButton&&n.type===eC.k.Credential&&t[tQ.Click].push({operationType:tQ.Click,frameId:a,srcElementId:r})},rT=e=>{let t=e.type===tX.Webcard&&e.webcardType===aS.AutologinSelection;return e.type===tX.Automatic||t},rk=async(e,t,a,r)=>{let i={formClassification:a.formClassification,requestOrigin:a.requestOrigin,tabRootDomain:new eB.Y(t.tab?.url??"").getRootDomain(),[tQ.Fill]:[],[tQ.Click]:[],matchType:ew.MatchType.Regular},n=a.autofillRecipe,s={context:e,operations:i,requestOrigin:a.requestOrigin,dataSource:a.dataSource,focusedElement:a.focusedElement,selectedVaultItem:r},o=rT(a.requestOrigin);for(let{frameId:e,srcElementId:t,ingredient:a}of n.ingredients)await rI({...s,frameId:e,fieldId:t,ingredient:a,isAutologin:o});let l=n.ingredients.filter(e=>e.ingredient.type===tH.JV.SubmitButton),d=l.find(e=>e.fieldClassification.includes("login"))??l.find(e=>e.fieldClassification.includes("next"))??l[0];return s.operations[tQ.Fill].length>0&&d&&await rM({...s,frameId:d.frameId,fieldId:d.srcElementId,ingredient:d.ingredient}),i},rP=async(e,t,a,r)=>{let i=a.autofillRecipe.postfillRecipes;if(i){for(let[n,s]of Object.entries(i))if((0,tH.Wm)(n)){let i=await tA({context:e,url:r,vaultType:n,queryOptions:{sortCriteria:[{field:"lastUse",direction:"descend"}],filterCriteria:[],maxNumberOfItems:1},limit:1});if(i.length>0&&!(await aY(e,i[0].id,i[0].vaultType)).isProtected){let r=i[0];for(let{frameId:i,srcElementId:o,ingredient:l}of s.ingredients)await rI({context:e,operations:t,frameId:i,fieldId:o,ingredient:l,dataSource:{type:n,vaultId:r.id},requestOrigin:a.requestOrigin,selectedVaultItem:r})}}}},rE=async(e,t,a,r)=>{if(a.tab?.url)switch(r.dataSource.type){case tH.JV.WebauthnConditionalUI:break;case tH.JV.NewPassword:{e.connectors.carbon.saveGeneratedPassword({password:r.dataSource.value,url:new eB.Y(a.tab.url).getRootDomain()});let i=await rk(e,a,r);t.applyAutofillOperationsAndTriggerDataCapture(es.AllFrames,i)}}},rv=(e,t)=>e.getRootDomain()===t.getRootDomain()&&""!==t.getSubdomain(),rR=async(e,t,a,r,i)=>{let n=i.getHostname();if(r?.vaultType===eC.k.Credential&&new eB.Y(r.url).getHostname()!==n){let s=await (0,eT.z)(e.grapheneClient.autofillSettings.queries.getPreferencesForCredentials({credentialIds:[r.id]})),o=await (0,eT.z)(e.grapheneClient.linkedWebsites.queries.getDashlaneDefinedLinkedWebsites({url:r.url})),l=rv(new eB.Y(r.url),i);if((!(0,eI.d6)(s)||!l||"www"!==i.getSubdomain()&&s.data[0]?.onlyAutofillExactDomain)&&!r.userAddedLinkedWebsites.includes(n)&&(0,eI.d6)(o)&&!o.data.includes(n)){let i={webcardId:(0,ef.Z)(),webcardType:aS.LinkedWebsiteUpdateConfirmation,formType:"",operation:{credentialId:a.dataSource.vaultId,credentialName:r.title,linkedWebsite:n}},s=await e.connectors.grapheneClient.linkedWebsites.commands.addLinkedWebsite({credentialId:a.dataSource.vaultId,linkedWebsite:n});(0,eI.d6)(s)&&await tO(e,t,i)}}},rN=async(e,t,a,r)=>{if(!a.tab?.url)return;if(!t0(r))throw Error(`Error: applyAutofillRecipeForVaultDataSourceHandler called without a VaultDataSource '${r}'`);if((await aY(e,r.dataSource.vaultId,r.dataSource.type)).isProtected)throw Error("Error: applyAutofillRecipeForVaultDataSourceHandler called with password protected items");let i=new eB.Y(a.tab.url),n=i.getRootDomain();await e.connectors.legacyCarbon.filledDataItem({dataType:tz.Z[r.dataSource.type],id:r.dataSource.vaultId,url:a.tab.url});let s=await tC(e,r.dataSource.type,r.dataSource.vaultId),o=await rk(e,a,r,s);if(o[tQ.Fill].length>0){r.autofillRecipe.postfillRecipes&&await rP(e,o,r,n);let a=await e.state.tab.get(),{isRecipeForAutologin:l,isMultiSteps:d,step:c}=iC(r.autofillRecipe,r.formClassification);l&&o[tQ.Click].length>0&&await e.state.tab.set({...a,lastAutologin:{domain:n,isMultiSteps:d,step:c}}),t.applyAutofillOperations(es.AllFrames,o),await rR(e,t,r,s,i)}r.dataSource.type===eC.k.Credential&&o[tQ.Click].length>0&&await a3(e,t)},rF=async(e,t,a,r)=>{if(a.tab?.url){if(t0(r)){let i=await aY(e,r.dataSource.vaultId,r.dataSource.type);i.isProtected?await aH(e,t,i.neverAskAgainMode,{type:a$.ApplyAutofillDetails,data:r}):await rN(e,t,a,r)}else t1(r)&&(!await eN(e.connectors)&&rr(await e.connectors.carbon.getUserLogin()??"",new eB.Y(a.tab.url).getRootDomain())?a7(e,t,r):await rE(e,t,a,r));await a8(e,a.tab.url)}},r_=e=>e.reduce((e,t)=>t.value&&"ownerName"===t.property?`${e} ${t.value}`:e,"").trim(),rD=e=>13===e.length,rL=e=>14===e.length,rG=e=>15===e.length,rU=e=>16===e.length,rx=e=>rD(e)||rL(e)||rG(e)||rU(e),rB=(e,t)=>"long"===t?`••••\u00A0••••\u00A0••••\u00A0${e}`:`••••\u00A0${e}`,rO={[eC.k.PaymentCard]:3,[eC.k.IdCard]:6,[eC.k.Passport]:6,[eC.k.DriverLicense]:6},rV=(e,t)=>e.find(e=>e.property===t),rW=(e,t,a)=>{let r=new Date(t,e,1),i=new Date(t,e-(rO[a]??6),1);return{expired:new Date>=r,aboutToExpire:new Date>=i}},rY=(e,t)=>{switch(e){case"password":return"••••••••••••";case"otpSecret":return"••• •••";case"securityCode":return"•••";case"cardNumber":return rB(t?.slice(-4)??"","long");case"BIC":return"••••••";case"IBAN":case"idNumber":return"••••••••••••••••";default:return t??"••••"}},rK=async(e,t,a,r)=>{let i={};return await Promise.all(r.map(async r=>{let n=await rS(e,{ingredient:{type:t,property:r},vaultItem:a});n&&(i[r]=rY(r,n))})),i},rH=e=>{let t=rV(e,"expireMonth"),a=rV(e,"expireYear"),r={month:t?.value,year:a?.value};if(t?.value&&t.format?.dateFormat||a?.value&&a.format?.dateFormat){let e=t?.format?.dateFormat?t:a;if(e){let{month:t,year:a}=ts(e.value,tr(e.format?.dateFormat));r.month=t,r.year=a}}return r.year&&2===r.year.length&&(r.year=tc(r.year)),r},rq=async(e,t)=>{let a=await tC(e,eC.k.PaymentCard,t);return a?rK(e,eC.k.PaymentCard,a,["ownerName","cardNumber","securityCode","expireDate"]):{}},rz=(e,t)=>{let{expireMonth:a,expireYear:r}=e,i=parseInt(r,10),{expired:n,aboutToExpire:s}=rW(parseInt(a,10),i,e.vaultType),o=!e.cardNumber,l=e.cardNumberLastDigits?rB(e.cardNumberLastDigits,"short"):"",d=a&&r?`${a.padStart(2,"0")}/${r.slice(-2)}`:"",c=l+"\xa0".repeat(3)+d;return{type:az.EnhancedItem,itemId:e.id,itemType:eC.k.PaymentCard,title:e.name,content:c,space:aj(t),expired:n,aboutToExpire:s&&!n,incomplete:o&&!s&&!n,paymentType:e.type,color:e.color.toLowerCase(),isProtected:!0}},rj=async(e,t)=>{let a=await tC(e,eC.k.Address,t);return a?rK(e,eC.k.Address,a,["addressFull","city","country","door","floor","state","stateCode","streetName","streetNumber","streetTitle","zipCode"]):{}},rZ=(e,t)=>{let a=e4(e.localeFormat),r=eq(e),i=ez(e)?`${e.streetNumber} ${r}`:r,n=ez(e)?`${e.city} ${e.zipCode}`:`${e.zipCode} ${e.city}`,s=`${n} ${a}`,o=`${e.addressName}${"\xa0".repeat(2)}-${"\xa0".repeat(2)}${s}`;return{type:az.SimpleItem,itemId:e.id,itemType:eC.k.Address,title:i,content:o,space:aj(t),isProtected:!1}},rJ=async(e,t)=>{let a=await tC(e,eC.k.BankAccount,t);return a?rK(e,eC.k.BankAccount,a,["owner","bank","BIC","IBAN"]):{}},r$=(e,t)=>({type:az.SimpleItem,itemId:e.id,itemType:eC.k.BankAccount,title:e.name,content:e.owner,space:aj(t),isProtected:!1}),rQ=async(e,t)=>{let a=await tC(e,eC.k.Company,t);return a?rK(e,eC.k.Company,a,["name","jobTitle"]):{}},rX=(e,t)=>({type:az.SimpleItem,itemId:e.id,itemType:eC.k.Company,title:e.name,content:e.jobTitle,space:aj(t),isProtected:!1}),r0=async(e,t)=>{let a=await tC(e,eC.k.Credential,t);return a?rK(e,eC.k.Credential,a,["email","login","secondaryLogin","password","otpSecret"]):{}},r1=(e,t)=>{let a=e.title;return a.match(/^".*"$/)&&(a=(a=a.substring(1)).substring(0,a.length-1)),{type:az.SimpleItem,itemId:e.id,itemType:eC.k.Credential,title:e.login||e.email,content:a,isLinkedWebsite:[ew.MatchType.AssociatedWebsite,ew.MatchType.UserAssociatedWebsite].includes(e.matchType),space:aj(t),isProtected:e.autoProtected,domain:new eB.Y(e.url).getRootDomain()}},r4=["FR","US-0-AK","US-0-AL","US-0-AR","US-0-AZ","US-0-CA","US-0-CO","US-0-CT","US-0-DE","US-0-FL","US-0-GA","US-0-HI","US-0-IA","US-0-ID","US-0-IL","US-0-IN","US-0-KS","US-0-KY","US-0-LA","US-0-MA","US-0-MD","US-0-ME","US-0-MI","US-0-MN","US-0-MO","US-0-MS","US-0-MT","US-0-NC","US-0-ND","US-0-NE","US-0-NH","US-0-NJ","US-0-NM","US-0-NV","US-0-NY","US-0-OH","US-0-OK","US-0-OR","US-0-PA","US-0-RI","US-0-SC","US-0-SD","US-0-TN","US-0-TX","US-0-UT","US-0-VA","US-0-VT","US-0-WA","US-0-WI","US-0-WV","US-0-WY","US-0-WY"],r2=e=>{let t="";return r4.includes(e.country)?e.country:r4.includes(e.state)?e.state:e0.includes(e.country)?"eu":"US"===e.country?"US_generic":"generic"},r6=async(e,t)=>{let a=await tC(e,eC.k.DriverLicense,t);return a?rK(e,eC.k.DriverLicense,a,["issueDateFull","expirationDateFull","state","idNumber"]):{}},r3=(e,t)=>{let{expirationMonth:a,expirationYear:r}=e,{expired:i,aboutToExpire:n}=rW(a,r,e.vaultType),s=r2(e);return{type:az.EnhancedItem,itemId:e.id,itemType:eC.k.DriverLicense,title:e.name,content:e.localeFormat,space:aj(t),expired:i,aboutToExpire:n&&!i,isProtected:!1,displayCountry:eX(e.localeFormat),country:e.localeFormat,backgroundName:s}},r5=async(e,t)=>{let a=await tC(e,eC.k.Email,t);return a?rK(e,eC.k.Email,a,["email"]):{}},r8=(e,t)=>({type:az.SimpleItem,itemId:e.id,itemType:eC.k.Email,title:e.email,content:e.name,communicationType:e.type,space:aj(t),isProtected:!1}),r9=async(e,t)=>{let a=await tC(e,eC.k.FiscalId,t);return a?rK(e,eC.k.FiscalId,a,["idNumber"]):{}},r7=(e,t)=>({type:az.SimpleItem,itemId:e.id,itemType:eC.k.FiscalId,title:e.idNumber,content:e.localeFormat,space:aj(t),isProtected:!1}),ie=async(e,t)=>{let a=await tC(e,eC.k.IdCard,t);return a?rK(e,eC.k.IdCard,a,["name","country","expirationDateFull","expirationYear","expirationMonth","expirationDay","issueDateFull","issueYear","issueMonth","issueDay","idNumber"]):{}},it=(e,t)=>{let{expirationMonth:a,expirationYear:r}=e,{expired:i,aboutToExpire:n}=rW(a,r,e.vaultType);return{type:az.EnhancedItem,itemId:e.id,itemType:eC.k.IdCard,title:e.name,content:e.localeFormat,expired:i,aboutToExpire:n,country:e.localeFormat,displayCountry:eX(e.localeFormat),space:aj(t),isProtected:!1}};var ia=a(83945);let ir=e=>{if(e.day&&e.month&&e.year?.length===4){to(e.month)in tt&&tt[to(e.month)];let t=e.month.padStart(2,"0"),a=e.day.padStart(2,"0"),r=`${e.year}-${t}-${a}`;if((0,ia.Z)((0,e7.Z)(r,"yyyy-MM-dd",new Date)))return r}return""},ii=e=>{let t=tm(e);return e.pseudo&&(t+=` (${e.pseudo})`),t},is=e=>{let t=[],a=(0,eJ.G3)(),r=ta(e.birthDate);if(r){let e=r.toLocaleString(a,{month:"long"}),i=r.getDate().toString().padStart(2,"0"),n=r.getFullYear().toString().padStart(4,"0");t.push(`${e}\u00A0${i},\u00A0${n}`)}return e.birthPlace&&t.push(e.birthPlace),t.join(", ")},io=async(e,t)=>{let a=await tC(e,eC.k.Identity,t);return a?rK(e,eC.k.Identity,a,["title","firstName","middleName","middleNameInitial","lastName","lastName2","pseudo","birthDate","birthPlace","age"]):{}},il=(e,t)=>({type:az.SimpleItem,itemId:e.id,itemType:eC.k.Identity,title:ii(e),content:is(e),space:aj(t),isProtected:!1}),id=async(e,t)=>{let a=await tC(e,eC.k.Passport,t);return a?rK(e,eC.k.Passport,a,["idNumber","country","expirationDateFull","expirationDay","expirationMonth","expirationYear","issueDateFull","issueDay","issueMonth","issueYear"]):{}},ic=(e,t)=>{let{expirationMonth:a,expirationYear:r}=e,{expired:i,aboutToExpire:n}=rW(a,r,e.vaultType);return{type:az.EnhancedItem,itemId:e.id,itemType:eC.k.Passport,title:e.name,content:e.localeFormat,country:e.localeFormat,space:aj(t),expired:i,aboutToExpire:n&&!i,isProtected:!1}},iu=async(e,t)=>{let a=await tC(e,eC.k.PersonalWebsite,t);return a?rK(e,eC.k.PersonalWebsite,a,["website"]):{}},ip=(e,t)=>({type:az.SimpleItem,itemId:e.id,itemType:eC.k.PersonalWebsite,title:e.website,content:e.name,space:aj(t),isProtected:!1}),im=async(e,t)=>{let a=await tC(e,eC.k.Phone,t);return a?rK(e,eC.k.Phone,a,["number","numberInternational"]):{}},ig=async(e,t)=>{let a=await tC(e,eC.k.SocialSecurityId,t);return a?rK(e,eC.k.SocialSecurityId,a,["idNumber"]):{}},ih=(e,t)=>({type:az.SimpleItem,itemId:e.id,itemType:eC.k.GeneratedPassword,title:"LAST_GENERATED_BUT_UNSAVED_PASSWORD",isTitleFixedType:!0,content:e.domain,space:aj(t),isProtected:!1,isLinkedWebsite:!1});function iw(e){let{vaultItem:t,vaultType:a,premiumStatusSpace:r}=e;switch(a){case eC.k.Address:return rZ(t,r);case eC.k.BankAccount:return r$(t,r);case eC.k.Company:return rX(t,r);case eC.k.Credential:return r1(t,r);case eC.k.DriverLicense:return r3(t,r);case eC.k.Email:return r8(t,r);case eC.k.FiscalId:return r7(t,r);case eC.k.IdCard:return it(t,r);case eC.k.Identity:return il(t,r);case eC.k.GeneratedPassword:return ih(t,r);case eC.k.PaymentCard:return rz(t,r);case eC.k.Passkey:{let e=t.rpName.match(/^"(.*)"$/)?.[1]??t.rpName;return{type:az.SimpleItem,itemId:t.id,itemType:eC.k.Passkey,title:t.userDisplayName,content:e,isProtected:!1}}case eC.k.Passport:return ic(t,r);case eC.k.PersonalWebsite:return ip(t,r);case eC.k.Phone:return{type:az.SimpleItem,itemId:t.id,itemType:eC.k.Phone,title:t.numberInternational,content:t.name,communicationType:t.type,space:aj(r),isProtected:!1};case eC.k.SocialSecurityId:return{type:az.EnhancedItem,itemId:t.id,itemType:eC.k.SocialSecurityId,title:t.name,content:t.localeFormat,country:t.localeFormat,space:aj(r),isProtected:!0};default:throw Error("Error: vault type not supported")}}function iy(e,t){switch(t){case eC.k.Credential:{let t=new eB.Y(e.url).getRootDomain(),a=!e.sharingStatus?.isShared||e.sharingStatus.canCopy,r=!e.sharingStatus?.isShared||e.sharingStatus.canEdit,i=!e.sharingStatus?.isShared||e.sharingStatus.canReveal;return{type:eC.k.Credential,itemId:e.id,itemSpaceId:e.spaceId,title:t,email:e.email,login:e.login,secondaryLogin:e.secondaryLogin,hasPassword:!!e.password,hasOTP:e.hasOtp,canCopy:a,canEdit:r,canReveal:i}}case eC.k.BankAccount:return{type:eC.k.BankAccount,itemId:e.id,itemSpaceId:e.spaceId,title:e.name,ownerName:e.owner,hasIBAN:!!e.IBAN,hasBIC:!!e.BIC,hasBankCode:!!e.bankCode};case eC.k.PaymentCard:return{type:eC.k.PaymentCard,itemId:e.id,itemSpaceId:e.spaceId,title:e.name,ownerName:e.ownerName,hasCardNumber:!!e.cardNumber,hasSecurityCode:!!e.securityCode,expireDate:tS(e)};default:return}}let ib=e=>e.type===eC.k.Credential&&["email","login","secondaryLogin"].includes(e.property),iS=e=>e.type===eC.k.Credential&&"password"===e.property,iC=(e,t)=>{let a=!1,r=!1;for(let{ingredient:t}of e.ingredients)if(a=a||ib(t),r=r||iS(t),a&&r)return{isRecipeForAutologin:!0,isMultiSteps:!1};return a&&!r&&t.includes(ah.STEP)?{isRecipeForAutologin:!0,isMultiSteps:!0,step:ah.STEP}:r&&!a&&t.includes(ah.FINAL)?{isRecipeForAutologin:!0,isMultiSteps:!0,step:ah.FINAL}:{isRecipeForAutologin:!1,isMultiSteps:!1}},iA=async(e,t)=>(await tA({context:e,url:t,vaultType:eC.k.Credential,queryOptions:{sortCriteria:[{field:"lastUse",direction:"descend"}],filterCriteria:[]}})).filter(e=>ru(e,t)),iI=e=>{for(let t of Object.keys(e)){let{recipesByField:a,formClassification:r}=e[t];for(let e of Object.keys(a)){let i=a[e].recipesBySourceType[eC.k.Credential];if(i){let{isRecipeForAutologin:a,isMultiSteps:n,step:s}=iC(i,r);if(a)return{formId:t,fieldId:e,recipe:i,isMultiSteps:n,step:s}}}}},iM=async(e,t,a)=>{if(ri(e))return!1;let{loggedIn:r}=await a.connectors.carbon.getUserLoginStatus();if(!r)return!1;let i=await (0,ex.O)(a.grapheneClient.autofillSettings.queries.getAutofillSettings());if((0,eI.d6)(i)&&i.data.isAutologinDisabled||(await tF(a)).isB2CFrozen)return!1;let n=t.formElements.filter(e=>rs(e.classification,"login"));if(1!==n.length)return!1;let s=n[0];return new eB.Y(s.iframeUrl).getHostname()===new eB.Y(e).getHostname()&&!s.hasCaptcha&&!s.sandboxed},iT=async(e,t,a,r)=>{if(!a.tab?.url)return;let i=a.tab.url,n=new eB.Y(i).getRootDomain(),s=iI(r);if(!s)return;let o=await iA(e,i);if(0===o.length||await tx(e))return;let l=await e.connectors.carbon.getSpaces();l=l.length>1?l:[];let d={webcardId:(0,ef.Z)(),webcardType:aS.AutologinSelection,webcards:o.map(e=>iw({vaultType:eC.k.Credential,vaultItem:e,premiumStatusSpace:l.find(t=>t.spaceId===e.spaceId)})),formType:r[s.formId].formClassification,tabRootDomain:n,extensionShortcuts:await (0,ag.Y)(),autofillRecipes:{[eC.k.Credential]:s.recipe}},c=await eR(e.connectors),u=await e.state.tab.get();if(1!==o.length||c)u.lastAutologin?.domain!==n&&(t.showWebcard(es.MainFrame,d),await e.state.tab.set({...u,lastAutologin:{domain:n,isMultiSteps:s.isMultiSteps,step:s.step}}));else{if((await aY(e,o[0].id,eC.k.Credential)).isProtected)return;let r={autofillRecipe:s.recipe,dataSource:{type:eC.k.Credential,vaultId:d.webcards[0].itemId},formClassification:d.formType,requestOrigin:{type:tX.Automatic}};await rF(e,t,a,r)}};var ik=a(86518),iP=a(38004);let iE=e=>{let t=[];return e?.appid&&t.push(ew.WebauthnExtensionId.Appid),e?.credProps&&t.push(ew.WebauthnExtensionId.CredProps),e?.hmacCreateSecret&&t.push(ew.WebauthnExtensionId.HmacSecret),t};async function iv({context:e,rpId:t,displayName:a,currentDomain:r,spaceId:i}){let n=await e.connectors.carbon.getNodePremiumStatus();if(n.b2bStatus?.currentTeam&&""!==i){let i=tD(eS.b.UserAuthenticatedWithPasskey,{passkey_domain:t,current_domain:r,credential_login:a});await e.connectors.grapheneClient.activityLogs.commands.storeActivityLogs({activityLogs:[i]})}}async function iR(e,{ceremonyStatus:t,passkeyType:a,errorName:r,msToCompleteCeremony:i}){let n=e.options.pubKeyCredParams.map(e=>aL[e.alg]),s=new eB.Y(e.options.rp.id??"").getRootDomain();return new ew.AnonymousRegisterPasskeyEvent({algorithmsSupportedList:n,authenticatorAttachment:aP(e.options.authenticatorSelection?.authenticatorAttachment,av),authenticatorResidentKey:aP(e.options.authenticatorSelection?.residentKey,aR),authenticatorUserVerification:aP(e.options.authenticatorSelection?.userVerification,aN),domain:{type:ew.DomainType.Web,id:await (0,ew.hashDomain)(s)},isRegisteredWithDashlane:t===ew.CeremonyStatus.Success,msToCompleteRegistration:i,msToCompleteRegistrationTimeout:e.options.timeout,passkeyRegistrationErrorType:aP(r,aF),passkeyRegistrationStatus:t,webauthnExtensionSupportedList:iE(e.options.extensions),passkeyType:a})}async function iN(e,t,a,r){r.ceremonyStatus===ew.CeremonyStatus.Success&&await iv({context:e,rpId:t.options.rp.id??"",currentDomain:a.tab?.url?new eB.Y(a.tab.url).getHostname():"",displayName:t.options.user.displayName,spaceId:r.spaceId??""}),await e.connectors.carbon.logEvent({event:await iR(t,r)}),await e.connectors.carbon.logEvent({event:function({ceremonyStatus:e,passkeyType:t,errorName:a}){return new ew.UserRegisterPasskeyEvent({passkeyRegistrationErrorType:aP(a,aF),passkeyRegistrationStatus:e,passkeyType:t})}(r)})}async function iF(e,{ceremonyStatus:t,passkeyType:a,errorName:r,msToCompleteCeremony:i}){let n=new eB.Y(e.options.rpId??"").getRootDomain();return new ew.AnonymousAuthenticateWithPasskeyEvent({authenticationMediationType:aP(e.mediation,aD),authenticatorUserVerification:aP(e.options.userVerification,aN),domain:{type:ew.DomainType.Web,id:await (0,ew.hashDomain)(n)},hasCredentialsAllowed:!!e.options.allowCredentials,isAuthenticatedWithDashlane:t===ew.CeremonyStatus.Success,msToCompleteAuthentication:i,msToCompleteAuthenticationTimeout:e.options.timeout,passkeyAuthenticationErrorType:aP(r,a_),passkeyAuthenticationStatus:t,webauthnExtensionSupportedList:iE(e.options.extensions),passkeyType:a})}async function i_(e,t,a,r){r.ceremonyStatus===ew.CeremonyStatus.Success&&await iv({context:e,rpId:t.options.rpId??"",currentDomain:a.tab?.url?new eB.Y(a.tab.url).getHostname():"",displayName:r.displayName??"",spaceId:r.spaceId??""}),await e.connectors.carbon.logEvent({event:await iF(t,r)}),await e.connectors.carbon.logEvent({event:function({ceremonyStatus:e,passkeyType:t,errorName:a}){return new ew.UserAuthenticateWithPasskeyEvent({passkeyAuthenticationErrorType:aP(a,a_),passkeyAuthenticationStatus:e,passkeyType:t})}(r)})}let iD=(e,t)=>({sortToken:{sortCriteria:[{field:"lastUse",direction:"descend"}],uniqField:"rpId"},filterToken:{filterCriteria:t?[{type:"matches",value:t}]:[]},domain:e});function iL(e,t,a){let r=new eB.Y(t).getHostname();return e.connectors.carbon.getPasskeysForDomain(iD(r,a))}var iG=a(20394),iU=a(27122);let ix=e=>{let t=+(e[0]>127),a=new Uint8Array(e.byteLength+2+t);return a[0]=2,a[1]=e.byteLength+t,a[2]=0,a.set(e,2+t),a},iB=e=>{let t=e.byteLength/2,a=ix(e.slice(0,t)),r=ix(e.slice(t)),i=new Uint8Array(a.byteLength+r.byteLength+2);return i[0]=48,i[1]=a.byteLength+r.byteLength,i.set(a,2),i.set(r,2+a.byteLength),i},iO=[{coseAlgorithmIdentifier:iG.aG.ES256,async generateNewKeyPair(e){let t=e.crypto.subtle,a=await t.generateKey({name:"ECDSA",namedCurve:"P-256"},!0,["sign","verify"]);return{publicKey:await t.exportKey("jwk",a.publicKey),privateKey:await t.exportKey("jwk",a.privateKey)}},encodePublicKey(e){if(void 0===e.x||void 0===e.y)throw new iK(ab.UnknownError);return iU.encode(new Map([[1,2],[3,-7],[-1,1],[-2,(0,iP.N)(e.x)],[-3,(0,iP.N)(e.y)]]))},async sign(e,t){let a=await crypto.subtle.importKey("jwk",t,{name:"ECDSA",namedCurve:"P-256"},!0,["sign"]);return iB(new Uint8Array(await crypto.subtle.sign({name:"ECDSA",hash:"SHA-256"},a,e)))}}],iV=e=>{let t=e.map(e=>Number(e.alg));return 0===t.length&&t.push(-7,-257),t},iW=async(e,t)=>{let a=iV(t),r=await eG(e.connectors)&&a.includes(iG.aG.ES256);if(r)return[void 0,r];for(let e of a){let t=iO.find(t=>t.coseAlgorithmIdentifier===e);if(t)return[t,r]}return[void 0,r]};class iY extends Error{constructor(e){super(),(0,N._)(this,"errorName",void 0),this.errorName=e?.logError}}class iK extends Error{constructor(e){super(),(0,N._)(this,"errorName",void 0),this.errorName=e}}var iH=((P={})[P.USER_PRESENT=1]="USER_PRESENT",P[P.USER_VERIFIED=4]="USER_VERIFIED",P[P.BACKUP_ELIGIBILITY=8]="BACKUP_ELIGIBILITY",P[P.BACKUP_STATE=16]="BACKUP_STATE",P[P.ATTESTED_CRED_DATA_INCLUDED=64]="ATTESTED_CRED_DATA_INCLUDED",P[P.EXTENSION_DATA_INCLUDED=128]="EXTENSION_DATA_INCLUDED",P);let iq=(e,t)=>{let a=new TextEncoder().encode(t);return e.crypto.subtle.digest("SHA-256",a)},iz=e=>{let t=[];for(let a of e){t.push(a.id);try{let e=(0,iP.N)(a.id),r=new TextDecoder("utf-8",{fatal:!0});t.push(r.decode(e))}catch(e){}}return t},ij=async(e,t,a,r)=>{let i=(await iL(e,t,r)).items,n=iz(a);return a.length>0?i.filter(e=>n.includes(e.credentialId)):i},iZ=e=>{if(!e?.startsWith("https://"))return;let t=new eB.Y(e),a=t.getHostname();if(!(!a||""===a||t.isUrlIP()))return{effectiveDomain:a,requestOrigin:e}},iJ=(e,t)=>!(e===t||t.endsWith(`.${e}`)),i$=(e,t)=>{if(0!==e.frameId&&(0!==t.parentFrameId||t.type===af.Create))throw new iK(ab.NotAllowedError);let a=e.url?new URL(e.url).origin:void 0,r=iZ(e.origin??a);if(!r)throw new iK(ab.NotAllowedError);let{effectiveDomain:i,requestOrigin:n}=r,s=t.publickeyCredentialsPermissionList?.map(e=>iZ(e)?.effectiveDomain);if(0!==e.frameId&&!s?.includes(i)||t.options.hints?.length===1&&t.options.hints.includes("security-key"))throw new iK(ab.NotAllowedError);return{effectiveDomain:i,requestOrigin:n}},iQ=async(e,t,a,r)=>{let i;i=aZ(r)?r.request:r;let n={status:"error",errorName:ab.NotAllowedError};switch(i.type){case af.Create:{t.webauthnCreateResponse(es.AllFrames,i.requestId,n);let[r,s]=await iW(e,i.options.pubKeyCredParams),o=s?ew.PasskeyType.Cloud:ew.PasskeyType.Legacy;iN(e,i,a,{ceremonyStatus:ew.CeremonyStatus.Cancelled,passkeyType:o})}break;case af.Get:i_(e,i,a,{ceremonyStatus:ew.CeremonyStatus.Cancelled,passkeyType:void 0}),t.webauthnGetResponse(es.AllFrames,i.requestId,n)}return Promise.resolve()},iX=async(e,t,a)=>{let r=await e.state.tab.get();await e.state.tab.set({...r,pendingWebauthnOperations:{...r.pendingWebauthnOperations,[t]:{origin:a}}})},i0=async(e,t)=>{let a=await e.state.tab.get(),{[t]:r,...i}=a.pendingWebauthnOperations??{};return await e.state.tab.set({...a,pendingWebauthnOperations:i}),r?.origin},i1=async(e,t,a)=>(await Promise.all(a.map(t=>e.connectors.carbon.getSinglePasskeyForAutofill(t.id)))).map(e=>({webcardItem:{...iw({vaultType:eC.k.Passkey,vaultItem:e,premiumStatusSpace:nt(e,t)}),metadataKeys:[aC.WebauthnRequest]},vaultItem:e})),i4=e=>/[\da-f]{8}-[\da-f]{4}-[\da-f]{4}-[\da-f]{4}-[\da-f]{12}/i.test(e)?"uuid":"base64URL",i2=e=>crypto.getRandomValues(new Uint8Array(e)),i6=e=>["discouraged","preferred","required"].includes(e),i3=async(e,t,a,r)=>{let i=a.type===af.Create?a.options.authenticatorSelection?.userVerification:a.options.userVerification,n=void 0!==i&&i6(i)?i:"preferred",s=(await aO(e)).every(e=>e===aB.W.MasterPassword||e===aB.W.Pin);if(!a.userVerificationDone&&("preferred"===n&&!s||"required"===n)){let i={source:a.type===af.Create?ew.AuthenticatorUserVerificationSource.PasskeyRegistration:ew.AuthenticatorUserVerificationSource.PasskeyLogin},n={type:a$.Webauthn,request:a},s=await aV(e,n,i,r);return t.updateWebcard(es.SenderFrame,s),"stop"}return t.closeWebcard(es.SenderFrame,r),"continue"},i5=async(e,t,a,r,i)=>{let n=a.conditionalUiRequest;if(n?.mediation!=="conditional")return[];let{effectiveDomain:s}=i$(t,n),o=n.options.rpId??s;if(iJ(o,s)||"required"===n.options.userVerification&&await e.connectors.carbon.getIsSSOUser())return[];let l=await ij(e,o,n.options.allowCredentials??[],i),d=await i1(e,r,l),c=n.options.userVerification,u=(await aO(e)).every(e=>e===aB.W.MasterPassword||e===aB.W.Pin);return("preferred"!==c||u)&&"required"!==c?d:d.map(({webcardItem:e,vaultItem:t})=>({webcardItem:{...e,closeOnSelect:!1},vaultItem:t}))},i8=async(e,t,a)=>{let r=!1;try{let{loggedIn:t}=await e.connectors.carbon.getUserLoginStatus();r=t&&await ev(e.connectors)}catch(t){e.logException(t,{message:"Error when checking for passkey support",fileName:"webauthn-conditional-ui.ts",funcName:"webauthnIsConditionalUiSupportedHandler"})}t.webauthnConditionalUiSupported(es.SenderFrame,r)},i9=async(e,t,a,r,i,n)=>{let s=[],o=a.type,l=new eB.Y(t).getRootDomain();return ro(o===eC.k.GeneratedPassword?await tA({context:e,url:t,vaultType:o,queryOptions:{sortCriteria:[{field:"generatedDate",direction:"descend"}],filterCriteria:[{field:"domain",type:"equals",value:l}]},limit:1,needDashlaneLinkedWebsites:n}):r?(await tI({context:e,searchQuery:r,domain:t,itemTypes:[o],sorting:{property:"lastUse",direction:"descend"},limit:i,needDashlaneLinkedWebsites:n})).items:await tA({context:e,url:t,vaultType:o,queryOptions:{sortCriteria:[{field:"lastUse",direction:"descend"}],filterCriteria:[]},limit:i,needDashlaneLinkedWebsites:n}),async r=>(o!==eC.k.Credential||ru(r,t))&&(!!await rS(e,{ingredient:a,vaultItem:r})||!!tE(a,r)))};async function i7(e,t,a,r){if(await e.connectors.carbon.getReactivationStatus()===ik._g.DISABLED||tH.JV.WebauthnConditionalUI in a.autofillRecipes)return;let i={webcardId:r??(0,ef.Z)(),webcardType:aS.AutofillDropdown,configuration:aA.Reactivation,formType:a.formClassification,srcElement:a,autofillRecipes:a.autofillRecipes,tabRootDomain:t,extensionShortcuts:await (0,ag.Y)()},n=(await e.connectors.carbon.getLocalAccounts()).find(e=>e.isLastSuccessfulLogin);return n?.rememberMeType!=="webauthn"||n.shouldAskMasterPassword?i:{...i,configuration:aA.WebAuthnReactivation}}let ne=async(e,t,a,r,i,n)=>{let s={warningType:aT.None,warningContext:""};if(ri(t))return{warningType:aT.UnsecureProtocol,warningContext:""};if(i&&n.some(e=>e.itemType===eC.k.Credential))return{warningType:aT.UnsecureIframe,warningContext:"UIF@sandbox".slice(0,50)};let o=new eB.Y(r).getRootDomain();if(a&&o&&a!==o){let t=(await tA({context:e,vaultType:eC.k.Credential,url:r})).map(e=>e.id);if(!n.some(e=>e.itemType===eC.k.Credential&&t.includes(e.itemId)))return{warningType:aT.UnsecureIframe,warningContext:`UIF@${r}`.slice(0,50)}}return s},nt=(e,t)=>{if("spaceId"in e)return t.find(t=>t.spaceId===e.spaceId)};async function na(e,t,a,r,i,n,s,o){let l=i.ingredients.find(({frameId:e,srcElementId:t})=>e===a.frameId&&t===a.elementId)?.ingredient;if(!l||!t$(l)||r!==l.type)return[];let d=am(a.formClassification);return(await i9(e,t,l,o,s)).filter(e=>!d.includes("change_password")||e.vaultType!==eC.k.Credential||!e.sharingStatus?.isShared||e.sharingStatus.canEdit).map(e=>({webcardItem:iw({vaultType:r,vaultItem:e,premiumStatusSpace:nt(e,n)}),vaultItem:e}))}async function nr(e,t,a,r,i){let n=r.autofillRecipes,s=await e.connectors.carbon.getSpaces();s=s.length>1?s:[];let o={},l={},d=Object.entries(n);return await Promise.all(d.map(async([n,d])=>{let c=Object.keys(o).reduce((e,t)=>e+t.length,0);if(!(c>=20&&(0,tH.Wm)(n))){if(n===tH.JV.WebauthnConditionalUI&&r.conditionalUiRequest){let t=await i5(e,a,r,s,i);t.length>0&&(o[eC.k.Passkey]=t),l=aJ(l,{type:aC.WebauthnRequest,request:r.conditionalUiRequest})}if((0,tH.Wm)(n)){if(n===eC.k.Passkey&&o[eC.k.Passkey]){e.logException(Error("Can not create webcard items for both conditional UI and passkey autofill at the same time"),{fileName:"userFocusOnElementHandler.ts",funcName:"buildAutofillDropdownWebcardItems"});return}let a=await na(e,t,r,n,d,s,20-c+1,i);o[n]=a}}})),{webcardItemsByType:o,metadata:l}}async function ni(e,t,a,r,i){let n=await nr(e,t,a,r,i),{webcardItemsByType:s}=n;if(am(r.formClassification).includes("login")&&(s[eC.k.Credential]?.length||s[eC.k.Passkey]?.length)&&(s={[eC.k.Credential]:s[eC.k.Credential]??[],[eC.k.Passkey]:s[eC.k.Passkey]??[]}),s[eC.k.Credential]?.length&&s[eC.k.Email]?.length){let e=s[eC.k.Credential].map(({vaultItem:e})=>e.email),t=s[eC.k.Email].filter(({vaultItem:t})=>!e.includes(t.email));s[eC.k.Email]=t}return{webcardItems:Object.values(s).flatMap(e=>e).map(e=>e.webcardItem),metadata:n.metadata}}async function nn(e,t,a,r,i,n=(0,ef.Z)()){let s=i.autofillRecipes,o=new eB.Y(t).getRootDomain(),{webcardItems:l,metadata:d}=await ni(e,t,r,i),c=Object.keys(s).filter(tH.Wm),u=i.frameSandboxed,p=i.conditionalUiRequest,m=!d[aC.WebauthnRequest],g=!!d[aC.WebauthnRequest],{warningType:h,warningContext:w}=await ne(e,t,o,a,u,l);return{webcardId:n,webcardType:aS.AutofillDropdown,configuration:aA.Classic,items:l,moreItemsAvailable:l.length>20,formType:i.formClassification,srcElement:i,autofillRecipes:s,warningType:h,context:w,fieldType:c,tabRootDomain:o,tabUrl:t,metadata:d,withSearch:m,withNonDashlaneKeyButton:g,webauthnRequest:p}}async function ns(e,t,a,r){let i={warningType:aT.None,warningContext:""};if(r)return{warningType:aT.B2BDiscontinued,warningContext:""};if(ri(e))return{warningType:aT.UnsecureProtocol,warningContext:""};if(rs(t,"change_password")){let t=await a.connectors.carbon.getUserLoginStatus(),[r,i]=[new eB.Y(rt(t.login)).getRootDomainName(),new eB.Y(e).getRootDomainName()],n=eW[i]??[];if(r&&(n.includes(r)||r===i))return{warningType:aT.PasswordGenerationDashlaneLogin,warningContext:""}}if(rs(t,"register")){let t=await tA({context:a,url:e,vaultType:eC.k.Credential,queryOptions:{sortCriteria:[{field:"lastUse",direction:"descend"}],filterCriteria:[]}});return t.length>0?{warningType:aT.PossibleDuplicateRegistration,warningContext:t[0].id}:i}return i}async function no(e,t,a,r){let i=t.formClassification,n=new eB.Y(a).getRootDomain(),s=await tN(e),o=await tF(e),l=await (0,ex.O)(e.connectors.grapheneClient.passwordHistory.queries.getPasswordGenerationSettings());if((0,eI.hx)(l))throw Error("Could not retrieve password generation settings");let{warningType:d,warningContext:c}=await ns(a,i,e,o.isB2BDiscontinued);return{webcardId:r??(0,ef.Z)(),webcardType:aS.AutofillDropdown,configuration:aA.GeneratePassword,passwordLimitStatus:s,passwordGenerationSettings:l.data,formType:i,srcElement:t,autofillRecipes:t.autofillRecipes,warningType:d,context:c,tabRootDomain:n,showAccountFrozenStatus:o}}async function nl(e,t,a,r,i,n){let s=await nn(e,t,a,r,i,n);return 0===s.items.length&&i.autofillRecipes[tH.JV.NewPassword]?no(e,i,t,n):s}let nd=async(e,t,a,r,i)=>{let n;let s=Object.keys(r.autofillRecipes).filter(tH.Wm),{webcardItems:o}=await ni(e,a,t,r);return o.length?n=o[0].itemType:s.length?n=s[0]:r.autofillRecipes[tH.JV.NewPassword]&&(n=tH.JV.NewPassword),{formType:r.formClassification,srcElement:r,autofillRecipes:r.autofillRecipes,webcardId:(0,ef.Z)(),webcardType:aS.AutofillDropdown,configuration:aA.AccountFrozen,cardTitleSourceType:n,passwordLimit:i}},nc=async(e,t,a,r)=>{let i;if(e.command?.timestamp,!a.tab?.url||!a.url)return;let n=new eB.Y(a.tab.url).getRootDomain(),s=await e.connectors.carbon.getUserLoginStatus(),o=await rw();if(s.loggedIn){i=await nl(e,a.tab.url,a.url,a,r);let t=(await tF(e)).isB2CFrozen&&aM(i)&&!i.metadata?.[aC.WebauthnRequest]&&i.items.every(e=>e.itemType!==eC.k.Passkey),{limit:n}=await tN(e);t&&!n&&e.logException(Error("User is frozen but there is no known password limit")),t&&n&&(i=await nd(e,a,a.tab.url,r,n))}else o||(i=await i7(e,n,r));if(i){let n=r.conditionalUiRequest;if(i.metadata?.[aC.WebauthnRequest]&&n){let{requestOrigin:t}=i$(a,n);await iX(e,i.webcardId,t)}t.showWebcard(es.MainFrame,i)}},nu=e=>e.type===tH.JV.NewPassword,np=e=>e.type===eC.k.Credential&&"password"===e.property,nm=e=>(e.type===eC.k.Email||e.type===eC.k.Credential)&&"email"===e.property,ng=e=>e.type===eC.k.Credential&&"login"===e.property||e.type===eC.k.Identity&&"pseudo"===e.property,nh=e=>e.type===eC.k.Credential&&"secondaryLogin"===e.property,nw=async(e,t,a)=>{let r=Object.values(e),i=await a.state.tab.get(),n=i.dataCaptureStepData,s=r.filter(({ingredients:e})=>e.some(nu)),o=r.find(({ingredients:e})=>e.some(np))?.value;if(!s.every(e=>e.value===s[0].value))return;let l=s[0]?.value??o,d=r.find(({ingredients:e})=>e.some(nm))?.value??n?.capturedData.capturedEmail,c=r.find(({ingredients:e})=>e.some(ng))?.value??n?.capturedData.capturedLogin,u=r.find(({ingredients:e})=>e.some(nh))?.value??n?.capturedData.capturedSecondaryLogin,p=d??c,m=new eB.Y(t).getRootDomain();if(!l){await a.state.tab.set({...i,dataCaptureStepData:{domain:m,capturedData:{capturedEmail:d,capturedLogin:c,capturedSecondaryLogin:u},firstStepUrl:t}});return}return{capturedPassword:l,capturedEmail:d,capturedLogin:c,capturedSecondaryLogin:u,capturedEmailOrLogin:p}},ny=(e,t)=>{let{capturedPassword:a,capturedEmailOrLogin:r,capturedLogin:i,capturedEmail:n}=e,{password:s,username:o,email:l}=t,d=n&&(o.trim()===n.trim()||l.trim()===n.trim())||i&&(o.trim()===i.trim()||l.trim()===i.trim())||!1;return a===s&&(void 0===r||d)},nb=(e,{capturedPassword:t,capturedEmailOrLogin:a,capturedLogin:r,capturedEmail:i})=>{let n=!!i&&(e.login.trim()===i.trim()||e.email.trim()===i.trim()),s=!!r&&(e.login.trim()===r.trim()||e.email.trim()===r.trim());return e.password===t&&(void 0===a||n||s)},nf=async(e,t,a)=>(await tA({context:e,url:t,vaultType:eC.k.Credential,queryOptions:{sortCriteria:[],filterCriteria:[]}})).some(e=>nb(e,a)),nS=async(e,t,a)=>(await tA({context:e,url:t,vaultType:eC.k.Credential,queryOptions:{sortCriteria:[],filterCriteria:[]}})).find(e=>nb(e,a)),nC=async e=>{let t=await e.state.tab.get();t.dataCaptureStepData&&await e.state.tab.set({...t,dataCaptureStepData:void 0})},nA=e=>{let t=new eB.Y(e).getRootDomainName();return"amazon"===t?new eB.Y(e).getRootDomain():"microsoftonline"===t?new eB.Y(e).getHostname():e},nI=async e=>{try{let t=await (0,ex.O)(e.grapheneClient.autofillSettings.queries.getUserAutofillCorrections());return(0,eI.d6)(t)&&(0,tq.P)(t.data)?t.data:[]}catch(t){return e.logException(t,{message:"Error when retrieving user autofill corrections",fileName:"user-autofill-correction.ts",funcName:"getUserAutofillCorrections"}),[]}},nM=async(e,t,a,r)=>{let i=new eB.Y(t).getHostname(),n={id:(0,ef.Z)(),fieldIdentifier:a,domain:i,correctedDataSource:r},s=await nI(e),o=s.findIndex(e=>e.domain===n.domain&&e.fieldIdentifier===n.fieldIdentifier);o>=0?s[o]=n:s.push(n),e.grapheneClient.autofillSettings.commands.setUserAutofillCorrections({corrections:s})};var nT=a(76794);let nk=(e,t,a)=>{let{key:r,value:i}=a;try{return e.storage.local.set({[r]:i}).then(()=>{})}catch(e){throw Error(`Failed to write the ${r} FF to local storage`,{cause:e})}},nP=(e,t)=>e.storage.local.get(t).then(e=>!!e[t]),nE=async(e,t)=>{try{return(await Promise.all(t.map(t=>e.carbon.getHasFeature(t)))).every(e=>e)}catch(e){throw Error("Failed to get feature flips in checkFeatureInCarbonFFs",{cause:e})}},nv=async(e,t,a)=>{let r=!1!==(await e.carbon.getGlobalExtensionSettings().catch(()=>({personalDataConsent:!1}))).personalDataConsent,i=await (0,ex.O)(t.autofillSettings.queries.getAnalysisStatusOnUrl({url:a}));return r&&(0,eI.d6)(i)&&i.data.analysisStatus===nT._.ANALYSIS_ENABLED},nR=async(e,t,a,r,i)=>{let n=await nv(e,t,i);a.updateDomainAnalysisStatus(r,n),n||a.updateAutofillRecipes(r,{})},nN=async(e,t,a,r,i,n)=>{let s=n?await eP(e):{};a.updateUserLoginStatus(r,n),a.updateUserFeatureFlips(r,s),await nR(e,t,a,r,i)},nF=(e,t)=>({matching:e.extra.filter(e=>t.includes(e)).length,nonMatching:e.extra.filter(e=>!t.includes(e)).length+t.filter(t=>!e.extra.includes(t)).length}),n_=(e,t,a,r,i)=>t>r||t===r&&a<i||t===r&&a===i&&0===Object.keys(e).length,nD=(e,t)=>{let a;let r=0,i=1e3,n=at[e][t.main];if(n){for(let e of n){let{matching:n,nonMatching:s}=nF(t,e.extraValues);(!a||n_(a.source,n,s,r,i))&&(a=e,r=n,i=s)}return a}},nL=(e,t,a,r,i)=>{let n=e.type===tH.JV.SubmitButton?eC.k.Credential:e.type,s=i[n]??{ingredients:[]};return i[n]=s,s.ingredients.push({frameId:t,srcElementId:a,fieldClassification:r,ingredient:e}),s},nG=(e,t,a,r,i,n)=>{let s=a.context.rId,o=n[s]??{fieldId:s,frameId:a.iframeId,fieldClassification:a.classification,fieldFormat:r,persistentIdentifier:i,knownValue:!1,recipesBySourceType:{}};n[s]=o;let l=o.recipesBySourceType[t]??e;o.recipesBySourceType[t]=l},nU=(e,t)=>{let a=[];return e&&Object.keys(e).forEach(r=>{a.push({type:r,property:e[r],format:t})}),a},nx=(e,t)=>{let a=`form-${e.context.attributes}`,r=`${t.context.type.toLowerCase()}-${t.context.attributes}`;return`ML@${a}@${r}`},nB=(e,t,a)=>{(0,tq.w)(t)||e.push(...nU(t.correctedDataSource,a))},nO=(e,t,a,r,i)=>{let n;let s=am(a),o=ap(t),l=0,d=1e3;for(let e of s)for(let t of o){let a=nD(e,t)??nD("default",t);if(!a)continue;let{matching:r,nonMatching:i}=nF(t,a.extraValues);(!n||n_(n,r,i,l,d))&&(n=a.source,l=r,d=i)}let c=Object.keys(n??{}).filter(e=>(0,tH.Wm)(e)?!i.includes(tz.Z[e]):!(0,tH.$b)(e)||!i.includes(tj.dJ.KWAuthentifiant)).reduce((e,t)=>(e[t]=(n??{})[t],e),{});e.push(...nU(c,r)),o.some(({main:e})=>"webauthn"===e)&&!Object.keys(c).includes(tH.JV.WebauthnConditionalUI)&&e.push(...nU({[tH.JV.WebauthnConditionalUI]:tH.JV.WebauthnConditionalUI}))},nV=(e,t)=>{let a=Object.entries(t),r=[tH.JV.NewPassword,eC.k.Credential,eC.k.GeneratedPassword,eC.k.PaymentCard,eC.k.SocialSecurityId];Object.values(e).forEach(e=>{let t=Object.keys(e.recipesBySourceType);if(t.includes(tH.JV.NewPassword))return;let i={};a.forEach(([e,a])=>{t.includes(e)||r.includes(e)||(i[e]={ingredients:a.ingredients})}),Object.keys(i).length>0&&Object.values(e.recipesBySourceType).forEach(e=>{e.postfillRecipes=i})})},nW=(e,t,a)=>rn(e.classification,"part")?"number"==typeof a&&e.classification===t?.classification&&e.context.type===t.context.type?a+1:0:void 0,nY=(e,t,a)=>{let r;let i={},n={};return e.fields.forEach((s,o)=>{let l=nW(s,e.fields[o-1],r),d=[],c={dateFormat:s.context.dateFormat,dateSeparator:s.context.dateSeparator,partNumber:l,optionLabels:s.context.optionLabels,optionValues:s.context.optionValues};r=l;let u=t.find(t=>t.fieldIdentifier===nx(e,s));for(let t of(u?nB(d,u,c):nO(d,s.classification,e.classification,c,a),d))nG(nL(t,s.iframeId,s.context.rId,s.classification,n),t.type,s,c,nx(e,s),i)}),rs(e.classification,"login")||nV(i,n),i},nK=(e,t,a)=>a.some(a=>a.fieldIdentifier===nx(t,e)&&(0,tq.w)(a)),nH=(e,t)=>{let a=[];for(let r of e.formElements){let e=r.fields.filter(e=>"other"===e.classification||nK(e,r,t));e.length>0&&a.push(...e.map(e=>({...e,persistentIdentifier:nx(r,e),formId:r.context.rId})))}return a},nq=(e,t,a)=>{let r={};for(let i of e.formElements){let e=i.context.rId;r[e]={formId:e,frameId:i.iframeId,frameSandboxed:i.sandboxed,formClassification:i.classification,recipesByField:nY(i,t,a)}}return r},nz=async(e,t,a)=>{for(let[r,i]of Object.entries(a.recipesBySourceType)){if(a.knownValue)return;let n=i.ingredients.find(({frameId:e,srcElementId:t})=>e===a.frameId&&t===a.fieldId);if(!n)continue;let s=n.ingredient;s.type===eC.k.Credential?a.knownValue=s.type===r&&t$(s)&&(await i9(e,"",s,new eB.Y(t).getRootDomain(),20,!0)).length>0:a.knownValue=!(0,tH.Wm)(r)||s.type===r&&t$(s)&&(await i9(e,t,s,void 0,20,!0)).length>0}},nj=async(e,t,a)=>{for(let r in a)for(let i in a[r].recipesByField)await nz(e,t,a[r].recipesByField[i])},nZ=async(e,t,a,r)=>{if(!a.tab?.url)return;let i=a.tab.url;if(!await nv(e.connectors,e.grapheneClient,i)){t.updateAutofillRecipes(es.AllFrames,{});return}let n=new eB.Y(i),s=n.getRootDomain(),o=n.getHostname(),{loggedIn:l}=await e.connectors.carbon.getUserLoginStatus(),d=[],c=[];if(l){let t=await (0,ex.O)(e.grapheneClient.autofillSettings.queries.getAutofillSettings());c=(0,eI.d6)(t)?t.data.disabledSourceTypes:[],d=(await nI(e)).filter(e=>e.domain===o)}let u=nq(r,d,c),p=nH(r,d),m=Object.values(u).some(e=>Object.values(e.recipesByField).some(e=>tH.JV.WebauthnConditionalUI in e.recipesBySourceType)),g=await e.state.tab.get();s!==g.lastAutologin?.domain&&await e.state.tab.set({...g,lastAutologin:void 0}),g.dataCaptureStepData&&s!==g.dataCaptureStepData.domain&&!(await tv(e,i)).includes(g.dataCaptureStepData.domain)&&await nC(e),l&&await nj(e,i,u),t.updateAutofillRecipes(es.AllFrames,u),t.updateUnrecognizedElements(es.AllFrames,p),!(l&&m&&(await tA({context:e,url:r.url,vaultType:eC.k.Passkey,queryOptions:{sortCriteria:[{field:"lastUse",direction:"descend"}],filterCriteria:[]},limit:1})).length>0)&&await iM(i,r,e)&&await iT(e,t,a,u)},nJ=(e,t,a,r)=>{nM(e,a,r.srcElement.persistentIdentifier,"none");let i={...r.srcElement,autofillRecipes:nQ(r.srcElement),formClassification:r.formType};t.updateWebcard(es.SenderFrame,{webcardId:r.webcardId??(0,ef.Z)(),configuration:aA.FieldDisabledNotification,webcardType:aS.AutofillDropdown,srcElement:i,formType:i.formClassification,autofillRecipes:i.autofillRecipes})},n$=(e,t,a,r,i)=>(a.tab?.url&&(t.disableDashlaneOnField(es.AllFrames,r.srcElement.elementId),i===t4.PermanentlyDisable&&nJ(e,t,a.tab.url,r)),Promise.resolve()),nQ=(e,t)=>{let{elementId:a,frameId:r}=e,i={};for(let n of nU(t,e.fieldFormat))nL(n,r,a,"",i);return i},nX=async(e,t,a,r,i)=>{let{autofillRecipes:n,configuration:s,formType:o,srcElement:l,webcardId:d}=r,c=i??(s===aA.Classic&&1===r.items.length?r.items[0]:void 0);if(c){t.closeWebcard(es.SenderFrame,d);let r=n[c.itemType];r&&await rF(e,t,a,{autofillRecipe:r,dataSource:{type:c.itemType,vaultId:c.itemId},formClassification:o,focusedElement:l,requestOrigin:{type:tX.UserAppliedAutofillCorrection}})}else t.updateWebcard(es.SenderFrame,r)},n0=async(e,t,a,r,i)=>{if(!a.tab?.url)return;let{formType:n,srcElement:s,webcardId:o,context:l,warningType:d}=r;if(nM(e,a.tab.url,s.persistentIdentifier,i.dataSource),"none"===i.dataSource){n$(e,t,a,r,t4.PermanentlyDisable);return}let c={...s,autofillRecipes:nQ(s,i.dataSource),formClassification:n},u={...await nl(e,a.tab.url,a.url??"",a,c,o),context:l,warningType:d};await nX(e,t,a,u,i.selectedItem)};var n1=a(97413);let n4=async(e,t,a)=>{if(!(a.tab&&"number"==typeof a.frameId&&a.url))return;let r=await e.connectors.carbon.getUserLoginStatus().then(({loggedIn:e})=>e);if(t.updateClientFrameId(es.SenderFrame,a.frameId),await nN(e.connectors,e.grapheneClient,t,es.SenderFrame,a.url,r),t.updateTabActiveInfo(es.SenderFrame,a.tab.highlighted||a.tab.active),0===a.frameId&&a.tab.id)try{await (0,n1.Q)({target:{tabId:a.tab.id},origin:"USER",files:["content/webui/webui-frame.css"]})}catch{}await tV(e,t)};var n2=((E={}).CopyAndPaste="PHISHING_ALERT_COPY_AND_PASTE",E.AI="PHISHING_ALERT_AI",E),n6=a(544);let n3=(e,t)=>{let a={webcardType:aS.PhishingPrevention,webcardId:(0,ef.Z)(),formType:"",contentData:{phishingAlertType:n2.AI,currentTabURL:t}};e.showWebcard(es.MainFrame,a)},n5=async e=>{if(!await e.connectors.carbon.getUserLoginStatus().then(({loggedIn:e})=>e))return!1;let t=await e.connectors.carbon.getPlatformInfo(),a=t.buildType===n6.P.NIGHTLY||t.buildType===n6.P.DEV,r=await eU(e.connectors);return a&&r},n8=async(e,t,a,r)=>{if(!a.tab?.url)return;let i=a.tab.url,n=new eB.Y(i).getRootDomain();if(r.phishingProbability&&r.phishingProbability>r.threshold){let a=["login","register","payment"],s=r.formTypes.find(e=>a.includes(e));if(void 0===s)throw Error("ML anti-phishing can not execute - form type mismatch");let o=aE[s];if(void 0===o)throw Error(`ML anti-phishing can not execute - unknown form type: ${s}`);await n5(e)&&n3(t,i);let l=new ew.UserPhishingAttemptDetectedEvent({formType:o,confidenceInterval:Math.round(100*r.phishingProbability),modelVersion:r.modelVersion}),d=new ew.AnonymousPhishingAttemptDetectedEvent({formType:o,domain:{type:ew.DomainType.Web,id:await (0,ew.hashDomain)(n)},confidence:r.phishingProbability,modelVersion:r.modelVersion});e.connectors.carbon.logEvent({event:l}),e.connectors.carbon.logEvent({event:d})}};var n9=a(15518);let n7=async(e,t,a,r,i)=>{let n=await i.get();if(!n.isRightClickMenuLive)try{await e.contextMenus.removeAll();let t=await eL(r)&&!n9.isSafari(),a=await (0,$.U)({title:"Dashlane",contexts:[t?"all":"editable"],id:t?"dashlane-right-click-menu":"correct-autofill"});t&&(await (0,$.U)({title:"Capture the page as zip",parentId:a,id:"capture-page",contexts:["all"]}),await (0,$.U)({title:"Select an item to autofill",parentId:a,id:"correct-autofill",contexts:["editable"]})),a&&await i.set({...n,isRightClickMenuLive:!0})}catch(e){i.set({...n,isRightClickMenuLive:!1}),a(e,{message:"Failed to create the right-click menu",fileName:"userRightClickOnElementHandler.ts",funcName:"createRightClickMenu"})}},se=async(e,t,a,r)=>{if(!a.tab?.url||!a.url)return;if(!(await e.connectors.carbon.getUserLoginStatus()).loggedIn){await eg.openWebapp(e,t,a,{});return}let i=(await tF(e)).isB2CFrozen,{limit:n}=await tN(e);i&&!n&&e.logException(Error("User is frozen but there is no known password limit"));let s=new eB.Y(a.url).getRootDomain(),o=new eB.Y(a.tab.url).getRootDomain(),l=i&&n?function(e,t,a=(0,ef.Z)()){return{autofillRecipes:{},configuration:aA.AccountFrozen,formType:e.formClassification,srcElement:e,webcardId:a,webcardType:aS.AutofillDropdown,passwordLimit:t}}(r,n):function(e,t,a,r,i=(0,ef.Z)()){let{warningType:n,warningContext:s}=function(e,t,a,r){let i={warningType:aT.None,warningContext:""};return ri(e)?{warningType:aT.UnsecureProtocol,warningContext:""}:t&&a&&t!==a?{warningType:aT.UnsecureIframe,warningContext:`UIF@${a}`.slice(0,50)}:r?{warningType:aT.UnsecureIframe,warningContext:"UIF@sandbox".slice(0,50)}:i}(e,t,a,r.frameSandboxed);return{webcardId:i,configuration:aA.SelfCorrecting,webcardType:aS.AutofillDropdown,formType:r.formClassification,srcElement:r,autofillRecipes:{},warningType:n,context:s,fieldType:void 0,tabRootDomain:t,elementHasImpala:r.elementHasImpala}}(a.tab.url,o,s,r);t.showWebcard(es.MainFrame,l)};var st=a(3911),sa=a(23052);async function sr(e,t,a,r){let i;let n=await (0,ex.O)(e.connectors.grapheneClient.autofillSettings.queries.getAutofillSettings());if((await tF(e)).isB2CFrozen||(0,eI.d6)(n)&&!n.data.isFollowUpNotificationEnabled)return;let s=iy(r,a.type);if(!s)return;for(i in s)""===s[i]&&delete s[i];let o={webcardType:aS.FollowUpNotification,webcardId:(0,ef.Z)(),formType:"",webcardData:s,copiedProperties:[a.property]};t.storeFollowUpNotificationItemId(es.MainFrame,s.itemId),t.showWebcard(es.MainFrame,o)}let si=async e=>{let t=await (0,eT.z)(e.connectors.grapheneClient.autofillSecurity.queries.isInAppNudgesEnabled());return!!(0,eI.d6)(t)&&t.data},sn=async e=>{let t=await (0,eT.z)(e.connectors.grapheneClient.autofillSecurity.queries.isPhishingPreventionCapabilityEnabled());return!!(0,eI.d6)(t)&&t.data},ss=/^[A-Za-z+\-.]+:\/\//,so=(e,t,a,r)=>{let i={webcardType:aS.PhishingPrevention,webcardId:(0,ef.Z)(),formType:"",contentData:{phishingAlertType:n2.CopyAndPaste,urlOfCopiedItem:t.vaultItem,urlOfPasteDestination:t.tab},metadata:aJ({},{type:aC.PhishingPrevention,itemId:r,vaultIngredient:a})};e.showWebcard(es.MainFrame,i)};async function sl(e,t){let a=new eB.Y(t.url),r=a.getRootDomain(),i=a.getHostname(),n=ss.exec(t.url)?.[0]??"https://",s=(await tv(e,t.url)).filter(e=>e!==r),o=s.concat(t.userAddedLinkedWebsites.map(e=>new eB.Y(e).getRootDomain()));return{rootDomain:r,hostname:i,urlProtocol:n,dashlaneDefinedLinkedWebsites:s,linkedWebsites:o}}async function sd(e,t,a,r,i){let n=await sl(e,a),s=new eB.Y(t),o=s.getRootDomain(),l=s.getHostname(),d=ss.exec(t)?.[0]??"",c=r.type===eC.k.Credential,u=ri(d)&&!ri(n.urlProtocol),p=(u?n.urlProtocol:"")+n.rootDomain,m=(u?d:"")+o,g=!i.noPhishingAlertLimitFlagPresent&&await tR(e,p,m),h=!n.linkedWebsites.includes(o)&&(n.rootDomain!==o||eY.includes(o)&&n.hostname!==l),w=c&&n.rootDomain&&!g&&(h||u);if(w&&!i.pasteBlocked)return e.logException(Error("Paste should have been blocked but wasn't"),{fileName:"data-paste-detected-handler.ts",funcName:"dataPasteDetectedHandler"}),{decision:"noAction"};if(w&&i.pasteBlocked){let e=p===m;return{decision:"showWebcard",vaultItemRootDomain:p,tabRootDomain:e?l:m}}return{decision:"allowPaste",vaultItem:a}}async function sc(e,t,a,r,i){if(!t.tab?.url)throw Error("Unexpected missing tab url");let n=await tC(e,r.type,a);if(!n)throw Error("Can not find source item of the copy");return(await tF(e)).isB2CFrozen||!await sn(e)?{decision:"allowPaste",vaultItem:n}:n.vaultType===eC.k.Credential?sd(e,t.tab.url,n,r,i):{decision:"allowPaste",vaultItem:n}}let su=async(e,t,a,r,i,n)=>{try{let s=await sc(e,a,r,i,n);"showWebcard"===s.decision?so(t,{vaultItem:s.vaultItemRootDomain,tab:s.tabRootDomain},i,r):"allowPaste"===s.decision&&(n.pasteBlocked&&t.permissionToPaste(es.AllFrames,!0),await sr(e,t,i,s.vaultItem))}catch(a){e.logException(a,{fileName:"data-paste-detected-handler.ts",funcName:"dataPasteDetectedHandler"}),n.pasteBlocked&&t.permissionToPaste(es.AllFrames,!0)}};async function sp(e,t,a,r,i){e.grapheneClient.autofillSecurity.commands.disablePhishingPreventionForUrl({credentialUrl:a.urlOfCopiedItem,pasteDestinationUrl:a.urlOfPasteDestination});let n=await tC(e,i.type,r);n&&await sr(e,t,i,n)}var sm=a(38466);let sg=async(e,t)=>{let a=await e.connectors.carbon.requestPaymentUpdateAuthenticationToken();t.updatePaymentUpdateAuthenticationToken(es.SenderFrame,a)};var sh=a(80801);async function sw(e,t){try{let a=(0,sh.z)(),r=await e.connectors.carbon.initUserVerificationWithWebAuthn({relyingPartyId:a});if(!r.success){t.updateWebAuthnStatus(es.SenderFrame,ay.Error);return}let i=await e.connectors.carbon.getUserLoginStatus();t.updateWebAuthnChallenge(es.SenderFrame,{login:i.login,publicKeyOptions:r.response.publicKeyOptions})}catch(e){throw t.updateWebAuthnStatus(es.SenderFrame,ay.Error),e}}let sy=async(e,t,a,r,i,n,s)=>{i===ed.Success&&(await e.connectors.grapheneClient.autofillSecurity.commands.resetProtectedItemAutofillTimer(),n.neverAgain&&await aq(e,t,a,r.data.dataSource.vaultId),await rN(e,t,a,r.data),t.closeWebcard(es.SenderFrame,s))},sb=async(e,t,a,r,i,n)=>{if(i===ed.Success){if(!a.url||!a.tab?.url)return;await e.connectors.grapheneClient.autofillSecurity.commands.resetProtectedItemAutofillTimer();let{vaultIngredient:i,itemId:s,previouslyCopiedProperties:o}=r,l=await tC(e,i.type,s);if(!l)return;let d=await rS(e,{ingredient:i,vaultItem:l}),c=iy(l,i.type);if(!c)return;let u={webcardType:aS.FollowUpNotification,webcardId:n,formType:"",webcardData:c,copiedProperties:[...o,i.property]};d&&(t.copyValueToClipboard(es.AllFrames,d),t.updateWebcard(es.SenderFrame,u))}};var sf=a(72211),sS=a(58782);let sC=new Uint8Array(16).fill(0),sA=new Uint8Array([83,17,38,214,231,23,65,92,147,32,61,154,166,152,18,57]),sI=[],sM=async e=>{if(!await ev(e.connectors))throw new iY},sT=async(e,t)=>{let{authenticatorSelection:a,hints:r}=t,i=await aO(e);return!(a?.userVerification==="required"&&0===i.length||!(r instanceof Array&&r.length>0)&&a?.authenticatorAttachment&&"platform"!==a.authenticatorAttachment||a?.residentKey&&"discouraged"===a.residentKey)},sk=(e,t,a)=>{if(e.options.rp.id=e.options.rp.id??a,iJ(e.options.rp.id,a))throw new iY({logError:ab.SecurityError})},sP=async(e,t,a,i)=>{let n;try{if(r=Date.now(),!(await e.connectors.carbon.getUserLoginStatus()).loggedIn)throw new iY;if(await sM(e),i.userVerificationDone)throw new iK(ab.InvalidStateError);let{effectiveDomain:s,requestOrigin:o}=i$(a,i),l=(0,iP.N)(i.options.user.id);if(l.byteLength<1||l.byteLength>64)throw new iY({logError:ab.InvalidStateError});sk(i,e,s);let[d,c]=await iW(e,i.options.pubKeyCredParams);if(void 0===d&&!c||(n=c?ew.PasskeyType.Cloud:ew.PasskeyType.Legacy,!await sT(e,i.options)))throw new iY({logError:ab.NotSupportedError});let u={webcardType:aS.WebauthnCreateConfirmation,webcardId:(0,ef.Z)(),formType:"login",rpName:i.options.rp.name,userDisplayName:i.options.user.displayName,request:i};await iX(e,u.webcardId,o),t.showWebcard(es.MainFrame,u)}catch(s){let r=s instanceof iK||s instanceof iY?s.errorName:ab.UnknownError;if(r&&iN(e,i,a,{ceremonyStatus:ew.CeremonyStatus.Failure,passkeyType:n,errorName:r}),t.webauthnCreateResponse(es.SenderFrame,i.requestId,{status:"useFallback",reason:"cannotRegister"}),!(s instanceof iK||s instanceof iY))throw s}};async function sE(e,t,a){let r,i;let{publicKey:n,privateKey:s}=await e.generateNewKeyPair(a.browserApi),o=t.options.rp.id;if(void 0===o)throw new iK(ab.SecurityError);let l=await a.connectors.carbon.getSpaces();l=l.length>1?l:[];do r=i2(16),i=(0,sS.K)(r);while("uuid"===i4(i));let d=l.find(e=>""!==e.spaceId),c=d?.settings.enableForcedCategorization?d.spaceId:"",u={credentialId:i,rpId:o,rpName:t.options.rp.name,userHandle:t.options.user.id,userDisplayName:t.options.user.displayName,counter:0,spaceId:c,keyAlgorithm:e.coseAlgorithmIdentifier,privateKey:{crv:"",d:"",ext:!0,key_ops:[],kty:"",x:"",y:"",...s}},p=await a.connectors.carbon.addPasskey(u);if(!p.success)throw new iK(ab.UnknownError);return{credentialIdBuffer:r,credentialIdBase64Url:i,counter:0,publicKey:n,rpId:o,passkeyItemId:p.id}}let sv=async(e,t,a,r)=>{let i=a.options.rp.id;if(a.options.excludeCredentials.length>0&&i){let n=(await iL(e,i)).items,s=iz(a.options.excludeCredentials);if(n.some(e=>s.includes(e.credentialId)))throw t.closeWebcard(es.SenderFrame,r),new iK(ab.InvalidStateError)}},sR=async(e,t,a,r,i)=>{let n=a.options.rp.id;if(void 0===n)throw new iK(ab.SecurityError);let{registerPasskey:s}=e.connectors.grapheneClient.cloudPasskey.queries,o=await (0,eT.z)(s({request:{clientDataHash:"",options:{user:a.options.user,pubKeyCredParams:a.options.pubKeyCredParams,attestation:a.options.attestation,extensions:a.options.extensions,rp:{id:n,name:a.options.rp.name}},origin:iZ(r)?.effectiveDomain??"",userVerificationDone:a.userVerificationDone}}));if((0,eI.hx)(o))switch(o.error.tag){case sf.qH.INVALID_STATE_ERROR:throw new iK(ab.InvalidStateError);case sf.qH.NOT_ALLOWED_ERROR:throw new iK(ab.NotAllowedError);case sf.qH.NOT_SUPPORTED_ERROR:throw new iK(ab.NotSupportedError);case sf.qH.SECURITY_ERROR:throw new iK(ab.SecurityError);case sf.qH.UNKNOWN_ERROR:default:throw new iK(ab.UnknownError)}let{credentialRegisterData:l,id:d}=o.data;return t.webauthnCreateResponse(es.AllFrames,a.requestId,{status:"success",value:{...l,rawId:l.id,clientDataJSON:(0,sS.K)(new TextEncoder().encode(i)),authenticatorAttachment:l.authenticatorAttachment,transports:l.transports}}),d},sN=async(e,t,a,i,n)=>{let s;try{let o;if(!(await e.connectors.carbon.getUserLoginStatus()).loggedIn)throw new iK(ab.InvalidStateError);let[l,d]=await iW(e,i.options.pubKeyCredParams);s=d?ew.PasskeyType.Cloud:ew.PasskeyType.Legacy,await sv(e,t,i,n);let c=await i3(e,t,i,n);if("stop"===c)return;let u=await i0(e,n);if(void 0===u)throw new iK(ab.InvalidStateError);let p={type:"webauthn.create",challenge:i.options.challenge,origin:u,crossOrigin:!1},m=JSON.stringify(p);if(d)s=ew.PasskeyType.Cloud,o=await sR(e,t,i,u,m);else if(void 0===l)throw new iK(ab.NotSupportedError);else{s=ew.PasskeyType.Legacy;let a=await sE(l,i,e);o=a.passkeyItemId;let r={};i.options.extensions?.credProps&&(r.credProps={rk:!0});let n=new ArrayBuffer(2);new DataView(n).setUint16(0,a.credentialIdBuffer.byteLength,!1);let d=l.encodePublicKey(a.publicKey),c=await new Blob([function(e){for(let t of sI)if(e===t||e.endsWith(`.${t}`))return sC;return sA}(a.rpId),n,a.credentialIdBuffer,d]).arrayBuffer(),u=await iq(e.browserApi,a.rpId),p=new Uint8Array([iH.USER_PRESENT|iH.ATTESTED_CRED_DATA_INCLUDED|iH.BACKUP_ELIGIBILITY|iH.BACKUP_STATE|(i.userVerificationDone?iH.USER_VERIFIED:0)]),g=new ArrayBuffer(4);new DataView(g).setUint32(0,a.counter,!1);let h=await new Blob([u,p,g,c]).arrayBuffer(),w=iU.encode({fmt:"none",attStmt:{},authData:h}),y={type:"public-key",rawId:a.credentialIdBase64Url,id:a.credentialIdBase64Url,clientDataJSON:(0,sS.K)(new TextEncoder().encode(m)),attestationObject:(0,sS.K)(w),authenticatorAttachment:"platform",authenticatorData:(0,sS.K)(h),publicKey:(0,sS.K)(d),publicKeyAlgorithm:l.coseAlgorithmIdentifier,transports:["internal","hybrid"],clientExtensionResults:r};t.webauthnCreateResponse(es.AllFrames,i.requestId,{status:"success",value:y})}let g=Date.now()-r,h=await e.connectors.carbon.getPasskey(o);iN(e,i,a,{ceremonyStatus:ew.CeremonyStatus.Success,passkeyType:s,msToCompleteCeremony:g,spaceId:h.spaceId})}catch(n){let r=n instanceof iK?n.errorName:ab.UnknownError;if(iN(e,i,a,{ceremonyStatus:ew.CeremonyStatus.Failure,passkeyType:s,errorName:r}),t.webauthnCreateResponse(es.AllFrames,i.requestId,{status:"error",errorName:r}),!(n instanceof iK))throw n}},sF=async(e,t,a,r,i)=>{let{requestOrigin:n}=i$(a,r),s=r.options.allowCredentials??[],o=await ij(t,i,s);if(0===o.length)throw new iY;if(1===o.length){let a=o[0],i={webcardType:aS.WebauthnGetConfirmation,webcardId:(0,ef.Z)(),formType:"login",rpName:a.rpName,request:r,allowUsingOtherAuthenticator:0===s.length,passkey:{passkeyItemId:a.id,userDisplayName:a.userDisplayName}};await iX(t,i.webcardId,n),e.showWebcard(es.MainFrame,i);return}if(o.length>1){let a=await t.connectors.carbon.getSpaces();a=a.length>1?a:[];let i={webcardType:aS.WebauthnPasskeySelection,webcardId:(0,ef.Z)(),formType:"login",passkeys:(await i1(t,a,o)).map(e=>e.webcardItem),metadata:aJ({},{type:aC.WebauthnRequest,request:r})};await iX(t,i.webcardId,n),e.showWebcard(es.MainFrame,i)}},s_=(e,t,a)=>{if(e.options.rpId=e.options.rpId??a,iJ(e.options.rpId,a))throw new iY({logError:ab.SecurityError})},sD=async(e,t,a,r)=>{try{i=Date.now();let{loggedIn:n}=await e.connectors.carbon.getUserLoginStatus();if(!n||!await ev(e.connectors))throw new iY;if(r.userVerificationDone)throw new iK(ab.InvalidStateError);let{effectiveDomain:s}=i$(a,r);s_(r,e,s);let o=await aO(e);if("required"===r.options.userVerification&&0===o.length)throw new iY({logError:ab.NotSupportedError});if("conditional"===r.mediation){t.webauthnStoreConditionalUiRequest(es.SenderFrame,{...r,mediation:"conditional"});return}r.options.rpId=r.options.rpId??s;let l=r.options.rpId;await sF(t,e,a,r,l)}catch(n){let i=n instanceof iK||n instanceof iY?n.errorName:ab.UnknownError;if(i&&i_(e,r,a,{ceremonyStatus:ew.CeremonyStatus.Failure,passkeyType:void 0,errorName:i}),t.webauthnGetResponse(es.SenderFrame,r.requestId,{status:"useFallback",reason:"cannotAuthenticate"}),!(n instanceof iK||n instanceof iY))throw n}},sL=async(e,t,a,r,n,s)=>{let o;try{if(!(await e.connectors.carbon.getUserLoginStatus()).loggedIn)throw new iK(ab.InvalidStateError);let l=await i3(e,t,{...r,passkeyItemId:n},s);if("stop"===l)return;let d=await i0(e,s);if(void 0===d)throw new iK(ab.InvalidStateError);let c={type:"webauthn.get",challenge:r.options.challenge,origin:d,crossOrigin:""!==r.parentFrameOrigin&&void 0!==r.parentFrameOrigin&&r.parentFrameOrigin!==d},u=JSON.stringify(c),p=await iq(e.browserApi,u),m=await e.connectors.carbon.getPasskey(n),g=iO.find(e=>e.coseAlgorithmIdentifier===m.keyAlgorithm);if(m.keyAlgorithm===iG.aG.CloudPasskey){o=ew.PasskeyType.Cloud;let a=r.options.rpId;if(void 0===a)throw new iK(ab.SecurityError);let{usePasskey:i}=e.connectors.grapheneClient.cloudPasskey.queries,s=await (0,eT.z)(i({id:n,request:{clientDataHash:(0,sS.K)(p),options:{rpId:a,extensions:r.options.extensions},origin:iZ(d)?.effectiveDomain??"",userVerificationDone:r.userVerificationDone}}));if((0,eI.hx)(s))switch(s.error.tag){case sf.qH.INVALID_STATE_ERROR:throw new iK(ab.InvalidStateError);case sf.qH.NOT_ALLOWED_ERROR:throw new iK(ab.NotAllowedError);case sf.qH.NOT_SUPPORTED_ERROR:throw new iK(ab.NotSupportedError);case sf.qH.SECURITY_ERROR:throw new iK(ab.SecurityError);case sf.qH.UNKNOWN_ERROR:default:throw new iK(ab.UnknownError)}let{credentialGetData:l}=s.data;t.webauthnGetResponse(es.AllFrames,r.requestId,{status:"success",value:{...l,rawId:l.id,response:{authenticatorData:l.response.authenticatorData,signature:l.response.signature,userHandle:l.response.userHandle,clientDataJSON:(0,sS.K)(new TextEncoder().encode(u))}}})}else if(void 0===g)throw new iK(ab.NotSupportedError);else{o=ew.PasskeyType.Legacy;let a=Number.isInteger(m.counter)&&0!==m.counter?m.counter+1:0;await e.connectors.carbon.updatePasskey({id:n,counter:a});let i=await iq(e.browserApi,m.rpId),s=new Uint8Array([iH.USER_PRESENT|iH.BACKUP_ELIGIBILITY|iH.BACKUP_STATE|(r.userVerificationDone?iH.USER_VERIFIED:0)]),l=new ArrayBuffer(4);new DataView(l).setUint32(0,a,!1);let d=await new Blob([i,s,l]).arrayBuffer(),c=await g.sign(await new Blob([d,p]).arrayBuffer(),m.privateKey),h=new TextEncoder().encode(m.credentialId),w="uuid"===i4(m.credentialId)?(0,sS.K)(h):m.credentialId,y={type:"public-key",rawId:w,id:w,response:{authenticatorData:(0,sS.K)(d),clientDataJSON:(0,sS.K)(new TextEncoder().encode(u)),signature:(0,sS.K)(c),userHandle:m.userHandle},authenticatorAttachment:"platform"};t.webauthnGetResponse(es.AllFrames,r.requestId,{status:"success",value:y})}let h=Date.now()-i;i_(e,r,a,{ceremonyStatus:ew.CeremonyStatus.Success,passkeyType:o,msToCompleteCeremony:h,displayName:m.userDisplayName,spaceId:m.spaceId})}catch(n){let i=n instanceof iK?n.errorName:ab.UnknownError;if(i_(e,r,a,{ceremonyStatus:ew.CeremonyStatus.Failure,passkeyType:o,errorName:i}),t.webauthnGetResponse(es.AllFrames,r.requestId,{status:"error",errorName:i}),!(n instanceof iK))throw n}},sG=async(e,t,a,r,i,n)=>{if(i===ed.Success){let i={...r.request,userVerificationDone:!0};switch(i.type){case af.Create:await sN(e,t,a,i,n);break;case af.Get:if(!i.passkeyItemId)throw await iQ(e,t,a,r.request),Error("Can not complete webauthn get operation without passkey item id");await sL(e,t,a,i,i.passkeyItemId,n);break;default:throw Error("Pending operation not supported")}}else await iQ(e,t,a,r.request)},sU=async(e,t,a,r,i,n,s)=>{if(!(r.type===aC.PendingOperation&&"operation"in r))throw Error("Invalid pending operation");let o=r.operation;switch(o.type){case a$.ApplyAutofillDetails:await sy(e,t,a,o,i,n,s);break;case a$.Webauthn:await sG(e,t,a,o,i,s);break;case a$.CopyValue:await sb(e,t,a,o,i,s);break;default:throw Error("Pending operation not supported")}};async function sx(e,t,a,r){try{let a=await e.connectors.grapheneClient.userVerification.commands.validateWebauthnAssertion({assertion:r});t.updateWebAuthnStatus(es.SenderFrame,(0,eI.d6)(a)?ay.Success:ay.Error)}catch(e){throw t.updateWebAuthnStatus(es.SenderFrame,ay.Error),e}}let sB=async(e,t,a,r)=>{let i=await e.connectors.carbon.validateMasterPassword(r);t.setMasterPasswordValidationResult(es.SenderFrame,i)};async function sO(e){let t=await (0,ex.O)(e.connectors.grapheneClient.pinCode.queries.getCurrentUserStatus()),a=(0,eI.ho)(t);return a.isPinCodeEnabled?a.attemptsLeft:0}let sV=async(e,t,a,r)=>{try{let a=await (0,eT.z)(e.connectors.grapheneClient.pinCode.queries.isPinCodeCorrect({pinCode:r})),{isPinCodeCorrect:i}=(0,eI.ho)(a),n=await sO(e);t.setPinCodeValidationResult(es.SenderFrame,{success:!0,isPinCodeCorrect:i,remainingAttempts:n})}catch(e){t.setPinCodeValidationResult(es.SenderFrame,{success:!1})}},sW=async(e,t,a,r,i)=>{let n={};switch(i){case eC.k.Address:n=await rj(e,r);break;case eC.k.BankAccount:n=await rJ(e,r);break;case eC.k.Company:n=await rQ(e,r);break;case eC.k.Credential:n=await r0(e,r);break;case eC.k.DriverLicense:n=await r6(e,r);break;case eC.k.Email:n=await r5(e,r);break;case eC.k.FiscalId:n=await r9(e,r);break;case eC.k.IdCard:n=await ie(e,r);break;case eC.k.Identity:n=await io(e,r);break;case eC.k.Passport:n=await id(e,r);break;case eC.k.PaymentCard:n=await rq(e,r);break;case eC.k.PersonalWebsite:n=await iu(e,r);break;case eC.k.Phone:n=await im(e,r);break;case eC.k.SocialSecurityId:n=await ig(e,r)}t.updateWebcardItemDetails(es.SenderFrame,r,i,n)},sY=[eC.k.Address,eC.k.BankAccount,eC.k.Company,eC.k.Credential,eC.k.DriverLicense,eC.k.Email,eC.k.FiscalId,eC.k.IdCard,eC.k.Identity,eC.k.Passport,eC.k.PaymentCard,eC.k.PersonalWebsite,eC.k.Phone,eC.k.SocialSecurityId],sK=async(e,t,a,r,i)=>{let n=a.tab?.url;if(!n)return;let s=[],o=0;if(i)o=(s=(await ni(e,n,a,{formClassification:i.formClassification,autofillRecipes:i.autofillRecipes,...i.srcElementDetails},r)).webcardItems).length;else{let t=await tI({context:e,searchQuery:r,itemTypes:sY,sorting:{property:"lastUse",direction:"descend"},limit:20});s=t.items.map(e=>iw({vaultType:e.vaultType,vaultItem:e})),o=t.count}t.updateWebcardItems(es.SenderFrame,s,o)},sH=async(e,t,a,r)=>{let i=await (0,eT.z)(e.connectors.grapheneClient.passwordHealth.queries.filterCredentialsIds({spaceId:null,credentialIds:r}));if((0,eI.d6)(i)){let e=i.data.reduce((e,t)=>(t.corruptionData?.riskType&&(e[t.id]=t.corruptionData.riskType),e),{});t.updateWebcardCredentialsAtRisk(es.SenderFrame,e)}},sq=(e,t,a)=>{let r=e.find(e=>e.settings.enableForcedCategorization&&e.settings.spaceForcedDomains.some(e=>{let r=t=>""!==e&&t&&t.includes(e);return r(a)||r(t)}));return{forceCategorizationEnabled:void 0!==r,forcedSpace:r?.spaceId}},sz=e=>e.length<=18?e:`${e.slice(0,18)}...`,sj=(e,t,a)=>{let{forceCategorizationEnabled:r,forcedSpace:i}=sq(e,t,a);return{spaces:e.map(({letter:e,color:t,spaceId:a,displayName:r})=>({letter:e,color:t,spaceId:a,displayName:sz(r)})),showSpacesList:e.length>1&&!r,defaultSpace:i??""}},sZ={[eC.k.Address]:e=>{if(!e[0])return;let t=rV(e,"country")?.value??"",a=e1(t),r=a!==e$.f.NO_TYPE?e4(a):t,i=[rV(e,"addressFull")?.value,rV(e,"city")?.value,r].filter(Boolean).join(`,\u00A0`);return{type:eC.k.Address,content:i,addressFull:rV(e,"addressFull")?.value??"",city:rV(e,"city")?.value??"",zipCode:rV(e,"zipCode")?.value??"",country:r,localeFormat:a}},[eC.k.Email]:e=>{if(e[0])return{type:eC.k.Email,content:rV(e,"email")?.value??"",email:rV(e,"email")?.value??""}},[eC.k.Identity]:e=>{if(!e[0])return;let t=rV(e,"birthDate"),a=rV(e,"birthDay"),r=rV(e,"birthMonth"),i=rV(e,"birthYear"),n="";t?.format?.dateFormat?n=ir(ts(t.value,tr(t.format.dateFormat))):a&&r&&i&&(n=ir({day:a.value,month:r.value,year:i.value}));let s=[rV(e,"firstName")?.value,rV(e,"lastName")?.value].filter(Boolean).join(`,\u00A0`);return{type:eC.k.Identity,content:s,firstName:rV(e,"firstName")?.value??"",lastName:rV(e,"lastName")?.value??"",birthDate:n,birthPlace:rV(e,"birthPlace")?.value??""}},[eC.k.PaymentCard]:e=>{let t=rV(e,"cardNumber")?.value??"",a=rV(e,"securityCode")?.value??"",r=t.replace(/\s/g,""),i=!!a&&3===a.length,n=!!r&&rx(r);if(!e[0]||!n||!i)return;let{month:s,year:o}=rH(e);return{type:eC.k.PaymentCard,content:rV(e,"name")?.value??"",cardName:rV(e,"name")?.value??"",ownerName:r_(e),expireMonth:s??"",expireYear:o??"",securityCode:a,cardNumber:r}},[eC.k.Phone]:e=>{if(!e[0])return;let t=e1(rV(e,"country")?.value);return{type:eC.k.Phone,content:rV(e,"number")?.value??"",number:rV(e,"number")?.value??"",localeFormat:t}},[eC.k.PersonalWebsite]:e=>{if(e[0])return{type:eC.k.PersonalWebsite,content:rV(e,"website")?.value??"",website:rV(e,"website")?.value??""}}},sJ=(e,t)=>sZ[e]?.(t),s$=/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/i,sQ=e=>s$.test(e),sX=/^[+]?([(]?[0-9]{1,4}[)]?[-\s.]?){1,5}$/,s0=e=>sX.test(e),s1={[eC.k.Address]:!0,[eC.k.BankAccount]:!1,[eC.k.Company]:!1,[eC.k.Credential]:!1,[eC.k.DriverLicense]:!1,[eC.k.Email]:!0,[eC.k.FiscalId]:!1,[eC.k.GeneratedPassword]:!1,[eC.k.IdCard]:!1,[eC.k.Identity]:!0,[eC.k.Note]:!1,[eC.k.Passkey]:!1,[eC.k.Passport]:!1,[eC.k.PaymentCard]:!0,[eC.k.PersonalWebsite]:!0,[eC.k.Phone]:!0,[eC.k.SocialSecurityId]:!1,[eC.k.Secret]:!1},s4={[eC.k.Address]:3,[eC.k.BankAccount]:0,[eC.k.Company]:0,[eC.k.Credential]:0,[eC.k.DriverLicense]:0,[eC.k.Email]:1,[eC.k.FiscalId]:0,[eC.k.GeneratedPassword]:0,[eC.k.IdCard]:0,[eC.k.Identity]:2,[eC.k.Note]:0,[eC.k.Passkey]:0,[eC.k.Passport]:0,[eC.k.PaymentCard]:3,[eC.k.PersonalWebsite]:1,[eC.k.Phone]:1,[eC.k.SocialSecurityId]:0,[eC.k.Secret]:0},s2=(e,t)=>e.type===t||t===eC.k.Phone&&e.type===eC.k.Address&&"country"===e.property,s6=(e,t,a)=>{if(t.type!==a)return!1;let r=new eB.Y(e).isUrlValid();switch(t.type){case eC.k.Email:return!("email"===t.property&&!sQ(e));case eC.k.PersonalWebsite:return!("website"===t.property&&!r);case eC.k.Phone:return!(("number"===t.property||"numberInternational"===t.property)&&!s0(e));default:return!0}},s3=(e,t)=>{let a=[];return(e.forEach(e=>{e.ingredients.forEach(r=>{t$(r)&&s2(r,t)&&s6(e.value,r,t)&&a.push({value:e.value,property:r.property,format:r.format})})}),(t!==eC.k.Phone||a.find(e=>"number"===e.property))&&(t!==eC.k.Identity||a.find(({property:e})=>"firstName"===e||"lastName"===e))&&(t!==eC.k.PaymentCard||a.find(({property:e})=>"cardNumber"===e)))?a:[]},s5=e=>{let t=Object.values(e),a=s3(t,eC.k.Address),r=s3(t,eC.k.Email),i=s3(t,eC.k.Identity),n=s3(t,eC.k.Phone),s=s3(t,eC.k.PersonalWebsite),o=s3(t,eC.k.PaymentCard);return{[eC.k.Address]:a,[eC.k.Email]:r,[eC.k.Identity]:i,[eC.k.PaymentCard]:o,[eC.k.PersonalWebsite]:s,[eC.k.Phone]:n}};var s8=a(17242),s9=a(4274);let s7=async e=>{let t=await (0,eT.z)(e.connectors.grapheneClient.vaultOrganization.queries.queryCollections({})),a=await (0,eT.z)(e.connectors.grapheneClient.sharingCollections.queries.sharedCollectionsWithItems());return[...(0,eI.d6)(t)?(0,eI.db)(t).collections:[],...(0,eI.d6)(a)?(0,eI.db)(a):[]].map(e=>"isShared"in e?e:{...e,isShared:!1}).sort((e,t)=>e.name.toLowerCase().localeCompare(t.name.toLowerCase()))},oe=async(e,t,a)=>{let r={collectionId:t.id,permission:s9.y3.Admin};await e.connectors.grapheneClient.sharingCollections.commands.addItemsToCollections({collectionPermissions:[r],itemIds:[a.credentialId]})},ot=async(e,t,a)=>{await e.connectors.grapheneClient.vaultOrganization.commands.updateCollection({id:t.id,collection:{vaultItems:[{id:a.credentialId}]},operationType:s8.C.APPEND_VAULT_ITEMS})},oa=async(e,t,a)=>{let r=t.isShared?oe(e,t,a):ot(e,t,a);await r},or=(e,t)=>tA({context:e,url:t,vaultType:eC.k.Credential,queryOptions:{sortCriteria:[{field:"lastUse",direction:"descend"}],filterCriteria:[]}}),oi=(e,t)=>tA({context:e,url:t,vaultType:eC.k.Email,queryOptions:{sortCriteria:[{field:"lastUse",direction:"descend"}],filterCriteria:[]}}),on=async(e,t)=>(await oi(e,t)).map(e=>e.email),os=async(e,t,a)=>{if(a)return a;let r=await oi(e,t);return 1===r.length?r[0].email:""},oo=async(e,t,a,r)=>{let i=await e.state.tab.get(),n=await e.connectors.carbon.getUserLoginStatus(),s=new eB.Y(a.url),o=s.getRootDomain(),l=s.getSubdomain(),d=s.getHostname(),c=await e.connectors.carbon.getSpaces();c=c.length>1?c:[];let u=await or(e,a.url),p=await tN(e),m=await tF(e),g=u.filter(({sharingStatus:e})=>!e?.isShared||e.canEdit).map(e=>iw({vaultType:eC.k.Credential,vaultItem:e,premiumStatusSpace:c.find(t=>t.spaceId===e.spaceId)})),h=await os(e,a.url,a.capturedEmailOrLogin),w=await on(e,a.url),y=await e.connectors.carbon.getIsSSOUser(),b=await e.connectors.carbon.getAccountAuthenticationType(),{showSpacesList:f,spaces:S,defaultSpace:C}=sj(await e.connectors.carbon.getSpaces(),h,d),A=await e_(e.connectors),I=A?await s7(e):[],{capturedEmail:M,capturedLogin:T,capturedSecondaryLogin:k}=a,P=i.dataCaptureStepData?.firstStepUrl??a.url;return nC(e),{webcardId:r??(0,ef.Z)(),webcardType:aS.SavePassword,formType:t,capturedUsernames:{email:M??"",login:T??"",secondaryLogin:k??""},emailOrLogin:h,existingCredentialsForDomain:g,dropdownLoginOptions:w,domain:o,subdomain:l,fullDomain:d,url:nA(P),loggedIn:n.loggedIn,allowMasterPasswordProtection:!y&&"masterPassword"===b,showSubdomainOpt:!!l,space:C,showSpacesList:f,spaces:S,passwordToSave:a.newPassword,passwordLimitStatus:p,showAccountFrozenStatus:m,collections:I,showCollectionList:A&&I.length>0}},ol=(e,t,a,r,i)=>{let n=new eB.Y(t).getHostname();return{webcardId:(0,ef.Z)(),webcardType:aS.B2CFrozenDialog,savePasswordDisplayUrl:n,formType:a,passwordLimit:r}},od=(e,t)=>e.getRootDomain()===t.getRootDomain()&&""!==t.getSubdomain(),oc=async(e,t,a,r,i)=>{if(i){let n=await (0,eT.z)(e.grapheneClient.vaultItemsCrud.queries.query({vaultItemTypes:[eO.U.Credential],ids:[i]})),s=await (0,eT.z)(e.grapheneClient.autofillSettings.queries.getPreferencesForCredentials({credentialIds:[i]}));if((0,eI.d6)(n)&&(0,eI.d6)(s)&&n.data.credentialsResult.matchCount>0){let o=n.data.credentialsResult.items[0],l=await (0,eT.z)(e.grapheneClient.linkedWebsites.queries.getDashlaneDefinedLinkedWebsites({url:o.URL})),d=new eB.Y(o.URL),c=new eB.Y(a),u=c.getHostname();if((!od(d,c)||"www"!==c.getSubdomain()&&s.data[0]?.onlyAutofillExactDomain)&&ny(r,o)&&!o.linkedURLs.includes(u)&&(0,eI.d6)(l)&&!l.data.includes(u)){let a={webcardType:aS.LinkedWebsiteUpdateConfirmation,webcardId:(0,ef.Z)(),formType:"",operation:{credentialId:i,credentialName:o.itemName,linkedWebsite:u}},r=await e.grapheneClient.linkedWebsites.commands.addLinkedWebsite({credentialId:i,linkedWebsite:u});return(0,eI.d6)(r)&&await tO(e,t,a),!0}}}return!1},ou=async(e,t,a,r,i,n)=>{if(!(!await tB(e,aS.FeedbackNotification)||await oc(e,t,a,r,n))&&!await nf(e,a,r)){let n=await oo(e,i.formClassification,{newPassword:r.capturedPassword,url:a,capturedEmailOrLogin:r.capturedEmailOrLogin,capturedEmail:r.capturedEmail,capturedLogin:r.capturedLogin,capturedSecondaryLogin:r.capturedSecondaryLogin});await tO(e,t,n)&&t.subscribeLiveValuesUpdate(es.AllFrames,i.formId,n.webcardId)}},op=async(e,t,a,r,i)=>{let n=ol(e,a,r.formClassification,i);await tO(e,t,n)},om=async(e,t,a,r,i,n)=>{let{limit:s}=await tN(e),o=(await tF(e)).isB2CFrozen;o&&!s&&e.logException(Error("User is frozen but there is no known password limit")),o&&s?await op(e,t,a,i,s):await ou(e,t,a,r,i,n)},og=async(e,t,a)=>{let r=e.connectors.carbon,i=await r.getUserLoginStatus(),n=Object.keys(t).reduce((e,a)=>{let r=t[a];if(s1[a]&&r){let t=sJ(a,r);t&&e.push(t)}return e},[]);return{webcardId:(0,ef.Z)(),webcardType:aS.DataCapture,loggedIn:i.loggedIn,data:n,formType:a.formClassification}},oh=async(e,t)=>{let a=e.map(e=>tT({context:t,vaultType:e})),r=await Promise.all(a);return e.filter((e,t)=>0===r[t])},ow=async(e,t)=>{let a=Object.keys(t).filter(e=>{let a=t[e]??[];return s1[e]&&a.length>=s4[e]}),r=await oh(a,e),i={};return r.forEach(e=>{i[e]=t[e]}),i},oy=async(e,t,a,r)=>{if((await tF(e)).isB2CFrozen)return;let i=await ow(e,a);if(Object.keys(i).length>0){let a=await og(e,i,r);await tO(e,t,a)}},ob=async(e,t,a,r,i)=>{let n=await e.connectors.carbon.getUserLoginStatus(),s=!1;if(!n.loggedIn)try{let t=await (0,eT.z)(e.connectors.grapheneClient.credentialRiskDetection.queries.isCredentialRiskDetectionEnabledForDevice());s=(0,eI.d6)(t)&&t.data.isEnabled}catch{s=!1}if(!n.loggedIn&&!s||Object.keys(r).length<1)return;let o=Object.keys(r)[0],l=r[o].elementValues;if(!a.tab?.url||r[o].preventDataCapture)return;let d=await nw(l,a.tab.url,e);if(n.loggedIn){if(d)await om(e,t,a.tab.url,d,r[o],i);else{let a=s5(l);await oy(e,t,a,r[o])}}else if(s&&d){let t=await (0,eT.z)(e.connectors.grapheneClient.credentialRiskDetection.queries.analysePasswordForRisks({password:d.capturedPassword}));if((0,eI.d6)(t)){let r=t.data.isCompromised?"compromised":t.data.isWeak?"weak":"safe";e.connectors.grapheneClient.credentialRiskDetection.commands.sendRiskyPasswordLoggedOutLog({domain:new eB.Y(a.tab.url).getHostname(),dateTime:new Date().getTime(),uuid:(0,ef.Z)().toUpperCase(),healthStatus:r})}}},of=async(e,t,a,r,i)=>{if(Object.keys(r).length<1)return;let n=Object.keys(r)[0],s=r[n].elementValues,o=await tY(e,i);if(o&&o.webcardType===aS.SavePassword&&a.tab?.url){let r=await nw(s,a.tab.url,e);if(r){let a=r.capturedPassword,n=r.capturedEmailOrLogin??o.emailOrLogin,s=r.capturedLogin??o.capturedUsernames.login,l=r.capturedSecondaryLogin??o.capturedUsernames.secondaryLogin,d=r.capturedEmail??o.capturedUsernames.email;if(o.passwordToSave!==a||o.emailOrLogin!==n||o.capturedUsernames.login!==s||o.capturedUsernames.email!==d||o.capturedUsernames.secondaryLogin!==l){let r={...o,passwordToSave:a,emailOrLogin:n,capturedUsernames:{email:d,login:s,secondaryLogin:l}};await tK(e,r),t.updateSavePasswordCapturedData(es.AllFrames,i,a,n,{email:d,login:s,secondaryLogin:l})}nC(e)}}},oS=async(e,t,a)=>{if(t)return(await tA({context:e,url:a,vaultType:eC.k.Credential})).find(e=>e.email===t||e.login===t)},oC=async(e,t,a,r,i)=>{let n=await oS(e,r,i),s=await e.connectors.carbon.getSpaces();if(n)t.updateSavePasswordTargetCredential(es.SenderFrame,{space:n.spaceId,showSpacesList:s.length>1&&!n.isForceCategorizedSpace},{id:n.id,subdomain:new eB.Y(n.url).getSubdomainWithoutLeadingWww(),onlyForThisSubdomain:n.subdomainOnly,isProtected:n.autoProtected});else{let{showSpacesList:e,defaultSpace:a}=sj(s,r,new eB.Y(i).getHostname());t.updateSavePasswordTargetCredential(es.SenderFrame,{space:a,showSpacesList:e})}};var oA=a(48834),oI=a(52235);function oM(e){return e in tj.cH?e:tj.cH.NO_TYPE}let oT=e=>{switch(e.type){case eC.k.Email:return{kwType:tj.dJ.KWEmail,origin:oA.Up.MAV_DATACAPTURE,content:{email:e.email,emailName:e.email,type:"NO_TYPE"}};case eC.k.Phone:return{kwType:tj.dJ.KWPhone,origin:oA.Up.MAV_DATACAPTURE,content:{type:oI.z.PHONE_TYPE_ANY,phoneName:e.number,number:e.number,localeFormat:oM(e.localeFormat)}};case eC.k.Address:return{kwType:tj.dJ.KWAddress,origin:oA.Up.MAV_DATACAPTURE,content:{addressName:"",addressFull:e.addressFull,city:e.city,zipCode:e.zipCode,country:e.country,localeFormat:oM(e.localeFormat),receiver:"",state:"",streetNumber:"",building:"",stairs:"",floor:"",door:"",digitCode:""}};case eC.k.Identity:return{kwType:tj.dJ.KWIdentity,origin:oA.Up.MAV_DATACAPTURE,content:{title:"",firstName:e.firstName,middleName:"",lastName:e.lastName,pseudo:"",birthDate:e.birthDate,birthPlace:e.birthPlace}};case eC.k.PersonalWebsite:return{kwType:tj.dJ.KWPersonalWebsite,origin:oA.Up.MAV_DATACAPTURE,content:{website:e.website,name:e.website}};case eC.k.PaymentCard:return{kwType:tj.dJ.KWPaymentMean_creditCard,origin:oA.Up.MAV_DATACAPTURE,content:{cardName:e.cardName,cardNumber:e.cardNumber,expireMonth:e.expireMonth,expireYear:e.expireYear,ownerName:e.ownerName,securityCode:e.securityCode,personalNote:""}};default:return}},ok=async(e,t,a,r)=>{(await e.connectors.carbon.getUserLoginStatus()).loggedIn&&r.forEach(t=>{let a=oT(t);a&&e.connectors.legacyCarbon.savePersonalDataItem(a)})};var oP=((v={}).SaveCredential="save-credential",v.UpdateCredential="update-credential",v);let oE=/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/i,ov=e=>oE.test(e),oR=async(e,t)=>{let{emailOrLogin:a,capturedUsernames:r,password:i,url:n,onlyForThisSubdomain:s,protectWithMasterPassword:o,spaceId:l,selectedCollection:d}=t,c=ov(a),u={email:c?a:r.email,login:c?r.login:a,secondaryLogin:r.secondaryLogin,password:i,url:n,onlyForThisSubdomain:s,protectWithMasterPassword:o,spaceId:l},p=await e.connectors.carbon.addCredential(u);return await e_(e.connectors)&&d&&await oa(e,d,p),p},oN=(e,t)=>{let{id:a,passwordToSave:r,onlyForThisSubdomain:i,spaceId:n}=t;return e.connectors.carbon.updateCredential({id:a,update:{password:r,spaceId:n,onlyForThisSubdomain:i}})},oF={google:"accounts.google.com"},o_=async(e,t)=>{let a=new eB.Y(e),r=oF[a.getRootDomainName()]??a.getRootDomain(),i=`https://${r}/.well-known/change-password`;try{if((await fetch(i)).ok){let e=await fetch(`https://${r}/.well-known/resource-that-should-not-exist-whose-status-code-should-not-be-200`);if(404===e.status)return i}}catch(e){t.logException(e,{fileName:"check-existing-credential-risk-handler.ts",funcName:"getChangePasswordUrl"})}},oD=e=>{let t=[];return e.compromisedPasswordInappNudgesEnabled&&t.push(ak.gI.Compromised),e.reusedPasswordInappNudgesEnabled&&t.push(ak.gI.Reused),e.weakPasswordInappNudgesEnabled&&t.push(ak.gI.Weak),t},oL={analysisResultsAvailable:nZ,phishingResultsAvailable:n8,documentComplete:n4,applySelfCorrectingAutofill:n0,disableDashlaneOnField:n$,userRightClickOnElement:se,startWebAuthnUserVerificationFlow:sw,validateWebAuthnUserVerificationFlow:sx,startWebAuthnLoginFlow:async(e,t)=>{if((await e.connectors.carbon.getUserLoginStatus()).loggedIn){t.updateWebAuthnStatus(es.SenderFrame,ay.Success);return}let a=(await e.connectors.carbon.getLocalAccounts()).find(e=>e.isLastSuccessfulLogin);if(!a||"webauthn"!==a.rememberMeType){t.updateWebAuthnStatus(es.SenderFrame,ay.Error);return}let r=a.login,i=await e.connectors.carbon.initOpenSessionWithWebAuthnAuthenticator({login:r,relyingPartyId:self.location.host}).catch(()=>({success:!1,error:{code:sm.bL.UNKNOWN_ERROR}}));if(!i.success){t.updateWebAuthnStatus(es.SenderFrame,ay.Error);return}t.updateWebAuthnChallenge(es.SenderFrame,{login:r,publicKeyOptions:i.response.publicKeyOptions})},completeWebAuthnLoginFlow:async(e,t,a,r,i)=>{let n=await e.connectors.carbon.openSessionWithWebAuthnAuthenticator({login:r,credential:i}).catch(()=>({success:!1}));t.updateWebAuthnStatus(es.SenderFrame,n.success?ay.Success:ay.Error)},disableReactivationWebcards:async e=>{await e.connectors.carbon.setReactivationStatus({reactivationStatus:ik._g.DISABLED})},validateMasterPassword:sB,validatePinCode:sV,resetProtectedItemsTimerAndApplyRecipe:async(e,t,a,r)=>{let i=await e.connectors.carbon.getIsSSOUser(),n=await e.connectors.carbon.getAccountAuthenticationType();if(!(i||"masterPassword"!==n))throw Error("In resetProtectedItemsTimerAndApplyRecipe, attempt to reset protection timer for non-passwordless user");if(!t0(r))throw Error(`In resetProtectedItemsTimerAndApplyRecipe, called without a VaultDataSource '${r}'`);await e.grapheneClient.autofillSecurity.commands.resetProtectedItemAutofillTimer(),await rN(e,t,a,r)},disableAccessProtectionForVaultItem:aq,requestPaymentUpdateAuthenticationToken:sg,webauthnCreate:sP,webauthnCreateUserConfirmed:sN,webauthnGet:sD,webauthnGetUserConfirmed:sL,webauthnUseOtherAuthenticator:(e,t,a,r)=>{let i;switch((i=aZ(r)?r.request:r).type){case af.Create:t.webauthnCreateResponse(es.AllFrames,i.requestId,{status:"useFallback",reason:"otherAuthenticator"});break;case af.Get:t.webauthnGetResponse(es.AllFrames,i.requestId,{status:"useFallback",reason:"otherAuthenticator"})}return Promise.resolve()},webauthnUserCanceled:iQ,webauthnIsConditionalUiSupported:i8,userVerificationComplete:sU,userFocusOnElement:nc,applyAutofillRecipe:rF,applyAutofillRecipeForOtherDataSource:rE,logAutofillPerformedEvent:aX,generateNewPassword:async(e,t,a,r)=>{let i=e.connectors.carbon,n=await i.generatePassword({settings:{digits:r.digits,letters:r.letters,avoidAmbiguous:r.avoidAmbiguous,symbols:r.symbols,length:r.length}}),[s,o]=n.success?[n.password,n.strength]:["",-1];t.updateNewPassword(es.SenderFrame,s,o)},queryVaultItems:sK,getVaultItemDetails:sW,webcardItemSelected:(e,t,a,r,i,n)=>{let s=i[aC.WebauthnRequest];if(s){if(!aZ(s))throw Error("Invalid webauthn metadata in selected webcard item");let i=s.request;if(i.type!==af.Get)throw Error("Wrong webauthn metadata type in selected webcard item");if(r.itemType!==eC.k.Passkey)throw Error("Wrong item type associated with webauthn metadata");return sL(e,t,a,i,r.itemId,n)}throw Error("Unsupported webcard item")},getCredentialsAtRiskByIds:sH,savePersonalData:ok,findSavePasswordTargetCredential:oC,captureDataFromPage:ob,checkExistingCredentialRisk:async(e,t,a,r)=>{if(!(await e.connectors.carbon.getUserLoginStatus()).loggedIn||!await si(e)||Object.keys(r).length<1)return;let i=Object.keys(r)[0],n=r[i].elementValues;if(!a.tab?.url||r[i].preventDataCapture)return;let s=await nw(n,a.tab.url,e);if(!s)return;let o=await nS(e,a.tab.url,s);if(!(o&&(!o.sharingStatus?.isShared||o.sharingStatus.canEdit)))return;let l=new eB.Y(a.tab.url).getRootDomain(),d=await e.state.tab.get(),c=d.lastInAppNudge?.domain;if(!c||c!==l){let a=await (0,eT.z)(e.connectors.grapheneClient.teamPlanDetails.queries.getTeamPolicies());if((0,eI.d6)(a)&&(a.data.compromisedPasswordInappNudgesEnabled||a.data.reusedPasswordInappNudgesEnabled||a.data.weakPasswordInappNudgesEnabled)){let n=oD(a.data),s=await (0,eT.z)(e.connectors.grapheneClient.passwordHealth.queries.filterCredentialsIds({credentialIds:[o.id],spaceId:null})),c=(0,eI.d6)(s)?(0,eI.db)(s)[0]:void 0;if(c?.corruptionData&&n.includes(c.corruptionData.riskType)&&c.id===o.id){let a=await o_(o.url,e);await e.state.tab.set({...d,lastInAppNudge:{domain:l}});let n={webcardId:(0,ef.Z)(),webcardType:aS.SecurityNudge,formType:r[i].formClassification,itemId:o.id,riskType:c.corruptionData.riskType,domainName:new eB.Y(o.url).getRootDomainName(),changePasswordUrl:a,reuseCount:c.corruptionData.riskType===ak.gI.Reused?c.corruptionData.reuseCount:void 0};await tO(e,t,n),await e.connectors.carbon.logEvent({event:new ew.UserReceiveSecurityAlertEvent({itemTypesAffected:[ew.ItemType.Credential],securityAlertType:ew.SecurityAlertType.NudgeInContext,securityAlertItemId:o.id,nudgeType:aG[c.corruptionData.riskType]})})}}}},notifyLiveValuesUpdate:of,saveCredential:async(e,t,a,r,i)=>{if(!(await e.connectors.carbon.getUserLoginStatus()).loggedIn)return;let n=await e.state.tab.get(),{url:s,emailOrLogin:o}=i,l=new eB.Y(s).getHostname();await tW(e,r);let{credentialId:d}=await oR(e,i),c={webcardType:aS.FeedbackNotification,operation:{type:oP.SaveCredential,credentialId:d,fullDomain:l,emailOrLogin:o},webcardId:r,formType:""};await a6(e)?(await e.state.tab.set({...n,persistentWebcards:{...n.persistentWebcards,[c.webcardId]:c}}),t.updateWebcard(es.SenderFrame,c)):(t.closeWebcard(es.SenderFrame,r),await a2(e,t,!0))},updateCredential:async(e,t,a,r,i)=>{let n=await e.state.tab.get();if(!(await e.connectors.carbon.getUserLoginStatus()).loggedIn)return;let s=new eB.Y(a.tab?.url??"").getHostname(),{id:o,title:l,newPassword:d,onlyForThisSubdomain:c,spaceId:u}=i;await tW(e,r),await oN(e,{id:o,passwordToSave:d,onlyForThisSubdomain:c,spaceId:u});let p={webcardType:aS.FeedbackNotification,operation:{type:oP.UpdateCredential,fullDomain:s,credentialId:o,emailOrLogin:l},webcardId:r,formType:""};await e.state.tab.set({...n,persistentWebcards:{...n.persistentWebcards,[p.webcardId]:p}}),t.updateWebcard(es.SenderFrame,p)},cancelSaveCredential:async(e,t)=>{await a2(e,t,!1)},dataCopiedToClipboardDetected:async(e,t,a,r,i,n)=>{let s;if(n.type===eC.k.Credential)try{let t=await tC(e,n.type,i);s=t?await (0,sa.W)(st.x,new eB.Y(t.url).getHostname()):void 0}catch(t){e.logException(t,{message:"Failed to retrieve credential domain",fileName:"user-paste-information-handler.ts",funcName:"dataCopiedToClipboardDetected"})}t.dataCopiedAlert(es.AllFrames,r,i,n,s)},dataPasteDetected:su,copyToClipboard:async(e,t,a,r,i,n,s)=>{if(!a.url||!a.tab?.url)return;let o=await tC(e,i.type,r);if(o){if((await aY(e,r,i.type)).isProtected){let a={type:a$.CopyValue,itemId:r,vaultIngredient:i,previouslyCopiedProperties:s},o=await e.connectors.carbon.getIsSSOUser(),l=await e.connectors.carbon.getAccountAuthenticationType(),d={source:ew.AuthenticatorUserVerificationSource.CopyVaultItem},c=o||"masterPassword"!==l?{webcardId:n,webcardType:aS.AutofillConfirmationPasswordLess,pendingCopyOperation:a,formType:"login"}:await aV(e,a,d,n);t.updateWebcard(es.MainFrame,c)}else{let a=await rS(e,{ingredient:i,vaultItem:o});a&&t.copyValueToClipboard(es.AllFrames,a)}}},signalPasteDecision:async(e,t,a,r,i)=>{if(!a.url||!a.tab?.url)return;t.permissionToPaste(es.AllFrames,r.allowedByUser);let n=i?.[aC.PhishingPrevention];r.allowedByUser&&n&&n.type===aC.PhishingPrevention&&await sp(e,t,r,n.itemId,n.vaultIngredient)},removeLinkedWebsite:async(e,t,a,r,i)=>{await e.grapheneClient.linkedWebsites.commands.removeLinkedWebsite({credentialId:r,linkedWebsite:i})},webcardClosed:async(e,t,a,r)=>{await tW(e,r)},logEvent:async(e,t,a,r)=>{await e.connectors.carbon.logEvent({event:r}).catch(tU)},logPageView:async(e,t,a,r)=>{await e.connectors.carbon.logPageView(r).catch(tU)},logException:(e,t,a,r,i)=>{let n={[eh.Injected]:"injectedtsException",[eh.Webcards]:"webcardsException",[eh.Popup]:"popupException"};return er(i.message,n[r],e.connectors,()=>{},{precisions:i.precisions,additionalInfo:i.additionalInfo}),Promise.resolve()},sendPropertyCopiedActivityLog:tG,logFormSubmit:ey,logRightClickMenu:eb,getUserSubscriptionCode:async(e,t)=>{if((await e.connectors.carbon.getUserLoginStatus()).loggedIn){let a=await (0,ex.O)(e.connectors.grapheneClient.subscriptionCode.queries.getSubscriptionCode());t.updateUserSubscriptionCode(es.SenderFrame,(0,eI.d6)(a)?a.data:"")}},getUserFeatureFlips:async(e,t)=>{let a={},{loggedIn:r}=await e.connectors.carbon.getUserLoginStatus();r&&(a=await eP(e.connectors)),t.updateUserFeatureFlips(es.SenderFrame,a)},...eg},oG=["https://*/*"],oU=()=>({global:{get:()=>{throw Error("Global state unavailable in basic auth")},set:()=>{throw Error("Global state unavailable in basic auth")}},tab:{get:()=>{throw Error("Persistent tab state unavailable in basic auth")},set:()=>{throw Error("Persistent tab state unavailable in basic auth")}}});class ox{constructor(e,t,a){(0,N._)(this,"_browserApi",void 0),(0,N._)(this,"_injectedConnectors",void 0),(0,N._)(this,"_logException",void 0),(0,N._)(this,"_pendingRequestIds",[]),(0,N._)(this,"requestCompleted",e=>{let t=this._pendingRequestIds.indexOf(e.requestId);-1!==t&&this._pendingRequestIds.splice(t,1)}),(0,N._)(this,"authRequired",async e=>{let t=await o7(this._injectedConnectors),a={state:oU(),browserApi:this._browserApi,connectors:t,grapheneClient:t.grapheneClient,logException:this._logException};if(!(await a.connectors.carbon.getUserLoginStatus()).loggedIn||this._pendingRequestIds.includes(e.requestId))return{};this._pendingRequestIds.push(e.requestId);let r=new Promise((e,t)=>setTimeout(()=>{t(Error("Credential fetch timed out after 3000ms"))},3e3)),i=iA(a,e.url),n=(await Promise.race([r,i])).filter(e=>e.autoLogin);if(n.length>0){let t=n.find(t=>new eB.Y(t.url).getHostname()===new eB.Y(e.url).getHostname())??n[0];return{authCredentials:{username:t.login||t.email,password:t.password}}}return{}}),this._browserApi=e,this._injectedConnectors=t,this._logException=a}}let oB=(e,t,a)=>{if(n9.isSafari())return;let r=(e,r)=>{o7(t).then(t=>er(e,"autofillEngineException",t,a,{...r,message:"Exception during basic auth process"}))},i=new ox(e,t,r),n=e=>{try{i.requestCompleted(e)}catch(e){r(e,{fileName:"basicAuth.ts",funcName:"registerBasicAuthListeners"})}};e.webRequest.onCompleted.addListener(n,{urls:oG},[]),e.webRequest.onErrorOccurred.addListener(n,{urls:oG}),e.webRequest.onAuthRequired.addListener(e=>i.authRequired(e).catch(e=>(r(e,{fileName:"basicAuth.ts",funcName:"registerBasicAuthListeners"}),{})),{urls:oG},[z.C.Blocking])},oO="autofill-engine-state-global",oV="autofill-engine-state-",oW=["http://*/*","https://*/*"],oY=e=>e?.url&&void 0!==e.id,oK=(e,t)=>e.tabs.query({...t,url:oW}).then(e=>e.filter(oY)),oH=e=>oK(e,{active:!0,lastFocusedWindow:!0}),oq=e=>(t,a)=>{let{browserApi:r,messageLogger:i,tabId:n,openPorts:s,port:o,sender:l}=e,d=o?.sender??l,c={};switch(a){case es.SenderFrame:if(!d)throw Error("No sender provided, target SenderFrame is invalid");c.frameId=d.frameId;break;case es.MainFrame:c.frameId=0;case es.AllFrames:}o&&a===es.SenderFrame?o.postMessage(t):(r.tabs.sendMessage(n,t,c),s.getPorts(n,c.frameId).forEach(e=>e.postMessage(t)))},oz=(e,t,a)=>async(t,r)=>{let i={};switch(r){case es.SenderFrame:throw Error("target SenderFrame is invalid");case es.MainFrame:i.frameId=0;case es.AllFrames:}(await oK(e)).forEach(r=>{r.id&&(e.tabs.sendMessage(r.id,t,i,()=>{if(e.runtime.lastError?.message==="Error: Could not establish connection. Receiving end does not exist.");else throw Error(e.runtime.lastError?.message)}),a.getPorts(r.id,i.frameId).forEach(e=>e.postMessage(t)))})},oj=async(e,t,a,r,i)=>{let[n]=await oH(e);if(n?.url){let s=el(oq({browserApi:e,messageLogger:r,tabId:n.id??0,openPorts:a}));await nR(t,i,s,es.AllFrames,n.url)}},oZ=(e,t,a,r,i)=>{n&&n.unsubscribe(),n=i.autofillSettings.queries.getAutofillSettings().subscribe(n=>{(0,eI.d6)(n)&&oj(e,t,a,r,i)})};var oJ=a(42912),o$=a(32985);let oQ=async(e,t,a,r)=>{let i=await Promise.all(t.map(async e=>{let t;if(e.binary){let a=e.blob;try{let e=await fetch(a);t=await e.blob()}catch{return null}}else t=new Blob([e.blob],{type:"text/plain"});return{name:e.filename,input:t}}).filter(Boolean));try{let t=await (0,oJ.RZ)(i).blob(),r=new URL(e).hostname+"-capture.zip",n=await new Promise((e,a)=>{let r=new FileReader;r.onloadend=()=>{"string"==typeof r.result?e(r.result):a(Error("Reader result not a string"))},r.onerror=a,r.readAsDataURL(t)}),s=await (0,o$.L)({url:n,filename:r,saveAs:!0});a("Vortex zip download started",{downloadId:s,timestamp:Date.now()})}catch(e){r(e,{message:"Exception in saveAsZip function",fileName:"start.ts",funcName:"saveAsZip"})}},oX=e=>(e.id??"")===(0,sh.z)(),o0=e=>e.origin??new URL(e.url??"").origin,o1=async(e,t,a)=>{try{let a;let r=o0(t);if(r===new URL(e.browserApi.runtime.getURL("")).origin||oX(t))return;let i=t.tab?.url||t.tab?.pendingUrl;if(i&&r&&r===new URL(i).origin){let t=await e.state.tab.get();await e.state.tab.set({...t,origin:r}),a=r}else a=(await e.state.tab.get()).origin;if(r&&i&&a&&a===new URL(i).origin)return}catch{}if("documentComplete"!==a)throw Error("Message sender is not trusted")};var o4=a(81010);let o2=`^${oV}([0-9]*)$`;async function o6(){let e=function(e){let t=[];e.includes(oO)&&t.push(oO);let a=new RegExp(o2);return e.reduce((e,t)=>a.test(t)?e.concat(t):e,t)}(Object.keys(await (0,x.U)(null)));e.length&&(0,o4.O)(e)}let o3=e=>`${oV}${e}`,o5="Unexpected undefined global state",o8="options.useInjectScriptOnStart",o9=async(e,t,a)=>{try{let r=await nE(a,["autofill_web_injectScriptOnStart","autofill_web_injectScriptOnStart_dev"]),i=await nP(e,o8);r!==i&&nk(e,t,{key:o8,value:r})}catch(e){throw Error(`Error in checkInjectScriptOnStartFF: ${e}`)}};async function o7(e){let t=await e.grapheneClientPromise;return{...e,grapheneClient:t}}let le=(e,t,a)=>({global:{get:async()=>{let e=await t.getState(oO);return void 0===e?(a(Error(o5),{fileName:"start.ts",funcName:"buildStateForTab",omitPrefix:!0}),{}):e},set:e=>t.setState(oO,e)},tab:{get:async()=>{let r=await t.getState(o3(e));return void 0===r?(a(Error("Unexpected undefined tab state"),{fileName:"start.ts",funcName:"buildStateForTab",omitPrefix:!0}),{}):r},set:a=>t.setState(o3(e),a)}}),lt=(e,t)=>({global:{get:async()=>{let a=await e.getState(oO);return void 0===a?(t(Error(o5),{fileName:"start.ts",funcName:"buildStateForPopup",omitPrefix:!0}),{}):a},set:t=>e.setState(oO,t)},tab:{get:()=>{throw Error("Can't access tab state in a command called from Popup")},set:()=>{throw Error("Can't change tab state in a command called from Popup")}}}),la=e=>{let{browserApi:t,injectedConnectors:a,openPorts:r,stateStorage:i,message:n,messageLogger:s,launchCapture:o,port:l,sender:d,sendResponse:c}=e,u=l?.sender??d;if(!eu(n)||!u)return!1;let p=(e,t)=>{o7(a).then(a=>er(e,"autofillEngineException",a,s,t?.omitPrefix?{...t}:{...t,message:`Exception processing command ${n.cmd}`}))};return(async()=>{let e,c;let m=await o7(a);if(u.tab?.id){let a=u.tab.id;e={state:le(a,i,p),browserApi:t,command:n,connectors:m,grapheneClient:m.grapheneClient,logException:p,launchCapture:o},c=el(oq({browserApi:t,messageLogger:s,tabId:a,openPorts:r,sender:d,port:l}))}else e={state:lt(i,p),browserApi:t,connectors:m,grapheneClient:m.grapheneClient,logException:p},c=el(oz(t,s,r));await o1(e,u,n.cmd),await oL[n.cmd](e,c,u,...n.parameters)})().catch(e=>{p(e,{fileName:"start.ts",funcName:"runtimeOnMessageListener",message:""})}).finally(()=>c()),!0},lr=async(e,t,a,r,i,{loggedIn:n},s)=>{let o=await o7(t);n&&(oZ(e,o,a,r,o.grapheneClient),n7(e,r,i,o,s),o9(e,r,o));let[l]=await oH(e);if(l?.url){let t=el(oq({browserApi:e,messageLogger:r,tabId:l.id??0,openPorts:a}));await nN(o,o.grapheneClient,t,es.AllFrames,l.url,n)}},li=(e,t)=>{let a=!1;return{get:async()=>{let r=await e.getState(oO);return void 0===r?(t(Error(o5),{fileName:"start.ts",funcName:"startAutofillEngine"}),{}):(a||(r={...r,...aw},await e.setState(oO,r),a=!0),r)},set:t=>e.setState(oO,t)}},ln=async(e,t,a,r,i)=>{let n=await o7(t),{loggedIn:s}=await n.carbon.getUserLoginStatus(),o=(await oK(e)).filter(e=>e.url&&e.id&&i.tabIds.includes(e.id));await Promise.all(o.map(async t=>{let i=el(oq({browserApi:e,messageLogger:r,tabId:t.id??0,openPorts:a}));await nN(n,n.grapheneClient,i,es.AllFrames,t.url??"",s),i.updateTabActiveInfo(es.AllFrames,!0)}))},ls=(e,t,a,r)=>{let i=(e,a)=>{o7(t).then(t=>er(e,"autofillEngineException",t,r,a??{}))};try{let n=new ep,s=new ee.y,o=li(a,i);t.carbon.liveLoginStatus.on(async a=>{try{await lr(e,t,n,r,i,a,o)}catch(e){i(e,{message:"Exception in liveLoginStatus handler",fileName:"start.ts",funcName:"startAutofillEngine"})}}),t.carbon.getUserLoginStatus().then(async a=>{try{await lr(e,t,n,r,i,a,o)}catch(e){i(e,{message:"Exception in getUserLoginStatus promise",fileName:"start.ts",funcName:"startAutofillEngine"})}}),e.contextMenus.onClicked.addListener((t,a)=>{if(!a?.id)throw Error("No tab ID while handling a right-click menu interaction");if("capture-page"===t.menuItemId){let e=()=>s.activate(a,{onSuccess:(e,t)=>{oQ(e,t,r,i),r("Vortex capture success",{timestamp:Date.now()})},onError:e=>{i(e,{message:"Exception in pageCaptureBackground.activate",fileName:"start.ts",funcName:"startAutofillEngine"})}});(0,et.r)({permissions:["downloads"]},t=>{if(t){e();return}(0,ea.W)({permissions:["downloads"]},t=>{t&&e()})})}"correct-autofill"===t.menuItemId&&el(oq({browserApi:e,messageLogger:r,tabId:a.id,openPorts:n})).computeContextMenuTargetInfo(es.AllFrames,t.frameId??0)}),e.tabs.onRemoved.addListener(e=>{a.setState(o3(e),{}).catch(e=>{i(e,{message:"Exception in onRemoved handler",fileName:"start.ts",funcName:"startAutofillEngine"})})}),e.tabs.onHighlighted.addListener(async a=>{try{await ln(e,t,n,r,a)}catch(e){i(e,{message:"Exception in onHighlighted handler",fileName:"start.ts",funcName:"startAutofillEngine"})}}),e.runtime.onConnect.addListener(o=>{n.storePort(o),o.onDisconnect.addListener(e=>n.removePort(e)),o.onMessage.addListener(l=>{try{return la({browserApi:e,injectedConnectors:t,openPorts:n,stateStorage:a,messageLogger:r,message:l,port:o,launchCapture:(...e)=>{s.activate(...e)},sendResponse:()=>{}})}catch(e){return i(e,{message:"Exception in onConnect.onMessage handler",fileName:"start.ts",funcName:"startAutofillEngine"}),!1}})}),e.runtime.onMessage.addListener((o,l,d)=>{try{return la({browserApi:e,injectedConnectors:t,openPorts:n,stateStorage:a,messageLogger:r,message:o,launchCapture:(...e)=>{s.activate(...e)},sender:l,sendResponse:d})}catch(e){return i(e,{message:"Exception in runtime.onMessage handler",fileName:"start.ts",funcName:"startAutofillEngine"}),!1}}),oB(e,t,r),o6()}catch(e){i(e,{message:"Exception while starting autofill-engine",fileName:"start.ts",funcName:"startAutofillEngine"})}},lo=0,ll=e=>"object"==typeof e&&null!==e&&"type"in e&&"query"===e.type&&"id"in e&&"number"==typeof e.id&&"content"in e,ld=e=>"object"==typeof e&&null!==e&&"type"in e&&"response"===e.type&&"id"in e&&"number"==typeof e.id&&"content"in e,lc=(e,t,a)=>{let r=++lo,i=t=>{ld(t)&&t.id===r&&(a(t.content),e.onMessage.removeListener(i))};e.onMessage.addListener(i),e.postMessage({type:"query",id:r,content:t})},lu=(e,t,a)=>!!ll(e)&&a(e.content,a=>{let r={type:"response",id:e.id,content:a};t.postMessage(r)});var lp=((R={}).GetWebcardInitialData="GetWebcardInitialData",R.UpdateWebcardGeometry="UpdateWebcardGeometry",R.WebcardOpened="WebcardOpened",R.WebcardClosed="WebcardClosed",R.IframeEvent="IframeEvent",R.KeyboardNavigationEvent="KeyboardNavigationEvent",R.SubscribeKeyboardNavigationEvents="SubscribeKeyboardNavigationEvents",R.RemoveSubscriptionsForClosedWebcard="RemoveSubscriptionsForClosedWebcard",R.VisibilityCheckRequest="VisibilityCheckRequest",R.GetAllowAttributeForIframe="GetAllowAttributeForIframe",R);let lm="autofill-engine-dispatcher",lg=e=>"object"==typeof e&&null!==e&&"identifier"in e&&"options"in e&&"object"==typeof e.options&&null!==e.options&&"message"in e.options&&"string"==typeof e.options.message&&e.options.message in lp&&e.identifier===lm,lh=e=>{let t;let a=function(e,t){let a;let r=new ep;return e.runtime.onConnect.addListener(e=>{e.name.startsWith(t)&&(r.storePort(e),e.onDisconnect.addListener(e=>r.removePort(e)),e.onMessage.addListener(t=>{a&&lu(t,e,(t,r)=>!!a&&!!e.sender&&a(t,e.sender,r))}))}),{setListener:e=>{a=e},sendMessage:(e,t,a,i)=>{r.getPorts(t,a).forEach(t=>lc(t,e,i))}}}(e,lm),r=(e.runtime.onMessage.addListener((e,a,r)=>t?.(e,a,r)??!1),{setListener:e=>{t=e},sendMessage:(t,a,r,i)=>{e.tabs.sendMessage(a,t,{frameId:r},i)}}),i=(e,t,i)=>{let n=t.tab?.id;if(!(n&&"number"==typeof t.frameId&&lg(e)))return!1;let{options:s}=e,o={options:{sourceFrameId:t.frameId,message:s.message},identifier:lm,parameters:e.parameters};return a.sendMessage(o,n,s.targetFrameId,i),r.sendMessage(o,n,s.targetFrameId,i),!0};a.setListener(i),r.setListener(i)}},87275:function(e,t,a){a.d(t,{w:()=>eE});var r,i,n=a(55466),s=a(2652),o=a(306),l=a(86223),d=a(64845),c=a(82161),u=a(3863),p=a(49213),m=a(72907),g=a(69853),h=a(1833),w=a(53868);let y=!1;try{y=IS_DEVTOOL_ENABLED,IS_STANDALONE_EXTENSION}catch{}var b=a(15636);class f{_onSendMessageListener(e,t,a){return!!(e&&this._messageListeners.has(e.msg))&&this._messageListeners.get(e.msg)(e,t,a)}addListener(e,t,a){if(this._messageListeners.has(t))throw Error("MessageHandler::addListener:: a listener already exists for message "+t);this._messageListeners.set(t,a.bind(e))}constructor(e){(0,n._)(this,"_messageListeners",void 0),this._messageListeners=new Map,b.p.addListener((t,a,r)=>{try{let i=this._onSendMessageListener(t,a,r);if("boolean"==typeof i)return i;return i.then(e=>r(e)).catch(t=>{e(t,{precisions:"Exception in onMessage listener",fileName:"MessageHandler.ts",funcName:"MessageHandler.constructor",code:s.w.ERROR}),r()}),!0}catch(t){return e(t,{precisions:"Exception in onMessage listener",fileName:"MessageHandler.ts",funcName:"MessageHandler.constructor",code:s.w.ERROR}),!1}})}}class S{setResource(e,t){this._resources[e]=t}setAllResources(e){this._resources=e}getResource(e){return e in this._resources?this._resources[e]:void 0}getAllResources(){return this._resources}constructor(){(0,n._)(this,"_resources",void 0),this._resources={}}}class C{constructor(e,t){(0,n._)(this,"frameId",void 0),(0,n._)(this,"innerMessage",void 0),(0,n._)(this,"msg",void 0),this.frameId=e,this.innerMessage=t,this.msg=C.MSG}}(0,n._)(C,"MSG","ContentToContentMessage");class A{constructor(){(0,n._)(this,"msg",A.MSG)}}(0,n._)(A,"MSG","classify");class I{constructor(e){(0,n._)(this,"debugMode",void 0),(0,n._)(this,"msg",void 0),this.debugMode=e,this.msg=I.MSG}}(0,n._)(I,"MSG","debug");class M{constructor(e){(0,n._)(this,"configuration",void 0),(0,n._)(this,"msg",void 0),this.configuration=e,this.msg=M.MSG}}(0,n._)(M,"MSG","allParameters");class T{constructor(e){(0,n._)(this,"lang",void 0),(0,n._)(this,"msg",void 0),this.lang=e,this.msg=T.MSG}}(0,n._)(T,"MSG","tabLanguage");class k{constructor(e){(0,n._)(this,"report",void 0),(0,n._)(this,"msg",void 0),this.report=e,this.msg=k.MSG}}(0,n._)(k,"MSG","dispatchIframeExportReportMessage");class P{constructor(e){(0,n._)(this,"frameId",void 0),(0,n._)(this,"msg",void 0),(0,n._)(this,"parentFrameId",void 0),this.frameId=e,this.msg=P.MSG}}(0,n._)(P,"MSG","queryFrameIdResponse");class E{constructor(){(0,n._)(this,"msg",E.MSG)}}(0,n._)(E,"MSG","queryAnalysisOnTopFrameIsSkippedInboundMessage");class v{constructor(e,t,a,r){(0,n._)(this,"frameId",void 0),(0,n._)(this,"frameIndex",void 0),(0,n._)(this,"name",void 0),(0,n._)(this,"url",void 0),(0,n._)(this,"msg",void 0),(0,n._)(this,"adyenTitle",void 0),this.frameId=e,this.frameIndex=t,this.name=a,this.url=r,this.msg=v.MSG}}(0,n._)(v,"MSG","ReportFrameIdAndIndexInboundMessage");class R{constructor(e,t,a){(0,n._)(this,"frameId",void 0),(0,n._)(this,"lastReport",void 0),(0,n._)(this,"forceReportEvenIfNoChange",void 0),(0,n._)(this,"msg",void 0),this.frameId=e,this.lastReport=t,this.forceReportEvenIfNoChange=a,this.msg=R.MSG}}(0,n._)(R,"MSG","iframeReport");class N{constructor(){(0,n._)(this,"msg",N.MSG)}}(0,n._)(N,"MSG","reclassifyIframeMessage");class F{constructor(){(0,n._)(this,"msg",F.MSG)}}(0,n._)(F,"MSG","getAllParameters");class _{constructor(){(0,n._)(this,"msg",_.MSG)}}(0,n._)(_,"MSG","getTabLanguage");class D{constructor(e){(0,n._)(this,"formsAndFieldsContexts",void 0),(0,n._)(this,"msg",void 0),this.formsAndFieldsContexts=e,this.msg=D.MSG}}(0,n._)(D,"MSG","ahoCorasickifyMessage");class L{constructor(e){(0,n._)(this,"isDevtoolEnabled",void 0),(0,n._)(this,"msg",void 0),this.isDevtoolEnabled=e,this.msg=L.MSG}}(0,n._)(L,"MSG","toggleDevtool");class G{constructor(e){(0,n._)(this,"formStructure",void 0),(0,n._)(this,"msg",void 0),this.formStructure=e,this.msg=G.MSG}}(0,n._)(G,"MSG","classificationReport");class U{constructor(e){(0,n._)(this,"scrapings",void 0),(0,n._)(this,"msg",void 0),this.scrapings=e,this.msg=U.MSG}}(0,n._)(U,"MSG","phishingReport");class x{constructor(e){(0,n._)(this,"report",void 0),(0,n._)(this,"msg",void 0),this.report=e,this.msg=x.MSG}}(0,n._)(x,"MSG","iframeExportReportMessage");class B{constructor(){(0,n._)(this,"msg",B.MSG)}}(0,n._)(B,"MSG","queryFrameId");class O{constructor(e,t,a){(0,n._)(this,"time",void 0),(0,n._)(this,"prose",void 0),(0,n._)(this,"url",void 0),(0,n._)(this,"msg",void 0),this.time=e,this.prose=t,this.url=a,this.msg=O.MSG}}(0,n._)(O,"MSG","timeToDMessage");class V{constructor(){(0,n._)(this,"msg",V.MSG)}}(0,n._)(V,"MSG","queryAnalysisOnTopFrameIsSkippedOutboundMessage");class W{constructor(){(0,n._)(this,"msg",W.MSG)}}(0,n._)(W,"MSG","initResourcesMessage");class Y{constructor(e){(0,n._)(this,"log",void 0),(0,n._)(this,"msg",void 0),this.log=e,this.msg=Y.MSG}}(0,n._)(Y,"MSG","logExceptionMessage");class K{constructor(){(0,n._)(this,"msg",K.MSG)}}(0,n._)(K,"MSG","getConfigurationMessage");class H{constructor(e){(0,n._)(this,"tiresiasBackgroundOption",void 0),(0,n._)(this,"msg",void 0),this.tiresiasBackgroundOption=e,this.msg=H.MSG}}(0,n._)(H,"MSG","setConfigurationMessage");let q=(e,t,a,r)=>{if(r.rateLimit&&r.rateLimit>=0&&r.rateLimit<Math.random())return;let i=r.rateLimit?`Rate limit applied: ${r.rateLimit}`:void 0,n=e instanceof Error?e.message:String(e),s=e instanceof Error?e.stack:void 0,o=r.appendExceptionToMessage??!0,l=[r.message,o?n:void 0].filter(e=>void 0!==e).join(" - "),d=l.length>150?l.slice(0,147)+"...":l,c=[r.precisions,s,i].filter(e=>void 0!==e).join("\n--\n");t({...r,message:d,precisions:c})},z=(e,t)=>(a,r)=>{q(a,e=>t.logException({exceptionType:"tiresiasException",log:e}),e,r)},j=(e,t)=>{e.logException({exceptionType:"tiresiasException",log:t})};class Z{get value(){return this._value}get children(){return this._children}get childCount(){return this._children?this._children.length:0}hasChild(e){if(!e)throw Error("AhoCorasickTrieNode::hasChild: invalid value");return!!this._children&&this._children.some(t=>t.value===e)}getChild(e){if(!e)throw Error("AhoCorasickTrieNode::getChild: invalid value");return this._children?this._children.find(t=>t.value===e)??null:null}addChild(e){if(!e)throw Error("AhoCorasickTrieNode::addChild: invalid value");if(!e.startsWith(this.value))throw Error("AhoCorasickTrieNode::addChild: unable to add child because value does not start with parent's value");if(e.length!==this.value.length+1)throw Error("AhoCorasickTrieNode::addChild: value has wrong size");this._children||(this._children=[]);let t=new Z(e);return this._children.push(t),t}find(e){if(this.value)throw Error("AhoCorasickTrieNode::find: context is not the root of the trie");let t="",a=this;for(let r=0;r<e.length;r++){t+=e[r];let i=a.getChild(t);if(!i)return null;a=i}return a}constructor(e){(0,n._)(this,"_value",void 0),(0,n._)(this,"_children",void 0),(0,n._)(this,"final",void 0),this._value=e,this._children=null,this.final=!1}}class J{search(e,t=!0){let a=[],r=[];for(let t=0;t<e.length;t++){let i=e[t];r.push(this._trie);let n=[];r.forEach(e=>{let r=e.value+i,s=e.getChild(r);s&&(n.push(s),s.final&&a.push({needle:s.value,startOffset:t-s.value.length+1,endOffset:t}))}),r=n}return a.sort((e,t)=>e.needle.length>t.needle.length?-1:e.needle.length<t.needle.length||e.endOffset>t.endOffset?1:e.endOffset<t.endOffset?-1:0),t?a:a.reduce((e,t)=>(e.length&&e.some(e=>t.startOffset<=e.endOffset&&t.endOffset>=e.startOffset)||e.push(t),e),[])}constructor(e){if((0,n._)(this,"_trie",void 0),!Array.isArray(e))throw Error("AhoCorasick::constructor: argument is not an array");this._trie=new Z(""),e.forEach(e=>{let t=this._trie;for(let a=0;a<e.length;a++){let r=e[a];if(t){let e=t.value+r;t=t.hasChild(e)?t.getChild(e):t.addChild(e)}else t=this._trie.addChild(r)}t&&(t.final=!0)})}}class ${_search(e,t=!0){return this._wrapped.search(e,t)}searchAndSplit(e){return this.kDISABLE?e:e.split(" ").reduce((e,t)=>{let a=this._search(t,!1);if(a?.length){a.sort((e,t)=>e.startOffset-t.startOffset);let r=0;for(let i of a)r!==i.startOffset&&e.push(t.substring(r,i.startOffset)),e.push(i.needle),r=i.endOffset+1;r<t.length&&e.push(t.substring(r))}else e.push(t);return e},[]).join(" ")}constructor(){(0,n._)(this,"kDISABLE",!1),(0,n._)(this,"_wrapped",void 0),this._wrapped=new J(["account","birth","change","compte","connect","connexion","cree","creation","create","date","daten","email","enregistre","enregistrer","enregistrez","enregistrement","first","forgot","identifier","identifiez","identification","inscrire","inscris","inscription","inscrivez","keep","log","oublie","passe","password","passeport","perdu","premier","register","remember","reset","search","sign","subscribe","update","user","users","username","validate"])}}var Q=a(30788);class X{setPandora(e){this._pandora=e}listen(){Q.b.addListener(e=>{e.onMessage.addListener(t=>{try{switch(t.name){case"init":if(!this.isEnabled){e.postMessage({name:"disable"});return}e.postMessage({name:"getClassifications",data:this._tabStorage.get(t.tabId)});break;case"devtoolModelContext":if(!t.data)throw Error("devtoolModelContext message sent without data");e.postMessage({name:"devtoolModelPrediction",data:this.contextPrediction(t.data)})}}catch(e){this.logException(e,{precisions:"Exception in onMessage listener",fileName:"DevtoolManager.ts",funcName:"DevtoolManager.listen",code:s.w.ERROR})}}),e.onDisconnect.addListener(t=>{try{let t=Object.keys(this._devtoolsConnection);for(let a=0,r=t.length;a<r;a++)if(this._devtoolsConnection[t[a]]===e){delete this._devtoolsConnection[t[a]];break}}catch(e){this.logException(e,{precisions:"Exception in onDisconnect listener",fileName:"DevtoolManager.ts",funcName:"DevtoolManager.listen",code:s.w.ERROR})}})})}storeTabFormsStructure(e,t){this.deleteTabId(e),this._tabStorage.set(e,t)}contextPrediction(e){let t={context:e.form,fields:e.fields.map(t=>({...t,form:{humanReadable:e.form.humanReadable,buttonVerbatim:e.form.buttonVerbatim,classification:""}}))};return this._pandora.explainStructure(t)}deleteTabId(e){this._tabStorage.has(e)&&this._tabStorage.delete(e)}cleanTabStorage(){for(let e of this._tabStorage.keys())this._tabStorage.delete(e)}constructor(e,t){(0,n._)(this,"isEnabled",void 0),(0,n._)(this,"logException",void 0),(0,n._)(this,"_devtoolsConnection",void 0),(0,n._)(this,"_tabStorage",void 0),(0,n._)(this,"_pandora",void 0),this.isEnabled=e,this.logException=t,this._devtoolsConnection={},this._tabStorage=new Map}}var ee=a(46160),et=a(32062),ea=((r={}).Json="JSON",r.Bson="BSON",r),er=((i={}).CANNOT_INIT_FILE="Cannot init from local directory",i.CANNOT_UPDATE_FILE="Cannot update file from distant server",i.UNKNOWN_ERROR="Unknown Error",i);class ei{buildLocalPath(){return"/data/"+this.fileName}getFileContent(){return this.fileContent}constructor(e){(0,n._)(this,"fileName",void 0),(0,n._)(this,"fileContent",void 0),this.fileName=e}}class en extends ei{loadLocally(){return new Promise((e,t)=>{this._localFileFetcher.fetch(this.buildLocalPath(),ea.Bson,t=>{this.fileContent=new this._classifierClassRef(t),e(this.fileContent)},e=>{t(Error(`${er.CANNOT_INIT_FILE}: ${e.message}`))})})}getRemoteUpdate(e){throw Error("Method not implemented.")}constructor(e,t,a){super(e),(0,n._)(this,"_localFileFetcher",void 0),(0,n._)(this,"_classifierClassRef",void 0),this._localFileFetcher=t,this._classifierClassRef=a}}class es extends en{constructor(e){super(es.NAME,e,ee.I)}}(0,n._)(es,"NAME","forms_model.min.bson");class eo extends en{constructor(e){super(eo.NAME,e,et.S)}}(0,n._)(eo,"NAME","fields_model.min.bson");class el extends ei{loadLocally(){return new Promise((e,t)=>{this._localFetcher.fetch(this.buildLocalPath(),ea.Json,t=>{this.fileContent=t,e(this.fileContent)},e=>{t(e)})})}getRemoteUpdate(e){return JSON.parse(e)}constructor(e){super(el.NAME),(0,n._)(this,"_localFetcher",void 0),this._localFetcher=e}}(0,n._)(el,"NAME","overrides.json");class ed{registerFileListener(e,t){return e in this.registeredFiles&&(this.registeredFiles[e].callback=t),this}async init(){await Promise.all(Object.values(this.registeredFiles).map(async({fileHandler:e,callback:t})=>{try{let a=await e.loadLocally();t&&t(a)}catch(e){this._tiresiasExceptionLogger(e,{precisions:"Exception in FileManager init",fileName:"FileManager.ts",funcName:"FileManager.init",code:s.w.ERROR})}}))}_handleGrapheneRemoteFileUpdate(){this._connectors.grapheneClient?.overrides.queries.overrides().subscribe(e=>{if(o.hx(e))return;let t=this.registeredFiles["overrides.json"].callback;t&&t(o.db(e).overrides)})}async handleRemoteFileMetaUpdate(e){let{carbonConnectorApi:t}=this._connectors;t&&await Promise.all(Object.keys(e).map(async e=>{if(!t||!(e in this.registeredFiles))return;let a=await this.registeredFiles[e].fileHandler.getRemoteUpdate(await t.getFileContent(e)),r=this.registeredFiles[e].callback;r&&r(a)}))}constructor(e,t,a){(0,n._)(this,"_tiresiasExceptionLogger",void 0),(0,n._)(this,"_localFileFetcher",void 0),(0,n._)(this,"_connectors",void 0),(0,n._)(this,"registeredFiles",void 0),this._tiresiasExceptionLogger=e,this._localFileFetcher=t,this._connectors=a,this.registeredFiles={[es.NAME]:{fileHandler:new es(this._localFileFetcher)},[eo.NAME]:{fileHandler:new eo(this._localFileFetcher)},[el.NAME]:{fileHandler:new el(this._localFileFetcher)}},this._connectors.carbonConnectorApi?.liveLoginStatus.on(({loggedIn:e})=>{e&&this._handleGrapheneRemoteFileUpdate()})}}var ec=a(1969),eu=a(87426);class ep{getParentFrameId(e,t){let a=this._tabMap.get(e);return a?a.get(t):void 0}constructor(e){(0,n._)(this,"_tabMap",void 0),this._tabMap=new Map,ec.a.addListener(t=>{try{if(t.tabId<0||t.frameId<0||t.parentFrameId<0)return;this._tabMap.has(t.tabId)||this._tabMap.set(t.tabId,new Map);let e=this._tabMap.get(t.tabId);if(e){if(e.has(t.frameId)&&e.get(t.frameId)===t.parentFrameId)return;e.set(t.frameId,t.parentFrameId)}}catch(t){e(t,{precisions:"Exception in onBeforeRequest listener",fileName:"FrameIdCollector.ts",funcName:"FrameIdCollector.constructor",code:s.w.ERROR})}},{urls:["<all_urls>"]}),u.$.addListener(t=>{try{this._tabMap.delete(t)}catch(t){e(t,{precisions:"Exception in onRemoved listener",fileName:"FrameIdCollector.ts",funcName:"FrameIdCollector.constructor",code:s.w.ERROR})}}),eu.g.addListener(t=>{try{t.id&&this._tabMap.set(t.id,new Map)}catch(t){e(t,{precisions:"Exception in onCreated listener",fileName:"FrameIdCollector.ts",funcName:"FrameIdCollector.constructor",code:s.w.ERROR})}})}}class em{setFormsClassifier(e){this._formsClassifier=e}setFieldsClassifier(e){this._fieldsClassifier=e}predictStructure(e){let t=this._formsClassifier.toString(this._formsClassifier.smartPredict(e.context));return{classification:t||"other",fields:e.fields.map(e=>(e.form.classification=t,this._fieldsClassifier.toString(this._fieldsClassifier.smartPredict(e))||"other"))}}explainStructure(e){let t=this._formsClassifier.smartPredict(e.context),a=this._formsClassifier.toString(t);return{form:{classification:a||"nothing",prediction:t,explanation:this._formsClassifier.explain(e.context),context:e.context},fields:e.fields.map(e=>{let t=this._fieldsClassifier.smartPredict(e);return e.form.classification=a,{classification:this._fieldsClassifier.toString(t)||"nothing",prediction:t,explanation:this._fieldsClassifier.explain(e),context:e}})}}constructor(){(0,n._)(this,"_formsClassifier",void 0),(0,n._)(this,"_fieldsClassifier",void 0)}}var eg=a(26906),eh=a(18656);let ew=async e=>{let t=await (0,eg.U)(e);if(void 0===t[e])throw Error("Undefined key in local storage");return t[e]},ey=e=>(0,eh.t)(e),eb="tiresiasConfigOption",ef=e=>ey({[eb]:e}),eS=()=>ew(eb);var eC=a(85500),eA=a(96014);class eI{loadFileContent(e,t){switch(t){case ea.Json:return JSON.parse(e);case ea.Bson:return(0,eA.vB)(e);default:return e}}}class eM extends eI{fetch(e,t,a,r){new Promise((r,i)=>{fetch((0,eC.A)(e),{mode:"same-origin"}).then(e=>e.blob()).then(function(e){let n=new FileReader;n.addEventListener("loadend",function(){if(a&&"function"==typeof a)try{this.result||i(Error("The result of fetch is null")),r(this.result)}catch(e){i(e)}}),t===ea.Bson?n.readAsArrayBuffer(e):n.readAsText(e)}).catch(i)}).then(e=>a(this.loadFileContent(e,t))).catch(r)}constructor(){super()}}class eT{static build(){return new eM}}let ek=["https","http"],eP={debugMode:!0,deepFormOutput:!0,isMLAntiPhishingEnabled:!1};class eE{async _loadPhishingModel(){try{return(0,l.u)(chrome.runtime.getURL("data/anti-phishing-model.ort"))}catch(e){return}}async _initializePhishingModel(){this._grapheneClient?.mlAntiPhishing.queries.getAntiPhishingStatus().pipe(m.w(e=>{if(o.d6(e)){let t=o.db(e).isEnabled;return eP.isMLAntiPhishingEnabled=t,t?this._phishingModel?g.of(this._phishingModel):h.D(this._loadPhishingModel()):g.of(void 0)}return g.of(void 0)}),w.b(e=>{this._phishingModel=e})).subscribe()}_initializeUpdateableResources(){this._resourcesStorage=new S,this._localFileFetcher=eT.build(),this._fileManager=new ed(this.logException,this._localFileFetcher,{carbonConnectorApi:this.carbonConnectorApi,grapheneClient:this._grapheneClient}).registerFileListener(es.NAME,e=>{this._pandora.setFormsClassifier(e)}).registerFileListener(eo.NAME,e=>{this._pandora.setFieldsClassifier(e)}).registerFileListener(el.NAME,e=>{this._resourcesStorage.setResource("overrides",e)}),this._fileResourcesLoading=this._fileManager.init()}_initializeDevTool(){this._devtoolManager=new X(!1,this.logException),this._devtoolManager.listen(),this._registerHandlers(),y&&this._devtoolManager.setPandora(this._pandora),d.i.addListener((e,t)=>{try{if("complete"===t.status){if(!t.url||!ek.includes(new URL(t.url).protocol))return;this._devtoolManager.isEnabled&&this._devtoolManager.deleteTabId(e);let a=new A;(0,c.b)(e,a,{ignoreError:!0},()=>{})}}catch(e){this.logException(e,{precisions:"Exception in onUpdated listener",fileName:"TiresiasBackground.ts",funcName:"TiresiasBackground._initializeDevTool",code:s.w.ERROR})}}),this._devtoolManager.isEnabled&&u.$.addListener(e=>{try{this._devtoolManager.deleteTabId(e)}catch(e){this.logException(e,{precisions:"Exception in onRemoved listener",fileName:"TiresiasBackground.ts",funcName:"TiresiasBackground._initializeDevTool",code:s.w.ERROR})}})}_replyConfiguration(e,t,a){return a(new M(eP)),!0}async _replyTabLanguage(e,t){try{let e=t.tab?.id;if(e){let t=await (0,p.e)(e);return new T(t||"und")}throw Error("Missing tabId")}catch(e){return this.logException(e,{message:"Unable to detect page language",appendExceptionToMessage:!1,fileName:"TiresiasBackground.ts",funcName:"TiresiasBackground._replyTabLanguage",code:s.w.WARNING,rateLimit:.1}),new T("und")}}_ahoCorasickify(e,t,a){let r=["humanReadableProse","attributes","buttonVerbatim"];return e.formsAndFieldsContexts.forEach(e=>{if(e.formContext)for(let t of r)t in e.formContext&&(e.formContext[t]=this._ahoCorasickWrapper.searchAndSplit(e.formContext[t]));e.fieldsContext.forEach(e=>{if(e)for(let t of r)t in e&&(e[t]=this._ahoCorasickWrapper.searchAndSplit(e[t]))})}),a(e.formsAndFieldsContexts),!0}_toggleDevTool(e,t,a){let r=y&&e.isDevtoolEnabled;return r||this._devtoolManager.cleanTabStorage(),this._devtoolManager.isEnabled=r,a({}),!0}_performClassification(e,t,a){return this._fileResourcesLoading.then(()=>{let r=t.tab?.id;if(a(e.formStructure.map(e=>this._pandora.predictStructure(e))),r&&this._devtoolManager.isEnabled){let t=e.formStructure.map(e=>this._pandora.explainStructure(e));this._devtoolManager.storeTabFormsStructure(r,t)}}),!0}_getPhishingProbability(e,t,a){return t.url&&(this._phishingModel||a(),(0,l.X)(this._phishingModel,e.scrapings,t.url).then(e=>{a(e)})),!0}_dispatchIframeReport(e,t,a){let r=t.tab?.id;return r&&(0,c.b)(r,new k(e.report),{}),a({}),!0}_respondFrameId(e,t,a){let r=new P(t.frameId??0);if(t.tab?.id){let e=this._frameIdCollector.getParentFrameId(t.tab.id,r.frameId);void 0!==e&&(r.parentFrameId=e)}return a(r),!0}_showTimeToD(e,t,a){return a({}),!0}_handleAnalysisSkippedRequest(e,t,a){let r=t.tab?.id;return r&&new Promise(e=>{(0,c.b)(r,new E,{frameId:0},e)}).then(e=>a(e)),!0}_handleContentToContentMessage(e,t,a){let r=t.tab?.id;return r&&new Promise(t=>{(0,c.b)(r,e.innerMessage,{frameId:e.frameId},t)}).then(e=>a(e)),!0}_handleInitResourcesMessage(e,t,a){return this._fileResourcesLoading.then(()=>{a(this._resourcesStorage.getAllResources())}),!0}_handleGetConfigurationMessage(e,t,a){return eS().then(e=>{a(e)}).catch(()=>{a(void 0)}),!0}_handleSetConfigurationMessage(e,t,a){return ef(e.tiresiasBackgroundOption),!0}_registerHandlers(){[{msg:F.MSG,handler:this._replyConfiguration},{msg:_.MSG,handler:this._replyTabLanguage},{msg:D.MSG,handler:this._ahoCorasickify},{msg:L.MSG,handler:this._toggleDevTool},{msg:G.MSG,handler:this._performClassification},{msg:U.MSG,handler:this._getPhishingProbability},{msg:x.MSG,handler:this._dispatchIframeReport},{msg:B.MSG,handler:this._respondFrameId},{msg:O.MSG,handler:this._showTimeToD},{msg:V.MSG,handler:this._handleAnalysisSkippedRequest},{msg:C.MSG,handler:this._handleContentToContentMessage},{msg:W.MSG,handler:this._handleInitResourcesMessage},{msg:Y.MSG,handler:this._handleLogExceptionMessage},{msg:K.MSG,handler:this._handleGetConfigurationMessage},{msg:H.MSG,handler:this._handleSetConfigurationMessage}].forEach(({msg:e,handler:t})=>{this._messageHandler.addListener(this,e,t)})}_handleLogExceptionMessage(e){return this.carbonConnectorApi&&j(this.carbonConnectorApi,{message:e.log.message??"LogExceptionMessage received with no message",...e.log}),!1}constructor(e){(0,n._)(this,"_ahoCorasickWrapper",void 0),(0,n._)(this,"_pandora",void 0),(0,n._)(this,"_devtoolManager",void 0),(0,n._)(this,"_frameIdCollector",void 0),(0,n._)(this,"_fileManager",void 0),(0,n._)(this,"_localFileFetcher",void 0),(0,n._)(this,"_resourcesStorage",void 0),(0,n._)(this,"_messageHandler",void 0),(0,n._)(this,"_fileResourcesLoading",void 0),(0,n._)(this,"_grapheneClient",void 0),(0,n._)(this,"_phishingModel",void 0),(0,n._)(this,"carbonConnectorApi",void 0),(0,n._)(this,"logException",void 0),this._grapheneClient=e.grapheneClient,this.carbonConnectorApi=e.carbonConnectorApi,this.logException=this.carbonConnectorApi?z(e.messageLogger,this.carbonConnectorApi):()=>{};try{this._messageHandler=new f(this.logException),this._pandora=new em,this._initializePhishingModel(),this._frameIdCollector=new ep(this.logException),this._ahoCorasickWrapper=new $,this._initializeDevTool(),this._initializeUpdateableResources()}catch(e){this.logException(e,{precisions:"Exception in background initialization",fileName:"TiresiasBackground.ts",funcName:"TiresiasBackground.constructor",code:s.w.ERROR})}}}}}]);