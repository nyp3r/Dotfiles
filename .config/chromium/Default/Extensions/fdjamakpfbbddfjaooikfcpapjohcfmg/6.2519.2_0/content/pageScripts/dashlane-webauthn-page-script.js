(()=>{"use strict";var e=function(e){return e.NotSupportedError="NotSupportedError",e.SecurityError="SecurityError",e.NotAllowedError="NotAllowedError",e.InvalidStateError="InvalidStateError",e.UnknownError="UnknownError",e}({});function t(e){return function(e){return"object"==typeof e&&null!==e&&"status"in e&&"success"===e.status&&"value"in e&&"object"==typeof e.value&&null!==e.value}(e)||function(e){return"object"==typeof e&&null!==e&&"status"in e&&"useFallback"===e.status}(e)||function(e){return"object"==typeof e&&null!==e&&"status"in e&&"error"===e.status&&"errorName"in e&&"string"==typeof e.errorName}(e)}function n(e){return globalThis.cloneInto&&"function"==typeof globalThis.cloneInto?e instanceof Promise?(t=e,new window.Promise(((e,o)=>t.then((t=>e(t&&"object"==typeof t?n(t):t))).catch((e=>o(e&&"object"==typeof e?n(e):e)))))):globalThis.cloneInto(e,window,{cloneFunctions:!0,wrapReflectors:!0}):e;var t}function o(e){return globalThis.exportFunction&&"function"==typeof globalThis.exportFunction?globalThis.exportFunction(((...t)=>{const o=e(...t);return o&&"object"==typeof o?n(o):o}),window):e}const r=Reflect.apply;function i(e,t,i){const a=o(i),s={apply:(e,t,n)=>a({original:e,thisArg:t,apply:r},...n)},l=new window.Proxy(e[t],n(s));globalThis.exportFunction&&"function"==typeof globalThis.exportFunction?globalThis.exportFunction(l,e,{defineAs:t}):Object.defineProperty(e,t,{value:l})}const a=Reflect.apply;function s(e,t,r){const i=o(r),s={apply:(e,t,n)=>i({original:e,thisArg:t,apply:a},...n)},l=e[t],u=new window.Proxy(l,n(s));globalThis.exportFunction&&"function"==typeof globalThis.exportFunction?globalThis.exportFunction(u,e,{defineAs:t}):Object.defineProperty(e,t,{value:u})}const l="dashlane-content-to-page",u="dashlane-content-ready";let c=0;const p=new Promise((e=>{const t=()=>{document.removeEventListener(u,t),e()};document.addEventListener(u,t)})),d=async(e,t)=>("forward_webauthn_ready"!==document.getElementById("dashlane_webauthn")?.getAttribute("name")&&await p,new Promise(((n,o)=>{const r=c+1;c=r;const i=e=>{const o=JSON.parse(e.detail);((e,t)=>"object"==typeof e&&null!==e&&"msgId"in e&&"number"==typeof e.msgId&&"response"in e&&t(e.response))(o,t)&&o.msgId===r&&(document.removeEventListener(l,i),n(o.response))};document.addEventListener(l,i);const a=new CustomEvent("dashlane-page-to-content",{detail:{msgId:r,message:e}});document.dispatchEvent(a)}))),h=Math.pow(10,6),f="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";function g(e){const t=e.length,n=[];for(let o=0;o<t;o+=3)n.push(f[e[o]>>2]),n.push(f[(3&e[o])<<4|e[o+1]>>4]),n.push(f[(15&e[o+1])<<2|e[o+2]>>6]),n.push(f[63&e[o+2]]);return n.join("")}function w(e){return function(e,t=h){const n=new Uint8Array(e),o=n.length,r=t%3,i=0===r?t:t+(3-r),a=Math.ceil(o/i);let s="",l=-1;for(;l++<a;){const e=l*i,t=l===a-1?o:(l+1)*i,r=g(n.slice(e,t));s=s.concat(r)}return o%3==2?s.substring(0,s.length-1)+"=":o%3==1?s.substring(0,s.length-2)+"==":s}(new Uint8Array(e)).replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")}const y=new Uint8Array(256);for(let e=0;e<f.length;e++)y[f.charCodeAt(e)]=e;function b(e){const t=e.replace(/-/g,"+").replace(/_/g,"/"),n=(4-t.length%4)%4;return function(e){let t=.75*e.length;const n=e.length;let o,r,i,a,s,l=0;e.endsWith("=")&&(t--,"="===e[e.length-2]&&t--);const u=new ArrayBuffer(t),c=new Uint8Array(u);for(o=0;o<n;o+=4)r=y[e.charCodeAt(o)],i=y[e.charCodeAt(o+1)],a=y[e.charCodeAt(o+2)],s=y[e.charCodeAt(o+3)],c[l++]=r<<2|i>>4,c[l++]=(15&i)<<4|a>>2,c[l++]=(3&a)<<6|63&s;return u}(t.padEnd(t.length+n,"="))}function A(e){return"buffer"in e?e.buffer:e}const m=Object.freeze({IS_CONDITIONAL_UI_AVAILABLE:"IS_CONDITIONAL_UI_AVAILABLE"});function I(e){return"object"==typeof e&&null!==e&&"function"in e&&"webauthn.create"===e.function&&"result"in e&&t(e.result)}function E(e){return"object"==typeof e&&null!==e&&"function"in e&&"webauthn.get"===e.function&&"result"in e&&t(e.result)}function v(e){return"object"==typeof e&&null!==e&&"function"in e&&e.function===m.IS_CONDITIONAL_UI_AVAILABLE&&"result"in e&&"boolean"==typeof e.result}const N=[],T=[],S={[e.NotSupportedError]:"The operation is not supported",[e.SecurityError]:"The operation is insecure",[e.NotAllowedError]:"The request is not allowed by the user agent or the platform in the current context, possibly because the user denied permission",[e.InvalidStateError]:"The object is in an invalid state",[e.UnknownError]:"The operation failed for an unknown transient reason (e.g. out of memory)"};i(window.navigator.credentials,"get",(async({original:e,thisArg:t,apply:n},r)=>{const i=r?.mediation,a=r?.publicKey;if(a){const e=function(e,t){return{function:"webauthn.get",mediation:t,param:{...e,challenge:w(A(e.challenge)),allowCredentials:(e.allowCredentials??[]).map((e=>({...e,id:w(A(e.id))})))}}}(a,i),t=await d(e,E);if("webauthn.get"===t.function){if("useFallback"!==t.result.status){if("error"===t.result.status)throw new DOMException(S[t.result.errorName],t.result.errorName);const e=function(e){const t={clientDataJSON:b(e.response.clientDataJSON),authenticatorData:b(e.response.authenticatorData),signature:b(e.response.signature),userHandle:e.response.userHandle?b(e.response.userHandle):null};return{...e,rawId:b(e.rawId),response:t,getClientExtensionResults:o((()=>e.clientExtensionResults??{}))}}(t.result.value);return N.push(e),e}s=i,l=t.result,"conditional"===s&&"otherAuthenticator"===l.reason&&delete r.mediation}}var s,l;return n(e,t,[r])})),i(window.navigator.credentials,"create",(async({original:e,thisArg:t,apply:n},r)=>{const i=r?.publicKey;if(i){const e=function(e){return{function:"webauthn.create",param:{...e,challenge:w(A(e.challenge)),excludeCredentials:(e.excludeCredentials??[]).map((e=>({...e,id:w(A(e.id))}))),user:{...e.user,id:w(A(e.user.id))}}}}(i),t=await d(e,I);if("webauthn.create"===t.function&&"useFallback"!==t.result.status){if("error"===t.result.status)throw new DOMException(S[t.result.errorName],t.result.errorName);const e=function(e){const t={clientDataJSON:b(e.clientDataJSON),attestationObject:b(e.attestationObject),getTransports:o((()=>e.transports)),getPublicKeyAlgorithm:o((()=>e.publicKeyAlgorithm)),getAuthenticatorData:o((()=>b(e.authenticatorData))),getPublicKey:o((()=>b(e.publicKey)))};return{...e,rawId:b(e.rawId),response:t,getClientExtensionResults:o((()=>e.clientExtensionResults??{}))}}(t.result.value);return T.push(e),e}}return n(e,t,[r])})),window.PublicKeyCredential&&(s(window.PublicKeyCredential,Symbol.hasInstance,(async({original:e,thisArg:t,apply:n},o)=>!(!N.some((e=>e===o))&&!T.some((e=>e===o)))||n(e,t,[o]))),s(window.AuthenticatorAssertionResponse,Symbol.hasInstance,(async({original:e,thisArg:t,apply:n},o)=>!!N.some((e=>e.response===o))||n(e,t,[o]))),s(window.AuthenticatorAttestationResponse,Symbol.hasInstance,(async({original:e,thisArg:t,apply:n},o)=>!!T.some((e=>e.response===o))||n(e,t,[o]))),i(window.PublicKeyCredential,"isConditionalMediationAvailable",(async({original:e,thisArg:t,apply:n})=>{const o={function:m.IS_CONDITIONAL_UI_AVAILABLE};return(await d(o,v)).result||n(e,t,[])})))})();