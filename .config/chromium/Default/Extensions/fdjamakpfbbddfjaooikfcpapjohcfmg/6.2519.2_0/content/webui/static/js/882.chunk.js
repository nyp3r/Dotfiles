"use strict";(this.webpackChunk_dashlane_webcards=this.webpackChunk_dashlane_webcards||[]).push([["882"],{9981:function(e,t,a){a.r(t),a.d(t,{App:()=>W});var n=a(6832),s=a(7637),r=a(1068),l=a(2263),u=a(4014),c=a(4191),d=a(1722);let o=new Set(["en","fr","es","ja","de","pt","it","ko","zh","nl","sv"]);function i(e){return e.substr(0,2)}function g(e){let t=i(e);return o.has(t)}var m=a(1906),b=a(7640);let f=e=>{let[t,a]=n.useState(),[s]=n.useState({});return n.useEffect(()=>{a(e.connectToAutofillEngine(new m.Ps().getBrowserApi(),s,b.vq.Webcards,(t,a)=>{e.log(`[AutofillEngine] ${t}
${JSON.stringify(a,null,2)}`)}))},[s,e]),[t,e=>{Object.keys(e).forEach(t=>{s[t]&&delete s[t],s[t]=e[t]})}]};var E=a(9470),p=a(3611),h=a(9713),w=a(2722);let F=e=>{let[t,a]=n.useState();return n.useEffect(()=>{a(e.connectToDispatcher(new m.Ps().getBrowserApi(),b.vq.Webcards))},[e]),t};var S=a(1081);let v=({children:e})=>((0,r.F)("system"),n.createElement(n.Fragment,null,e)),W=({utils:e,MainComponent:t})=>{let[a,r]=n.useState(null),[o,m]=n.useState(null),[b,W]=n.useState(()=>()=>{}),[k,y]=n.useState(()=>()=>{}),[I,A]=n.useState(e.getFromUrl().features??{}),C=n.useMemo(()=>e.getFromUrl().langCode||function(){let e=[navigator.language].concat(navigator.languages).find(g);return e?e.includes("-")?i(e):e:"en"}(),[e]),[_,U]=f(e),D=F(e),M=n.useCallback(async()=>{let t=e.getFromUrl().token;if(D&&t){let e=await D.sendMessage({message:d._.GetWebcardInitialData,targetFrameId:0},t);e&&m(t=>({...e,sandboxKey:(t?.sandboxKey??0)+1}))}},[_,D,e]);return(n.useEffect(()=>{let t=e.getFromUrl().token;D&&t&&(M(),W(()=>e=>D.sendMessage({message:d._.UpdateWebcardGeometry,targetFrameId:0},t,e).then(e=>{e&&(r(Number(e)),D.sendMessage({message:d._.WebcardOpened}))})),y(()=>e=>{D.sendMessage({message:d._.WebcardClosed,targetFrameId:0},t,e),_?.webcardClosed(t)}),U({updateUserFeatureFlips:e=>{A(e??{})}}),_?.getUserFeatureFlips())},[_,D,e]),o&&_&&D)?(U({updateWebcard:e=>{e.webcardId===o.webcardId&&m({...e,sandboxKey:o.sandboxKey})},closeWebcard:e=>{e===o.webcardId&&k()},updateDomainAnalysisStatus:e=>{e||k()}}),n.createElement(s.f6W,{theme:(0,l.It)(u.uH,s.uHP)},n.createElement(c.SG,null,n.createElement(v,null,n.createElement(h.q6,{langCode:C},n.createElement(S.f,{autofillEngineCommands:_,autofillEngineDispatcher:D,setAutofillEngineActionsHandlers:U},n.createElement(E.D,{featureFlips:I},n.createElement(w.Z9,{timeToWebcard:a},n.createElement(p.k.Provider,{value:{sendWebcardGeometry:b}},n.createElement(t,{utils:e,data:o,closeWebcard:k,getInitState:M})))))))))):null}}}]);