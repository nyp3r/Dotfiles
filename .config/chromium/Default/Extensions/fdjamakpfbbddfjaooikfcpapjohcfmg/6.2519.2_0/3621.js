"use strict";(globalThis.webpackChunk_dashlane_leeloo=globalThis.webpackChunk_dashlane_leeloo||[]).push([[3621],{5559:(e,t,a)=>{a.r(t),a.d(t,{SecretAddPanelComponent:()=>A});var n=a(96832),c=a(40577),s=a(8180),i=a(51031),l=a(14877),r=a(39431),o=a(14900),d=a(73704),p=a(86498),_=a(88203),u=a(14943),h=a(45272),b=a(92077),S=a(42670),m=a(19122),g=a(53189),C=a(69909),y=a(63520),I=a(15940),T=a(66098),w=a(78047),f=a(36351);const{CONTENT:v,DOCUMENT_STORAGE:E}=I.SecretsTabs,A=()=>{const{routes:e}=(0,b.Xo)(),t=(0,u.Y)(),[a,I]=(0,n.useState)(v),[A,D]=(0,n.useState)(!1),[O,Z]=(0,n.useState)(!1),{currentSpaceId:N,teamId:R}=(0,m.fV)(),U=(0,c.o)("ace_secrets_vault_attachment"),{attachments:k,isUploading:x,removeAttachment:P,removeAllAttachments:B}=(0,C.P)(),[M,F]=(0,n.useState)({id:"",title:"",content:"",spaceId:null!=N?N:R?String(R):"",secured:!1}),{shouldShowFrozenStateDialog:V}=(0,S.Ub)(),{createVaultItem:z}=(0,s.u)(l.L),L=(0,p.V)(),{translate:X}=(0,_.Z)();if((0,n.useEffect)((()=>{(0,h.Nc)(d.PageView.ItemSecretCreate)}),[]),t.status!==i.rq.Success||!t?.data)return null;const H=()=>{(0,b.uX)(e.userSecrets)},G=U?[{id:"tab-secret-detail",contentId:"content-secret-detail",title:X("webapp_secrets_edition_field_tab_title_details"),onSelect:()=>I(v)},{id:"tab-secret-attachments",contentId:"content-secret-attachments",title:X("webapp_secrets_edition_field_tab_title_attachments"),onSelect:()=>I(E)}]:void 0;return(0,f.tZ)(y.zI,{isUsingNewDesign:!0,isViewingExistingItem:!1,itemHasBeenEdited:A,submitPending:O,onSubmit:async()=>{O||(Z(!0),await(async()=>{try{var e;await z({vaultItemType:r.U.Secret,content:{title:M.title,content:M.content,spaceId:null!=(e=M.spaceId)?e:"",isSecured:M.secured,attachments:k}})}catch(e){Z(!1),L.showAlert(X("_common_generic_error"),o.BLW.ERROR)}})(),H())},onNavigateOut:()=>{B(),H()},formId:"add_secret_panel",header:(0,f.tZ)(T.h,{title:M.title?M.title:X("webapp_secrets_title_field"),tabs:G}),secondaryActions:a===E?[(0,f.tZ)(g.d,{isQuotaReached:!1,isShared:!1,dataType:"KWSecret",disabled:!!V,isUploading:x},"uploadAction")]:[],children:(0,f.tZ)(w.e,{activeTab:a,isSecured:M.secured,secretValues:M,attachments:k,handleChange:(e,t)=>{if("spaceId"===e&&t===M.spaceId)return;const a={...M,[e]:t},n=!!(a.title||a.content||a.spaceId||a.secured);n!==A&&D(n),F(a)},handleFileInfoDetached:P,isAttachmentUploading:x,isNewItem:!0,sharingCapabilities:{canManageAccess:!1,canShare:!1,canEdit:!0,canCopy:!0,canReveal:!0}})})}},15940:(e,t,a)=>{a.d(t,{SecretsTabs:()=>n});let n=function(e){return e[e.CONTENT=0]="CONTENT",e[e.SHARED_ACCESS=1]="SHARED_ACCESS",e[e.DOCUMENT_STORAGE=2]="DOCUMENT_STORAGE",e}({})},66098:(e,t,a)=>{a.d(t,{h:()=>l});var n,c=a(94138),s=a(63520),i=a(36351);const l=({title:e,tabs:t})=>(0,i.tZ)(s.V9,{icon:n||(n=(0,i.tZ)(c.A,{type:"secret",size:"xlarge"})),title:e,tabs:t})},78047:(e,t,a)=>{a.d(t,{e:()=>x});var n=a(96832),c=a(63847),s=a(93853),i=a(51409),l=a(68999),r=a(80610),o=a(51031),d=a(80936),p=a(88203),_=a(24294),u=a(33988),h=a(54350),b=a(68037),S=a(67406),m=a(15940),g=a(42670),C=a(47595),y=a(73704),I=a(30894),T=a(68819),w=a(82207),f=a(45272),v=a(79432),E=a(13252),A=a(36351);const{CONTENT:D,SHARED_ACCESS:O,DOCUMENT_STORAGE:Z}=m.SecretsTabs,N="webapp_secure_notes_edition_field_text_max_size_reached",R="webapp_secret_edition_action_show_secret_content",U="webapp_secret_edition_action_hide_secret_content",k=1e4,x=({activeTab:e,sharingCapabilities:t,isSecured:a,isAttachmentUploading:m,isNewItem:x,secretValues:P,attachments:B,handleChange:M,handleFileInfoDetached:F,onModalDisplayStateChange:V})=>{const{translate:z}=(0,p.Z)(),[L,X]=(0,n.useState)(""),{shouldShowFrozenStateDialog:H}=(0,g.Ub)(),G=(0,u.F)(),{isMPLessUser:K}=(0,h.Z)(),q=!G&&!K,{areProtectedItemsUnlocked:W,openProtectedItemsUnlocker:Y}=(0,I.tY)(),{logRevealSecretContent:j,logCopiedSecretContent:Q}=(0,v.D)(),J=(0,d.I)(),$=J.status===o.rq.Success&&!J.isDisabled,{id:ee,title:te,content:ae,spaceId:ne,secured:ce}=P,[se,ie]=(0,n.useState)(""===ae),le=a&&!W,re=Boolean(ae.length),oe=Boolean(ne),de=(0,n.useCallback)(((e,t)=>new Promise(((a,n)=>{if(e||!le||!q)return t(),a();Y({action:T.P.Show,itemType:T.R.Secret,successCallback:()=>(t(),a()),cancelCallback:n})}))),[le,Y]),pe=()=>{ie((e=>!e)),!se&&oe&&j(te)};return null===H?null:(0,A.BX)(n.Fragment,{children:[e===D&&(0,A.BX)(c.k,{"aria-labelledby":"tab-secret-detail",id:"content-secret-detail",flexDirection:"column",gap:"16px",children:[(0,A.BX)(b.u,{title:z("webapp_secrets_box_title_details"),children:[(0,A.tZ)(s.n,{"data-name":"title",label:z("webapp_secrets_title_field"),value:te,onChange:e=>M("title",e.target.value),disabled:!t.canEdit,readOnly:H,sx:{marginBottom:"8px"}}),(0,A.tZ)(i.K,{"data-name":"content",label:z("webapp_secrets_content_field"),placeholder:z("webapp_secrets_content_field_placeholder"),value:se||!re?ae:"••••••••",onBeforeInput:e=>{const t=e.currentTarget.value;t.length>k&&(X(z(N,{charLeft:k-(t.length-1)})),e.preventDefault())},onPaste:e=>{const t=e.clipboardData.getData("text/plain");e.currentTarget.value.length+t.length>k&&(X(z(N,{charLeft:k-e.currentTarget.value.length})),e.preventDefault())},onChange:e=>{L&&X(""),M("content",e.target.value)},readOnly:!se&&re||H||!t.canEdit,feedback:L?{text:L}:void 0,error:!!L,actions:[(0,A.tZ)(l.z,{layout:"iconOnly",icon:se?"ActionHideOutlined":"ActionRevealOutlined",mood:"brand",intensity:"supershy",sx:{marginRight:"16px"},onClick:()=>{de(se,pe).catch((()=>{ie(!1)}))},"aria-label":z(se?U:R),tooltip:z(se?U:R)},"secret-content-visibility"),...re?[(0,A.tZ)(w.m,{data:ae,checkProtected:()=>le,copyLabel:z("webapp_secret_edition_action_copy_secret_content"),onCopy:()=>{(0,f.Kz)(new y.UserCopyVaultItemFieldEvent({itemId:ee,itemType:y.ItemType.Secret,field:y.Field.Secret,isProtected:a})),oe&&Q(te)},itemType:T.R.Secret,tooltipLocation:"right"},"copy-secret-content")]:[]]})]}),$?(0,A.tZ)(S.M,{disabled:H,contentCardLabel:z("webapp_secrets_box_title_organization"),wrapInContentCard:!0,isUsingNewDesign:!0,defaultSpaceId:null!=ne?ne:"",spaceId:null!=ne?ne:"",onChange:e=>M("spaceId",e)}):null,q?(0,A.tZ)(b.u,{title:z("webapp_secrets_box_title_preferences"),children:(0,A.tZ)(r.X,{readOnly:H,label:z("webapp_secrets_preferences_mp_title"),description:z("webapp_secrets_preferences_mp_description"),checked:Boolean(ce),onChange:()=>{W||x?M("secured",Boolean(!ce)):((0,I.jF)(),Y({action:T.P.Show,itemType:T.R.Secret,successCallback:()=>M("secured",Boolean(!ce))}))}})}):null]}),e===Z&&(0,A.tZ)("div",{"aria-labelledby":"tab-secret-attachments",id:"content-secret-attachments",children:(0,A.tZ)(C.P,{attachments:B,additionalProps:{itemId:ee,itemType:y.ItemType.Secret,handleFileInfoDetached:e=>{F(e)},onModalDisplayStateChange:V,isUploading:m}})}),e===O&&(0,A.tZ)("div",{"aria-labelledby":"tab-secret-shared-access",id:"content-secret-shared-access",children:(0,A.tZ)(_.u,{canManageAccess:t.canManageAccess,type:E.y2.Secret,id:ee})})]})}}}]);